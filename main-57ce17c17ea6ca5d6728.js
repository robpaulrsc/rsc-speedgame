!function(n){var i={};function r(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=n,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=190)}([function(e,t,n){e.exports=c;var i=n(8);function c(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}c.ZERO=new c(0,0,0),c.UNIT_X=new c(1,0,0),c.UNIT_Y=new c(0,1,0),c.UNIT_Z=new c(0,0,1),c.prototype.cross=function(e,t){var n=e.x,i=e.y,r=e.z,o=this.x,a=this.y,s=this.z;return(t=t||new c).x=a*r-s*i,t.y=s*n-o*r,t.z=o*i-a*n,t},c.prototype.set=function(e,t,n){return this.x=e,this.y=t,this.z=n,this},c.prototype.setZero=function(){this.x=this.y=this.z=0},c.prototype.vadd=function(e,t){if(!t)return new c(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z},c.prototype.vsub=function(e,t){if(!t)return new c(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z},c.prototype.crossmat=function(){return new i([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])},c.prototype.normalize=function(){var e=this.x,t=this.y,n=this.z,i=Math.sqrt(e*e+t*t+n*n);if(0<i){var r=1/i;this.x*=r,this.y*=r,this.z*=r}else this.x=0,this.y=0,this.z=0;return i},c.prototype.unit=function(e){e=e||new c;var t=this.x,n=this.y,i=this.z,r=Math.sqrt(t*t+n*n+i*i);return 0<r?(r=1/r,e.x=t*r,e.y=n*r,e.z=i*r):(e.x=1,e.y=0,e.z=0),e},c.prototype.length=c.prototype.norm=function(){var e=this.x,t=this.y,n=this.z;return Math.sqrt(e*e+t*t+n*n)},c.prototype.lengthSquared=c.prototype.norm2=function(){return this.dot(this)},c.prototype.distanceTo=function(e){var t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,a=e.z;return Math.sqrt((r-t)*(r-t)+(o-n)*(o-n)+(a-i)*(a-i))},c.prototype.distanceSquared=function(e){var t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,a=e.z;return(r-t)*(r-t)+(o-n)*(o-n)+(a-i)*(a-i)},c.prototype.mult=function(e,t){t=t||new c;var n=this.x,i=this.y,r=this.z;return t.x=e*n,t.y=e*i,t.z=e*r,t},c.prototype.vmul=function(e,t){return(t=t||new c).x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t},c.prototype.scale=c.prototype.mult,c.prototype.addScaledVector=function(e,t,n){return(n=n||new c).x=this.x+e*t.x,n.y=this.y+e*t.y,n.z=this.z+e*t.z,n},c.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},c.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z},c.prototype.negate=function(e){return(e=e||new c).x=-this.x,e.y=-this.y,e.z=-this.z,e};var a=new c,s=new c;c.prototype.tangents=function(e,t){var n=this.norm();if(0<n){var i=a,r=1/n;i.set(this.x*r,this.y*r,this.z*r);var o=s;Math.abs(i.x)<.9?o.set(1,0,0):o.set(0,1,0),i.cross(o,e),i.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)},c.prototype.toString=function(){return this.x+","+this.y+","+this.z},c.prototype.toArray=function(){return[this.x,this.y,this.z]},c.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},c.prototype.lerp=function(e,t,n){var i=this.x,r=this.y,o=this.z;n.x=i+(e.x-i)*t,n.y=r+(e.y-r)*t,n.z=o+(e.z-o)*t},c.prototype.almostEquals=function(e,t){return void 0===t&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)},c.prototype.almostZero=function(e){return void 0===e&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)};var r=new c;c.prototype.isAntiparallelTo=function(e,t){return this.negate(r),r.almostEquals(e,t)},c.prototype.clone=function(){return new c(this.x,this.y,this.z)}},function(e,t,n){e.exports=i;var i=n(1);function i(){this.id=i.idCounter++,this.type=0,this.boundingSphereRadius=0,this.collisionResponse=!0,this.material=null,this.body=null}n(0),n(3),n(28),(i.prototype.constructor=i).prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type},i.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type},i.prototype.calculateLocalInertia=function(e,t){throw"calculateLocalInertia() not implemented for shape type "+this.type},i.idCounter=0,i.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},function(e,t,n){var i=n(57)("wks"),r=n(42),o=n(4).Symbol,a="function"==typeof o;(e.exports=function(e){return i[e]||(i[e]=a&&o[e]||(a?o:r)("Symbol."+e))}).store=i},function(e,t,n){e.exports=v;var p=n(0);function v(e,t,n,i){this.x=void 0!==e?e:0,this.y=void 0!==t?t:0,this.z=void 0!==n?n:0,this.w=void 0!==i?i:1}v.prototype.set=function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},v.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w},v.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},v.prototype.setFromAxisAngle=function(e,t){var n=Math.sin(.5*t);return this.x=e.x*n,this.y=e.y*n,this.z=e.z*n,this.w=Math.cos(.5*t),this},v.prototype.toAxisAngle=function(e){e=e||new p,this.normalize();var t=2*Math.acos(this.w),n=Math.sqrt(1-this.w*this.w);return n<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/n,e.y=this.y/n,e.z=this.z/n),[e,t]};var o=new p,a=new p;v.prototype.setFromVectors=function(e,t){if(e.isAntiparallelTo(t)){var n=o,i=a;e.tangents(n,i),this.setFromAxisAngle(n,Math.PI)}else{var r=e.cross(t);this.x=r.x,this.y=r.y,this.z=r.z,this.w=Math.sqrt(Math.pow(e.norm(),2)*Math.pow(t.norm(),2))+e.dot(t),this.normalize()}return this},new p,new p,new p,v.prototype.mult=function(e,t){t=t||new v;var n=this.x,i=this.y,r=this.z,o=this.w,a=e.x,s=e.y,c=e.z,l=e.w;return t.x=n*l+o*a+i*c-r*s,t.y=i*l+o*s+r*a-n*c,t.z=r*l+o*c+n*s-i*a,t.w=o*l-n*a-i*s-r*c,t},v.prototype.inverse=function(e){var t=this.x,n=this.y,i=this.z,r=this.w;e=e||new v,this.conjugate(e);var o=1/(t*t+n*n+i*i+r*r);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e},v.prototype.conjugate=function(e){return(e=e||new v).x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e},v.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this},v.prototype.normalizeFast=function(){var e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0==e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this},v.prototype.vmult=function(e,t){t=t||new p;var n=e.x,i=e.y,r=e.z,o=this.x,a=this.y,s=this.z,c=this.w,l=c*n+a*r-s*i,u=c*i+s*n-o*r,h=c*r+o*i-a*n,d=-o*n-a*i-s*r;return t.x=l*c+d*-o+u*-s-h*-a,t.y=u*c+d*-a+h*-o-l*-s,t.z=h*c+d*-s+l*-a-u*-o,t},v.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},v.prototype.toEuler=function(e,t){var n,i,r;t=t||"YZX";var o=this.x,a=this.y,s=this.z,c=this.w;switch(t){case"YZX":var l=o*a+s*c;if(.499<l&&(n=2*Math.atan2(o,c),i=Math.PI/2,r=0),l<-.499&&(n=-2*Math.atan2(o,c),i=-Math.PI/2,r=0),isNaN(n)){var u=o*o,h=a*a,d=s*s;n=Math.atan2(2*a*c-2*o*s,1-2*h-2*d),i=Math.asin(2*l),r=Math.atan2(2*o*c-2*a*s,1-2*u-2*d)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=n,e.z=i,e.x=r},v.prototype.setFromEuler=function(e,t,n,i){i=i||"XYZ";var r=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(n/2),s=Math.sin(e/2),c=Math.sin(t/2),l=Math.sin(n/2);return"XYZ"===i?(this.x=s*o*a+r*c*l,this.y=r*c*a-s*o*l,this.z=r*o*l+s*c*a,this.w=r*o*a-s*c*l):"YXZ"===i?(this.x=s*o*a+r*c*l,this.y=r*c*a-s*o*l,this.z=r*o*l-s*c*a,this.w=r*o*a+s*c*l):"ZXY"===i?(this.x=s*o*a-r*c*l,this.y=r*c*a+s*o*l,this.z=r*o*l+s*c*a,this.w=r*o*a-s*c*l):"ZYX"===i?(this.x=s*o*a-r*c*l,this.y=r*c*a+s*o*l,this.z=r*o*l-s*c*a,this.w=r*o*a+s*c*l):"YZX"===i?(this.x=s*o*a+r*c*l,this.y=r*c*a+s*o*l,this.z=r*o*l-s*c*a,this.w=r*o*a-s*c*l):"XZY"===i&&(this.x=s*o*a-r*c*l,this.y=r*c*a-s*o*l,this.z=r*o*l+s*c*a,this.w=r*o*a+s*c*l),this},v.prototype.clone=function(){return new v(this.x,this.y,this.z,this.w)},v.prototype.slerp=function(e,t,n){n=n||new v;var i,r,o,a,s,c=this.x,l=this.y,u=this.z,h=this.w,d=e.x,p=e.y,f=e.z,m=e.w;return(r=c*d+l*p+u*f+h*m)<0&&(r=-r,d=-d,p=-p,f=-f,m=-m),s=1e-6<1-r?(i=Math.acos(r),o=Math.sin(i),a=Math.sin((1-t)*i)/o,Math.sin(t*i)/o):(a=1-t,t),n.x=a*c+s*d,n.y=a*l+s*p,n.z=a*u+s*f,n.w=a*h+s*m,n},v.prototype.integrate=function(e,t,n,i){i=i||new v;var r=e.x*n.x,o=e.y*n.y,a=e.z*n.z,s=this.x,c=this.y,l=this.z,u=this.w,h=.5*t;return i.x+=h*(r*u+o*l-a*c),i.y+=h*(o*u+a*s-r*l),i.z+=h*(a*u+r*c-o*s),i.w+=h*(-r*s-o*c-a*l),i}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){e.exports={version:n(129).version,AABB:n(7),ArrayCollisionMatrix:n(69),Body:n(9),Box:n(34),Broadphase:n(35),Constraint:n(21),ContactEquation:n(10),Narrowphase:n(71),ConeTwistConstraint:n(131),ContactMaterial:n(74),ConvexPolyhedron:n(19),Cylinder:n(133),DistanceConstraint:n(134),Equation:n(22),EventTarget:n(52),FrictionEquation:n(53),GSSolver:n(75),GridBroadphase:n(135),Heightfield:n(136),HingeConstraint:n(76),LockConstraint:n(137),Mat3:n(8),Material:n(28),NaiveBroadphase:n(77),ObjectCollisionMatrix:n(138),Pool:n(73),Particle:n(78),Plane:n(70),PointToPointConstraint:n(38),Quaternion:n(3),Ray:n(36),RaycastVehicle:n(139),RaycastResult:n(29),RigidVehicle:n(141),RotationalEquation:n(39),RotationalMotorEquation:n(54),SAPBroadphase:n(142),SPHSystem:n(143),Shape:n(1),Solver:n(37),Sphere:n(79),SplitSolver:n(144),Spring:n(145),Transform:n(20),Trimesh:n(146),Vec3:n(0),Vec3Pool:n(72),World:n(148)}},function(e,t,n){var i=n(11);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var i=n(0);function r(e){e=e||{},this.lowerBound=new i,e.lowerBound&&this.lowerBound.copy(e.lowerBound),this.upperBound=new i,e.upperBound&&this.upperBound.copy(e.upperBound)}n(27),e.exports=r;var l=new i;r.prototype.setFromPoints=function(e,t,n,i){var r=this.lowerBound,o=this.upperBound,a=n;r.copy(e[0]),a&&a.vmult(r,r),o.copy(r);for(var s=1;s<e.length;s++){var c=e[s];a&&(a.vmult(c,l),c=l),c.x>o.x&&(o.x=c.x),c.x<r.x&&(r.x=c.x),c.y>o.y&&(o.y=c.y),c.y<r.y&&(r.y=c.y),c.z>o.z&&(o.z=c.z),c.z<r.z&&(r.z=c.z)}return t&&(t.vadd(r,r),t.vadd(o,o)),i&&(r.x-=i,r.y-=i,r.z-=i,o.x+=i,o.y+=i,o.z+=i),this},r.prototype.copy=function(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this},r.prototype.clone=function(){return(new r).copy(this)},r.prototype.extend=function(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)},r.prototype.overlaps=function(e){var t=this.lowerBound,n=this.upperBound,i=e.lowerBound,r=e.upperBound,o=i.x<=n.x&&n.x<=r.x||t.x<=r.x&&r.x<=n.x,a=i.y<=n.y&&n.y<=r.y||t.y<=r.y&&r.y<=n.y,s=i.z<=n.z&&n.z<=r.z||t.z<=r.z&&r.z<=n.z;return o&&a&&s},r.prototype.volume=function(){var e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)},r.prototype.contains=function(e){var t=this.lowerBound,n=this.upperBound,i=e.lowerBound,r=e.upperBound;return t.x<=i.x&&n.x>=r.x&&t.y<=i.y&&n.y>=r.y&&t.z<=i.z&&n.z>=r.z},r.prototype.getCorners=function(e,t,n,i,r,o,a,s){var c=this.lowerBound,l=this.upperBound;e.copy(c),t.set(l.x,c.y,c.z),n.set(l.x,l.y,c.z),i.set(c.x,l.y,l.z),r.set(l.x,c.y,c.z),o.set(c.x,l.y,c.z),a.set(c.x,c.y,l.z),s.copy(l)};var p=[new i,new i,new i,new i,new i,new i,new i,new i];r.prototype.toLocalFrame=function(e,t){var n=p,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],c=n[5],l=n[6],u=n[7];this.getCorners(i,r,o,a,s,c,l,u);for(var h=0;8!==h;h++){var d=n[h];e.pointToLocal(d,d)}return t.setFromPoints(n)},r.prototype.toWorldFrame=function(e,t){var n=p,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],c=n[5],l=n[6],u=n[7];this.getCorners(i,r,o,a,s,c,l,u);for(var h=0;8!==h;h++){var d=n[h];e.pointToWorld(d,d)}return t.setFromPoints(n)},r.prototype.overlapsRay=function(e){var t=1/e._direction.x,n=1/e._direction.y,i=1/e._direction.z,r=(this.lowerBound.x-e.from.x)*t,o=(this.upperBound.x-e.from.x)*t,a=(this.lowerBound.y-e.from.y)*n,s=(this.upperBound.y-e.from.y)*n,c=(this.lowerBound.z-e.from.z)*i,l=(this.upperBound.z-e.from.z)*i,u=Math.max(Math.max(Math.min(r,o),Math.min(a,s)),Math.min(c,l)),h=Math.min(Math.min(Math.max(r,o),Math.max(a,s)),Math.max(c,l));return!(h<0||h<u)}},function(e,t,n){e.exports=l;var u=n(0);function l(e){this.elements=e||[0,0,0,0,0,0,0,0,0]}l.prototype.identity=function(){var e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1},l.prototype.setZero=function(){var e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0},l.prototype.setTrace=function(e){var t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z},l.prototype.getTrace=function(e){e=e||new u;var t=this.elements;e.x=t[0],e.y=t[4],e.z=t[8]},l.prototype.vmult=function(e,t){t=t||new u;var n=this.elements,i=e.x,r=e.y,o=e.z;return t.x=n[0]*i+n[1]*r+n[2]*o,t.y=n[3]*i+n[4]*r+n[5]*o,t.z=n[6]*i+n[7]*r+n[8]*o,t},l.prototype.smult=function(e){for(var t=0;t<this.elements.length;t++)this.elements[t]*=e},l.prototype.mmult=function(e,t){for(var n=t||new l,i=0;i<3;i++)for(var r=0;r<3;r++){for(var o=0,a=0;a<3;a++)o+=e.elements[i+3*a]*this.elements[a+3*r];n.elements[i+3*r]=o}return n},l.prototype.scale=function(e,t){t=t||new l;for(var n=this.elements,i=t.elements,r=0;3!==r;r++)i[3*r+0]=e.x*n[3*r+0],i[3*r+1]=e.y*n[3*r+1],i[3*r+2]=e.z*n[3*r+2];return t},l.prototype.solve=function(e,t){t=t||new u;for(var n,i=[],r=0;r<12;r++)i.push(0);for(r=0;r<3;r++)for(n=0;n<3;n++)i[r+4*n]=this.elements[r+3*n];i[3]=e.x,i[7]=e.y,i[11]=e.z;var o,a,s=3,c=s;do{if(0===i[(r=c-s)+4*r])for(n=r+1;n<c;n++)if(0!==i[r+4*n]){for(o=4;i[(a=4-o)+4*r]+=i[a+4*n],--o;);break}if(0!==i[r+4*r])for(n=r+1;n<c;n++){var l=i[r+4*n]/i[r+4*r];for(o=4;i[(a=4-o)+4*n]=a<=r?0:i[a+4*n]-i[a+4*r]*l,--o;);}}while(--s);if(t.z=i[11]/i[10],t.y=(i[7]-i[6]*t.z)/i[5],t.x=(i[3]-i[2]*t.z-i[1]*t.y)/i[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t},l.prototype.e=function(e,t,n){if(void 0===n)return this.elements[t+3*e];this.elements[t+3*e]=n},l.prototype.copy=function(e){for(var t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this},l.prototype.toString=function(){for(var e="",t=0;t<9;t++)e+=this.elements[t]+",";return e},l.prototype.reverse=function(e){e=e||new l;for(var t,n=[],i=0;i<18;i++)n.push(0);for(i=0;i<3;i++)for(t=0;t<3;t++)n[i+6*t]=this.elements[i+3*t];n[3]=1,n[9]=0,n[15]=0,n[4]=0,n[10]=1,n[16]=0,n[5]=0,n[11]=0,n[17]=1;var r,o,a=3,s=a;do{if(0===n[(i=s-a)+6*i])for(t=i+1;t<s;t++)if(0!==n[i+6*t]){for(r=6;n[(o=6-r)+6*i]+=n[o+6*t],--r;);break}if(0!==n[i+6*i])for(t=i+1;t<s;t++){var c=n[i+6*t]/n[i+6*i];for(r=6;n[(o=6-r)+6*t]=o<=i?0:n[o+6*t]-n[o+6*i]*c,--r;);}}while(--a);i=2;do{t=i-1;do{for(c=n[i+6*t]/n[i+6*i],r=6;n[(o=6-r)+6*t]=n[o+6*t]-n[o+6*i]*c,--r;);}while(t--)}while(--i);i=2;do{for(c=1/n[i+6*i],r=6;n[(o=6-r)+6*i]=n[o+6*i]*c,--r;);}while(i--);i=2;do{t=2;do{if(o=n[3+t+6*i],isNaN(o)||o===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(i,t,o)}while(t--)}while(i--);return e},l.prototype.setRotationFromQuaternion=function(e){var t=e.x,n=e.y,i=e.z,r=e.w,o=t+t,a=n+n,s=i+i,c=t*o,l=t*a,u=t*s,h=n*a,d=n*s,p=i*s,f=r*o,m=r*a,v=r*s,g=this.elements;return g[0]=1-(h+p),g[1]=l-v,g[2]=u+m,g[3]=l+v,g[4]=1-(c+p),g[5]=d-f,g[6]=u-m,g[7]=d+f,g[8]=1-(c+h),this},l.prototype.transpose=function(e){for(var t=(e=e||new l).elements,n=this.elements,i=0;3!==i;i++)for(var r=0;3!==r;r++)t[3*i+r]=n[3*r+i];return e}},function(e,t,n){e.exports=y;var i=n(52),o=(n(1),n(0)),r=n(8),a=n(3),s=(n(28),n(7)),c=n(34);function y(e){e=e||{},i.apply(this),this.id=y.idCounter++,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new o,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:1,this.collisionResponse=!0,this.position=new o,this.previousPosition=new o,this.interpolatedPosition=new o,this.initPosition=new o,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new o,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new o,this.force=new o;var t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=0<t?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?y.STATIC:y.DYNAMIC,typeof e.type==typeof y.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=0,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this._wakeUpAfterNarrowphase=!1,this.torque=new o,this.quaternion=new a,this.initQuaternion=new a,this.previousQuaternion=new a,this.interpolatedQuaternion=new a,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new o,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new o,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new o,this.invInertia=new o,this.invInertiaWorld=new r,this.invMassSolve=0,this.invInertiaSolve=new o,this.invInertiaWorldSolve=new r,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new o(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new o(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new s,this.aabbNeedsUpdate=!0,this.wlambda=new o,e.shape&&this.addShape(e.shape),this.updateMassProperties()}((y.prototype=new i).constructor=y).COLLIDE_EVENT_NAME="collide",y.DYNAMIC=1,y.STATIC=2,y.KINEMATIC=4,y.AWAKE=0,y.SLEEPY=1,y.SLEEPING=2,y.idCounter=0,y.wakeupEvent={type:"wakeup"},y.prototype.wakeUp=function(){var e=this.sleepState;this.sleepState=0,this._wakeUpAfterNarrowphase=!1,e===y.SLEEPING&&this.dispatchEvent(y.wakeupEvent)},y.prototype.sleep=function(){this.sleepState=y.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this._wakeUpAfterNarrowphase=!1},y.sleepyEvent={type:"sleepy"},y.sleepEvent={type:"sleep"},y.prototype.sleepTick=function(e){if(this.allowSleep){var t=this.sleepState,n=this.velocity.norm2()+this.angularVelocity.norm2(),i=Math.pow(this.sleepSpeedLimit,2);t===y.AWAKE&&n<i?(this.sleepState=y.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(y.sleepyEvent)):t===y.SLEEPY&&i<n?this.wakeUp():t===y.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(y.sleepEvent))}},y.prototype.updateSolveMassProperties=function(){this.sleepState===y.SLEEPING||this.type===y.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))},y.prototype.pointToLocalFrame=function(e,t){return t=t||new o,e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t},y.prototype.vectorToLocalFrame=function(e,t){return t=t||new o,this.quaternion.conjugate().vmult(e,t),t},y.prototype.pointToWorldFrame=function(e,t){return t=t||new o,this.quaternion.vmult(e,t),t.vadd(this.position,t),t},y.prototype.vectorToWorldFrame=function(e,t){return t=t||new o,this.quaternion.vmult(e,t),t};var h=new o,d=new a;y.prototype.addShape=function(e,t,n){var i=new o,r=new a;return t&&i.copy(t),n&&r.copy(n),this.shapes.push(e),this.shapeOffsets.push(i),this.shapeOrientations.push(r),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this},y.prototype.updateBoundingRadius=function(){for(var e=this.shapes,t=this.shapeOffsets,n=e.length,i=0,r=0;r!==n;r++){var o=e[r];o.updateBoundingSphereRadius();var a=t[r].norm(),s=o.boundingSphereRadius;i<a+s&&(i=a+s)}this.boundingRadius=i};var p=new s;y.prototype.computeAABB=function(){for(var e=this.shapes,t=this.shapeOffsets,n=this.shapeOrientations,i=e.length,r=h,o=d,a=this.quaternion,s=this.aabb,c=p,l=0;l!==i;l++){var u=e[l];a.vmult(t[l],r),r.vadd(this.position,r),n[l].mult(a,o),u.calculateWorldAABB(r,o,c.lowerBound,c.upperBound),0===l?s.copy(c):s.extend(c)}this.aabbNeedsUpdate=!1};var l=new r,u=new r;new r,y.prototype.updateInertiaWorld=function(e){var t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){var n=l,i=u;n.setRotationFromQuaternion(this.quaternion),n.transpose(i),n.scale(t,n),n.mmult(i,this.invInertiaWorld)}},new o;var f=new o;y.prototype.applyForce=function(e,t){if(this.type===y.DYNAMIC){var n=f;t.cross(e,n),this.force.vadd(e,this.force),this.torque.vadd(n,this.torque)}};var m=new o,v=new o;y.prototype.applyLocalForce=function(e,t){if(this.type===y.DYNAMIC){var n=m,i=v;this.vectorToWorldFrame(e,n),this.vectorToWorldFrame(t,i),this.applyForce(n,i)}},new o;var g=new o,A=new o;y.prototype.applyImpulse=function(e,t){if(this.type===y.DYNAMIC){var n=t,i=g;i.copy(e),i.mult(this.invMass,i),this.velocity.vadd(i,this.velocity);var r=A;n.cross(e,r),this.invInertiaWorld.vmult(r,r),this.angularVelocity.vadd(r,this.angularVelocity)}};var b=new o,w=new o;y.prototype.applyLocalImpulse=function(e,t){if(this.type===y.DYNAMIC){var n=b,i=w;this.vectorToWorldFrame(e,n),this.vectorToWorldFrame(t,i),this.applyImpulse(n,i)}};var x=new o;y.prototype.updateMassProperties=function(){var e=x;this.invMass=0<this.mass?1/this.mass:0;var t=this.inertia,n=this.fixedRotation;this.computeAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),c.calculateInertia(e,this.mass,t),this.invInertia.set(0<t.x&&!n?1/t.x:0,0<t.y&&!n?1/t.y:0,0<t.z&&!n?1/t.z:0),this.updateInertiaWorld(!0)},y.prototype.getVelocityAtWorldPoint=function(e,t){var n=new o;return e.vsub(this.position,n),this.angularVelocity.cross(n,t),this.velocity.vadd(t,t),t},new o,new o,new a,new a,y.prototype.integrate=function(e,t,n){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),(this.type===y.DYNAMIC||this.type===y.KINEMATIC)&&this.sleepState!==y.SLEEPING){var i=this.velocity,r=this.angularVelocity,o=this.position,a=this.force,s=this.torque,c=this.quaternion,l=this.invMass,u=this.invInertiaWorld,h=this.linearFactor,d=l*e;i.x+=a.x*d*h.x,i.y+=a.y*d*h.y,i.z+=a.z*d*h.z;var p=u.elements,f=this.angularFactor,m=s.x*f.x,v=s.y*f.y,g=s.z*f.z;r.x+=e*(p[0]*m+p[1]*v+p[2]*g),r.y+=e*(p[3]*m+p[4]*v+p[5]*g),r.z+=e*(p[6]*m+p[7]*v+p[8]*g),o.x+=i.x*e,o.y+=i.y*e,o.z+=i.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(n?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}},function(e,t,n){e.exports=o;var i=n(22),r=n(0);function o(e,t,n){n=void 0!==n?n:1e6,i.call(this,e,t,0,n),this.restitution=0,this.ri=new r,this.rj=new r,this.ni=new r}n(8),(o.prototype=new i).constructor=o;var A=new r,b=new r,w=new r;o.prototype.computeB=function(e){var t=this.a,n=this.b,i=this.bi,r=this.bj,o=this.ri,a=this.rj,s=A,c=b,l=i.velocity,u=i.angularVelocity,h=(i.force,i.torque,r.velocity),d=r.angularVelocity,p=(r.force,r.torque,w),f=this.jacobianElementA,m=this.jacobianElementB,v=this.ni;o.cross(v,s),a.cross(v,c),v.negate(f.spatial),s.negate(f.rotational),m.spatial.copy(v),m.rotational.copy(c),p.copy(r.position),p.vadd(a,p),p.vsub(i.position,p),p.vsub(o,p);var g=v.dot(p),y=this.restitution+1;return-g*t-(y*h.dot(v)-y*l.dot(v)+d.dot(c)-u.dot(s))*n-e*this.computeGiMf()};var a=new r,s=new r,c=new r,l=new r,u=new r;o.prototype.getImpactVelocityAlongNormal=function(){var e=a,t=s,n=c,i=l,r=u;return this.bi.position.vadd(this.ri,n),this.bj.position.vadd(this.rj,i),this.bi.getVelocityAtWorldPoint(n,e),this.bj.getVelocityAtWorldPoint(i,t),e.vsub(t,r),this.ni.dot(r)}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(31)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var o=n(30);e.exports=function(i,r,e){if(o(i),void 0===r)return i;switch(e){case 1:return function(e){return i.call(r,e)};case 2:return function(e,t){return i.call(r,e,t)};case 3:return function(e,t,n){return i.call(r,e,t,n)}}return function(){return i.apply(r,arguments)}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var m=n(4),v=n(23),g=n(16),y=n(18),A=n(13),b=function(e,t,n){var i,r,o,a,s=e&b.F,c=e&b.G,l=e&b.S,u=e&b.P,h=e&b.B,d=c?m:l?m[t]||(m[t]={}):(m[t]||{}).prototype,p=c?v:v[t]||(v[t]={}),f=p.prototype||(p.prototype={});for(i in c&&(n=t),n)o=((r=!s&&d&&void 0!==d[i])?d:n)[i],a=h&&r?A(o,m):u&&"function"==typeof o?A(Function.call,o):o,d&&y(d,i,o,e&b.U),p[i]!=o&&g(p,i,a),u&&f[i]!=o&&(f[i]=o)};m.core=v,b.F=1,b.G=2,b.S=4,b.P=8,b.B=16,b.W=32,b.U=64,b.R=128,e.exports=b},function(e,t,n){var i=n(17),r=n(44);e.exports=n(12)?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var i=n(6),r=n(88),o=n(89),a=Object.defineProperty;t.f=n(12)?Object.defineProperty:function(e,t,n){if(i(e),t=o(t,!0),i(n),r)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var o=n(4),a=n(16),s=n(32),c=n(42)("src"),i=Function.toString,l=(""+i).split("toString");n(23).inspectSource=function(e){return i.call(e)},(e.exports=function(e,t,n,i){var r="function"==typeof n;r&&(s(n,"name")||a(n,"name",t)),e[t]!==n&&(r&&(s(n,c)||a(n,c,e[t]?""+e[t]:l.join(String(t)))),e===o?e[t]=n:i?e[t]?e[t]=n:a(e,t,n):(delete e[t],a(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[c]||i.call(this)})},function(e,t,n){e.exports=d;var i=n(1),b=n(0),m=(n(3),n(20));function d(e,t,n){i.call(this),this.type=i.types.CONVEXPOLYHEDRON,this.vertices=e||[],this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.faces=t||[],this.faceNormals=[],this.computeNormals(),this.worldFaceNormalsNeedsUpdate=!0,this.worldFaceNormals=[],this.uniqueEdges=[],this.uniqueAxes=n?n.slice():null,this.computeEdges(),this.updateBoundingSphereRadius()}(d.prototype=new i).constructor=d;var h=new b;d.prototype.computeEdges=function(){var e=this.faces,t=this.vertices,n=(t.length,this.uniqueEdges);n.length=0;for(var i=h,r=0;r!==e.length;r++)for(var o=e[r],a=o.length,s=0;s!==a;s++){var c=(s+1)%a;t[o[s]].vsub(t[o[c]],i),i.normalize();for(var l=!1,u=0;u!==n.length;u++)if(n[u].almostEquals(i)||n[u].almostEquals(i)){l=!0;break}l||n.push(i.clone())}},d.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var e=0;e<this.faces.length;e++){for(var t=0;t<this.faces[e].length;t++)if(!this.vertices[this.faces[e][t]])throw new Error("Vertex "+this.faces[e][t]+" not found!");var n=this.faceNormals[e]||new b;this.getFaceNormal(e,n),n.negate(n),this.faceNormals[e]=n;var i=this.vertices[this.faces[e][0]];if(n.dot(i)<0)for(console.error(".faceNormals["+e+"] = Vec3("+n.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule."),t=0;t<this.faces[e].length;t++)console.warn(".vertices["+this.faces[e][t]+"] = Vec3("+this.vertices[this.faces[e][t]].toString()+")")}};var r=new b,o=new b;d.computeNormal=function(e,t,n,i){t.vsub(e,o),n.vsub(t,r),r.cross(o,i),i.isZero()||i.normalize()},d.prototype.getFaceNormal=function(e,t){var n=this.faces[e],i=this.vertices[n[0]],r=this.vertices[n[1]],o=this.vertices[n[2]];return d.computeNormal(i,r,o,t)};var w=new b;d.prototype.clipAgainstHull=function(e,t,n,i,r,o,a,s,c){for(var l=w,u=-1,h=-Number.MAX_VALUE,d=0;d<n.faces.length;d++){l.copy(n.faceNormals[d]),r.vmult(l,l);var p=l.dot(o);h<p&&(h=p,u=d)}for(var f=[],m=n.faces[u],v=m.length,g=0;g<v;g++){var y=n.vertices[m[g]],A=new b;A.copy(y),r.vmult(A,A),i.vadd(A,A),f.push(A)}0<=u&&this.clipFaceAgainstHull(o,e,t,f,a,s,c)};var E=new b,M=new b,T=new b,S=new b,C=new b,L=new b;d.prototype.findSeparatingAxis=function(e,t,n,i,r,o,a,s){var c=E,l=M,u=T,h=S,d=C,p=L,f=Number.MAX_VALUE;if(this.uniqueAxes)for(v=0;v!==this.uniqueAxes.length;v++){if(n.vmult(this.uniqueAxes[v],c),!1===(A=this.testSepAxis(c,e,t,n,i,r)))return!1;A<f&&(f=A,o.copy(c))}else for(var m=a?a.length:this.faces.length,v=0;v<m;v++){var g=a?a[v]:v;if(c.copy(this.faceNormals[g]),n.vmult(c,c),!1===(A=this.testSepAxis(c,e,t,n,i,r)))return!1;A<f&&(f=A,o.copy(c))}if(e.uniqueAxes)for(v=0;v!==e.uniqueAxes.length;v++){if(r.vmult(e.uniqueAxes[v],l),!1===(A=this.testSepAxis(l,e,t,n,i,r)))return!1;A<f&&(f=A,o.copy(l))}else{var y=s?s.length:e.faces.length;for(v=0;v<y;v++){var A;if(g=s?s[v]:v,l.copy(e.faceNormals[g]),r.vmult(l,l),!1===(A=this.testSepAxis(l,e,t,n,i,r)))return!1;A<f&&(f=A,o.copy(l))}}for(var b=0;b!==this.uniqueEdges.length;b++){n.vmult(this.uniqueEdges[b],h);for(var w=0;w!==e.uniqueEdges.length;w++)if(r.vmult(e.uniqueEdges[w],d),h.cross(d,p),!p.almostZero()){p.normalize();var x=this.testSepAxis(p,e,t,n,i,r);if(!1===x)return!1;x<f&&(f=x,o.copy(p))}}return i.vsub(t,u),0<u.dot(o)&&o.negate(o),!0};var p=[],f=[];d.prototype.testSepAxis=function(e,t,n,i,r,o){d.project(this,e,n,i,p),d.project(t,e,r,o,f);var a=p[0],s=p[1],c=f[0],l=f[1];if(a<l||c<s)return!1;var u=a-l,h=c-s;return u<h?u:h};var a=new b,s=new b;d.prototype.calculateLocalInertia=function(e,t){this.computeLocalAABB(a,s);var n=s.x-a.x,i=s.y-a.y,r=s.z-a.z;t.x=1/12*e*(2*i*2*i+2*r*2*r),t.y=1/12*e*(2*n*2*n+2*r*2*r),t.z=1/12*e*(2*i*2*i+2*n*2*n)},d.prototype.getPlaneConstantOfFace=function(e){var t=this.faces[e],n=this.faceNormals[e],i=this.vertices[t[0]];return-n.dot(i)};var I=new b,O=new b,k=new b,j=new b,H=new b,F=new b,N=new b,z=new b;d.prototype.clipFaceAgainstHull=function(e,t,n,i,r,o,a){for(var s=I,c=O,l=k,u=j,h=H,d=F,p=N,f=z,m=i,v=[],g=-1,y=Number.MAX_VALUE,A=0;A<this.faces.length;A++){s.copy(this.faceNormals[A]),n.vmult(s,s);var b=s.dot(e);b<y&&(y=b,g=A)}if(!(g<0)){var w=this.faces[g];w.connectedFaces=[];for(var x=0;x<this.faces.length;x++)for(var E=0;E<this.faces[x].length;E++)-1!==w.indexOf(this.faces[x][E])&&x!==g&&-1===w.connectedFaces.indexOf(x)&&w.connectedFaces.push(x);m.length;for(var M=w.length,T=0;T<M;T++){var S=this.vertices[w[T]],C=this.vertices[w[(T+1)%M]];S.vsub(C,c),l.copy(c),n.vmult(l,l),t.vadd(l,l),u.copy(this.faceNormals[g]),n.vmult(u,u),t.vadd(u,u),l.cross(u,h),h.negate(h),d.copy(S),n.vmult(d,d),t.vadd(d,d),d.dot(h);var L=w.connectedFaces[T];p.copy(this.faceNormals[L]);var _=this.getPlaneConstantOfFace(L);f.copy(p),n.vmult(f,f);var B=_-f.dot(t);for(this.clipFaceAgainstPlane(m,v,f,B);m.length;)m.shift();for(;v.length;)m.push(v.shift())}for(p.copy(this.faceNormals[g]),_=this.getPlaneConstantOfFace(g),f.copy(p),n.vmult(f,f),B=_-f.dot(t),x=0;x<m.length;x++){var R=f.dot(m[x])+B;if(R<=r&&(console.log("clamped: depth="+R+" to minDist="+r),R=r),R<=o){var P=m[x];if(R<=0){var D={point:P,normal:f,depth:R};a.push(D)}}}}},d.prototype.clipFaceAgainstPlane=function(e,t,n,i){var r,o,a=e.length;if(a<2)return t;var s=e[e.length-1],c=e[0];r=n.dot(s)+i;for(var l=0;l<a;l++){if(c=e[l],o=n.dot(c)+i,r<0)if(o<0)(u=new b).copy(c),t.push(u);else{var u=new b;s.lerp(c,r/(r-o),u),t.push(u)}else o<0&&(u=new b,s.lerp(c,r/(r-o),u),t.push(u),t.push(c));s=c,r=o}return t},d.prototype.computeWorldVertices=function(e,t){for(var n=this.vertices.length;this.worldVertices.length<n;)this.worldVertices.push(new b);for(var i=this.vertices,r=this.worldVertices,o=0;o!==n;o++)t.vmult(i[o],r[o]),e.vadd(r[o],r[o]);this.worldVerticesNeedsUpdate=!1},new b,d.prototype.computeLocalAABB=function(e,t){var n=this.vertices.length,i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var r=0;r<n;r++){var o=i[r];o.x<e.x?e.x=o.x:o.x>t.x&&(t.x=o.x),o.y<e.y?e.y=o.y:o.y>t.y&&(t.y=o.y),o.z<e.z?e.z=o.z:o.z>t.z&&(t.z=o.z)}},d.prototype.computeWorldFaceNormals=function(e){for(var t=this.faceNormals.length;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new b);for(var n=this.faceNormals,i=this.worldFaceNormals,r=0;r!==t;r++)e.vmult(n[r],i[r]);this.worldFaceNormalsNeedsUpdate=!1},d.prototype.updateBoundingSphereRadius=function(){for(var e=0,t=this.vertices,n=0,i=t.length;n!==i;n++){var r=t[n].norm2();e<r&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)};var v=new b;d.prototype.calculateWorldAABB=function(e,t,n,i){for(var r,o,a,s,c,l,u=this.vertices.length,h=this.vertices,d=0;d<u;d++){v.copy(h[d]),t.vmult(v,v),e.vadd(v,v);v.x<r||void 0===r?r=v.x:(v.x>s||void 0===s)&&(s=v.x),v.y<o||void 0===o?o=v.y:(v.y>c||void 0===c)&&(c=v.y),v.z<a||void 0===a?a=v.z:(v.z>l||void 0===l)&&(l=v.z)}n.set(r,o,a),i.set(s,c,l)},d.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},d.prototype.getAveragePointLocal=function(e){e=e||new b;for(var t=this.vertices.length,n=this.vertices,i=0;i<t;i++)e.vadd(n[i],e);return e.mult(1/t,e),e},d.prototype.transformAllPoints=function(e,t){var n=this.vertices.length,i=this.vertices;if(t){for(var r=0;r<n;r++){var o=i[r];t.vmult(o,o)}for(r=0;r<this.faceNormals.length;r++)o=this.faceNormals[r],t.vmult(o,o)}if(e)for(r=0;r<n;r++)(o=i[r]).vadd(e,o)};var g=new b,y=new b,A=new b;d.prototype.pointIsInside=function(e){var t=this.vertices.length,n=this.vertices,i=this.faces,r=this.faceNormals,o=this.faces.length,a=g;this.getAveragePointLocal(a);for(var s=0;s<o;s++){this.faces[s].length,t=r[s];var c=n[i[s][0]],l=y;e.vsub(c,l);var u=t.dot(l),h=A;a.vsub(c,h);var d=t.dot(h);if(u<0&&0<d||0<u&&d<0)return!1}return-1},new b;var x=new b,_=new b;d.project=function(e,t,n,i,r){var o=e.vertices.length,a=x,s=0,c=0,l=_,u=e.vertices;l.setZero(),m.vectorToLocalFrame(n,i,t,a),m.pointToLocalFrame(n,i,l,l);var h=l.dot(a);c=s=u[0].dot(a);for(var d=1;d<o;d++){var p=u[d].dot(a);s<p&&(s=p),p<c&&(c=p)}if((c-=h)>(s-=h)){var f=c;c=s,s=f}r[0]=s,r[1]=c}},function(e,t,n){var r=n(0),i=n(3);function o(e){e=e||{},this.position=new r,e.position&&this.position.copy(e.position),this.quaternion=new i,e.quaternion&&this.quaternion.copy(e.quaternion)}e.exports=o;var a=new i;o.pointToLocalFrame=function(e,t,n,i){return i=i||new r,n.vsub(e,i),t.conjugate(a),a.vmult(i,i),i},o.prototype.pointToLocal=function(e,t){return o.pointToLocalFrame(this.position,this.quaternion,e,t)},o.pointToWorldFrame=function(e,t,n,i){return i=i||new r,t.vmult(n,i),i.vadd(e,i),i},o.prototype.pointToWorld=function(e,t){return o.pointToWorldFrame(this.position,this.quaternion,e,t)},o.prototype.vectorToWorldFrame=function(e,t){return t=t||new r,this.quaternion.vmult(e,t),t},o.vectorToWorldFrame=function(e,t,n){return e.vmult(t,n),n},o.vectorToLocalFrame=function(e,t,n,i){return i=i||new r,t.w*=-1,t.vmult(n,i),t.w*=-1,i}},function(e,t,n){e.exports=r;var i=n(27);function r(e,t,n){n=i.defaults(n,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=e,this.bodyB=t,this.id=r.idCounter++,this.collideConnected=n.collideConnected,n.wakeUpBodies&&(e&&e.wakeUp(),t&&t.wakeUp())}r.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},r.prototype.enable=function(){for(var e=this.equations,t=0;t<e.length;t++)e[t].enabled=!0},r.prototype.disable=function(){for(var e=this.equations,t=0;t<e.length;t++)e[t].enabled=!1},r.idCounter=0},function(e,t,n){e.exports=o;var r=n(130),i=n(0);function o(e,t,n,i){this.id=o.id++,this.minForce=void 0===n?-1e6:n,this.maxForce=void 0===i?1e6:i,this.bi=e,this.bj=t,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new r,this.jacobianElementB=new r,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}(o.prototype.constructor=o).id=0,o.prototype.setSpookParams=function(e,t,n){var i=t,r=e,o=n;this.a=4/(o*(1+4*i)),this.b=4*i/(1+4*i),this.eps=4/(o*o*r*(1+4*i))},o.prototype.computeB=function(e,t,n){var i=this.computeGW();return-this.computeGq()*e-i*t-this.computeGiMf()*n},o.prototype.computeGq=function(){var e=this.jacobianElementA,t=this.jacobianElementB,n=this.bi,i=this.bj,r=n.position,o=i.position;return e.spatial.dot(r)+t.spatial.dot(o)},new i,o.prototype.computeGW=function(){var e=this.jacobianElementA,t=this.jacobianElementB,n=this.bi,i=this.bj,r=n.velocity,o=i.velocity,a=n.angularVelocity,s=i.angularVelocity;return e.multiplyVectors(r,a)+t.multiplyVectors(o,s)},o.prototype.computeGWlambda=function(){var e=this.jacobianElementA,t=this.jacobianElementB,n=this.bi,i=this.bj,r=n.vlambda,o=i.vlambda,a=n.wlambda,s=i.wlambda;return e.multiplyVectors(r,a)+t.multiplyVectors(o,s)};var u=new i,h=new i,d=new i,p=new i;o.prototype.computeGiMf=function(){var e=this.jacobianElementA,t=this.jacobianElementB,n=this.bi,i=this.bj,r=n.force,o=n.torque,a=i.force,s=i.torque,c=n.invMassSolve,l=i.invMassSolve;return r.scale(c,u),a.scale(l,h),n.invInertiaWorldSolve.vmult(o,d),i.invInertiaWorldSolve.vmult(s,p),e.multiplyVectors(u,d)+t.multiplyVectors(h,p)};var l=new i;o.prototype.computeGiMGt=function(){var e=this.jacobianElementA,t=this.jacobianElementB,n=this.bi,i=this.bj,r=n.invMassSolve,o=i.invMassSolve,a=n.invInertiaWorldSolve,s=i.invInertiaWorldSolve,c=r+o;return a.vmult(e.rotational,l),c+=l.dot(e.rotational),s.vmult(t.rotational,l),c+l.dot(t.rotational)};var a=new i;new i,new i,new i,new i,new i,o.prototype.addToWlambda=function(e){var t=this.jacobianElementA,n=this.jacobianElementB,i=this.bi,r=this.bj,o=a;i.vlambda.addScaledVector(i.invMassSolve*e,t.spatial,i.vlambda),r.vlambda.addScaledVector(r.invMassSolve*e,n.spatial,r.vlambda),i.invInertiaWorldSolve.vmult(t.rotational,o),i.wlambda.addScaledVector(e,o,i.wlambda),r.invInertiaWorldSolve.vmult(n.rotational,o),r.wlambda.addScaledVector(e,o,r.wlambda)},o.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},function(e,t){var n=e.exports={version:"2.6.2"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports={}},function(e,t,n){var i=n(33),r=Math.min;e.exports=function(e){return 0<e?r(i(e),9007199254740991):0}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){function n(){}(e.exports=n).defaults=function(e,t){for(var n in e=e||{},t)n in e||(e[n]=t[n]);return e}},function(e,t){function n(e){var t="";"string"==typeof(e=e||{})?(t=e,e={}):"object"==typeof e&&(t=""),this.name=t,this.id=n.idCounter++,this.friction=void 0!==e.friction?e.friction:-1,this.restitution=void 0!==e.restitution?e.restitution:-1}(e.exports=n).idCounter=0},function(e,t,n){var i=n(0);function r(){this.rayFromWorld=new i,this.rayToWorld=new i,this.hitNormalWorld=new i,this.hitPointWorld=new i,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1}(e.exports=r).prototype.reset=function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1},r.prototype.abort=function(){this._shouldStop=!0},r.prototype.set=function(e,t,n,i,r,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(n),this.hitPointWorld.copy(i),this.shape=r,this.body=o,this.distance=a}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?i:n)(e)}},function(e,t,n){e.exports=r;var i=n(1),a=n(0),s=n(19);function r(e){i.call(this),this.type=i.types.BOX,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}((r.prototype=new i).constructor=r).prototype.updateConvexPolyhedronRepresentation=function(){var e=this.halfExtents.x,t=this.halfExtents.y,n=this.halfExtents.z,i=a,r=[new i(-e,-t,-n),new i(e,-t,-n),new i(e,t,-n),new i(-e,t,-n),new i(-e,-t,n),new i(e,-t,n),new i(e,t,n),new i(-e,t,n)],o=(new i(0,0,1),new i(0,1,0),new i(1,0,0),new s(r,[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]]));(this.convexPolyhedronRepresentation=o).material=this.material},r.prototype.calculateLocalInertia=function(e,t){return t=t||new a,r.calculateInertia(this.halfExtents,e,t),t},r.calculateInertia=function(e,t,n){var i=e;n.x=1/12*t*(2*i.y*2*i.y+2*i.z*2*i.z),n.y=1/12*t*(2*i.x*2*i.x+2*i.z*2*i.z),n.z=1/12*t*(2*i.y*2*i.y+2*i.x*2*i.x)},r.prototype.getSideNormals=function(e,t){var n=e,i=this.halfExtents;if(n[0].set(i.x,0,0),n[1].set(0,i.y,0),n[2].set(0,0,i.z),n[3].set(-i.x,0,0),n[4].set(0,-i.y,0),n[5].set(0,0,-i.z),void 0!==t)for(var r=0;r!==n.length;r++)t.vmult(n[r],n[r]);return n},r.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z},r.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var c=new a;new a,r.prototype.forEachWorldCorner=function(e,t,n){for(var i=this.halfExtents,r=[[i.x,i.y,i.z],[-i.x,i.y,i.z],[-i.x,-i.y,i.z],[-i.x,-i.y,-i.z],[i.x,-i.y,-i.z],[i.x,i.y,-i.z],[-i.x,i.y,-i.z],[i.x,-i.y,i.z]],o=0;o<r.length;o++)c.set(r[o][0],r[o][1],r[o][2]),t.vmult(c,c),e.vadd(c,c),n(c.x,c.y,c.z)};var u=[new a,new a,new a,new a,new a,new a,new a,new a];r.prototype.calculateWorldAABB=function(e,t,n,i){var r=this.halfExtents;u[0].set(r.x,r.y,r.z),u[1].set(-r.x,r.y,r.z),u[2].set(-r.x,-r.y,r.z),u[3].set(-r.x,-r.y,-r.z),u[4].set(r.x,-r.y,-r.z),u[5].set(r.x,r.y,-r.z),u[6].set(-r.x,r.y,-r.z),u[7].set(r.x,-r.y,r.z);var o=u[0];t.vmult(o,o),e.vadd(o,o),i.copy(o),n.copy(o);for(var a=1;a<8;a++){o=u[a],t.vmult(o,o),e.vadd(o,o);var s=o.x,c=o.y,l=o.z;s>i.x&&(i.x=s),c>i.y&&(i.y=c),l>i.z&&(i.z=l),s<n.x&&(n.x=s),c<n.y&&(n.y=c),l<n.z&&(n.z=l)}}},function(e,t,n){var i=n(9),r=n(0),o=n(3);function a(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}n(1),n(70),(e.exports=a).prototype.collisionPairs=function(e,t,n){throw new Error("collisionPairs not implemented for this BroadPhase class!")},a.prototype.needBroadphaseCollision=function(e,t){return 0!=(e.collisionFilterGroup&t.collisionFilterMask)&&0!=(t.collisionFilterGroup&e.collisionFilterMask)&&(0==(e.type&i.STATIC)&&e.sleepState!==i.SLEEPING||0==(t.type&i.STATIC)&&t.sleepState!==i.SLEEPING)},a.prototype.intersectionTest=function(e,t,n,i){this.useBoundingBoxes?this.doBoundingBoxBroadphase(e,t,n,i):this.doBoundingSphereBroadphase(e,t,n,i)};var s=new r;new r,new o,new r,a.prototype.doBoundingSphereBroadphase=function(e,t,n,i){var r=s;t.position.vsub(e.position,r);var o=Math.pow(e.boundingRadius+t.boundingRadius,2);r.norm2()<o&&(n.push(e),i.push(t))},a.prototype.doBoundingBoxBroadphase=function(e,t,n,i){e.aabbNeedsUpdate&&e.computeAABB(),t.aabbNeedsUpdate&&t.computeAABB(),e.aabb.overlaps(t.aabb)&&(n.push(e),i.push(t))};var h={keys:[]},d=[],p=[];a.prototype.makePairsUnique=function(e,t){for(var n=h,i=d,r=p,o=e.length,a=0;a!==o;a++)i[a]=e[a],r[a]=t[a];for(e.length=0,a=t.length=0;a!==o;a++){var s=i[a].id,c=r[a].id;n[l=s<c?s+","+c:c+","+s]=a,n.keys.push(l)}for(a=0;a!==n.keys.length;a++){var l=n.keys.pop(),u=n[l];e.push(i[u]),t.push(r[u]),delete n[l]}},a.prototype.setWorld=function(e){};var c=new r;a.boundingSphereCheck=function(e,t){var n=c;return e.position.vsub(t.position,n),Math.pow(e.shape.boundingSphereRadius+t.shape.boundingSphereRadius,2)>n.norm2()},a.prototype.aabbQuery=function(e,t,n){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}},function(e,t,n){e.exports=l;var v=n(0),i=n(3),S=n(20),r=(n(19),n(34),n(29)),o=n(1),f=n(7);function l(e,t){this.from=e?e.clone():new v,this.to=t?t.clone():new v,this._direction=new v,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=l.ANY,this.result=new r,this.hasHit=!1,this.callback=function(e){}}(l.prototype.constructor=l).CLOSEST=1,l.ANY=2,l.ALL=4;var a=new f,s=[];l.prototype.intersectWorld=function(e,t){return this.mode=t.mode||l.ANY,this.result=t.result||new r,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||function(){},this.hasHit=!1,this.result.reset(),this._updateDirection(),this.getAABB(a),s.length=0,e.broadphase.aabbQuery(e,a,s),this.intersectBodies(s),this.hasHit};var h=new v,d=new v;function L(e,t,n,i){i.vsub(t,p),n.vsub(t,h),e.vsub(t,d);var r,o,a=p.dot(p),s=p.dot(h),c=p.dot(d),l=h.dot(h),u=h.dot(d);return 0<=(r=l*c-s*u)&&0<=(o=a*u-s*c)&&r+o<a*l-s*s}l.pointInTriangle=L;var c=new v,u=new i;l.prototype.intersectBody=function(e,t){t&&(this.result=t,this._updateDirection());var n=this.checkCollisionResponse;if((!n||e.collisionResponse)&&0!=(this.collisionFilterGroup&e.collisionFilterMask)&&0!=(e.collisionFilterGroup&this.collisionFilterMask))for(var i=c,r=u,o=0,a=e.shapes.length;o<a;o++){var s=e.shapes[o];if((!n||s.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],r),e.quaternion.vmult(e.shapeOffsets[o],i),i.vadd(e.position,i),this.intersectShape(s,r,i,e),this.result._shouldStop))break}},l.prototype.intersectBodies=function(e,t){t&&(this.result=t,this._updateDirection());for(var n=0,i=e.length;!this.result._shouldStop&&n<i;n++)this.intersectBody(e[n])},l.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction),this._direction.normalize()},l.prototype.intersectShape=function(e,t,n,i){if(!(function(e,t,n){n.vsub(e,p);var i=p.dot(t);return t.mult(i,x),x.vadd(e,x),n.distanceTo(x)}(this.from,this._direction,n)>e.boundingSphereRadius)){var r=this[e.type];r&&r.call(this,e,t,n,i,e)}},new v,new v;var _=new v,B=new v,R=new v,P=new v;new v,new r,l.prototype.intersectBox=function(e,t,n,i,r){return this.intersectConvex(e.convexPolyhedronRepresentation,t,n,i,r)},l.prototype[o.types.BOX]=l.prototype.intersectBox,l.prototype.intersectPlane=function(e,t,n,i,r){var o=this.from,a=this.to,s=this._direction,c=new v(0,0,1);t.vmult(c,c);var l=new v;o.vsub(n,l);var u=l.dot(c);if(a.vsub(n,l),!(0<u*l.dot(c)||o.distanceTo(a)<u)){var h=c.dot(s);if(!(Math.abs(h)<this.precision)){var d=new v,p=new v,f=new v;o.vsub(n,d);var m=-c.dot(d)/h;s.scale(m,p),o.vadd(p,f),this.reportIntersection(c,f,r,i,-1)}}},l.prototype[o.types.PLANE]=l.prototype.intersectPlane,l.prototype.getAABB=function(e){var t=this.to,n=this.from;e.lowerBound.x=Math.min(t.x,n.x),e.lowerBound.y=Math.min(t.y,n.y),e.lowerBound.z=Math.min(t.z,n.z),e.upperBound.x=Math.max(t.x,n.x),e.upperBound.y=Math.max(t.y,n.y),e.upperBound.z=Math.max(t.z,n.z)};var m={faceList:[0]},g=new v,y=new l,A=[];l.prototype.intersectHeightfield=function(e,t,n,i,r){e.data,e.elementSize;var o=y;o.from.copy(this.from),o.to.copy(this.to),S.pointToLocalFrame(n,t,o.from,o.from),S.pointToLocalFrame(n,t,o.to,o.to),o._updateDirection();var a,s,c,l,u=A;a=s=0,c=l=e.data.length-1;var h=new f;o.getAABB(h),e.getIndexOfPosition(h.lowerBound.x,h.lowerBound.y,u,!0),a=Math.max(a,u[0]),s=Math.max(s,u[1]),e.getIndexOfPosition(h.upperBound.x,h.upperBound.y,u,!0),c=Math.min(c,u[0]+1),l=Math.min(l,u[1]+1);for(var d=a;d<c;d++)for(var p=s;p<l;p++){if(this.result._shouldStop)return;if(e.getAabbAtIndex(d,p,h),h.overlapsRay(o)){if(e.getConvexTrianglePillar(d,p,!1),S.pointToWorldFrame(n,t,e.pillarOffset,g),this.intersectConvex(e.pillarConvex,t,g,i,r,m),this.result._shouldStop)return;e.getConvexTrianglePillar(d,p,!0),S.pointToWorldFrame(n,t,e.pillarOffset,g),this.intersectConvex(e.pillarConvex,t,g,i,r,m)}}},l.prototype[o.types.HEIGHTFIELD]=l.prototype.intersectHeightfield;var b=new v,w=new v;l.prototype.intersectSphere=function(e,t,n,i,r){var o=this.from,a=this.to,s=e.radius,c=Math.pow(a.x-o.x,2)+Math.pow(a.y-o.y,2)+Math.pow(a.z-o.z,2),l=2*((a.x-o.x)*(o.x-n.x)+(a.y-o.y)*(o.y-n.y)+(a.z-o.z)*(o.z-n.z)),u=Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2)+Math.pow(o.z-n.z,2)-Math.pow(s,2),h=Math.pow(l,2)-4*c*u,d=b,p=w;if(!(h<0))if(0==h)o.lerp(a,h,d),d.vsub(n,p),p.normalize(),this.reportIntersection(p,d,r,i,-1);else{var f=(-l-Math.sqrt(h))/(2*c),m=(-l+Math.sqrt(h))/(2*c);if(0<=f&&f<=1&&(o.lerp(a,f,d),d.vsub(n,p),p.normalize(),this.reportIntersection(p,d,r,i,-1)),this.result._shouldStop)return;0<=m&&m<=1&&(o.lerp(a,m,d),d.vsub(n,p),p.normalize(),this.reportIntersection(p,d,r,i,-1))}},l.prototype[o.types.SPHERE]=l.prototype.intersectSphere;var D=new v,I=(new v,new v,new v);l.prototype.intersectConvex=function(e,t,n,i,r,o){for(var a=D,s=I,c=o&&o.faceList||null,l=e.faces,u=e.vertices,h=e.faceNormals,d=this._direction,p=this.from,f=this.to,m=p.distanceTo(f),v=c?c.length:l.length,g=this.result,y=0;!g._shouldStop&&y<v;y++){var A=c?c[y]:y,b=l[A],w=h[A],x=t,E=n;s.copy(u[b[0]]),x.vmult(s,s),s.vadd(E,s),s.vsub(p,s),x.vmult(w,a);var M=d.dot(a);if(!(Math.abs(M)<this.precision)){var T=a.dot(s)/M;if(!(T<0)){d.mult(T,_),_.vadd(p,_),B.copy(u[b[0]]),x.vmult(B,B),E.vadd(B,B);for(var S=1;!g._shouldStop&&S<b.length-1;S++){R.copy(u[b[S]]),P.copy(u[b[S+1]]),x.vmult(R,R),x.vmult(P,P),E.vadd(R,R),E.vadd(P,P);var C=_.distanceTo(p);!L(_,B,R,P)&&!L(_,R,B,P)||m<C||this.reportIntersection(a,_,r,i,A)}}}}},l.prototype[o.types.CONVEXPOLYHEDRON]=l.prototype.intersectConvex;var C=new v,O=new v,k=new v,j=new v,H=new v,F=new v,N=(new f,[]),z=new S;l.prototype.intersectTrimesh=function(e,t,n,i,r,o){var a=C,s=N,c=z,l=I,u=O,h=k,d=j,p=F,f=H,m=(o&&o.faceList,e.indices),v=(e.vertices,e.faceNormals,this.from),g=this.to,y=this._direction;c.position.copy(n),c.quaternion.copy(t),S.vectorToLocalFrame(n,t,y,u),S.pointToLocalFrame(n,t,v,h),S.pointToLocalFrame(n,t,g,d),d.x*=e.scale.x,d.y*=e.scale.y,d.z*=e.scale.z,h.x*=e.scale.x,h.y*=e.scale.y,h.z*=e.scale.z,d.vsub(h,u),u.normalize();var A=h.distanceSquared(d);e.tree.rayQuery(this,c,s);for(var b=0,w=s.length;!this.result._shouldStop&&b!==w;b++){var x=s[b];e.getNormal(x,a),e.getVertex(m[3*x],B),B.vsub(h,l);var E=u.dot(a),M=a.dot(l)/E;if(!(M<0)){u.scale(M,_),_.vadd(h,_),e.getVertex(m[3*x+1],R),e.getVertex(m[3*x+2],P);var T=_.distanceSquared(h);!L(_,R,B,P)&&!L(_,B,R,P)||A<T||(S.vectorToWorldFrame(t,a,f),S.pointToWorldFrame(n,t,_,p),this.reportIntersection(f,p,r,i,x))}}s.length=0},l.prototype[o.types.TRIMESH]=l.prototype.intersectTrimesh,l.prototype.reportIntersection=function(e,t,n,i,r){var o=this.from,a=this.to,s=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&0<e.dot(this._direction)))switch(c.hitFaceIndex=void 0!==r?r:-1,this.mode){case l.ALL:this.hasHit=!0,c.set(o,a,e,t,n,i,s),c.hasHit=!0,this.callback(c);break;case l.CLOSEST:(s<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,n,i,s));break;case l.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,n,i,s),c._shouldStop=!0}};var p=new v,x=new v},function(e,t){function n(){this.equations=[]}(e.exports=n).prototype.solve=function(e,t){return 0},n.prototype.addEquation=function(e){e.enabled&&this.equations.push(e)},n.prototype.removeEquation=function(e){var t=this.equations,n=t.indexOf(e);-1!==n&&t.splice(n,1)},n.prototype.removeAllEquations=function(){this.equations.length=0}},function(e,t,n){e.exports=i;var c=n(21),l=n(10),u=n(0);function i(e,t,n,i,r){c.call(this,e,n),r=void 0!==r?r:1e6,this.pivotA=t?t.clone():new u,this.pivotB=i?i.clone():new u;var o=this.equationX=new l(e,n),a=this.equationY=new l(e,n),s=this.equationZ=new l(e,n);this.equations.push(o,a,s),o.minForce=a.minForce=s.minForce=-r,o.maxForce=a.maxForce=s.maxForce=r,o.ni.set(1,0,0),a.ni.set(0,1,0),s.ni.set(0,0,1)}(i.prototype=new c).update=function(){var e=this.bodyA,t=this.bodyB,n=this.equationX,i=this.equationY,r=this.equationZ;e.quaternion.vmult(this.pivotA,n.ri),t.quaternion.vmult(this.pivotB,n.rj),i.ri.copy(n.ri),i.rj.copy(n.rj),r.ri.copy(n.ri),r.rj.copy(n.rj)}},function(e,t,n){e.exports=i;var r=n(0),o=(n(8),n(22));function i(e,t,n){var i=void 0!==(n=n||{}).maxForce?n.maxForce:1e6;o.call(this,e,t,-i,i),this.axisA=n.axisA?n.axisA.clone():new r(1,0,0),this.axisB=n.axisB?n.axisB.clone():new r(0,1,0),this.maxAngle=Math.PI/2}(i.prototype=new o).constructor=i;var l=new r,u=new r;i.prototype.computeB=function(e){var t=this.a,n=this.b,i=this.axisA,r=this.axisB,o=l,a=u,s=this.jacobianElementA,c=this.jacobianElementB;return i.cross(r,o),r.cross(i,a),s.rotational.copy(a),c.rotational.copy(o),-(Math.cos(this.maxAngle)-i.dot(r))*t-this.computeGW()*n-e*this.computeGiMf()}},function(e,t){function n(){}function i(){throw new Error("Method not implemented.")}(e.exports=n).prototype.init=i,n.prototype.step=i,n.prototype.destroy=i,n.prototype.addBody=i,n.prototype.removeBody=i,n.prototype.applyBodyMethod=i,n.prototype.updateBodyProperties=i,n.prototype.addMaterial=i,n.prototype.addContactMaterial=i,n.prototype.addConstraint=i,n.prototype.removeConstraint=i,n.prototype.getContacts=i},function(e,t){e.exports=!1},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t,n){var i=n(11),r=n(4).document,o=i(r)&&i(r.createElement);e.exports=function(e){return o?r.createElement(e):{}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var i=n(17).f,r=n(32),o=n(2)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},function(e,t,n){var i=n(67),r=n(26);e.exports=function(e){return i(r(e))}},function(e,t,n){var i=n(57)("keys"),r=n(42);e.exports=function(e){return i[e]||(i[e]=r(e))}},function(e,t,n){var i=n(26);e.exports=function(e){return Object(i(e))}},function(e,t,n){for(var i=n(111),r=n(66),o=n(18),a=n(4),s=n(16),c=n(24),l=n(2),u=l("iterator"),h=l("toStringTag"),d=c.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=r(p),m=0;m<f.length;m++){var v,g=f[m],y=p[g],A=a[g],b=A&&A.prototype;if(b&&(b[u]||s(b,u,d),b[h]||s(b,h,g),c[g]=d,y))for(v in i)b[v]||o(b,v,i[v],!0)}},function(e,t,n){"use strict";var i=n(15),r=n(114)(0),o=n(118)([].forEach,!0);i(i.P+i.F*!o,"Array",{forEach:function(e){return r(this,e,arguments[1])}})},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){function n(){}(e.exports=n).prototype={constructor:n,addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t),this},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},hasAnyEventListener:function(e){return void 0!==this._listeners&&void 0!==this._listeners[e]},removeEventListener:function(e,t){if(void 0===this._listeners)return this;var n=this._listeners;if(void 0===n[e])return this;var i=n[e].indexOf(t);return-1!==i&&n[e].splice(i,1),this},dispatchEvent:function(e){if(void 0===this._listeners)return this;var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=0,i=t.length;n<i;n++)t[n].call(this,e)}return this}}},function(e,t,n){e.exports=o;var i=n(22),r=n(0);function o(e,t,n){i.call(this,e,t,-n,n),this.ri=new r,this.rj=new r,this.t=new r}n(8),(o.prototype=new i).constructor=o;var l=new r,u=new r;o.prototype.computeB=function(e){this.a;var t=this.b,n=(this.bi,this.bj,this.ri),i=this.rj,r=l,o=u,a=this.t;n.cross(a,r),i.cross(a,o);var s=this.jacobianElementA,c=this.jacobianElementB;return a.negate(s.spatial),r.negate(s.rotational),c.spatial.copy(a),c.rotational.copy(o),-this.computeGW()*t-e*this.computeGiMf()}},function(e,t,n){e.exports=o;var i=n(0),r=(n(8),n(22));function o(e,t,n){n=void 0!==n?n:1e6,r.call(this,e,t,-n,n),this.axisA=new i,this.axisB=new i,this.targetVelocity=0}((o.prototype=new r).constructor=o).prototype.computeB=function(e){this.a;var t=this.b,n=(this.bi,this.bj,this.axisA),i=this.axisB,r=this.jacobianElementA,o=this.jacobianElementB;return r.rotational.copy(n),i.negate(o.rotational),-(this.computeGW()-this.targetVelocity)*t-e*this.computeGiMf()}},function(e,t,n){var s=n(5),c=n(153);n(155);var i,r,o,a,l,u={dependencies:["velocity"],schema:{mass:{default:5,if:{type:"dynamic"}},linearDamping:{default:.01,if:{type:"dynamic"}},angularDamping:{default:.01,if:{type:"dynamic"}},shape:{default:"auto",oneOf:["auto","box","cylinder","sphere","hull","mesh","none"]},cylinderAxis:{default:"y",oneOf:["x","y","z"]},sphereRadius:{default:NaN},type:{default:"dynamic",oneOf:["static","dynamic"]}},init:function(){this.system=this.el.sceneEl.systems.physics,this.el.sceneEl.hasLoaded?this.initBody():this.el.sceneEl.addEventListener("loaded",this.initBody.bind(this))},initBody:function(){var e=this.el,t=this.data,n=this.el.object3D,i=n.position,r=n.quaternion;if(this.body=new s.Body({mass:"static"===t.type?0:t.mass||0,material:this.system.getMaterial("defaultMaterial"),position:new s.Vec3(i.x,i.y,i.z),quaternion:new s.Quaternion(r.x,r.y,r.z,r.w),linearDamping:t.linearDamping,angularDamping:t.angularDamping,type:"dynamic"===t.type?s.Body.DYNAMIC:s.Body.STATIC}),this.el.object3D.updateMatrixWorld(!0),"none"!==t.shape){var o="auto"===t.shape?void 0:AFRAME.utils.extend({},this.data,{type:c.Type[t.shape.toUpperCase()]}),a=c(this.el.object3D,o);if(!a)return void e.addEventListener("object3dset",this.initBody.bind(this));this.body.addShape(a,a.offset,a.orientation),this.system.debug&&(this.shouldUpdateWireframe=!0),this.isLoaded=!0}this.el.body=this.body,this.body.el=e,this.isPlaying&&this._play(),this.isLoaded&&this.el.emit("body-loaded",{body:this.el.body})},addShape:function(e,t,n){"none"===this.data.shape?e?this.body?(this.body.addShape(e,t,n),this.system.debug&&(this.shouldUpdateWireframe=!0),this.shouldUpdateBody=!0):console.warn("shape cannot be added before body is loaded"):console.warn("shape cannot be null"):console.warn("shape can only be added if shape property is none")},tick:function(){this.shouldUpdateBody&&(this.isLoaded=!0,this._play(),this.el.emit("body-loaded",{body:this.el.body}),this.shouldUpdateBody=!1),this.shouldUpdateWireframe&&(this.createWireframe(this.body),this.shouldUpdateWireframe=!1)},play:function(){this.isLoaded&&this._play()},_play:function(){this.syncToPhysics(),this.system.addComponent(this),this.system.addBody(this.body),this.wireframe&&this.el.sceneEl.object3D.add(this.wireframe)},pause:function(){this.isLoaded&&this._pause()},_pause:function(){this.system.removeComponent(this),this.body&&this.system.removeBody(this.body),this.wireframe&&this.el.sceneEl.object3D.remove(this.wireframe)},update:function(e){if(this.body){var t=this.data;null!=e.type&&t.type!=e.type&&(this.body.type="dynamic"===t.type?s.Body.DYNAMIC:s.Body.STATIC),this.body.mass=t.mass||0,"dynamic"===t.type&&(this.body.linearDamping=t.linearDamping,this.body.angularDamping=t.angularDamping),t.mass!==e.mass&&this.body.updateMassProperties(),this.body.updateProperties&&this.body.updateProperties()}},remove:function(){this.body&&(delete this.body.el,delete this.body),delete this.el.body,delete this.wireframe},beforeStep:function(){0===this.body.mass&&this.syncToPhysics()},step:function(){0!==this.body.mass&&this.syncFromPhysics()},createWireframe:function(e){var t,n;this.wireframe&&(this.el.sceneEl.object3D.remove(this.wireframe),delete this.wireframe),this.wireframe=new THREE.Object3D,this.el.sceneEl.object3D.add(this.wireframe);for(var i=new THREE.Quaternion,r=0;r<this.body.shapes.length;r++){t=this.body.shapeOffsets[r],i.copy(this.body.shapeOrientations[r]),n=s.shape2mesh(this.body).children[r];var o=new THREE.LineSegments(new THREE.EdgesGeometry(n.geometry),new THREE.LineBasicMaterial({color:16711680}));t&&o.position.copy(t),i&&o.quaternion.copy(i),this.wireframe.add(o)}this.syncWireframe()},syncWireframe:function(){var e,t=this.wireframe;this.wireframe&&(t.quaternion.copy(this.body.quaternion),t.orientation&&t.quaternion.multiply(t.orientation),t.position.copy(this.body.position),t.offset&&(e=t.offset.clone().applyQuaternion(t.quaternion),t.position.add(e)),t.updateMatrix())},syncToPhysics:(i=new THREE.Quaternion,r=new THREE.Vector3,function(){var e=this.el,t=e.parentEl,n=this.body;n&&(e.components.velocity&&n.velocity.copy(e.getAttribute("velocity")),t.isScene?(n.quaternion.copy(e.object3D.quaternion),n.position.copy(e.object3D.position)):(e.object3D.getWorldQuaternion(i),n.quaternion.copy(i),e.object3D.getWorldPosition(r),n.position.copy(r)),this.body.updateProperties&&this.body.updateProperties(),this.wireframe&&this.syncWireframe())}),syncFromPhysics:(o=new THREE.Vector3,a=new THREE.Quaternion,l=new THREE.Quaternion,function(){var e=this.el,t=e.parentEl,n=this.body;n&&t&&(t.isScene?(e.object3D.quaternion.copy(n.quaternion),e.object3D.position.copy(n.position)):(a.copy(n.quaternion),t.object3D.getWorldQuaternion(l),a.premultiply(l.inverse()),e.object3D.quaternion.copy(a),o.copy(n.position),t.object3D.worldToLocal(o),e.object3D.position.copy(o)),this.wireframe&&this.syncWireframe())})};e.exports.definition=u,e.exports.Component=AFRAME.registerComponent("body",u)},function(e,t,n){var r=n(14),o=n(2)("toStringTag"),a="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:a?r(t):"Object"==(i=r(t))&&"function"==typeof t.callee?"Arguments":i}},function(e,t,n){var i=n(23),r=n(4),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n(41)?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var o=n(6);e.exports=function(e,t,n,i){try{return i?t(o(n)[0],n[1]):t(n)}catch(t){var r=e.return;throw void 0!==r&&o(r.call(e)),t}}},function(e,t,n){var i=n(24),r=n(2)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[r]===e)}},function(e,t,n){var i=n(56),r=n(2)("iterator"),o=n(24);e.exports=n(23).getIteratorMethod=function(e){if(null!=e)return e[r]||e["@@iterator"]||o[i(e)]}},function(e,t,n){function i(){var e=+this;if(A.hasOwnProperty(e)){var t=A[e];delete A[e],t()}}function r(e){i.call(e.data)}var o,a,s,c=n(13),l=n(93),u=n(62),h=n(43),d=n(4),p=d.process,f=d.setImmediate,m=d.clearImmediate,v=d.MessageChannel,g=d.Dispatch,y=0,A={};f&&m||(f=function(e){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);return A[++y]=function(){l("function"==typeof e?e:Function(e),t)},o(y),y},m=function(e){delete A[e]},"process"==n(14)(p)?o=function(e){p.nextTick(c(i,e,1))}:g&&g.now?o=function(e){g.now(c(i,e,1))}:v?(s=(a=new v).port2,a.port1.onmessage=r,o=c(s.postMessage,s,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(o=function(e){d.postMessage(e+"","*")},d.addEventListener("message",r,!1)):o="onreadystatechange"in h("script")?function(e){u.appendChild(h("script")).onreadystatechange=function(){u.removeChild(this),i.call(e)}}:function(e){setTimeout(c(i,e,1),0)}),e.exports={set:f,clear:m}},function(e,t,n){var i=n(4).document;e.exports=i&&i.documentElement},function(e,t,n){"use strict";var r=n(30);function i(e){var n,i;this.promise=new e(function(e,t){if(void 0!==n||void 0!==i)throw TypeError("Bad Promise constructor");n=e,i=t}),this.resolve=r(n),this.reject=r(i)}e.exports.f=function(e){return new i(e)}},function(e,t,n){var o=n(2)("iterator"),a=!1;try{var i=[7][o]();i.return=function(){a=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!a)return!1;var n=!1;try{var i=[7],r=i[o]();r.next=function(){return{done:n=!0}},i[o]=function(){return r},e(i)}catch(e){}return n}},function(e,t,n){"use strict";function A(){return this}var b=n(41),w=n(15),x=n(18),E=n(16),M=n(24),T=n(102),S=n(45),C=n(108),L=n(2)("iterator"),_=!([].keys&&"next"in[].keys());e.exports=function(e,t,n,i,r,o,a){T(n,t,i);function s(e){if(!_&&e in f)return f[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}}var c,l,u,h=t+" Iterator",d="values"==r,p=!1,f=e.prototype,m=f[L]||f["@@iterator"]||r&&f[r],v=m||s(r),g=r?d?s("entries"):v:void 0,y="Array"==t&&f.entries||m;if(y&&(u=C(y.call(new e)))!==Object.prototype&&u.next&&(S(u,h,!0),b||"function"==typeof u[L]||E(u,L,A)),d&&m&&"values"!==m.name&&(p=!0,v=function(){return m.call(this)}),b&&!a||!_&&!p&&f[L]||E(f,L,v),M[t]=v,M[h]=A,r)if(c={values:d?v:s("values"),keys:o?v:s("keys"),entries:g},a)for(l in c)l in f||x(f,l,c[l]);else w(w.P+w.F*(_||p),t,c);return c}},function(e,t,n){var i=n(105),r=n(68);e.exports=Object.keys||function(e){return i(e,r)}},function(e,t,n){var i=n(14);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){function n(){this.matrix=[]}(e.exports=n).prototype.get=function(e,t){if(e=e.index,(t=t.index)>e){var n=t;t=e,e=n}return this.matrix[(e*(e+1)>>1)+t-1]},n.prototype.set=function(e,t,n){if(e=e.index,(t=t.index)>e){var i=t;t=e,e=i}this.matrix[(e*(e+1)>>1)+t-1]=n?1:0},n.prototype.reset=function(){for(var e=0,t=this.matrix.length;e!==t;e++)this.matrix[e]=0},n.prototype.setNumObjects=function(e){this.matrix.length=e*(e-1)>>1}},function(e,t,n){e.exports=o;var i=n(1),r=n(0);function o(){i.call(this),this.type=i.types.PLANE,this.worldNormal=new r,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}((o.prototype=new i).constructor=o).prototype.computeWorldNormal=function(e){var t=this.worldNormal;t.set(0,0,1),e.vmult(t,t),this.worldNormalNeedsUpdate=!1},o.prototype.calculateLocalInertia=function(e,t){return t||new r},o.prototype.volume=function(){return Number.MAX_VALUE};var a=new r;o.prototype.calculateWorldAABB=function(e,t,n,i){a.set(0,0,1),t.vmult(a,a);var r=Number.MAX_VALUE;n.set(-r,-r,-r),i.set(r,r,r),1===a.x&&(i.x=e.x),1===a.y&&(i.y=e.y),1===a.z&&(i.z=e.z),-1===a.x&&(n.x=e.x),-1===a.y&&(n.y=e.y),-1===a.z&&(n.z=e.z)},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},function(e,t,n){e.exports=s;var i=n(7),E=n(9),r=n(1),O=n(36),y=n(0),k=n(20),o=(n(19),n(3)),a=(n(37),n(72)),u=n(10),v=n(53);function s(e){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new a,this.world=e,this.currentContactMaterial=null,this.enableFrictionReduction=!1}s.prototype.createContactEquation=function(e,t,n,i,r,o){var a;this.contactPointPool.length?((a=this.contactPointPool.pop()).bi=e,a.bj=t):a=new u(e,t),a.enabled=e.collisionResponse&&t.collisionResponse&&n.collisionResponse&&i.collisionResponse;var s=this.currentContactMaterial;a.restitution=s.restitution,a.setSpookParams(s.contactEquationStiffness,s.contactEquationRelaxation,this.world.dt);var c=n.material||e.material,l=i.material||t.material;return c&&l&&0<=c.restitution&&0<=l.restitution&&(a.restitution=c.restitution*l.restitution),a.si=r||n,a.sj=o||i,a},s.prototype.createFrictionEquationsFromContact=function(e,t){var n=e.bi,i=e.bj,r=e.si,o=e.sj,a=this.world,s=this.currentContactMaterial,c=s.friction,l=r.material||n.material,u=o.material||i.material;if(l&&u&&0<=l.friction&&0<=u.friction&&(c=l.friction*u.friction),0<c){var h=c*a.gravity.length(),d=n.invMass+i.invMass;0<d&&(d=1/d);var p=this.frictionEquationPool,f=p.length?p.pop():new v(n,i,h*d),m=p.length?p.pop():new v(n,i,h*d);return f.bi=m.bi=n,f.bj=m.bj=i,f.minForce=m.minForce=-h*d,f.maxForce=m.maxForce=h*d,f.ri.copy(e.ri),f.rj.copy(e.rj),m.ri.copy(e.ri),m.rj.copy(e.rj),e.ni.tangents(f.t,m.t),f.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,a.dt),m.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,a.dt),f.enabled=m.enabled=e.enabled,t.push(f,m),!0}return!1};var c=new y,l=new y,h=new y;s.prototype.createFrictionFromAverage=function(e){var t=this.result[this.result.length-1];if(this.createFrictionEquationsFromContact(t,this.frictionResult)&&1!==e){var n=this.frictionResult[this.frictionResult.length-2],i=this.frictionResult[this.frictionResult.length-1];c.setZero(),l.setZero(),h.setZero();for(var r=t.bi,o=(t.bj,0);o!==e;o++)(t=this.result[this.result.length-1-o]).bodyA!==r?(c.vadd(t.ni,c),l.vadd(t.ri,l),h.vadd(t.rj,h)):(c.vsub(t.ni,c),l.vadd(t.rj,l),h.vadd(t.ri,h));var a=1/e;l.scale(a,n.ri),h.scale(a,n.rj),i.ri.copy(n.ri),i.rj.copy(n.rj),c.normalize(),c.tangents(n.t,i.t)}};var M=new y,T=new y,S=new o,C=new o;s.prototype.getContacts=function(e,t,n,i,r,o,a){this.contactPointPool=r,this.frictionEquationPool=a,this.result=i,this.frictionResult=o;for(var s=S,c=C,l=M,u=T,h=0,d=e.length;h!==d;h++){var p=e[h],f=t[h],m=null;p.material&&f.material&&(m=n.getContactMaterial(p.material,f.material)||null);for(var v=p.type&E.KINEMATIC&&f.type&E.STATIC||p.type&E.STATIC&&f.type&E.KINEMATIC||p.type&E.KINEMATIC&&f.type&E.KINEMATIC,g=0;g<p.shapes.length;g++){p.quaternion.mult(p.shapeOrientations[g],s),p.quaternion.vmult(p.shapeOffsets[g],l),l.vadd(p.position,l);for(var y=p.shapes[g],A=0;A<f.shapes.length;A++){f.quaternion.mult(f.shapeOrientations[A],c),f.quaternion.vmult(f.shapeOffsets[A],u),u.vadd(f.position,u);var b=f.shapes[A];if(!(l.distanceTo(u)>y.boundingSphereRadius+b.boundingSphereRadius)){var w=null;y.material&&b.material&&(w=n.getContactMaterial(y.material,b.material)||null),this.currentContactMaterial=w||m||n.defaultContactMaterial;var x=this[y.type|b.type];x&&(y.type<b.type?x.call(this,y,b,l,u,s,c,p,f,y,b,v):x.call(this,b,y,u,l,c,s,f,p,y,b,v))&&v&&(n.shapeOverlapKeeper.set(y.id,b.id),n.bodyOverlapKeeper.set(p.id,f.id))}}}}},s.prototype[r.types.BOX|r.types.BOX]=s.prototype.boxBox=function(e,t,n,i,r,o,a,s,c,l,u){return e.convexPolyhedronRepresentation.material=e.material,t.convexPolyhedronRepresentation.material=t.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t.convexPolyhedronRepresentation,n,i,r,o,a,s,e,t,u)},s.prototype[r.types.BOX|r.types.CONVEXPOLYHEDRON]=s.prototype.boxConvex=function(e,t,n,i,r,o,a,s,c,l,u){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t,n,i,r,o,a,s,e,t,u)},s.prototype[r.types.BOX|r.types.PARTICLE]=s.prototype.boxParticle=function(e,t,n,i,r,o,a,s,c,l,u){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexParticle(e.convexPolyhedronRepresentation,t,n,i,r,o,a,s,e,t,u)},s.prototype[r.types.SPHERE]=s.prototype.sphereSphere=function(e,t,n,i,r,o,a,s,c,l,u){if(u)return n.distanceSquared(i)<Math.pow(e.radius+t.radius,2);var h=this.createContactEquation(a,s,e,t,c,l);i.vsub(n,h.ni),h.ni.normalize(),h.ri.copy(h.ni),h.rj.copy(h.ni),h.ri.mult(e.radius,h.ri),h.rj.mult(-t.radius,h.rj),h.ri.vadd(n,h.ri),h.ri.vsub(a.position,h.ri),h.rj.vadd(i,h.rj),h.rj.vsub(s.position,h.rj),this.result.push(h),this.createFrictionEquationsFromContact(h,this.frictionResult)};var A=new y,b=new y,w=new y;s.prototype[r.types.PLANE|r.types.TRIMESH]=s.prototype.planeTrimesh=function(e,t,n,i,r,o,a,s,c,l,u){var h=new y,d=A;d.set(0,0,1),r.vmult(d,d);for(var p=0;p<t.vertices.length/3;p++){t.getVertex(p,h);var f=new y;f.copy(h),k.pointToWorldFrame(i,o,f,h);var m=b;if(h.vsub(n,m),d.dot(m)<=0){if(u)return!0;var v=this.createContactEquation(a,s,e,t,c,l);v.ni.copy(d);var g=w;d.scale(m.dot(d),g),h.vsub(g,g),v.ri.copy(g),v.ri.vsub(a.position,v.ri),v.rj.copy(h),v.rj.vsub(s.position,v.rj),this.result.push(v),this.createFrictionEquationsFromContact(v,this.frictionResult)}}};var j=new y,H=new y,F=(new y,new y),N=new y,z=new y,U=new y,G=new y,V=new y,W=new y,q=new y,X=new y,Q=new y,Y=new y,Z=new i,K=[];s.prototype[r.types.SPHERE|r.types.TRIMESH]=s.prototype.sphereTrimesh=function(e,t,n,i,r,o,a,s,c,l,u){var h=z,d=U,p=G,f=V,m=W,v=q,g=Z,y=N,A=H,b=K;k.pointToLocalFrame(i,o,n,m);var w=e.radius;g.lowerBound.set(m.x-w,m.y-w,m.z-w),g.upperBound.set(m.x+w,m.y+w,m.z+w),t.getTrianglesInAABB(g,b);for(var x=F,E=e.radius*e.radius,M=0;M<b.length;M++)for(var T=0;T<3;T++)if(t.getVertex(t.indices[3*b[M]+T],x),x.vsub(m,A),A.norm2()<=E){if(y.copy(x),k.pointToWorldFrame(i,o,y,x),x.vsub(n,A),u)return!0;(L=this.createContactEquation(a,s,e,t,c,l)).ni.copy(A),L.ni.normalize(),L.ri.copy(L.ni),L.ri.scale(e.radius,L.ri),L.ri.vadd(n,L.ri),L.ri.vsub(a.position,L.ri),L.rj.copy(x),L.rj.vsub(s.position,L.rj),this.result.push(L),this.createFrictionEquationsFromContact(L,this.frictionResult)}for(M=0;M<b.length;M++)for(T=0;T<3;T++){t.getVertex(t.indices[3*b[M]+T],h),t.getVertex(t.indices[3*b[M]+(T+1)%3],d),d.vsub(h,p),m.vsub(d,v);var S=v.dot(p);m.vsub(h,v);var C=v.dot(p);if(0<C&&S<0&&(m.vsub(h,v),f.copy(p),f.normalize(),C=v.dot(f),f.scale(C,v),v.vadd(h,v),(I=v.distanceTo(m))<e.radius)){if(u)return!0;var L=this.createContactEquation(a,s,e,t,c,l);v.vsub(m,L.ni),L.ni.normalize(),L.ni.scale(e.radius,L.ri),k.pointToWorldFrame(i,o,v,v),v.vsub(s.position,L.rj),k.vectorToWorldFrame(o,L.ni,L.ni),k.vectorToWorldFrame(o,L.ri,L.ri),this.result.push(L),this.createFrictionEquationsFromContact(L,this.frictionResult)}}for(var _=X,B=Q,R=Y,P=j,D=(M=0,b.length);M!==D;M++){t.getTriangleVertices(b[M],_,B,R),t.getNormal(b[M],P),m.vsub(_,v);var I=v.dot(P);if(P.scale(I,v),m.vsub(v,v),I=v.distanceTo(m),O.pointInTriangle(v,_,B,R)&&I<e.radius){if(u)return!0;L=this.createContactEquation(a,s,e,t,c,l),v.vsub(m,L.ni),L.ni.normalize(),L.ni.scale(e.radius,L.ri),k.pointToWorldFrame(i,o,v,v),v.vsub(s.position,L.rj),k.vectorToWorldFrame(o,L.ni,L.ni),k.vectorToWorldFrame(o,L.ri,L.ri),this.result.push(L),this.createFrictionEquationsFromContact(L,this.frictionResult)}}b.length=0};var f=new y,m=new y;s.prototype[r.types.SPHERE|r.types.PLANE]=s.prototype.spherePlane=function(e,t,n,i,r,o,a,s,c,l,u){var h=this.createContactEquation(a,s,e,t,c,l);if(h.ni.set(0,0,1),o.vmult(h.ni,h.ni),h.ni.negate(h.ni),h.ni.normalize(),h.ni.mult(e.radius,h.ri),n.vsub(i,f),h.ni.mult(h.ni.dot(f),m),f.vsub(m,h.rj),-f.dot(h.ni)<=e.radius){if(u)return!0;var d=h.ri,p=h.rj;d.vadd(n,d),d.vsub(a.position,d),p.vadd(i,p),p.vsub(s.position,p),this.result.push(h),this.createFrictionEquationsFromContact(h,this.frictionResult)}};var d=new y,p=new y,g=new y;function J(e,t,n){for(var i=null,r=e.length,o=0;o!==r;o++){var a=e[o],s=d;e[(o+1)%r].vsub(a,s);var c=p;s.cross(t,c);var l=g;n.vsub(a,l);var u=c.dot(l);if(!(null===i||0<u&&!0===i||u<=0&&!1===i))return!1;null===i&&(i=0<u)}return!0}var $=new y,ee=new y,te=new y,ne=new y,ie=[new y,new y,new y,new y,new y,new y],re=new y,oe=new y,ae=new y,se=new y;s.prototype[r.types.SPHERE|r.types.BOX]=s.prototype.sphereBox=function(e,t,n,i,r,o,a,s,c,l,u){var h=this.v3pool,d=ie;n.vsub(i,$),t.getSideNormals(d,o);for(var p=e.radius,f=!1,m=oe,v=ae,g=se,y=null,A=0,b=0,w=0,x=null,E=0,M=d.length;E!==M&&!1===f;E++){var T=ee;T.copy(d[E]);var S=T.norm();T.normalize();var C=$.dot(T);if(C<S+p&&0<C){var L=te,_=ne;L.copy(d[(E+1)%3]),_.copy(d[(E+2)%3]);var B=L.norm(),R=_.norm();L.normalize(),_.normalize();var P=$.dot(L),D=$.dot(_);if(P<B&&-B<P&&D<R&&-R<D){var I=Math.abs(C-S-p);if((null===x||I<x)&&(x=I,b=P,w=D,y=S,m.copy(T),v.copy(L),g.copy(_),A++,u))return!0}}}if(A){f=!0;var O=this.createContactEquation(a,s,e,t,c,l);m.mult(-p,O.ri),O.ni.copy(m),O.ni.negate(O.ni),m.mult(y,m),v.mult(b,v),m.vadd(v,m),g.mult(w,g),m.vadd(g,O.rj),O.ri.vadd(n,O.ri),O.ri.vsub(a.position,O.ri),O.rj.vadd(i,O.rj),O.rj.vsub(s.position,O.rj),this.result.push(O),this.createFrictionEquationsFromContact(O,this.frictionResult)}for(var k=h.get(),j=re,H=0;2!==H&&!f;H++)for(var F=0;2!==F&&!f;F++)for(var N=0;2!==N&&!f;N++)if(k.set(0,0,0),H?k.vadd(d[0],k):k.vsub(d[0],k),F?k.vadd(d[1],k):k.vsub(d[1],k),N?k.vadd(d[2],k):k.vsub(d[2],k),i.vadd(k,j),j.vsub(n,j),j.norm2()<p*p){if(u)return!0;f=!0,(O=this.createContactEquation(a,s,e,t,c,l)).ri.copy(j),O.ri.normalize(),O.ni.copy(O.ri),O.ri.mult(p,O.ri),O.rj.copy(k),O.ri.vadd(n,O.ri),O.ri.vsub(a.position,O.ri),O.rj.vadd(i,O.rj),O.rj.vsub(s.position,O.rj),this.result.push(O),this.createFrictionEquationsFromContact(O,this.frictionResult)}h.release(k),k=null;var z=h.get(),U=h.get(),G=(O=h.get(),h.get()),V=(I=h.get(),d.length);for(H=0;H!==V&&!f;H++)for(F=0;F!==V&&!f;F++)if(H%3!=F%3){d[F].cross(d[H],z),z.normalize(),d[H].vadd(d[F],U),O.copy(n),O.vsub(U,O),O.vsub(i,O);var W=O.dot(z);for(z.mult(W,G),N=0;N===H%3||N===F%3;)N++;I.copy(n),I.vsub(G,I),I.vsub(U,I),I.vsub(i,I);var q=Math.abs(W),X=I.norm();if(q<d[N].norm()&&X<p){if(u)return!0;f=!0;var Q=this.createContactEquation(a,s,e,t,c,l);U.vadd(G,Q.rj),Q.rj.copy(Q.rj),I.negate(Q.ni),Q.ni.normalize(),Q.ri.copy(Q.rj),Q.ri.vadd(i,Q.ri),Q.ri.vsub(n,Q.ri),Q.ri.normalize(),Q.ri.mult(p,Q.ri),Q.ri.vadd(n,Q.ri),Q.ri.vsub(a.position,Q.ri),Q.rj.vadd(i,Q.rj),Q.rj.vsub(s.position,Q.rj),this.result.push(Q),this.createFrictionEquationsFromContact(Q,this.frictionResult)}}h.release(z,U,O,G,I)};var ce=new y,le=new y,ue=new y,he=new y,de=new y,pe=new y,fe=new y,me=new y,ve=new y,ge=new y;s.prototype[r.types.SPHERE|r.types.CONVEXPOLYHEDRON]=s.prototype.sphereConvex=function(e,t,n,i,r,o,a,s,c,l,u){var h=this.v3pool;n.vsub(i,ce);for(var d=t.faceNormals,p=t.faces,f=t.vertices,m=e.radius,v=0;v!==f.length;v++){var g=f[v],y=de;o.vmult(g,y),i.vadd(y,y);var A=he;if(y.vsub(n,A),A.norm2()<m*m)return!!u||(b=!0,(I=this.createContactEquation(a,s,e,t,c,l)).ri.copy(A),I.ri.normalize(),I.ni.copy(I.ri),I.ri.mult(m,I.ri),y.vsub(i,I.rj),I.ri.vadd(n,I.ri),I.ri.vsub(a.position,I.ri),I.rj.vadd(i,I.rj),I.rj.vsub(s.position,I.rj),this.result.push(I),void this.createFrictionEquationsFromContact(I,this.frictionResult))}for(var b=!1,w=(v=0,p.length);v!==w&&!1===b;v++){var x=d[v],E=p[v],M=pe;o.vmult(x,M);var T=fe;o.vmult(f[E[0]],T),T.vadd(i,T);var S=me;M.mult(-m,S),n.vadd(S,S);var C=ve;S.vsub(T,C);var L=C.dot(M),_=ge;if(n.vsub(T,_),L<0&&0<_.dot(M)){for(var B=[],R=0,P=E.length;R!==P;R++){var D=h.get();o.vmult(f[E[R]],D),i.vadd(D,D),B.push(D)}if(J(B,M,n)){if(u)return!0;b=!0;var I=this.createContactEquation(a,s,e,t,c,l);M.mult(-m,I.ri),M.negate(I.ni);var O=h.get();M.mult(-L,O);var k=h.get();M.mult(-m,k),n.vsub(i,I.rj),I.rj.vadd(k,I.rj),I.rj.vadd(O,I.rj),I.rj.vadd(i,I.rj),I.rj.vsub(s.position,I.rj),I.ri.vadd(n,I.ri),I.ri.vsub(a.position,I.ri),h.release(O),h.release(k),this.result.push(I),this.createFrictionEquationsFromContact(I,this.frictionResult),R=0;for(var j=B.length;R!==j;R++)h.release(B[R]);return}for(R=0;R!==E.length;R++){var H=h.get(),F=h.get();o.vmult(f[E[(R+1)%E.length]],H),o.vmult(f[E[(R+2)%E.length]],F),i.vadd(H,H),i.vadd(F,F);var N=le;F.vsub(H,N);var z=ue;N.unit(z);var U=h.get(),G=h.get();n.vsub(H,G);var V=G.dot(z);z.mult(V,U),U.vadd(H,U);var W=h.get();if(U.vsub(n,W),0<V&&V*V<N.norm2()&&W.norm2()<m*m){if(u)return!0;for(I=this.createContactEquation(a,s,e,t,c,l),U.vsub(i,I.rj),U.vsub(n,I.ni),I.ni.normalize(),I.ni.mult(m,I.ri),I.rj.vadd(i,I.rj),I.rj.vsub(s.position,I.rj),I.ri.vadd(n,I.ri),I.ri.vsub(a.position,I.ri),this.result.push(I),this.createFrictionEquationsFromContact(I,this.frictionResult),R=0,j=B.length;R!==j;R++)h.release(B[R]);return h.release(H),h.release(F),h.release(U),h.release(W),void h.release(G)}h.release(H),h.release(F),h.release(U),h.release(W),h.release(G)}for(R=0,j=B.length;R!==j;R++)h.release(B[R])}}},new y,new y,s.prototype[r.types.PLANE|r.types.BOX]=s.prototype.planeBox=function(e,t,n,i,r,o,a,s,c,l,u){return t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,t.convexPolyhedronRepresentation.id=t.id,this.planeConvex(e,t.convexPolyhedronRepresentation,n,i,r,o,a,s,e,t,u)};var x=new y,L=new y,_=new y,B=new y;s.prototype[r.types.PLANE|r.types.CONVEXPOLYHEDRON]=s.prototype.planeConvex=function(e,t,n,i,r,o,a,s,c,l,u){var h=x,d=L;d.set(0,0,1),r.vmult(d,d);for(var p=0,f=_,m=0;m!==t.vertices.length;m++)if(h.copy(t.vertices[m]),o.vmult(h,h),i.vadd(h,h),h.vsub(n,f),d.dot(f)<=0){if(u)return!0;var v=this.createContactEquation(a,s,e,t,c,l),g=B;d.mult(d.dot(f),g),h.vsub(g,g),g.vsub(n,v.ri),v.ni.copy(d),h.vsub(i,v.rj),v.ri.vadd(n,v.ri),v.ri.vsub(a.position,v.ri),v.rj.vadd(i,v.rj),v.rj.vsub(s.position,v.rj),this.result.push(v),p++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(v,this.frictionResult)}this.enableFrictionReduction&&p&&this.createFrictionFromAverage(p)};var R=new y,P=new y;s.prototype[r.types.CONVEXPOLYHEDRON]=s.prototype.convexConvex=function(e,t,n,i,r,o,a,s,c,l,u,h,d){var p=R;if(!(n.distanceTo(i)>e.boundingSphereRadius+t.boundingSphereRadius)&&e.findSeparatingAxis(t,n,r,i,o,p,h,d)){var f=[],m=P;e.clipAgainstHull(n,r,t,i,o,p,-100,100,f);for(var v=0,g=0;g!==f.length;g++){if(u)return!0;var y=this.createContactEquation(a,s,e,t,c,l),A=y.ri,b=y.rj;p.negate(y.ni),f[g].normal.negate(m),m.mult(f[g].depth,m),f[g].point.vadd(m,A),b.copy(f[g].point),A.vsub(n,A),b.vsub(i,b),A.vadd(n,A),A.vsub(a.position,A),b.vadd(i,b),b.vsub(s.position,b),this.result.push(y),v++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(y,this.frictionResult)}this.enableFrictionReduction&&v&&this.createFrictionFromAverage(v)}};var D=new y,I=new y,ye=new y;s.prototype[r.types.PLANE|r.types.PARTICLE]=s.prototype.planeParticle=function(e,t,n,i,r,o,a,s,c,l,u){var h=D;h.set(0,0,1),a.quaternion.vmult(h,h);var d=I;if(i.vsub(a.position,d),h.dot(d)<=0){if(u)return!0;var p=this.createContactEquation(s,a,t,e,c,l);p.ni.copy(h),p.ni.negate(p.ni),p.ri.set(0,0,0);var f=ye;h.mult(h.dot(i),f),i.vsub(f,f),p.rj.copy(f),this.result.push(p),this.createFrictionEquationsFromContact(p,this.frictionResult)}};var Ae=new y;s.prototype[r.types.PARTICLE|r.types.SPHERE]=s.prototype.sphereParticle=function(e,t,n,i,r,o,a,s,c,l,u){var h=Ae;if(h.set(0,0,1),i.vsub(n,h),h.norm2()<=e.radius*e.radius){if(u)return!0;var d=this.createContactEquation(s,a,t,e,c,l);h.normalize(),d.rj.copy(h),d.rj.mult(e.radius,d.rj),d.ni.copy(h),d.ni.negate(d.ni),d.ri.set(0,0,0),this.result.push(d),this.createFrictionEquationsFromContact(d,this.frictionResult)}};var be=new o,we=new y,xe=(new y,new y),Ee=new y,Me=new y;s.prototype[r.types.PARTICLE|r.types.CONVEXPOLYHEDRON]=s.prototype.convexParticle=function(e,t,n,i,r,o,a,s,c,l,u){var h=-1,d=xe,p=Me,f=null,m=we;if(m.copy(i),m.vsub(n,m),r.conjugate(be),be.vmult(m,m),e.pointIsInside(m)){e.worldVerticesNeedsUpdate&&e.computeWorldVertices(n,r),e.worldFaceNormalsNeedsUpdate&&e.computeWorldFaceNormals(r);for(var v=0,g=e.faces.length;v!==g;v++){var y=[e.worldVertices[e.faces[v][0]]],A=e.worldFaceNormals[v];i.vsub(y[0],Ee);var b=-A.dot(Ee);if(null===f||Math.abs(b)<Math.abs(f)){if(u)return!0;f=b,h=v,d.copy(A)}}if(-1!==h){var w=this.createContactEquation(s,a,t,e,c,l);d.mult(f,p),p.vadd(i,p),p.vsub(n,p),w.rj.copy(p),d.negate(w.ni),w.ri.set(0,0,0);var x=w.ri,E=w.rj;x.vadd(i,x),x.vsub(s.position,x),E.vadd(n,E),E.vsub(a.position,E),this.result.push(w),this.createFrictionEquationsFromContact(w,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}},s.prototype[r.types.BOX|r.types.HEIGHTFIELD]=s.prototype.boxHeightfield=function(e,t,n,i,r,o,a,s,c,l,u){return e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexHeightfield(e.convexPolyhedronRepresentation,t,n,i,r,o,a,s,e,t,u)};var Te=new y,Se=new y,Ce=[0];s.prototype[r.types.CONVEXPOLYHEDRON|r.types.HEIGHTFIELD]=s.prototype.convexHeightfield=function(e,t,n,i,r,o,a,s,c,l,u){var h=t.data,d=t.elementSize,p=e.boundingSphereRadius,f=Se,m=Ce,v=Te;k.pointToLocalFrame(i,o,n,v);var g=Math.floor((v.x-p)/d)-1,y=Math.ceil((v.x+p)/d)+1,A=Math.floor((v.y-p)/d)-1,b=Math.ceil((v.y+p)/d)+1;if(!(y<0||b<0||g>h.length||A>h[0].length)){g<0&&(g=0),y<0&&(y=0),A<0&&(A=0),b<0&&(b=0),g>=h.length&&(g=h.length-1),y>=h.length&&(y=h.length-1),b>=h[0].length&&(b=h[0].length-1),A>=h[0].length&&(A=h[0].length-1);var w=[];t.getRectMinMax(g,A,y,b,w);var x=w[0],E=w[1];if(!(v.z-p>E||v.z+p<x))for(var M=g;M<y;M++)for(var T=A;T<b;T++){var S=!1;if(t.getConvexTrianglePillar(M,T,!1),k.pointToWorldFrame(i,o,t.pillarOffset,f),n.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(S=this.convexConvex(e,t.pillarConvex,n,f,r,o,a,s,null,null,u,m,null)),u&&S)return!0;if(t.getConvexTrianglePillar(M,T,!0),k.pointToWorldFrame(i,o,t.pillarOffset,f),n.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(S=this.convexConvex(e,t.pillarConvex,n,f,r,o,a,s,null,null,u,m,null)),u&&S)return!0}}};var Le=new y,_e=new y;s.prototype[r.types.SPHERE|r.types.HEIGHTFIELD]=s.prototype.sphereHeightfield=function(e,t,n,i,r,o,a,s,c,l,u){var h=t.data,d=e.radius,p=t.elementSize,f=_e,m=Le;k.pointToLocalFrame(i,o,n,m);var v=Math.floor((m.x-d)/p)-1,g=Math.ceil((m.x+d)/p)+1,y=Math.floor((m.y-d)/p)-1,A=Math.ceil((m.y+d)/p)+1;if(!(g<0||A<0||v>h.length||A>h[0].length)){v<0&&(v=0),g<0&&(g=0),y<0&&(y=0),A<0&&(A=0),v>=h.length&&(v=h.length-1),g>=h.length&&(g=h.length-1),A>=h[0].length&&(A=h[0].length-1),y>=h[0].length&&(y=h[0].length-1);var b=[];t.getRectMinMax(v,y,g,A,b);var w=b[0],x=b[1];if(!(m.z-d>x||m.z+d<w))for(var E=this.result,M=v;M<g;M++)for(var T=y;T<A;T++){var S=E.length,C=!1;if(t.getConvexTrianglePillar(M,T,!1),k.pointToWorldFrame(i,o,t.pillarOffset,f),n.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(C=this.sphereConvex(e,t.pillarConvex,n,f,r,o,a,s,e,t,u)),u&&C)return!0;if(t.getConvexTrianglePillar(M,T,!0),k.pointToWorldFrame(i,o,t.pillarOffset,f),n.distanceTo(f)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&(C=this.sphereConvex(e,t.pillarConvex,n,f,r,o,a,s,e,t,u)),u&&C)return!0;if(2<E.length-S)return}}}},function(e,t,n){e.exports=o;var i=n(0),r=n(73);function o(){r.call(this),this.type=i}(o.prototype=new r).constructObject=function(){return new i}},function(e,t){function n(){this.objects=[],this.type=Object}(e.exports=n).prototype.release=function(){for(var e=arguments.length,t=0;t!==e;t++)this.objects.push(arguments[t]);return this},n.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()},n.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")},n.prototype.resize=function(e){for(var t=this.objects;t.length>e;)t.pop();for(;t.length<e;)t.push(this.constructObject());return this}},function(e,t,n){var i=n(27);function r(e,t,n){n=i.defaults(n,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=r.idCounter++,this.materials=[e,t],this.friction=n.friction,this.restitution=n.restitution,this.contactEquationStiffness=n.contactEquationStiffness,this.contactEquationRelaxation=n.contactEquationRelaxation,this.frictionEquationStiffness=n.frictionEquationStiffness,this.frictionEquationRelaxation=n.frictionEquationRelaxation}(e.exports=r).idCounter=0},function(e,t,n){e.exports=r,n(0),n(3);var i=n(37);function r(){i.call(this),this.iterations=10,this.tolerance=1e-7}r.prototype=new i;var L=[],_=[],B=[];r.prototype.solve=function(e,t){var n,i,r,o,a,s=0,c=this.iterations,l=this.tolerance*this.tolerance,u=this.equations,h=u.length,d=t.bodies,p=d.length,f=e;if(0!==h)for(var m=0;m!==p;m++)d[m].updateSolveMassProperties();var v=_,g=B,y=L;for(v.length=h,g.length=h,y.length=h,m=0;m!==h;m++){var A=u[m];y[m]=0,g[m]=A.computeB(f),v[m]=1/A.computeC()}if(0!==h){for(m=0;m!==p;m++){var b=(E=d[m]).vlambda,w=E.wlambda;b.set(0,0,0),w.set(0,0,0)}for(s=0;s!==c;s++){for(var x=o=0;x!==h;x++)A=u[x],n=g[x],i=v[x],(a=y[x])+(r=i*(n-A.computeGWlambda()-A.eps*a))<A.minForce?r=A.minForce-a:a+r>A.maxForce&&(r=A.maxForce-a),y[x]+=r,o+=0<r?r:-r,A.addToWlambda(r);if(o*o<l)break}for(m=0;m!==p;m++){var E,M=(E=d[m]).velocity,T=E.angularVelocity;E.vlambda.vmul(E.linearFactor,E.vlambda),M.vadd(E.vlambda,M),E.wlambda.vmul(E.angularFactor,E.wlambda),T.vadd(E.wlambda,T)}for(var S=u.length,C=1/f;S--;)u[S].multiplier=y[S]*C}return s}},function(e,t,n){e.exports=i,n(21);var l=n(38),u=n(39),h=n(54),d=(n(10),n(0));function i(e,t,n){var i=void 0!==(n=n||{}).maxForce?n.maxForce:1e6,r=n.pivotA?n.pivotA.clone():new d,o=n.pivotB?n.pivotB.clone():new d;l.call(this,e,r,t,o,i),(this.axisA=n.axisA?n.axisA.clone():new d(1,0,0)).normalize(),(this.axisB=n.axisB?n.axisB.clone():new d(1,0,0)).normalize();var a=this.rotationalEquation1=new u(e,t,n),s=this.rotationalEquation2=new u(e,t,n),c=this.motorEquation=new h(e,t,i);c.enabled=!1,this.equations.push(a,s,c)}i.prototype=new l,(i.constructor=i).prototype.enableMotor=function(){this.motorEquation.enabled=!0},i.prototype.disableMotor=function(){this.motorEquation.enabled=!1},i.prototype.setMotorSpeed=function(e){this.motorEquation.targetVelocity=e},i.prototype.setMotorMaxForce=function(e){this.motorEquation.maxForce=e,this.motorEquation.minForce=-e};var p=new d,f=new d;i.prototype.update=function(){var e=this.bodyA,t=this.bodyB,n=this.motorEquation,i=this.rotationalEquation1,r=this.rotationalEquation2,o=p,a=f,s=this.axisA,c=this.axisB;l.prototype.update.call(this),e.quaternion.vmult(s,o),t.quaternion.vmult(c,a),o.tangents(i.axisA,r.axisA),i.axisB.copy(a),r.axisB.copy(a),this.motorEquation.enabled&&(e.quaternion.vmult(this.axisA,n.axisA),t.quaternion.vmult(this.axisB,n.axisB))}},function(e,t,n){e.exports=o;var i=n(35),r=n(7);function o(){i.apply(this)}((o.prototype=new i).constructor=o).prototype.collisionPairs=function(e,t,n){var i,r,o,a,s=e.bodies,c=s.length;for(i=0;i!==c;i++)for(r=0;r!==i;r++)o=s[i],a=s[r],this.needBroadphaseCollision(o,a)&&this.intersectionTest(o,a,t,n)},new r,o.prototype.aabbQuery=function(e,t,n){n=n||[];for(var i=0;i<e.bodies.length;i++){var r=e.bodies[i];r.aabbNeedsUpdate&&r.computeAABB(),r.aabb.overlaps(t)&&n.push(r)}return n}},function(e,t,n){e.exports=o;var i=n(1),r=n(0);function o(){i.call(this),this.type=i.types.PARTICLE}((o.prototype=new i).constructor=o).prototype.calculateLocalInertia=function(e,t){return(t=t||new r).set(0,0,0),t},o.prototype.volume=function(){return 0},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0},o.prototype.calculateWorldAABB=function(e,t,n,i){n.copy(e),i.copy(e)}},function(e,t,n){e.exports=o;var i=n(1),r=n(0);function o(e){if(i.call(this),this.radius=void 0!==e?Number(e):1,this.type=i.types.SPHERE,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}((o.prototype=new i).constructor=o).prototype.calculateLocalInertia=function(e,t){t=t||new r;var n=2*e*this.radius*this.radius/5;return t.x=n,t.y=n,t.z=n,t},o.prototype.volume=function(){return 4*Math.PI*this.radius/3},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius},o.prototype.calculateWorldAABB=function(e,t,n,i){for(var r=this.radius,o=["x","y","z"],a=0;a<o.length;a++){var s=o[a];n[s]=e[s]-r,i[s]=e[s]+r}}},function(e,t,n){var o=n(5),i=n(40);function r(){this.world=null,this.materials={},this.contactMaterial=null}(r.prototype=new i).constructor=r,(e.exports=r).prototype.init=function(e){var t=new o.World;t.quatNormalizeSkip=e.quatNormalizeSkip,t.quatNormalizeFast=e.quatNormalizeFast,t.solver.iterations=e.solverIterations,t.gravity.set(0,e.gravity,0),t.broadphase=new o.NaiveBroadphase,this.world=t},r.prototype.step=function(e){this.world.step(e)},r.prototype.destroy=function(){delete this.world,delete this.contactMaterial,this.materials={}},r.prototype.addBody=function(e){this.world.addBody(e)},r.prototype.removeBody=function(e){this.world.removeBody(e)},r.prototype.applyBodyMethod=function(e,t,n){e["__"+t].apply(e,n)},r.prototype.updateBodyProperties=function(){},r.prototype.getMaterial=function(e){return this.materials[e]},r.prototype.addMaterial=function(e){this.materials[e.name]=new o.Material(e),this.materials[e.name].name=e.name},r.prototype.addContactMaterial=function(e,t,n){var i=this.materials[e],r=this.materials[t];this.contactMaterial=new o.ContactMaterial(i,r,n),this.world.addContactMaterial(this.contactMaterial)},r.prototype.addConstraint=function(e){this.world.addConstraint(e)},r.prototype.removeConstraint=function(e){this.world.removeConstraint(e)},r.prototype.getContacts=function(){return this.world.contacts}},function(e,t){e.exports={INIT:"init",STEP:"step",ADD_BODY:"add-body",REMOVE_BODY:"remove-body",APPLY_BODY_METHOD:"apply-body-method",UPDATE_BODY_PROPERTIES:"update-body-properties",ADD_MATERIAL:"add-material",ADD_CONTACT_MATERIAL:"add-contact-material",ADD_CONSTRAINT:"add-constraint",REMOVE_CONSTRAINT:"remove-constraint",COLLIDE:"collide"}},function(e,t,n){var i=n(40);function r(){throw new Error("[AmmoDriver] Driver not implemented.")}(r.prototype=new i).constructor=r,e.exports=r},function(e,t,n){var a=n(5),s=n(167),c="__id";e.exports.ID=c;var i={};function r(e){var t={type:e.type};if(e.type===a.Shape.types.BOX)t.halfExtents=l(e.halfExtents);else if(e.type===a.Shape.types.SPHERE)t.radius=e.radius;else{if(e._type!==a.Shape.types.CYLINDER)throw new Error("Unimplemented shape type: %s",e.type);t.type=a.Shape.types.CYLINDER,t.radiusTop=e.radiusTop,t.radiusBottom=e.radiusBottom,t.height=e.height,t.numSegments=e.numSegments}return t}function o(e){var t;if(e.type===a.Shape.types.BOX)t=new a.Box(u(e.halfExtents));else if(e.type===a.Shape.types.SPHERE)t=new a.Sphere(e.radius);else{if(e.type!==a.Shape.types.CYLINDER)throw new Error("Unimplemented shape type: %s",e.type);(t=new a.Cylinder(e.radiusTop,e.radiusBottom,e.height,e.numSegments))._type=a.Shape.types.CYLINDER}return t}function l(e){return e.toArray()}function u(e){return new a.Vec3(e[0],e[1],e[2])}function h(e){return e.toArray()}function d(e){return new a.Quaternion(e[0],e[1],e[2],e[3])}e.exports.assignID=function(e,t){t[c]||(i[e]=i[e]||1,t[c]=e+"_"+i[e]++)},e.exports.serializeBody=function(e){return{shapes:e.shapes.map(r),shapeOffsets:e.shapeOffsets.map(l),shapeOrientations:e.shapeOrientations.map(h),position:l(e.position),quaternion:e.quaternion.toArray(),velocity:l(e.velocity),angularVelocity:l(e.angularVelocity),id:e[c],mass:e.mass,linearDamping:e.linearDamping,angularDamping:e.angularDamping,fixedRotation:e.fixedRotation,allowSleep:e.allowSleep,sleepSpeedLimit:e.sleepSpeedLimit,sleepTimeLimit:e.sleepTimeLimit}},e.exports.deserializeBodyUpdate=function(e,t){return t.position.set(e.position[0],e.position[1],e.position[2]),t.quaternion.set(e.quaternion[0],e.quaternion[1],e.quaternion[2],e.quaternion[3]),t.velocity.set(e.velocity[0],e.velocity[1],e.velocity[2]),t.angularVelocity.set(e.angularVelocity[0],e.angularVelocity[1],e.angularVelocity[2]),t.linearDamping=e.linearDamping,t.angularDamping=e.angularDamping,t.fixedRotation=e.fixedRotation,t.allowSleep=e.allowSleep,t.sleepSpeedLimit=e.sleepSpeedLimit,t.sleepTimeLimit=e.sleepTimeLimit,t.mass!==e.mass&&(t.mass=e.mass,t.updateMassProperties()),t},e.exports.deserializeInterpBodyUpdate=function(e,t,n,i){var r=1-i,o=i;n.position.set(e.position[0]*r+t.position[0]*o,e.position[1]*r+t.position[1]*o,e.position[2]*r+t.position[2]*o);var a=s.slerp(e.quaternion,t.quaternion,i);return n.quaternion.set(a[0],a[1],a[2],a[3]),n.velocity.set(e.velocity[0]*r+t.velocity[0]*o,e.velocity[1]*r+t.velocity[1]*o,e.velocity[2]*r+t.velocity[2]*o),n.angularVelocity.set(e.angularVelocity[0]*r+t.angularVelocity[0]*o,e.angularVelocity[1]*r+t.angularVelocity[1]*o,e.angularVelocity[2]*r+t.angularVelocity[2]*o),n.linearDamping=t.linearDamping,n.angularDamping=t.angularDamping,n.fixedRotation=t.fixedRotation,n.allowSleep=t.allowSleep,n.sleepSpeedLimit=t.sleepSpeedLimit,n.sleepTimeLimit=t.sleepTimeLimit,n.mass!==t.mass&&(n.mass=t.mass,n.updateMassProperties()),n},e.exports.deserializeBody=function(e){for(var t,n=new a.Body({mass:e.mass,position:u(e.position),quaternion:d(e.quaternion),velocity:u(e.velocity),angularVelocity:u(e.angularVelocity),linearDamping:e.linearDamping,angularDamping:e.angularDamping,fixedRotation:e.fixedRotation,allowSleep:e.allowSleep,sleepSpeedLimit:e.sleepSpeedLimit,sleepTimeLimit:e.sleepTimeLimit}),i=0;t=e.shapes[i];i++)n.addShape(o(t),u(e.shapeOffsets[i]),d(e.shapeOrientations[i]));return n[c]=e.id,n},e.exports.serializeShape=r,e.exports.deserializeShape=o,e.exports.serializeConstraint=function(e){var t={id:e[c],type:e.type,maxForce:e.maxForce,bodyA:e.bodyA[c],bodyB:e.bodyB[c]};switch(e.type){case"LockConstraint":break;case"DistanceConstraint":t.distance=e.distance;break;case"HingeConstraint":case"ConeTwistConstraint":t.axisA=l(e.axisA),t.axisB=l(e.axisB),t.pivotA=l(e.pivotA),t.pivotB=l(e.pivotB);break;case"PointToPointConstraint":t.pivotA=l(e.pivotA),t.pivotB=l(e.pivotB);break;default:throw new Error("Unexpected constraint type: "+e.type+'. You may need to manually set `constraint.type = "FooConstraint";`.')}return t},e.exports.deserializeConstraint=function(e,t){var n,i=a[e.type],r=t[e.bodyA],o=t[e.bodyB];switch(e.type){case"LockConstraint":n=new a.LockConstraint(r,o,e);break;case"DistanceConstraint":n=new a.DistanceConstraint(r,o,e.distance,e.maxForce);break;case"HingeConstraint":case"ConeTwistConstraint":n=new i(r,o,{pivotA:u(e.pivotA),pivotB:u(e.pivotB),axisA:u(e.axisA),axisB:u(e.axisB),maxForce:e.maxForce});break;case"PointToPointConstraint":n=new a.PointToPointConstraint(r,u(e.pivotA),o,u(e.pivotB),e.maxForce);break;default:throw new Error("Unexpected constraint type: "+e.type)}return n[c]=e.id,n},e.exports.serializeContact=function(e){return{bi:e.bi[c],bj:e.bj[c],ni:l(e.ni),ri:l(e.ri),rj:l(e.rj)}},e.exports.deserializeContact=function(e,t){return{bi:t[e.bi],bj:t[e.bj],ni:u(e.ni),ri:u(e.ri),rj:u(e.rj)}},e.exports.serializeVec3=l,e.exports.deserializeVec3=u,e.exports.serializeQuaternion=h,e.exports.deserializeQuaternion=d},function(P,e){!function(e){"use strict";var c,t=Object.prototype,l=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag",a="object"==typeof P,s=e.regeneratorRuntime;if(s)a&&(P.exports=s);else{(s=e.regeneratorRuntime=a?P.exports:{}).wrap=A;var h="suspendedStart",d="suspendedYield",p="executing",f="completed",m={},u={};u[r]=function(){return this};var v=Object.getPrototypeOf,g=v&&v(v(B([])));g&&g!==t&&l.call(g,r)&&(u=g);var y=E.prototype=w.prototype=Object.create(u);x.prototype=y.constructor=E,E.constructor=x,E[o]=x.displayName="GeneratorFunction",s.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},s.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(y),e},s.awrap=function(e){return{__await:e}},M(T.prototype),T.prototype[i]=function(){return this},s.AsyncIterator=T,s.async=function(e,t,n,i){var r=new T(A(e,t,n,i));return s.isGeneratorFunction(t)?r:r.next().then(function(e){return e.done?e.value:r.next()})},M(y),y[o]="Generator",y[r]=function(){return this},y.toString=function(){return"[object Generator]"},s.keys=function(n){var i=[];for(var e in n)i.push(e);return i.reverse(),function e(){for(;i.length;){var t=i.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},s.values=B,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=c)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function e(e,t){return o.type="throw",o.arg=n,i.next=e,t&&(i.method="next",i.arg=c),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t],o=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var a=l.call(r,"catchLoc"),s=l.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&l.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;L(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:B(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=c),m}}}function A(e,t,n,i){var o,a,s,c,r=t&&t.prototype instanceof w?t:w,l=Object.create(r.prototype),u=new _(i||[]);return l._invoke=(o=e,a=n,s=u,c=h,function(e,t){if(c===p)throw new Error("Generator is already running");if(c===f){if("throw"===e)throw t;return R()}for(s.method=e,s.arg=t;;){var n=s.delegate;if(n){var i=S(n,s);if(i){if(i===m)continue;return i}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(c===h)throw c=f,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);c=p;var r=b(o,a,s);if("normal"===r.type){if(c=s.done?f:d,r.arg===m)continue;return{value:r.arg,done:s.done}}"throw"===r.type&&(c=f,s.method="throw",s.arg=r.arg)}}),l}function b(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function w(){}function x(){}function E(){}function M(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function T(c){var t;this._invoke=function(n,i){function e(){return new Promise(function(e,t){!function t(e,n,i,r){var o=b(c[e],c,n);if("throw"!==o.type){var a=o.arg,s=a.value;return s&&"object"==typeof s&&l.call(s,"__await")?Promise.resolve(s.__await).then(function(e){t("next",e,i,r)},function(e){t("throw",e,i,r)}):Promise.resolve(s).then(function(e){a.value=e,i(a)},r)}r(o.arg)}(n,i,e,t)})}return t=t?t.then(e,e):e()}}function S(e,t){var n=e.iterator[t.method];if(n===c){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=c,S(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=b(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,m;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=c),t.delegate=null,m):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function B(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(l.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=c,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:c,done:!0}}}(function(){return this}()||Function("return this")())},function(e,t,n){"use strict";var i=n(6);e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABgmlDQ1BzUkdCIElFQzYxOTY2LTIuMQAAKJF1kbtLA0EQh78kSiSJKGhhYXFItIoSFYI2Fgm+QC2SCEZtkstLyOO4S5BgK9gKCqKNr0L/Am0Fa0FQFEFsbKwVbVTOOSNExMwyO9/+dmfYnQV7NKfmjQY/5AslPTweVOZi84rzETtumvHhiquGNh0Zi1LX3m6wWfGq16pV/9y/5k6mDBVsTcIjqqaXhCeEp5ZLmsWbwu1qNp4UPhb26XJB4WtLT1T5yeJMlT8s1qPhENhbhZXML078YjWr54Xl5XjzubL6cx/rJZ5UYTYisUu8E4Mw4wRRmGSUEAH6GZY5QC8D9MmKOvn+7/wZipKryqxRQWeJDFlK0luFslRPSUyLnpKRo2L1/29fjfTgQLW6JwiND6b50g3ODfhcN833fdP8PADHPZwVavnFPRh6FX29pnl3oWUVTs5rWmILTteg406L6/FvySFuT6fh+QiaY9B2Ca6Fas9+9jm8heiKfNUFbO9Aj5xvWfwCPVhn04dUBg4AAAAJcEhZcwAAITgAACE4AUWWMWAAAAC6SURBVDiNnc4hTkNBEMbxHwXSBgwGzQVoKpF1HIIEQ1hHm2DWvqzdKzzbA6BrCEkPgaHXaGoazJP72tcd82W+mfnPx4AKKd+ElEelWdEs1Lxt4qEKEFKe4KlvPiTBG7ZVgJDyNSI2tQleMG6bWJcAn/g+ttALCCnPMcO6CoBlp0cBFz3fH/CH37aJjzUJPnB56nsREFK+xXvXng/AK+6wx08NYNHppm3irgZw3+nXqWO4KnjPmGI1BPAPXm8js7SyGNwAAAAASUVORK5CYII="},function(e,t,n){"use strict";function i(){}function h(e){var t;return!(!v(e)||"function"!=typeof(t=e.then))&&t}function r(u,n){if(!u._n){u._n=!0;var i=u._c;x(function(){for(var c=u._v,l=1==u._s,e=0,t=function(e){var t,n,i,r=l?e.ok:e.fail,o=e.resolve,a=e.reject,s=e.domain;try{r?(l||(2==u._h&&j(u),u._h=1),!0===r?t=c:(s&&s.enter(),t=r(c),s&&(s.exit(),i=!0)),t===e.promise?a(C("Promise-chain cycle")):(n=h(t))?n.call(t,o,a):o(t)):a(c)}catch(e){s&&!i&&s.exit(),a(e)}};i.length>e;)t(i[e++]);u._c=[],u._n=!1,n&&!u._h&&O(u)})}}function o(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),r(t,!0))}var a,s,c,l,u=n(41),d=n(4),p=n(13),f=n(56),m=n(15),v=n(11),g=n(30),y=n(90),A=n(91),b=n(92),w=n(61).set,x=n(94)(),E=n(63),M=n(95),T=n(96),S=n(97),C=d.TypeError,L=d.process,_=L&&L.versions,B=_&&_.v8||"",R=d.Promise,P="process"==f(L),D=s=E.f,I=!!function(){try{var e=R.resolve(1),t=(e.constructor={})[n(2)("species")]=function(e){e(i,i)};return(P||"function"==typeof PromiseRejectionEvent)&&e.then(i)instanceof t&&0!==B.indexOf("6.6")&&-1===T.indexOf("Chrome/66")}catch(e){}}(),O=function(o){w.call(d,function(){var e,t,n,i=o._v,r=k(o);if(r&&(e=M(function(){P?L.emit("unhandledRejection",i,o):(t=d.onunhandledrejection)?t({promise:o,reason:i}):(n=d.console)&&n.error&&n.error("Unhandled promise rejection",i)}),o._h=P||k(o)?2:1),o._a=void 0,r&&e.e)throw e.v})},k=function(e){return 1!==e._h&&0===(e._a||e._c).length},j=function(t){w.call(d,function(){var e;P?L.emit("rejectionHandled",t):(e=d.onrejectionhandled)&&e({promise:t,reason:t._v})})},H=function(e){var n,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===e)throw C("Promise can't be resolved itself");(n=h(e))?x(function(){var t={_w:i,_d:!1};try{n.call(e,p(H,t,1),p(o,t,1))}catch(e){o.call(t,e)}}):(i._v=e,i._s=1,r(i,!1))}catch(e){o.call({_w:i,_d:!1},e)}}};I||(R=function(e){y(this,R,"Promise","_h"),g(e),a.call(this);try{e(p(H,this,1),p(o,this,1))}catch(e){o.call(this,e)}},(a=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(98)(R.prototype,{then:function(e,t){var n=D(b(this,R));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=P?L.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&r(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),c=function(){var e=new a;this.promise=e,this.resolve=p(H,e,1),this.reject=p(o,e,1)},E.f=D=function(e){return e===R||e===l?new c(e):s(e)}),m(m.G+m.W+m.F*!I,{Promise:R}),n(45)(R,"Promise"),n(99)("Promise"),l=n(23).Promise,m(m.S+m.F*!I,"Promise",{reject:function(e){var t=D(this);return(0,t.reject)(e),t.promise}}),m(m.S+m.F*(u||!I),"Promise",{resolve:function(e){return S(u&&this===l?R:this,e)}}),m(m.S+m.F*!(I&&n(64)(function(e){R.all(e).catch(i)})),"Promise",{all:function(e){var a=this,t=D(a),s=t.resolve,c=t.reject,n=M(function(){var i=[],r=0,o=1;A(e,!1,function(e){var t=r++,n=!1;i.push(void 0),o++,a.resolve(e).then(function(e){n||(n=!0,i[t]=e,--o||s(i))},c)}),--o||s(i)});return n.e&&c(n.v),t.promise},race:function(e){var t=this,n=D(t),i=n.reject,r=M(function(){A(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}})},function(e,t,n){e.exports=!n(12)&&!n(31)(function(){return 7!=Object.defineProperty(n(43)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(11);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var d=n(13),p=n(58),f=n(59),m=n(6),v=n(25),g=n(60),y={},A={};(t=e.exports=function(e,t,n,i,r){var o,a,s,c,l=r?function(){return e}:g(e),u=d(n,i,t?2:1),h=0;if("function"!=typeof l)throw TypeError(e+" is not iterable!");if(f(l)){for(o=v(e.length);h<o;h++)if((c=t?u(m(a=e[h])[0],a[1]):u(e[h]))===y||c===A)return c}else for(s=l.call(e);!(a=s.next()).done;)if((c=p(s,u,a.value,t))===y||c===A)return c}).BREAK=y,t.RETURN=A},function(e,t,n){var r=n(6),o=n(30),a=n(2)("species");e.exports=function(e,t){var n,i=r(e).constructor;return void 0===i||null==(n=r(i)[a])?t:o(n)}},function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var s=n(4),c=n(61).set,l=s.MutationObserver||s.WebKitMutationObserver,u=s.process,h=s.Promise,d="process"==n(14)(u);e.exports=function(){function e(){var e,t;for(d&&(e=u.domain)&&e.exit();n;){t=n.fn,n=n.next;try{t()}catch(e){throw n?r():i=void 0,e}}i=void 0,e&&e.enter()}var n,i,r;if(d)r=function(){u.nextTick(e)};else if(!l||s.navigator&&s.navigator.standalone)if(h&&h.resolve){var t=h.resolve(void 0);r=function(){t.then(e)}}else r=function(){c.call(s,e)};else{var o=!0,a=document.createTextNode("");new l(e).observe(a,{characterData:!0}),r=function(){a.data=o=!o}}return function(e){var t={fn:e,next:void 0};i&&(i.next=t),n||(n=t,r()),i=t}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var i=n(4).navigator;e.exports=i&&i.userAgent||""},function(e,t,n){var i=n(6),r=n(11),o=n(63);e.exports=function(e,t){if(i(e),r(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){var r=n(18);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){"use strict";var i=n(4),r=n(17),o=n(12),a=n(2)("species");e.exports=function(e){var t=i[e];o&&t&&!t[a]&&r.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var i=n(101)(!0);n(65)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var c=n(33),l=n(26);e.exports=function(s){return function(e,t){var n,i,r=String(l(e)),o=c(t),a=r.length;return o<0||a<=o?s?"":void 0:(n=r.charCodeAt(o))<55296||56319<n||o+1===a||(i=r.charCodeAt(o+1))<56320||57343<i?s?r.charAt(o):n:s?r.slice(o,o+2):i-56320+(n-55296<<10)+65536}}},function(e,t,n){"use strict";var i=n(103),r=n(44),o=n(45),a={};n(16)(a,n(2)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(a,{next:r(1,n)}),o(e,t+" Iterator")}},function(e,t,i){function r(){}var o=i(6),a=i(104),s=i(68),c=i(47)("IE_PROTO"),l=function(){var e,t=i(43)("iframe"),n=s.length;for(t.style.display="none",i(62).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;n--;)delete l.prototype[s[n]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(r.prototype=o(e),n=new r,r.prototype=null,n[c]=e):n=l(),void 0===t?n:a(n,t)}},function(e,t,n){var a=n(17),s=n(6),c=n(66);e.exports=n(12)?Object.defineProperties:function(e,t){s(e);for(var n,i=c(t),r=i.length,o=0;o<r;)a.f(e,n=i[o++],t[n]);return e}},function(e,t,n){var a=n(32),s=n(46),c=n(106)(!1),l=n(47)("IE_PROTO");e.exports=function(e,t){var n,i=s(e),r=0,o=[];for(n in i)n!=l&&a(i,n)&&o.push(n);for(;t.length>r;)a(i,n=t[r++])&&(~c(o,n)||o.push(n));return o}},function(e,t,n){var c=n(46),l=n(25),u=n(107);e.exports=function(s){return function(e,t,n){var i,r=c(e),o=l(r.length),a=u(n,o);if(s&&t!=t){for(;a<o;)if((i=r[a++])!=i)return!0}else for(;a<o;a++)if((s||a in r)&&r[a]===t)return s||a||0;return!s&&-1}}},function(e,t,n){var i=n(33),r=Math.max,o=Math.min;e.exports=function(e,t){return(e=i(e))<0?r(e+t,0):o(e,t)}},function(e,t,n){var i=n(32),r=n(48),o=n(47)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),i(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){"use strict";var d=n(13),i=n(15),p=n(48),f=n(58),m=n(59),v=n(25),g=n(110),y=n(60);i(i.S+i.F*!n(64)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,i,r,o=p(e),a="function"==typeof this?this:Array,s=arguments.length,c=1<s?arguments[1]:void 0,l=void 0!==c,u=0,h=y(o);if(l&&(c=d(c,2<s?arguments[2]:void 0,2)),null==h||a==Array&&m(h))for(n=new a(t=v(o.length));u<t;u++)g(n,u,l?c(o[u],u):o[u]);else for(r=h.call(o),n=new a;!(i=r.next()).done;u++)g(n,u,l?f(r,c,[i.value,u],!0):i.value);return n.length=u,n}})},function(e,t,n){"use strict";var i=n(17),r=n(44);e.exports=function(e,t,n){t in e?i.f(e,t,r(0,n)):e[t]=n}},function(e,t,n){"use strict";var i=n(112),r=n(113),o=n(24),a=n(46);e.exports=n(65)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t,n){var i=n(2)("unscopables"),r=Array.prototype;null==r[i]&&n(16)(r,i,{}),e.exports=function(e){r[i][e]=!0}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var A=n(13),b=n(67),w=n(48),x=n(25),i=n(115);e.exports=function(h,e){var d=1==h,p=2==h,f=3==h,m=4==h,v=6==h,g=5==h||v,y=e||i;return function(e,t,n){for(var i,r,o=w(e),a=b(o),s=A(t,n,3),c=x(a.length),l=0,u=d?y(e,c):p?y(e,0):void 0;l<c;l++)if((g||l in a)&&(r=s(i=a[l],l,o),h))if(d)u[l]=r;else if(r)switch(h){case 3:return!0;case 5:return i;case 6:return l;case 2:u.push(i)}else if(m)return!1;return v?-1:f||m?m:u}}},function(e,t,n){var i=n(116);e.exports=function(e,t){return new(i(e))(t)}},function(e,t,n){var i=n(11),r=n(117),o=n(2)("species");e.exports=function(e){var t;return r(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!r(t.prototype)||(t=void 0),i(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var i=n(14);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){"use strict";var i=n(31);e.exports=function(e,t){return!!e&&i(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t,n){"use strict";var i=n(15),r=n(25),o=n(120),a="".startsWith;i(i.P+i.F*n(122)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),n=r(Math.min(1<arguments.length?arguments[1]:void 0,t.length)),i=String(e);return a?a.call(t,i,n):t.slice(n,n+i.length)===i}})},function(e,t,n){var i=n(121),r=n(26);e.exports=function(e,t,n){if(i(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(e))}},function(e,t,n){var i=n(11),r=n(14),o=n(2)("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==r(e))}},function(e,t,n){var i=n(2)("match");e.exports=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[i]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,i){(function(r,m){t.exports=function r(o,a,s){function c(t,e){if(!a[t]){if(!o[t]){if(0,l)return l(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=a[t]={exports:{}};o[t][0].call(i.exports,function(e){return c(o[t][1][e]||e)},i,i.exports,r,o,a,s)}return a[t].exports}for(var l=!1,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,t,n){var i=Object.prototype.toString;t.exports=function(e){return e.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===i.call(e.buffer)||Array.isArray(e)}},{}],2:[function(e,n,t){(function(t){var o={scope:{}};o.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){if(n.get||n.set)throw new TypeError("ES3 does not support getters and setters.");e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},o.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:void 0!==t&&null!=t?t:e},o.global=o.getGlobal(this),o.SYMBOL_PREFIX="jscomp_symbol_",o.initSymbol=function(){o.initSymbol=function(){},o.global.Symbol||(o.global.Symbol=o.Symbol)},o.symbolCounter_=0,o.Symbol=function(e){return o.SYMBOL_PREFIX+(e||"")+o.symbolCounter_++},o.initSymbolIterator=function(){o.initSymbol();var e=o.global.Symbol.iterator;e=e||(o.global.Symbol.iterator=o.global.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&o.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return o.arrayIterator(this)}}),o.initSymbolIterator=function(){}},o.arrayIterator=function(e){var t=0;return o.iteratorPrototype(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})},o.iteratorPrototype=function(e){return o.initSymbolIterator(),(e={next:e})[o.global.Symbol.iterator]=function(){return this},e},o.array=o.array||{},o.iteratorFromArray=function(t,n){o.initSymbolIterator(),t instanceof String&&(t+="");var i=0,r={next:function(){if(i<t.length){var e=i++;return{value:n(e,t[e]),done:!1}}return r.next=function(){return{done:!0,value:void 0}},r.next()}};return r[Symbol.iterator]=function(){return r},r},o.polyfill=function(e,t,n,i){if(t){for(n=o.global,e=e.split("."),i=0;i<e.length-1;i++){var r=e[i];r in n||(n[r]={}),n=n[r]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&o.defineProperty(n,e,{configurable:!0,writable:!0,value:t})}},o.polyfill("Array.prototype.keys",function(e){return e||function(){return o.iteratorFromArray(this,function(e){return e})}},"es6-impl","es3");var e,F=this;e=function(){function r(e){if(!B.col(e))try{return document.querySelectorAll(e)}catch(e){}}function w(e,t){for(var n=e.length,i=2<=arguments.length?t:void 0,r=[],o=0;o<n;o++)if(o in e){var a=e[o];t.call(i,a,o,e)&&r.push(a)}return r}function l(e){return e.reduce(function(e,t){return e.concat(B.arr(t)?l(t):t)},[])}function o(e){return B.arr(e)?e:(B.str(e)&&(e=r(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function a(e,t){return e.some(function(e){return e===t})}function s(e){var t,n={};for(t in e)n[t]=e[t];return n}function u(e,t){var n,i=s(e);for(n in e)i[n]=t.hasOwnProperty(n)?t[n]:e[n];return i}function h(e,t){var n,i=s(e);for(n in t)i[n]=B.und(e[n])?t[n]:e[n];return i}function d(e){if(e=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e))return e[2]}function p(e,t){return B.fnc(e)?e(t.target,t.id,t.total):e}function x(e,t){if(t in e.style)return getComputedStyle(e).getPropertyValue(t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase())||"0"}function f(e,t){return B.dom(e)&&a(_,t)?"transform":B.dom(e)&&(e.getAttribute(t)||B.svg(e)&&e[t])?"attribute":B.dom(e)&&"transform"!==t&&x(e,t)?"css":null!=e[t]?"object":void 0}function m(e,t){switch(f(e,t)){case"transform":return function(e,n){var t,i=-1<(t=n).indexOf("translate")||"perspective"===t?"px":-1<t.indexOf("rotate")||-1<t.indexOf("skew")?"deg":void 0;i=-1<n.indexOf("scale")?1:0+i;if(!(e=e.style.transform))return i;for(var r=[],o=[],a=[],s=/(\w+)\((.+?)\)/g;r=s.exec(e);)o.push(r[1]),a.push(r[2]);return(e=w(a,function(e,t){return o[t]===n})).length?e[0]:i}(e,t);case"css":return x(e,t);case"attribute":return e.getAttribute(t)}return e[t]||0}function v(e,t){var n=/^(\*=|\+=|-=)/.exec(e);if(!n)return e;var i=d(e)||0;switch(t=parseFloat(t),e=parseFloat(e.replace(n[0],"")),n[0][0]){case"+":return t+e+i;case"-":return t-e+i;case"*":return t*e+i}}function c(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function n(e){e=e.points;for(var t,n=0,i=0;i<e.numberOfItems;i++){var r=e.getItem(i);0<i&&(n+=c(t,r)),t=r}return n}function g(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return 2*Math.PI*e.getAttribute("r");case"rect":return 2*e.getAttribute("width")+2*e.getAttribute("height");case"line":return c({x:e.getAttribute("x1"),y:e.getAttribute("y1")},{x:e.getAttribute("x2"),y:e.getAttribute("y2")});case"polyline":return n(e);case"polygon":var t=e.points;return n(e)+c(t.getItem(t.numberOfItems-1),t.getItem(0))}}function E(t,n){function e(e){return e=void 0===e?0:e,t.el.getPointAtLength(1<=n+e?n+e:0)}var i=e(),r=e(-1),o=e(1);switch(t.property){case"x":return i.x;case"y":return i.y;case"angle":return 180*Math.atan2(o.y-r.y,o.x-r.x)/Math.PI}}function y(e,t){var n,i=/-?\d*\.?\d+/g;if(n=B.pth(e)?e.totalLength:e,B.col(n))if(B.rgb(n)){var r=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(n);n=r?"rgba("+r[1]+",1)":n}else n=B.hex(n)?function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,i){return t+t+n+n+i+i});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return"rgba("+(e=parseInt(t[1],16))+","+parseInt(t[2],16)+","+(t=parseInt(t[3],16))+",1)"}(n):B.hsl(n)?function(e){function t(e,t,n){return n<0&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}var n=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e);e=parseInt(n[1])/360;var i=parseInt(n[2])/100,r=parseInt(n[3])/100;n=n[4]||1;if(0==i)r=i=e=r;else{var o=r<.5?r*(1+i):r+i-r*i,a=2*r-o;r=t(a,o,e+1/3),i=t(a,o,e);e=t(a,o,e-1/3)}return"rgba("+255*r+","+255*i+","+255*e+","+n+")"}(n):void 0;else r=(r=d(n))?n.substr(0,n.length-r.length):n,n=t&&!/\s/g.test(n)?r+t:r;return{original:n+="",numbers:n.match(i)?n.match(i).map(Number):[0],strings:B.str(e)||t?n.split(i):[]}}function A(e){return w(e=e?l(B.arr(e)?e.map(o):o(e)):[],function(e,t,n){return n.indexOf(e)===t})}function b(e,n){var t=s(n);if(B.arr(e)){var i=e.length;2!==i||B.obj(e[0])?B.fnc(n.duration)||(t.duration=n.duration/i):e={value:e}}return o(e).map(function(e,t){return t=t?0:n.delay,e=B.obj(e)&&!B.pth(e)?e:{value:e},B.und(e.delay)&&(e.delay=t),e}).map(function(e){return h(e,t)})}function M(t,e,n,i){var r="delay"===t;return e.length?(r?Math.min:Math.max).apply(Math,e.map(function(e){return e[t]})):r?i.delay:n.offset+i.delay+i.duration}function i(e){var t,n,r,i=u(C,e),o=u(L,e),a=(n=A(e.targets)).map(function(e,t){return{target:e,id:t,total:n.length}}),s=[],c=h(i,o);for(t in e)c.hasOwnProperty(t)||"targets"===t||s.push({name:t,offset:c.offset,tweens:b(e[t],o)});return r=s,e=w(l(a.map(function(i){return r.map(function(e){var o,a,s,t=f(i.target,e.name);if(t){var n=(a=i,(o=e).tweens.map(function(e){var t=(e=function(e,t){var n,i={};for(n in e){var r=p(e[n],t);B.arr(r)&&1===(r=r.map(function(e){return p(e,t)})).length&&(r=r[0]),i[n]=r}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}(e,a)).value,n=m(a.target,o.name),i=s?s.to.original:n,r=(i=B.arr(t)?t[0]:i,v(B.arr(t)?t[1]:t,i));return n=d(r)||d(i)||d(n),e.from=y(i,n),e.to=y(r,n),e.start=s?s.end:o.offset,e.end=e.start+e.delay+e.duration,e.easing=function(e){return B.arr(e)?R.apply(this,e):P[e]}(e.easing),e.elasticity=(1e3-Math.min(Math.max(e.elasticity,1),999))/1e3,e.isPath=B.pth(t),e.isColor=B.col(e.from.original),e.isColor&&(e.round=1),s=e}));e={type:t,property:e.name,animatable:i,tweens:n,duration:n[n.length-1].end,delay:n[0].delay}}else e=void 0;return e})})),function(e){return!B.und(e)}),h(i,{children:[],animatables:a,animations:e,duration:M("duration",e,i,o),delay:M("delay",e,i,o)})}function T(e){function u(){return window.Promise&&new Promise(function(e){return y=e})}function h(e){return b.reversed?b.duration-e:e}function d(t){for(var e=0,n={},i=b.animations,r=i.length;e<r;){var o=i[e],a=o.animatable,s=(c=o.tweens)[h=c.length-1];h&&(s=w(c,function(e){return t<e.end})[0]||s);for(var c=Math.min(Math.max(t-s.start-s.delay,0),s.duration)/s.duration,l=isNaN(c)?1:s.easing(c,s.elasticity),u=(c=s.to.strings,s.round),h=[],d=void 0,p=(d=s.to.numbers.length,0);p<d;p++){var f=void 0,m=(f=s.to.numbers[p],s.from.numbers[p]);f=s.isPath?E(s.value,l*f):m+l*(f-m);u&&(s.isColor&&2<p||(f=Math.round(f*u)/u)),h.push(f)}if(s=c.length)for(d=c[0],l=0;l<s;l++)u=c[l+1],p=h[l],isNaN(p)||(d=u?d+(p+u):d+(p+" "));else d=h[0];D[o.type](a.target,o.property,d,n,a.id),o.currentValue=d,e++}if(e=Object.keys(n).length)for(i=0;i<e;i++)S=S||(x(document.body,"transform")?"transform":"-webkit-transform"),b.animatables[i].target.style[S]=n[i].join(" ");b.currentTime=t,b.progress=t/b.duration*100}function p(e){b[e]&&b[e](b)}function f(){b.remaining&&!0!==b.remaining&&b.remaining--}function t(e){var t=b.duration,n=b.offset,i=n+b.delay,r=b.currentTime,o=b.reversed,a=h(e);if(b.children.length){var s=b.children,c=s.length;if(a>=b.currentTime)for(var l=0;l<c;l++)s[l].seek(a);else for(;c--;)s[c].seek(a)}(i<=a||!t)&&(b.began||(b.began=!0,p("begin")),p("run")),n<a&&a<t?d(a):(a<=n&&0!==r&&(d(0),o&&f()),(t<=a&&r!==t||!t)&&(d(t),o||f())),p("update"),t<=e&&(b.remaining?(v=m,"alternate"===b.direction&&(b.reversed=!b.reversed)):(b.pause(),b.completed||(b.completed=!0,p("complete"),"Promise"in window&&(y(),A=u()))),g=0)}e=void 0===e?{}:e;var m,v,g=0,y=null,A=u(),b=i(e);return b.reset=function(){var e=b.direction,t=b.loop;for(b.currentTime=0,b.progress=0,b.paused=!0,b.began=!1,b.completed=!1,b.reversed="reverse"===e,b.remaining="alternate"===e&&1===t?2:t,d(0),e=b.children.length;e--;)b.children[e].reset()},b.tick=function(e){t((g+(m=e)-(v=v||m))*T.speed)},b.seek=function(e){t(h(e))},b.pause=function(){var e=I.indexOf(b);-1<e&&I.splice(e,1),b.paused=!0},b.play=function(){b.paused&&(b.paused=!1,v=0,g=h(b.currentTime),I.push(b),O||k())},b.reverse=function(){b.reversed=!b.reversed,v=0,g=h(b.currentTime)},b.restart=function(){b.pause(),b.reset(),b.play()},b.finished=A,b.reset(),b.autoplay&&b.play(),b}var S,C={update:void 0,begin:void 0,run:void 0,complete:void 0,loop:1,direction:"normal",autoplay:!0,offset:0},L={duration:1e3,delay:0,easing:"easeOutElastic",elasticity:500,round:0},_="translateX translateY translateZ rotate rotateX rotateY rotateZ scale scaleX scaleY scaleZ skewX skewY perspective".split(" "),B={arr:function(e){return Array.isArray(e)},obj:function(e){return-1<Object.prototype.toString.call(e).indexOf("Object")},pth:function(e){return B.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},dom:function(e){return e.nodeType||B.svg(e)},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return void 0===e},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return B.hex(e)||B.rgb(e)||B.hsl(e)}},R=function(a,s,c,l){if(0<=a&&a<=1&&0<=c&&c<=1){var u=new Float32Array(11);if(a!==s||c!==l)for(var e=0;e<11;++e)u[e]=H(.1*e,a,c);return function(e){if(a===s&&c===l)return e;if(0===e)return 0;if(1===e)return 1;for(var t=0,n=1;10!==n&&u[n]<=e;++n)t+=.1;n=t+(e-u[--n])/(u[n+1]-u[n])*.1;var i=3*(1-3*c+3*a)*n*n+2*(3*c-6*a)*n+3*a;if(.001<=i){for(t=0;t<4&&0!=(i=3*(1-3*c+3*a)*n*n+2*(3*c-6*a)*n+3*a);++t){var r=H(n,a,c)-e;n-=r/i}e=n}else if(0===i)e=n;else{n=t,t+=.1;for(var o=0;0<(i=H(r=n+(t-n)/2,a,c)-e)?t=r:n=r,1e-7<Math.abs(i)&&++o<10;);e=r}return H(e,s,l)}}},P=function(){function n(e,t){return 0===e||1===e?e:-Math.pow(2,10*(e-1))*Math.sin(2*(e-1-t/(2*Math.PI)*Math.asin(1))*Math.PI/t)}var e,i="Quad Cubic Quart Quint Sine Expo Circ Back Elastic".split(" "),t={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],n],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(e,t){return 1-n(1-e,t)}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(e,t){return e<.5?n(2*e,t)/2:1-n(-2*e+2,t)/2}]},r={linear:R(.25,.25,.75,.75)},o={};for(e in t)o.type=e,t[o.type].forEach(function(n){return function(e,t){r["ease"+n.type+i[t]]=B.fnc(e)?e:R.apply(F,e)}}(o)),o={type:o.type};return r}(),D={css:function(e,t,n){return e.style[t]=n},attribute:function(e,t,n){return e.setAttribute(t,n)},object:function(e,t,n){return e[t]=n},transform:function(e,t,n,i,r){i[r]||(i[r]=[]),i[r].push(t+"("+n+")")}},I=[],O=0,k=j;function j(){O=requestAnimationFrame(e)}function e(e){var t=I.length;if(t){for(var n=0;n<t;)I[n]&&I[n].tick(e),n++;j()}else cancelAnimationFrame(O),O=0}function H(e,t,n){return(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e}return T.version="2.2.0",T.speed=1,T.running=I,T.remove=function(e){e=A(e);for(var t=I.length;t--;)for(var n=I[t],i=n.animations,r=i.length;r--;)a(e,i[r].animatable.target)&&(i.splice(r,1),i.length||n.pause())},T.getValue=m,T.path=function(e,t){var n=B.str(e)?r(e)[0]:e,i=t||100;return function(e){return{el:n,property:e,totalLength:g(n)*(i/100)}}},T.setDashoffset=function(e){var t=g(e);return e.setAttribute("stroke-dasharray",t),t},T.bezier=R,T.easings=P,T.timeline=function(i){var r=T(i);return r.pause(),r.duration=0,r.add=function(e){return r.children.forEach(function(e){e.began=!0,e.completed=!0}),o(e).forEach(function(e){var t=h(e,u(L,i||{}));t.targets=t.targets||i.targets,e=r.duration;var n=t.offset;t.autoplay=!1,t.direction=r.direction,t.offset=B.und(n)?e:v(n,e),r.began=!0,r.completed=!0,r.seek(t.offset),(t=T(t)).began=!0,t.completed=!0,t.duration>e&&(r.duration=t.duration),r.children.push(t)}),r.seek(0),r.reset(),r.autoplay&&r.restart(),r},r},T.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},T},"object"==typeof n&&n.exports?n.exports=e():this.anime=e()}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,n){t.exports=function(e,t){return"number"==typeof e?e:"number"==typeof t?t:0}},{}],4:[function(e,t,n){"use strict";n.byteLength=function(e){return 3*e.length/4-h(e)},n.toByteArray=function(e){var t,n,i,r,o,a=e.length;r=h(e),o=new u(3*a/4-r),n=0<r?a-4:a;var s=0;for(t=0;t<n;t+=4)i=l[e.charCodeAt(t)]<<18|l[e.charCodeAt(t+1)]<<12|l[e.charCodeAt(t+2)]<<6|l[e.charCodeAt(t+3)],o[s++]=i>>16&255,o[s++]=i>>8&255,o[s++]=255&i;return 2===r?(i=l[e.charCodeAt(t)]<<2|l[e.charCodeAt(t+1)]>>4,o[s++]=255&i):1===r&&(i=l[e.charCodeAt(t)]<<10|l[e.charCodeAt(t+1)]<<4|l[e.charCodeAt(t+2)]>>2,o[s++]=i>>8&255,o[s++]=255&i),o},n.fromByteArray=function(e){for(var t,n=e.length,i=n%3,r="",o=[],a=0,s=n-i;a<s;a+=16383)o.push(d(e,a,s<a+16383?s:a+16383));return 1==i?(t=e[n-1],r+=c[t>>2],r+=c[t<<4&63],r+="=="):2==i&&(t=(e[n-2]<<8)+e[n-1],r+=c[t>>10],r+=c[t>>4&63],r+=c[t<<2&63],r+="="),o.push(r),o.join("")};for(var c=[],l=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,o=i.length;r<o;++r)c[r]=i[r],l[i.charCodeAt(r)]=r;function h(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function d(e,t,n){for(var i,r=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),r.push(c[i>>18&63]+c[i>>12&63]+c[i>>6&63]+c[63&i]);return r.join("")}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},{}],5:[function(e,t,n){"use strict";t.exports={createLink:function(e,t){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("link");for(var r in i.href=e,i.rel="stylesheet",t)if(t.hasOwnProperty(r)){var o=t[r];i.setAttribute("data-"+r,o)}n.appendChild(i)},createStyle:function(e,t){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");for(var r in i.type="text/css",t)if(t.hasOwnProperty(r)){var o=t[r];i.setAttribute("data-"+r,o)}i.sheet?(i.innerHTML=e,i.sheet.cssText=e,n.appendChild(i)):i.styleSheet?(n.appendChild(i),i.styleSheet.cssText=e):(i.appendChild(document.createTextNode(e)),n.appendChild(i))}}},{}],6:[function(e,t,n){var i=e("buffer").Buffer;t.exports=function(e,t){if(i.isBuffer(e)&&i.isBuffer(t)){if("function"==typeof e.equals)return e.equals(t);if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}}},{buffer:7}],7:[function(t,e,k){(function(e){"use strict";var s=t("base64-js"),o=t("ieee754"),a=t("isarray");function n(){return h.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return h.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=h.prototype:(null===e&&(e=new h(t)),e.length=t),e}function h(e,t,n){if(!(h.TYPED_ARRAY_SUPPORT||this instanceof h))return new h(e,t,n);if("number"!=typeof e)return i(this,e,t,n);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return r(this,e)}function i(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i),h.TYPED_ARRAY_SUPPORT?(e=t).__proto__=h.prototype:e=u(e,t),e}(e,t,n,i):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!h.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(t,n),r=(e=c(e,i)).write(t,n);return r!==i&&(e=e.slice(0,r)),e}(e,t,n):function(e,t){if(h.isBuffer(t)){var n=0|d(t.length);return 0===(e=c(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?c(e,0):u(e,t);if("Buffer"===t.type&&a(t.data))return u(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function r(e,t){if(l(t),e=c(e,t<0?0:0|d(t)),!h.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function u(e,t){var n=t.length<0?0:0|d(t.length);e=c(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function d(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function p(e,t){if(h.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return I(e).length;default:if(i)return D(e).length;t=(""+t).toLowerCase(),i=!0}}function f(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function m(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=h.from(t,i)),h.isBuffer(t))return 0===t.length?-1:v(e,t,n,i,r);if("number"==typeof t)return t&=255,h.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,i,r){var o,a=1,s=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s/=a=2,c/=2,n/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(r){var u=-1;for(o=n;o<s;o++)if(l(e,o)===l(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===c)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(s<n+c&&(n=s-c),o=n;0<=o;o--){for(var h=!0,d=0;d<c;d++)if(l(e,o+d)!==l(t,d)){h=!1;break}if(h)return o}return-1}function g(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");o/2<i&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function y(e,t,n,i){return O(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function A(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var o,a,s,c,l=e[r],u=null,h=239<l?4:223<l?3:191<l?2:1;if(r+h<=n)switch(h){case 1:l<128&&(u=l);break;case 2:128==(192&(o=e[r+1]))&&127<(c=(31&l)<<6|63&o)&&(u=c);break;case 3:o=e[r+1],a=e[r+2],128==(192&o)&&128==(192&a)&&2047<(c=(15&l)<<12|(63&o)<<6|63&a)&&(c<55296||57343<c)&&(u=c);break;case 4:o=e[r+1],a=e[r+2],s=e[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(c=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)&&c<1114112&&(u=c)}null===u?(u=65533,h=1):65535<u&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),r+=h}return function(e){var t=e.length;if(t<=b)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=b));return n}(i)}k.Buffer=h,k.SlowBuffer=function(e){return+e!=e&&(e=0),h.alloc(+e)},k.INSPECT_MAX_BYTES=50,h.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),k.kMaxLength=n(),h.poolSize=8192,h._augment=function(e){return e.__proto__=h.prototype,e},h.from=function(e,t,n){return i(null,e,t,n)},h.TYPED_ARRAY_SUPPORT&&(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0})),h.alloc=function(e,t,n){return r=t,o=n,l(i=e),i<=0?c(null,i):void 0!==r?"string"==typeof o?c(null,i).fill(r,o):c(null,i).fill(r):c(null,i);var i,r,o},h.allocUnsafe=function(e){return r(null,e)},h.allocUnsafeSlow=function(e){return r(null,e)},h.isBuffer=function(e){return!(null==e||!e._isBuffer)},h.compare=function(e,t){if(!h.isBuffer(e)||!h.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,o=Math.min(n,i);r<o;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return h.alloc(0);var n;if(void 0===t)for(n=t=0;n<e.length;++n)t+=e[n].length;var i=h.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var o=e[n];if(!h.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},h.byteLength=p,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)f(this,t,t+1);return this},h.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)f(this,t,t+3),f(this,t+1,t+2);return this},h.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)f(this,t,t+7),f(this,t+1,t+6),f(this,t+2,t+5),f(this,t+3,t+4);return this},h.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?A(this,0,e):function(e,t,n){var i,r,o,a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return E(this,t,n);case"utf8":case"utf-8":return A(this,t,n);case"ascii":return w(this,t,n);case"latin1":case"binary":return x(this,t,n);case"base64":return i=this,o=n,0===(r=t)&&o===i.length?s.fromByteArray(i):s.fromByteArray(i.slice(r,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}.apply(this,arguments)},h.prototype.equals=function(e){if(!h.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===h.compare(this,e)},h.prototype.inspect=function(){var e="",t=k.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},h.prototype.compare=function(e,t,n,i,r){if(!h.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(r<=i&&n<=t)return 0;if(r<=i)return-1;if(n<=t)return 1;if(this===e)return 0;for(var o=(r>>>=0)-(i>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),c=this.slice(i,r),l=e.slice(t,n),u=0;u<s;++u)if(c[u]!==l[u]){o=c[u],a=l[u];break}return o<a?-1:a<o?1:0},h.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},h.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},h.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},h.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r,o,a,s,c,l,u,h,d,p=this.length-t;if((void 0===n||p<n)&&(n=p),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i=i||"utf8";for(var f=!1;;)switch(i){case"hex":return g(this,e,t,n);case"utf8":case"utf-8":return h=t,d=n,O(D(e,(u=this).length-h),u,h,d);case"ascii":return y(this,e,t,n);case"latin1":case"binary":return y(this,e,t,n);case"base64":return s=this,c=t,l=n,O(I(e),s,c,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o=t,a=n,O(function(e,t){for(var n,i,r,o=[],a=0;a<e.length&&!((t-=2)<0);++a)i=(n=e.charCodeAt(a))>>8,r=n%256,o.push(r),o.push(i);return o}(e,(r=this).length-o),r,o,a);default:if(f)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),f=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var b=4096;function w(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function x(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function E(e,t,n){var i,r=e.length;(!t||t<0)&&(t=0),(!n||n<0||r<n)&&(n=r);for(var o="",a=t;a<n;++a)o+=(i=e[a])<16?"0"+i.toString(16):i.toString(16);return o}function M(e,t,n){for(var i=e.slice(t,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function T(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function S(e,t,n,i,r,o){if(!h.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r<t||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function C(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,o=Math.min(e.length-n,2);r<o;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function L(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,o=Math.min(e.length-n,4);r<o;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function _(e,t,n,i){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,i,r){return r||_(e,0,n,4),o.write(e,t,n,i,23,4),n+4}function R(e,t,n,i,r){return r||_(e,0,n,8),o.write(e,t,n,i,52,8),n+8}h.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):i<e&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):i<t&&(t=i),t<e&&(t=e),h.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=h.prototype;else{var r=t-e;n=new h(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+e]}return n},h.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i},h.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var i=this[e+--t],r=1;0<t&&(r*=256);)i+=this[e+--t]*r;return i},h.prototype.readUInt8=function(e,t){return t||T(e,1,this.length),this[e]},h.prototype.readUInt16LE=function(e,t){return t||T(e,2,this.length),this[e]|this[e+1]<<8},h.prototype.readUInt16BE=function(e,t){return t||T(e,2,this.length),this[e]<<8|this[e+1]},h.prototype.readUInt32LE=function(e,t){return t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},h.prototype.readUInt32BE=function(e,t){return t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},h.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},h.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var i=t,r=1,o=this[e+--i];0<i&&(r*=256);)o+=this[e+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},h.prototype.readInt8=function(e,t){return t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},h.prototype.readInt16LE=function(e,t){t||T(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},h.prototype.readInt16BE=function(e,t){t||T(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},h.prototype.readInt32LE=function(e,t){return t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},h.prototype.readInt32BE=function(e,t){return t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},h.prototype.readFloatLE=function(e,t){return t||T(e,4,this.length),o.read(this,e,!0,23,4)},h.prototype.readFloatBE=function(e,t){return t||T(e,4,this.length),o.read(this,e,!1,23,4)},h.prototype.readDoubleLE=function(e,t){return t||T(e,8,this.length),o.read(this,e,!0,52,8)},h.prototype.readDoubleBE=function(e,t){return t||T(e,8,this.length),o.read(this,e,!1,52,8)},h.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||S(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},h.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||S(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[t+r]=255&e;0<=--r&&(o*=256);)this[t+r]=e/o&255;return t+n},h.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,1,255,0),h.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},h.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):C(this,e,t,!0),t+2},h.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):C(this,e,t,!1),t+2},h.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},h.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},h.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);S(this,e,t,n,r-1,-r)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},h.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);S(this,e,t,n,r-1,-r)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;0<=--o&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},h.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,1,127,-128),h.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},h.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):C(this,e,t,!0),t+2},h.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):C(this,e,t,!1),t+2},h.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},h.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||S(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),h.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},h.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},h.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},h.prototype.writeDoubleLE=function(e,t,n){return R(this,e,t,!0,n)},h.prototype.writeDoubleBE=function(e,t,n){return R(this,e,t,!1,n)},h.prototype.copy=function(e,t,n,i){if(n=n||0,i||0===i||(i=this.length),t>=e.length&&(t=e.length),t=t||0,0<i&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,o=i-n;if(this===e&&n<t&&t<i)for(r=o-1;0<=r;--r)e[r+t]=this[r+n];else if(o<1e3||!h.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},h.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!h.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(o=t;o<n;++o)this[o]=e;else{var a=h.isBuffer(e)?e:D(new h(e,i).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var P=/[^+\/0-9A-Za-z-_]/g;function D(e,t){var n;t=t||1/0;for(var i=e.length,r=null,o=[],a=0;a<i;++a){if(55295<(n=e.charCodeAt(a))&&n<57344){if(!r){if(56319<n){-1<(t-=3)&&o.push(239,191,189);continue}if(a+1===i){-1<(t-=3)&&o.push(239,191,189);continue}r=n;continue}if(n<56320){-1<(t-=3)&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&-1<(t-=3)&&o.push(239,191,189);if(r=null,n<128){if(--t<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function I(e){return s.toByteArray(function(e){if((e=((t=e).trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(P,"")).length<2)return"";for(var t;e.length%4!=0;)e+="=";return e}(e))}function O(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":4,ieee754:17,isarray:22}],8:[function(e,t,n){!function(){if("undefined"!=typeof window)try{var e=new window.CustomEvent("test",{cancelable:!0});if(e.preventDefault(),!0!==e.defaultPrevented)throw new Error("Could not prevent default")}catch(e){function t(e,t){var n,i;return t=t||{bubbles:!1,cancelable:!1,detail:void 0},(n=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i=n.preventDefault,n.preventDefault=function(){i.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(e){this.defaultPrevented=!0}},n}t.prototype=window.Event.prototype,window.CustomEvent=t}}()},{}],9:[function(e,t,n){function i(){var e;try{e=n.storage.debug}catch(e){}return e}(n=t.exports=e("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" "),!t)return e;var n="color: "+this.color;e=[e[0],n,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,r=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(r=i))}),e.splice(r,0,n),e},n.save=function(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(e){}},n.load=i,n.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){return JSON.stringify(e)},n.enable(i())},{"./debug":10}],10:[function(e,t,s){(s=t.exports=function(e){function t(){}function n(){var r=n;null==r.useColors&&(r.useColors=s.useColors()),null==r.color&&r.useColors&&(r.color=s.colors[c++%s.colors.length]);var o=Array.prototype.slice.call(arguments);o[0]=s.coerce(o[0]),"string"!=typeof o[0]&&(o=["%o"].concat(o));var a=0;o[0]=o[0].replace(/%([a-z%])/g,function(e,t){if("%%"===e)return e;a++;var n=s.formatters[t];if("function"==typeof n){var i=o[a];e=n.call(r,i),o.splice(a,1),a--}return e}),"function"==typeof s.formatArgs&&(o=s.formatArgs.apply(r,o)),(n.log||s.log||console.log.bind(console)).apply(r,o)}n.enabled=!(t.enabled=!1);var i=s.enabled(e)?n:t;return i.namespace=e,i}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},s.disable=function(){s.enable("")},s.enable=function(e){s.save(e);for(var t=(e||"").split(/[\s,]+/),n=t.length,i=0;i<n;i++)t[i]&&("-"===(e=t[i].replace(/\*/g,".*?"))[0]?s.skips.push(new RegExp("^"+e.substr(1)+"$")):s.names.push(new RegExp("^"+e+"$")))},s.enabled=function(e){var t,n;for(t=0,n=s.skips.length;t<n;t++)if(s.skips[t].test(e))return!1;for(t=0,n=s.names.length;t<n;t++)if(s.names[t].test(e))return!0;return!1},s.names=[],s.skips=[],s.formatters={};var c=0},{}],11:[function(e,t,n){"use strict";var r=e("is-obj"),o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function s(e,t,n){var i=t[n];if(null!=i){if(o.call(e,n)&&(void 0===e[n]||null===e[n]))throw new TypeError("Cannot convert undefined or null to object ("+n+")");o.call(e,n)&&r(i)?e[n]=c(Object(e[n]),t[n]):e[n]=i}}function c(e,t){if(e===t)return e;for(var n in t=Object(t))o.call(t,n)&&s(e,t,n);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(t),r=0;r<i.length;r++)a.call(t,i[r])&&s(e,t,i[r]);return e}t.exports=function(e){e=function(e){if(null==e)throw new TypeError("Sources cannot be null or undefined");return Object(e)}(e);for(var t=1;t<arguments.length;t++)c(e,arguments[t]);return e}},{"is-obj":21}],12:[function(t,n,i){!function(t,h,n,i){"use strict";function d(e,t){for(var n=0,i=e.length;n<i;n++)a(e[n],t)}function p(t){return function(e){ee(e)&&(a(e,t),d(e.querySelectorAll(j),t))}}function f(e){var t=ie.call(e,"is"),n=e.nodeName.toUpperCase(),i=F.call(O,t?P+t.toUpperCase():R+n);return t&&-1<i&&!m(n,t)?-1:i}function m(e,t){return-1<j.indexOf(e+'[is="'+t+'"]')}function s(e){var t=e.currentTarget,n=e.attrChange,i=e.attrName,r=e.target;!pe||r&&r!==t||!t.attributeChangedCallback||"style"===i||e.prevValue===e.newValue||t.attributeChangedCallback(i,n===e[S]?null:e.prevValue,n===e[L]?null:e.newValue)}function v(e){var t=p(e);return function(e){A.push(t,e.target)}}function g(e){de&&(de=!1,e.currentTarget.removeEventListener(B,g)),d((e.target||h).querySelectorAll(j),e.detail===T?T:M),$&&function(){for(var e,t=0,n=te.length;t<n;t++)e=te[t],H.contains(e)||(n--,te.splice(t--,1),a(e,T))}()}function r(e,t){re.call(this,e,t),c.call(this,{target:this})}function o(e,t){Z(e,t),b?b.observe(e,se):(he&&(e.setAttribute=r,e[E]=u(e),e.addEventListener("DOMSubtreeModified",c)),e.addEventListener(_,s)),e.createdCallback&&pe&&(e.created=!0,e.createdCallback(),e.created=!1)}function y(e){throw new Error("A "+e+" type is already registered")}function a(e,t){var n,i=f(e);-1<i&&(w(e,k[i]),i=0,t!==M||e[M]?t!==T||e[T]||(e[M]=!1,e[T]=!0,i=1):(e[T]=!1,e[M]=!0,i=1,$&&F.call(te,e)<0&&te.push(e)),i&&(n=e[t+"Callback"])&&n.call(e))}if(!(i in h)){var A,c,l,u,b,w,x,E="__"+i+(1e5*Math.random()>>0),M="attached",T="detached",S="ADDITION",C="MODIFICATION",L="REMOVAL",_="DOMAttrModified",B="DOMContentLoaded",R="<",P="=",D=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,I=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],O=[],k=[],j="",H=h.documentElement,F=O.indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},N=n.prototype,z=N.hasOwnProperty,U=N.isPrototypeOf,G=n.defineProperty,V=n.getOwnPropertyDescriptor,W=n.getOwnPropertyNames,q=n.getPrototypeOf,X=n.setPrototypeOf,Q=!!n.__proto__,Y=n.create||function e(t){return t?(e.prototype=t,new e):this},Z=X||(Q?function(e,t){return e.__proto__=t,e}:W&&V?function(e,t){for(;Ae(e,t),(t=q(t))&&!U.call(t,e););return e}:function(e,t){for(var n in t)e[n]=t[n];return e}),K=t.MutationObserver||t.WebKitMutationObserver,J=(t.HTMLElement||t.Element||t.Node).prototype,$=!U.call(J,H),ee=$?function(e){return 1===e.nodeType}:function(e){return U.call(J,e)},te=$&&[],ne=J.cloneNode,ie=J.getAttribute,re=J.setAttribute,oe=J.removeAttribute,ae=h.createElement,se=K&&{attributes:!0,characterData:!0,attributeOldValue:!0},ce=K||function(e){he=!1,H.removeEventListener(_,ce)},le=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,10)},ue=!1,he=!0,de=!0,pe=!0;x=X||Q?(w=function(e,t){U.call(t,e)||o(e,t)},o):w=function(e,t){e[E]||(e[E]=n(!0),o(e,t))},$?(he=!1,ge=V(J,"addEventListener"),ye=ge.value,ge.value=function(e,t,n){e===_&&this.attributeChangedCallback&&this.setAttribute!==me&&(this[E]={className:{name:"class",value:this.className}},this.setAttribute=me,this.removeAttribute=fe,ye.call(this,"propertychange",ve)),ye.call(this,e,t,n)},G(J,"addEventListener",ge)):K||(H.addEventListener(_,ce),H.setAttribute(E,1),H.removeAttribute(E),he&&(c=function(e){var t,n,i;if(this===e.target){for(i in t=this[E],this[E]=n=u(this),n){if(!(i in t))return l(0,this,i,t[i],n[i],S);if(n[i]!==t[i])return l(1,this,i,t[i],n[i],C)}for(i in t)if(!(i in n))return l(2,this,i,t[i],n[i],L)}},l=function(e,t,n,i,r,o){var a={attrChange:e,currentTarget:t,attrName:n,prevValue:i,newValue:r};a[o]=e,s(a)},u=function(e){for(var t,n,i={},r=e.attributes,o=0,a=r.length;o<a;o++)"setAttribute"!==(n=(t=r[o]).name)&&(i[n]=t.value);return i})),h[i]=function(e,t){if(i=e.toUpperCase(),ue||(ue=!0,K?(s=p(M),c=p(T),b=new K(function(e){for(var t,n,i,r=0,o=e.length;r<o;r++)"childList"===(t=e[r]).type?(a(t.addedNodes,s),a(t.removedNodes,c)):(n=t.target,pe&&n.attributeChangedCallback&&"style"!==t.attributeName&&(i=ie.call(n,t.attributeName))!==t.oldValue&&n.attributeChangedCallback(t.attributeName,t.oldValue,i))})).observe(h,{childList:!0,subtree:!0}):(A=[],le(function e(){for(;A.length;)A.shift().call(null,A.shift());le(e)}),h.addEventListener("DOMNodeInserted",v(M)),h.addEventListener("DOMNodeRemoved",v(T))),h.addEventListener(B,g),h.addEventListener("readystatechange",g),h.createElement=function(e,t){var n=ae.apply(h,arguments),i=""+e,r=F.call(O,(t?P:R)+(t||i).toUpperCase()),o=-1<r;return t&&(n.setAttribute("is",t=t.toLowerCase()),o=o&&m(i.toUpperCase(),t)),pe=!h.createElement.innerHTMLHelper,o&&x(n,k[r]),n},J.cloneNode=function(e){var t=ne.call(this,!!e),n=f(t);return-1<n&&x(t,k[n]),e&&function(e){for(var t,n=0,i=e.length;n<i;n++)t=e[n],x(t,k[f(t)])}(t.querySelectorAll(j)),t}),-2<F.call(O,P+i)+F.call(O,R+i)&&y(e),!D.test(i)||-1<F.call(I,i))throw new Error("The type "+e+" is invalid");function a(e,t){for(var n=0,i=e.length;n<i;t(e[n++]));}function n(){return l?h.createElement(u,i):h.createElement(u)}var s,c,i,r,o=t||N,l=z.call(o,"extends"),u=l?t.extends.toUpperCase():i;return l&&-1<F.call(O,R+u)&&y(u),r=O.push((l?P:R)+i)-1,j=j.concat(j.length?",":"",l?u+'[is="'+e.toLowerCase()+'"]':u),n.prototype=k[r]=z.call(o,"prototype")?o.prototype:Y(J),d(h.querySelectorAll(j),M),n}}function fe(e){var t=new CustomEvent(_,{bubbles:!0});t.attrName=e,t.prevValue=ie.call(this,e),t.newValue=null,t[L]=t.attrChange=2,oe.call(this,e),this.dispatchEvent(t)}function me(t,n){var i=this.hasAttribute(t),r=i&&ie.call(this,t);e=new CustomEvent(_,{bubbles:!0}),re.call(this,t,n),e.attrName=t,e.prevValue=i?r:null,e.newValue=n,i?e[C]=e.attrChange=1:e[S]=e.attrChange=0,this.dispatchEvent(e)}function ve(e){var t,n=e.currentTarget,i=n[E],r=e.propertyName;i.hasOwnProperty(r)&&(i=i[r],(t=new CustomEvent(_,{bubbles:!0})).attrName=i.name,t.prevValue=i.value||null,t.newValue=i.value=n[r]||null,null==t.prevValue?t[S]=t.attrChange=0:t[C]=t.attrChange=1,n.dispatchEvent(t))}var ge,ye;function Ae(e,t){for(var n,i=W(t),r=0,o=i.length;r<o;r++)n=i[r],z.call(e,n)||G(e,n,V(t,n))}}(window,document,Object,"registerElement")},{}],13:[function(e,t,n){t.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],14:[function(e,t,n){var u=e("dtype");t.exports=function(e,t,n){if(!e)throw new TypeError("must specify data as first parameter");if(n=0|+(n||0),Array.isArray(e)&&Array.isArray(e[0])){var i=e[0].length,r=e.length*i;t&&"string"!=typeof t||(t=new(u(t||"float32"))(r+n));var o=t.length-n;if(r!=o)throw new Error("source length "+r+" ("+i+"x"+e.length+") does not match destination length "+o);for(var a=0,s=n;a<e.length;a++)for(var c=0;c<i;c++)t[s++]=e[a][c]}else if(t&&"string"!=typeof t)t.set(e,n);else{var l=u(t||"float32");0===n?t=new l(e):(t=new l(e.length+n)).set(e,n)}return t}},{dtype:13}],15:[function(e,t,n){var i=e("is-function");t.exports=function(e,t,n){if(!i(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===r.call(e)?function(e,t,n){for(var i=0,r=e.length;i<r;i++)o.call(e,i)&&t.call(n,e[i],i,e)}(e,t,n):"string"==typeof e?function(e,t,n){for(var i=0,r=e.length;i<r;i++)t.call(n,e.charAt(i),i,e)}(e,t,n):function(e,t,n){for(var i in e)o.call(e,i)&&t.call(n,e[i],i,e)}(e,t,n)};var r=Object.prototype.toString,o=Object.prototype.hasOwnProperty},{"is-function":20}],16:[function(e,n,t){(function(e){var t;t="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},n.exports=t}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(e,t,n){n.read=function(e,t,n,i,r){var o,a,s=8*r-i-1,c=(1<<s)-1,l=c>>1,u=-7,h=n?r-1:0,d=n?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=s;0<u;o=256*o+e[t+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;0<u;a=256*a+e[t+h],h+=d,u-=8);if(0===o)o=1-l;else{if(o===c)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,i),o-=l}return(p?-1:1)*a*Math.pow(2,o-i)},n.write=function(e,t,n,i,r,o){var a,s,c,l=8*o-r-1,u=(1<<l)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),2<=(t+=1<=a+h?d/c:d*Math.pow(2,1-h))*c&&(a++,c/=2),u<=a+h?(s=0,a=u):1<=a+h?(s=(t*c-1)*Math.pow(2,r),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,r),a=0));8<=r;e[n+p]=255&s,p+=f,s/=256,r-=8);for(a=a<<r|s,l+=r;0<l;e[n+p]=255&a,p+=f,a/=256,l-=8);e[n+p-f]|=128*m}},{}],18:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;function n(){}n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],19:[function(e,t,n){function i(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}t.exports=function(e){return null!=e&&(i(e)||"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&i(e.slice(0,0))||!!e._isBuffer)}},{}],20:[function(e,t,n){t.exports=function(e){var t=i.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var i=Object.prototype.toString},{}],21:[function(e,t,n){"use strict";t.exports=function(e){var t=typeof e;return null!==e&&("object"==t||"function"==t)}},{}],22:[function(e,t,n){var i={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},{}],23:[function(e,t,n){var s=e("word-wrapper"),c=e("xtend"),l=e("as-number"),b=["x","e","a","o","n","s","r","c","u","m","v","w","z"],r=["m","w"],w=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],i="\t".charCodeAt(0),o=" ".charCodeAt(0);function a(e){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(e)}function u(e,t){if(!e.chars||0===e.chars.length)return null;var n=E(e.chars,t);return 0<=n?e.chars[n]:null}function x(e,t,n){if(!e.kernings||0===e.kernings.length)return 0;for(var i=e.kernings,r=0;r<i.length;r++){var o=i[r];if(o.first===t&&o.second===n)return o.amount}return 0}function E(e,t,n){for(var i=n=n||0;i<e.length;i++)if(e[i].id===t)return i;return-1}t.exports=function(e){return new a(e)},a.prototype.update=function(e){if(e=c({measure:this._measure},e),this._opt=e,this._opt.tabSize=l(this._opt.tabSize,4),!e.font)throw new Error("must provide a valid bitmap font");var u=this.glyphs,h=e.text||"",d=e.font;this._setupSpaceGlyphs(d);var t=s.lines(h,e),n=e.width||0;u.length=0;var i,p=t.reduce(function(e,t){return Math.max(e,t.width,n)},0),f=0,m=0,v=l(e.lineHeight,d.common.lineHeight),r=d.common.base,o=v-r,g=e.letterSpacing||0,a=v*t.length-o,y="center"===(i=this._opt.align)?1:"right"===i?2:0;m-=a,this._width=p,this._height=a,this._descender=v-r,this._baseline=r,this._xHeight=function(e){for(var t=0;t<b.length;t++){var n=b[t].charCodeAt(0),i=E(e.chars,n);if(0<=i)return e.chars[i].height}return 0}(d),this._capHeight=function(e){for(var t=0;t<w.length;t++){var n=w[t].charCodeAt(0),i=E(e.chars,n);if(0<=i)return e.chars[i].height}return 0}(d),this._lineHeight=v,this._ascender=v-o-this._xHeight;var A=this;t.forEach(function(e,t){for(var n,i=e.start,r=e.end,o=e.width,a=i;a<r;a++){var s=h.charCodeAt(a),c=A.getGlyph(d,s);if(c){n&&(f+=x(d,n.id,c.id));var l=f;1==y?l+=(p-o)/2:2==y&&(l+=p-o),u.push({position:[l,m],data:c,index:a,line:t}),f+=c.xadvance+g,n=c}}m+=v,f=0}),this._linesTotal=t.length},a.prototype._setupSpaceGlyphs=function(e){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,e.chars&&0!==e.chars.length){var t=u(e,o)||function(e){for(var t=0;t<r.length;t++){var n=r[t].charCodeAt(0),i=E(e.chars,n);if(0<=i)return e.chars[i]}return 0}(e)||e.chars[0],n=this._opt.tabSize*t.xadvance;this._fallbackSpaceGlyph=t,this._fallbackTabGlyph=c(t,{x:0,y:0,xadvance:n,id:i,xoffset:0,yoffset:0,width:0,height:0})}},a.prototype.getGlyph=function(e,t){return u(e,t)||(t===i?this._fallbackTabGlyph:t===o?this._fallbackSpaceGlyph:null)},a.prototype.computeMetrics=function(e,t,n,i){var r,o=this._opt.letterSpacing||0,a=this._opt.font,s=0,c=0,l=0;if(!a.chars||0===a.chars.length)return{start:t,end:t,width:0};n=Math.min(e.length,n);for(var u=t;u<n;u++){var h=e.charCodeAt(u),d=this.getGlyph(a,h);if(d){d.xoffset;var p=(s+=r?x(a,r.id,d.id):0)+d.xadvance+o,f=s+d.width;if(i<=f||i<=p)break;s=p,c=f,r=d}l++}return r&&(c+=r.xoffset),{start:t,end:t+l,width:c}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(function(e){var t;Object.defineProperty(a.prototype,e,{get:(t=e,new Function(["return function "+t+"() {","  return this._"+t,"}"].join("\n"))()),configurable:!0})})},{"as-number":3,"word-wrapper":47,xtend:50}],24:[function(t,r,e){(function(l){function u(){}var e=t("xhr"),h=t("parse-bmfont-ascii"),d=t("parse-bmfont-xml"),p=t("parse-bmfont-binary"),f=t("./lib/is-binary"),n=t("xtend"),i=self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;r.exports=function(s,c){c="function"==typeof c?c:u,(s="string"==typeof s?{uri:s}:s||{}).binary&&(s=function(e){if(i)return n(e,{responseType:"arraybuffer"});if(void 0===self.XMLHttpRequest)throw new Error("your browser does not support XHR loading");var t=new self.XMLHttpRequest;return t.overrideMimeType("text/plain; charset=x-user-defined"),n({xhr:t},e)}(s)),e(s,function(e,t,n){if(e)return c(e);if(!/^2/.test(t.statusCode))return c(new Error("http status code: "+t.statusCode));if(!n)return c(new Error("no body result"));var i,r=!1;if("[object ArrayBuffer]"===Object.prototype.toString.call(n)){var o=new Uint8Array(n);n=new l(o,"binary")}f(n)&&(r=!0,"string"==typeof n&&(n=new l(n,"binary"))),r||(l.isBuffer(n)&&(n=n.toString(s.encoding)),n=n.trim());try{var a=t.headers["content-type"];i=r?p(n):/json/.test(a)||"{"===n.charAt(0)?JSON.parse(n):/xml/.test(a)||"<"===n.charAt(0)?d(n):h(n)}catch(e){c(new Error("error parsing font "+e.message)),c=u}c(null,i)})}}).call(this,t("buffer").Buffer)},{"./lib/is-binary":25,buffer:7,"parse-bmfont-ascii":27,"parse-bmfont-binary":28,"parse-bmfont-xml":29,xhr:48,xtend:50}],25:[function(i,r,e){(function(e){var t=i("buffer-equal"),n=new e([66,77,70,3]);r.exports=function(e){return"string"==typeof e?"BMF"===e.substring(0,3):4<e.length&&t(e.slice(0,4),n)}}).call(this,i("buffer").Buffer)},{buffer:7,"buffer-equal":6}],26:[function(e,t,n){"use strict";var c=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return 0;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return 0;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return 0;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(e){i[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return 0}}()?Object.assign:function(e,t){for(var n,i,r=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),o=1;o<arguments.length;o++){for(var a in n=Object(arguments[o]))l.call(n,a)&&(r[a]=n[a]);if(c){i=c(n);for(var s=0;s<i.length;s++)u.call(n,i[s])&&(r[i[s]]=n[i[s]])}}return r}},{}],27:[function(e,t,n){function o(e,t){if(!(e=e.replace(/\t+/g," ").trim()))return null;var n=e.indexOf(" ");if(-1===n)throw new Error("no named row at line "+t);var i=e.substring(0,n);e=(e=(e=(e=e.substring(n+1)).replace(/letter=[\'\"]\S+[\'\"]/gi,"")).split("=")).map(function(e){return e.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var r=[],o=0;o<e.length;o++){var a=e[o];0===o?r.push({key:a[0],data:""}):o===e.length-1?r[r.length-1].data=c(a[0]):(r[r.length-1].data=c(a[0]),r.push({key:a[1],data:""}))}var s={key:i,data:{}};return r.forEach(function(e){s.data[e.key]=e.data}),s}function c(e){return e&&0!==e.length?0===e.indexOf('"')||0===e.indexOf("'")?e.substring(1,e.length-1):-1!==e.indexOf(",")?e.split(",").map(function(e){return parseInt(e,10)}):parseInt(e,10):""}t.exports=function(e){if(!e)throw new Error("no data provided");var t={pages:[],chars:[],kernings:[]},n=(e=e.toString().trim()).split(/\r\n?|\n/g);if(0===n.length)throw new Error("no data in BMFont file");for(var i=0;i<n.length;i++){var r=o(n[i],i);if(r)if("page"===r.key){if("number"!=typeof r.data.id)throw new Error("malformed file at line "+i+" -- needs page id=N");if("string"!=typeof r.data.file)throw new Error("malformed file at line "+i+' -- needs page file="path"');t.pages[r.data.id]=r.data.file}else"chars"===r.key||"kernings"===r.key||("char"===r.key?t.chars.push(r.data):"kerning"===r.key?t.kernings.push(r.data):t[r.key]=r.data)}return t}},{}],28:[function(e,t,n){var r=[66,77,70];function o(e,t,n){if(n>t.length-1)return 0;var i,r,o,a=t.readUInt8(n++),s=t.readInt32LE(n);switch(n+=4,a){case 1:e.info=function(e,t){var n={};n.size=e.readInt16LE(t);var i=e.readUInt8(t+2);return n.smooth=i>>7&1,n.unicode=i>>6&1,n.italic=i>>5&1,n.bold=i>>4&1,i>>3&1&&(n.fixedHeight=1),n.charset=e.readUInt8(t+3)||"",n.stretchH=e.readUInt16LE(t+4),n.aa=e.readUInt8(t+6),n.padding=[e.readInt8(t+7),e.readInt8(t+8),e.readInt8(t+9),e.readInt8(t+10)],n.spacing=[e.readInt8(t+11),e.readInt8(t+12)],n.outline=e.readUInt8(t+13),n.face=c(e,t+14).toString("utf8"),n}(t,n);break;case 2:e.common=(r=n,(o={}).lineHeight=(i=t).readUInt16LE(r),o.base=i.readUInt16LE(r+2),o.scaleW=i.readUInt16LE(r+4),o.scaleH=i.readUInt16LE(r+6),o.pages=i.readUInt16LE(r+8),i.readUInt8(r+10),o.packed=0,o.alphaChnl=i.readUInt8(r+11),o.redChnl=i.readUInt8(r+12),o.greenChnl=i.readUInt8(r+13),o.blueChnl=i.readUInt8(r+14),o);break;case 3:e.pages=function(e,t,n){for(var i=[],r=c(e,t),o=r.length+1,a=n/o,s=0;s<a;s++)i[s]=e.slice(t,t+r.length).toString("utf8"),t+=o;return i}(t,n,s);break;case 4:e.chars=function(e,t){for(var n=[],i=s/20,r=0;r<i;r++){var o={},a=20*r;o.id=e.readUInt32LE(t+0+a),o.x=e.readUInt16LE(t+4+a),o.y=e.readUInt16LE(t+6+a),o.width=e.readUInt16LE(t+8+a),o.height=e.readUInt16LE(t+10+a),o.xoffset=e.readInt16LE(t+12+a),o.yoffset=e.readInt16LE(t+14+a),o.xadvance=e.readInt16LE(t+16+a),o.page=e.readUInt8(t+18+a),o.chnl=e.readUInt8(t+19+a),n[r]=o}return n}(t,n);break;case 5:e.kernings=function(e,t){for(var n=[],i=s/10,r=0;r<i;r++){var o={},a=10*r;o.first=e.readUInt32LE(t+0+a),o.second=e.readUInt32LE(t+4+a),o.amount=e.readInt16LE(t+8+a),n[r]=o}return n}(t,n)}return 5+s}function c(e,t){for(var n=t;n<e.length&&0!==e[n];n++);return e.slice(t,n)}t.exports=function(n){if(n.length<6)throw new Error("invalid buffer length for BMFont");if(!r.every(function(e,t){return n.readUInt8(t)===e}))throw new Error("BMFont missing BMF byte header");var e=3;if(3<n.readUInt8(e++))throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var t={kernings:[],chars:[]},i=0;i<5;i++)e+=o(t,n,e);return t}},{}],29:[function(e,t,n){var l=e("./parse-attribs"),u=e("xml-parse-from-string"),i={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};function h(e){return function(e){for(var t=[],n=0;n<e.attributes.length;n++)t.push(e.attributes[n]);return t}(e).reduce(function(e,t){var n;return e[n=t.nodeName,i[n.toLowerCase()]||n]=t.nodeValue,e},{})}t.exports=function(e){e=e.toString();var a=u(e),s={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(e){var t=a.getElementsByTagName(e)[0];t&&(s[e]=l(h(t)))});var t=a.getElementsByTagName("pages")[0];if(!t)throw new Error("malformed file -- no <pages> element");for(var n=t.getElementsByTagName("page"),i=0;i<n.length;i++){var r=n[i],o=parseInt(r.getAttribute("id"),10),c=r.getAttribute("file");if(isNaN(o))throw new Error('malformed file -- page "id" attribute is NaN');if(!c)throw new Error('malformed file -- needs page "file" attribute');s.pages[parseInt(o,10)]=c}return["chars","kernings"].forEach(function(e){var t=a.getElementsByTagName(e)[0];if(t)for(var n=e.substring(0,e.length-1),i=t.getElementsByTagName(n),r=0;r<i.length;r++){var o=i[r];s[e].push(l(h(o)))}}),s}},{"./parse-attribs":30,"xml-parse-from-string":49}],30:[function(e,t,n){t.exports=function(e){for(var t in"chasrset"in e&&(e.charset=e.chasrset,delete e.chasrset),e)"face"!==t&&"charset"!==t&&(e[t]="padding"===t||"spacing"===t?e[t].split(",").map(function(e){return parseInt(e,10)}):parseInt(e[t],10));return e}},{}],31:[function(e,t,n){var a=e("trim"),i=e("for-each");t.exports=function(e){if(!e)return{};var o={};return i(a(e).split("\n"),function(e){var t,n=e.indexOf(":"),i=a(e.slice(0,n)).toLowerCase(),r=a(e.slice(n+1));void 0===o[i]?o[i]=r:(t=o[i],"[object Array]"===Object.prototype.toString.call(t)?o[i].push(r):o[i]=[o[i],r])}),o}},{"for-each":15,trim:45}],32:[function(e,n,t){(function(e){var r=e.performance||{},t=function(){for(var e=["now","webkitNow","msNow","mozNow","oNow"];e.length;){var t=e.shift();if(t in r)return r[t].bind(r)}var n=Date.now||function(){return(new Date).getTime()},i=(r.timing||{}).navigationStart||n();return function(){return n()-i}}();t.performanceNow=r.now,t.noConflict=function(){r.now=t.performanceNow},t.conflict=function(){r.now=t},t.conflict(),n.exports=t}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(e,t,n){var i,r,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(t){if(i===setTimeout)return setTimeout(t,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(e){i=a}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var l,u=[],h=!1,d=-1;function p(){h&&l&&(h=!1,l.length?u=l.concat(u):d=-1,u.length&&f())}function f(){if(!h){var e=c(p);h=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new m(e,t)),1!==u.length||h||c(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],34:[function(e,t,n){function i(e,t){return function(){e.apply(t,arguments)}}function o(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],u(e,i(r,this),i(s,this))}function a(n){var i=this;null!==this._state?p(function(){var e=i._state?n.onFulfilled:n.onRejected;if(null!==e){var t;try{t=e(i._value)}catch(e){return void n.reject(e)}n.resolve(t)}else(i._state?n.resolve:n.reject)(i._value)}):this._deferreds.push(n)}function r(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void u(i(t,e),i(r,this),i(s,this))}this._state=!0,this._value=e,c.call(this)}catch(e){s.call(this,e)}}function s(e){this._state=!1,this._value=e,c.call(this)}function c(){for(var e=0,t=this._deferreds.length;e<t;e++)a.call(this,this._deferreds[e]);this._deferreds=null}function l(e,t,n,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i}function u(e,t,n){var i=!1;try{e(function(e){i||(i=!0,t(e))},function(e){i||(i=!0,n(e))})}catch(e){if(i)return;i=!0,n(e)}}var h,d,p,f;h=this,d=setTimeout,p="function"==typeof m&&m||function(e){d(e,1)},f=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(n,i){var r=this;return new o(function(e,t){a.call(r,new l(n,i,e,t))})},o.all=function(){var s=Array.prototype.slice.call(1===arguments.length&&f(arguments[0])?arguments[0]:arguments);return new o(function(i,r){if(0===s.length)return i([]);var o=s.length;function a(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){a(t,e)},r)}s[t]=e,0==--o&&i(s)}catch(e){r(e)}}for(var e=0;e<s.length;e++)a(e,s[e])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(n){return new o(function(e,t){t(n)})},o.race=function(r){return new o(function(e,t){for(var n=0,i=r.length;n<i;n++)r[n].then(e,t)})},o._setImmediateFn=function(e){p=e},void 0!==t&&t.exports?t.exports=o:h.Promise||(h.Promise=o)},{}],35:[function(e,t,n){var f=e("dtype"),m=e("an-array"),v=e("is-buffer"),g=[0,2,3],y=[2,1,3];t.exports=function(e,t){e&&(m(e)||v(e))||(t=e||{},e=null);for(var n="string"==typeof(t="number"==typeof t?{count:t}:t||{}).type?t.type:"uint16",i="number"==typeof t.count?t.count:1,r=t.start||0,o=!1!==t.clockwise?g:y,a=o[0],s=o[1],c=o[2],l=6*i,u=e||new(f(n))(l),h=0,d=0;h<l;h+=6,d+=4){var p=h+r;u[p+0]=d+0,u[p+1]=d+1,u[p+2]=d+2,u[p+3]=d+a,u[p+4]=d+s,u[p+5]=d+c}return u}},{"an-array":1,dtype:13,"is-buffer":19}],36:[function(e,t,n){(function(e){"use strict";function t(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:0<e?1:+e}),"name"in Function.prototype==0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}),Object.assign(t.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),i=0,r=n.length;i<r;i++)n[i].call(this,e)}}}});var n,i,u,h,r,o,a,s,c,l,d,p,f,m,v,g,y,A,b,w,x,E,q=0,X=1,Q=2,j=1,H=2,O=0,xe=1,Y=2,M=0,Z=0,K=1,J=2,$=3,ee=4,te=5,ne=100,T=101,S=102,C=103,L=104,_=200,B=201,R=202,P=203,D=204,I=205,k=206,F=207,N=208,z=209,U=210,ie=0,re=1,oe=2,ae=3,se=4,ce=5,le=6,ue=7,G=0,V=1,W=2,he=0,Ee=1,de=2,pe=3,fe=4,me=5,ve=301,ge=302,ye=303,Ae=304,be=305,we=306,Me=307,Te=1e3,Se=1001,Ce=1002,Le=1003,_e=1004,Be=1005,Re=1006,Pe=1007,De=1008,Ie=1009,Oe=1010,ke=1011,je=1012,He=1013,Fe=1014,Ne=1015,ze=1016,Ue=1017,Ge=1018,Ve=1019,We=1020,qe=1021,Xe=1022,Qe=1023,Ye=1024,Ze=1025,Ke=Qe,Je=1026,$e=1027,et=1028,tt=33776,nt=33777,it=33778,rt=33779,ot=35840,at=35841,st=35842,ct=35843,lt=36196,ut=37808,ht=37809,dt=37810,pt=37811,ft=37812,mt=37813,vt=37814,gt=37815,yt=37816,At=37817,bt=37818,wt=37819,xt=37820,Et=37821,Mt=0,Tt=3e3,St=3001,Ct=3007,Lt=3002,_t=3004,Bt=3005,Rt=3006,Pt=3200,Dt=3201,It=0,Ot=1,kt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var r=[],e=0;e<256;e++)r[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(r[255&e]+r[e>>8&255]+r[e>>16&255]+r[e>>24&255]+"-"+r[255&t]+r[t>>8&255]+"-"+r[t>>16&15|64]+r[t>>24&255]+"-"+r[63&n|128]+r[n>>8&255]+"-"+r[n>>16&255]+r[n>>24&255]+r[255&i]+r[i>>8&255]+r[i>>16&255]+r[i>>24&255]).toUpperCase()}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*kt.DEG2RAD},radToDeg:function(e){return e*kt.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function jt(e,t){this.x=e||0,this.y=t||0}function Ht(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Ft(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==i?i:1}function Nt(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function zt(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(jt.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(jt.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:(n=new jt,i=new jt,function(e,t){return n.set(e,e),i.set(t,t),this.clamp(n,i)}),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*i+e.x,this.y=r*i+o*n+e.y,this}}),Object.assign(Ht.prototype,{isMatrix4:!0,set:function(e,t,n,i,r,o,a,s,c,l,u,h,d,p,f,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=i,v[1]=r,v[5]=o,v[9]=a,v[13]=s,v[2]=c,v[6]=l,v[10]=u,v[14]=h,v[3]=d,v[7]=p,v[11]=f,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Ht).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:(l=new Nt,function(e){var t=this.elements,n=e.elements,i=1/l.setFromMatrixColumn(e,0).length(),r=1/l.setFromMatrixColumn(e,1).length(),o=1/l.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,i=e.y,r=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(i),c=Math.sin(i),l=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){var h=o*l,d=o*u,p=a*l,f=a*u;t[0]=s*l,t[4]=-s*u,t[8]=c,t[1]=d+p*c,t[5]=h-f*c,t[9]=-a*s,t[2]=f-h*c,t[6]=p+d*c,t[10]=o*s}else if("YXZ"===e.order){var m=s*l,v=s*u,g=c*l,y=c*u;t[0]=m+y*a,t[4]=g*a-v,t[8]=o*c,t[1]=o*u,t[5]=o*l,t[9]=-a,t[2]=v*a-g,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order){m=s*l,v=s*u,g=c*l,y=c*u;t[0]=m-y*a,t[4]=-o*u,t[8]=g+v*a,t[1]=v+g*a,t[5]=o*l,t[9]=y-m*a,t[2]=-o*c,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){h=o*l,d=o*u,p=a*l,f=a*u;t[0]=s*l,t[4]=p*c-d,t[8]=h*c+f,t[1]=s*u,t[5]=f*c+h,t[9]=d*c-p,t[2]=-c,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var A=o*s,b=o*c,w=a*s,x=a*c;t[0]=s*l,t[4]=x-A*u,t[8]=w*u+b,t[1]=u,t[5]=o*l,t[9]=-a*l,t[2]=-c*l,t[6]=b*u+w,t[10]=A-x*u}else if("XZY"===e.order){A=o*s,b=o*c,w=a*s,x=a*c;t[0]=s*l,t[4]=-u,t[8]=c*l,t[1]=A*u+x,t[5]=o*l,t[9]=b*u-w,t[2]=w*u-b,t[6]=a*l,t[10]=x*u+A}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:(s=new Nt(0,0,0),c=new Nt(1,1,1),function(e){return this.compose(s,e,c)}),lookAt:(r=new Nt,o=new Nt,a=new Nt,function(e,t,n){var i=this.elements;return a.subVectors(e,t),0===a.lengthSq()&&(a.z=1),a.normalize(),r.crossVectors(n,a),0===r.lengthSq()&&(1===Math.abs(n.z)?a.x+=1e-4:a.z+=1e-4,a.normalize(),r.crossVectors(n,a)),r.normalize(),o.crossVectors(a,r),i[0]=r.x,i[4]=o.x,i[8]=a.x,i[1]=r.y,i[5]=o.y,i[9]=a.y,i[2]=r.z,i[6]=o.z,i[10]=a.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[4],s=n[8],c=n[12],l=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],v=n[14],g=n[3],y=n[7],A=n[11],b=n[15],w=i[0],x=i[4],E=i[8],M=i[12],T=i[1],S=i[5],C=i[9],L=i[13],_=i[2],B=i[6],R=i[10],P=i[14],D=i[3],I=i[7],O=i[11],k=i[15];return r[0]=o*w+a*T+s*_+c*D,r[4]=o*x+a*S+s*B+c*I,r[8]=o*E+a*C+s*R+c*O,r[12]=o*M+a*L+s*P+c*k,r[1]=l*w+u*T+h*_+d*D,r[5]=l*x+u*S+h*B+d*I,r[9]=l*E+u*C+h*R+d*O,r[13]=l*M+u*L+h*P+d*k,r[2]=p*w+f*T+m*_+v*D,r[6]=p*x+f*S+m*B+v*I,r[10]=p*E+f*C+m*R+v*O,r[14]=p*M+f*L+m*P+v*k,r[3]=g*w+y*T+A*_+b*D,r[7]=g*x+y*S+A*B+b*I,r[11]=g*E+y*C+A*R+b*O,r[15]=g*M+y*L+A*P+b*k,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:(E=new Nt,function(e){for(var t=0,n=e.count;t<n;t++)E.x=e.getX(t),E.y=e.getY(t),E.z=e.getZ(t),E.applyMatrix4(this),e.setXYZ(t,E.x,E.y,E.z);return e}),determinant:function(){var e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],a=e[5],s=e[9],c=e[13],l=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(r*s*u-i*c*u-r*a*h+n*c*h+i*a*d-n*s*d)+e[7]*(t*s*d-t*c*h+r*o*h-i*o*d+i*c*l-r*s*l)+e[11]*(t*c*u-t*a*d-r*o*u+n*o*d+r*a*l-n*c*l)+e[15]*(-i*a*l-t*s*u+t*a*h+i*o*u-n*o*h+n*s*l)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,i=e.elements,r=i[0],o=i[1],a=i[2],s=i[3],c=i[4],l=i[5],u=i[6],h=i[7],d=i[8],p=i[9],f=i[10],m=i[11],v=i[12],g=i[13],y=i[14],A=i[15],b=p*y*h-g*f*h+g*u*m-l*y*m-p*u*A+l*f*A,w=v*f*h-d*y*h-v*u*m+c*y*m+d*u*A-c*f*A,x=d*g*h-v*p*h+v*l*m-c*g*m-d*l*A+c*p*A,E=v*p*u-d*g*u-v*l*f+c*g*f+d*l*y-c*p*y,M=r*b+o*w+a*x+s*E;if(0==M){var T="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(T);return console.warn(T),this.identity()}var S=1/M;return n[0]=b*S,n[1]=(g*f*s-p*y*s-g*a*m+o*y*m+p*a*A-o*f*A)*S,n[2]=(l*y*s-g*u*s+g*a*h-o*y*h-l*a*A+o*u*A)*S,n[3]=(p*u*s-l*f*s-p*a*h+o*f*h+l*a*m-o*u*m)*S,n[4]=w*S,n[5]=(d*y*s-v*f*s+v*a*m-r*y*m-d*a*A+r*f*A)*S,n[6]=(v*u*s-c*y*s-v*a*h+r*y*h+c*a*A-r*u*A)*S,n[7]=(c*f*s-d*u*s+d*a*h-r*f*h-c*a*m+r*u*m)*S,n[8]=x*S,n[9]=(v*p*s-d*g*s-v*o*m+r*g*m+d*o*A-r*p*A)*S,n[10]=(c*g*s-v*l*s+v*o*h-r*g*h-c*o*A+r*l*A)*S,n[11]=(d*l*s-c*p*s-d*o*h+r*p*h+c*o*m-r*l*m)*S,n[12]=E*S,n[13]=(d*g*a-v*p*a+v*o*f-r*g*f-d*o*y+r*p*y)*S,n[14]=(v*l*a-c*g*a-v*o*u+r*g*u+c*o*y-r*l*y)*S,n[15]=(c*p*a-d*l*a+d*o*u-r*p*u-c*o*f+r*l*f)*S,this},scale:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=1-n,o=e.x,a=e.y,s=e.z,c=r*o,l=r*a;return this.set(c*o+n,c*a-i*s,c*s+i*a,0,c*a+i*s,l*a+n,l*s-i*o,0,c*s-i*a,l*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var i=this.elements,r=t._x,o=t._y,a=t._z,s=t._w,c=r+r,l=o+o,u=a+a,h=r*c,d=r*l,p=r*u,f=o*l,m=o*u,v=a*u,g=s*c,y=s*l,A=s*u,b=n.x,w=n.y,x=n.z;return i[0]=(1-(f+v))*b,i[1]=(d+A)*b,i[2]=(p-y)*b,i[3]=0,i[4]=(d-A)*w,i[5]=(1-(h+v))*w,i[6]=(m+g)*w,i[7]=0,i[8]=(p+y)*x,i[9]=(m-g)*x,i[10]=(1-(h+f))*x,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this},decompose:(u=new Nt,h=new Ht,function(e,t,n){var i=this.elements,r=u.set(i[0],i[1],i[2]).length(),o=u.set(i[4],i[5],i[6]).length(),a=u.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],h.copy(this);var s=1/r,c=1/o,l=1/a;return h.elements[0]*=s,h.elements[1]*=s,h.elements[2]*=s,h.elements[4]*=c,h.elements[5]*=c,h.elements[6]*=c,h.elements[8]*=l,h.elements[9]*=l,h.elements[10]*=l,t.setFromRotationMatrix(h),n.x=r,n.y=o,n.z=a,this}),makePerspective:function(e,t,n,i,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*r/(t-e),c=2*r/(n-i),l=(t+e)/(t-e),u=(n+i)/(n-i),h=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,n,i,r,o){var a=this.elements,s=1/(t-e),c=1/(n-i),l=1/(o-r),u=(t+e)*s,h=(n+i)*c,d=(o+r)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}),Object.assign(Ft,{slerp:function(e,t,n,i){return n.copy(e).slerp(t,i)},slerpFlat:function(e,t,n,i,r,o,a){var s=n[i+0],c=n[i+1],l=n[i+2],u=n[i+3],h=r[o+0],d=r[o+1],p=r[o+2],f=r[o+3];if(u!==f||s!==h||c!==d||l!==p){var m=1-a,v=s*h+c*d+l*p+u*f,g=0<=v?1:-1,y=1-v*v;if(y>Number.EPSILON){var A=Math.sqrt(y),b=Math.atan2(A,v*g);m=Math.sin(m*b)/A,a=Math.sin(a*b)/A}var w=a*g;if(s=s*m+h*w,c=c*m+d*w,l=l*m+p*w,u=u*m+f*w,m===1-a){var x=1/Math.sqrt(s*s+c*c+l*l+u*u);s*=x,c*=x,l*=x,u*=x}}e[t]=s,e[t+1]=c,e[t+2]=l,e[t+3]=u}}),Object.defineProperties(Ft.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(Ft.prototype,{isQuaternion:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,i=e._y,r=e._z,o=e.order,a=Math.cos,s=Math.sin,c=a(n/2),l=a(i/2),u=a(r/2),h=s(n/2),d=s(i/2),p=s(r/2);return"XYZ"===o?(this._x=h*l*u+c*d*p,this._y=c*d*u-h*l*p,this._z=c*l*p+h*d*u,this._w=c*l*u-h*d*p):"YXZ"===o?(this._x=h*l*u+c*d*p,this._y=c*d*u-h*l*p,this._z=c*l*p-h*d*u,this._w=c*l*u+h*d*p):"ZXY"===o?(this._x=h*l*u-c*d*p,this._y=c*d*u+h*l*p,this._z=c*l*p+h*d*u,this._w=c*l*u-h*d*p):"ZYX"===o?(this._x=h*l*u-c*d*p,this._y=c*d*u+h*l*p,this._z=c*l*p-h*d*u,this._w=c*l*u+h*d*p):"YZX"===o?(this._x=h*l*u+c*d*p,this._y=c*d*u+h*l*p,this._z=c*l*p-h*d*u,this._w=c*l*u-h*d*p):"XZY"===o&&(this._x=h*l*u-c*d*p,this._y=c*d*u-h*l*p,this._z=c*l*p+h*d*u,this._w=c*l*u+h*d*p),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,i=n[0],r=n[4],o=n[8],a=n[1],s=n[5],c=n[9],l=n[2],u=n[6],h=n[10],d=i+s+h;return 0<d?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(u-c)*t,this._y=(o-l)*t,this._z=(a-r)*t):s<i&&h<i?(t=2*Math.sqrt(1+i-s-h),this._w=(u-c)/t,this._x=.25*t,this._y=(r+a)/t,this._z=(o+l)/t):h<s?(t=2*Math.sqrt(1+s-i-h),this._w=(o-l)/t,this._x=(r+a)/t,this._y=.25*t,this._z=(c+u)/t):(t=2*Math.sqrt(1+h-i-s),this._w=(a-r)/t,this._x=(o+l)/t,this._y=(c+u)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:(x=new Nt,function(e,t){return void 0===x&&(x=new Nt),(w=e.dot(t)+1)<1e-6?(w=0,Math.abs(e.x)>Math.abs(e.z)?x.set(-e.y,e.x,0):x.set(0,-e.z,e.y)):x.crossVectors(e,t),this._x=x.x,this._y=x.y,this._z=x.z,this._w=w,this.normalize()}),angleTo:function(e){return 2*Math.acos(Math.abs(kt.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);if(0===n)return this;var i=Math.min(1,t/n);return this.slerp(e,i),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,i=e._y,r=e._z,o=e._w,a=t._x,s=t._y,c=t._z,l=t._w;return this._x=n*l+o*a+i*c-r*s,this._y=i*l+o*s+r*a-n*c,this._z=r*l+o*c+n*s-i*a,this._w=o*l-n*a-i*s-r*c,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,i=this._y,r=this._z,o=this._w,a=o*e._w+n*e._x+i*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),1<=a)return this._w=o,this._x=n,this._y=i,this._z=r,this;var s=1-a*a;if(s<=Number.EPSILON){var c=1-t;return this._w=c*o+t*this._w,this._x=c*n+t*this._x,this._y=c*i+t*this._y,this._z=c*r+t*this._z,this.normalize()}var l=Math.sqrt(s),u=Math.atan2(l,a),h=Math.sin((1-t)*u)/l,d=Math.sin(t*u)/l;return this._w=o*h+this._w*d,this._x=n*h+this._x*d,this._y=i*h+this._y*d,this._z=r*h+this._z*d,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Nt.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(d=new Ft,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(d.setFromEuler(e))}),applyAxisAngle:(b=new Ft,function(e,t){return this.applyQuaternion(b.setFromAxisAngle(e,t))}),applyMatrix3:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*o,this},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,a=e.z,s=e.w,c=s*t+o*i-a*n,l=s*n+a*t-r*i,u=s*i+r*n-o*t,h=-r*t-o*n-a*i;return this.x=c*s+h*-r+l*-a-u*-o,this.y=l*s+h*-o+u*-r-c*-a,this.z=u*s+h*-a+c*-o-l*-r,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:(A=new Ht,function(e){return this.applyMatrix4(A.getInverse(e.projectionMatrix)).applyMatrix4(e.matrixWorld)}),transformDirection:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:(g=new Nt,y=new Nt,function(e,t){return g.set(e,e,e),y.set(t,t,t),this.clamp(g,y)}),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,i=e.y,r=e.z,o=t.x,a=t.y,s=t.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(v=new Nt,function(e){return v.copy(this).projectOnVector(e),this.sub(v)}),reflect:(m=new Nt,function(e){return this.sub(m.copy(e).multiplyScalar(2*this.dot(e)))}),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(kt.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(zt.prototype,{isMatrix3:!0,set:function(e,t,n,i,r,o,a,s,c){var l=this.elements;return l[0]=e,l[1]=i,l[2]=a,l[3]=t,l[4]=r,l[5]=s,l[6]=n,l[7]=o,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:(f=new Nt,function(e){for(var t=0,n=e.count;t<n;t++)f.x=e.getX(t),f.y=e.getY(t),f.z=e.getZ(t),f.applyMatrix3(this),e.setXYZ(t,f.x,f.y,f.z);return e}),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[3],s=n[6],c=n[1],l=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=i[0],m=i[3],v=i[6],g=i[1],y=i[4],A=i[7],b=i[2],w=i[5],x=i[8];return r[0]=o*f+a*g+s*b,r[3]=o*m+a*y+s*w,r[6]=o*v+a*A+s*x,r[1]=c*f+l*g+u*b,r[4]=c*m+l*y+u*w,r[7]=c*v+l*A+u*x,r[2]=h*f+d*g+p*b,r[5]=h*m+d*y+p*w,r[8]=h*v+d*A+p*x,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],c=e[7],l=e[8];return t*o*l-t*a*c-n*r*l+n*a*s+i*r*c-i*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,i=this.elements,r=n[0],o=n[1],a=n[2],s=n[3],c=n[4],l=n[5],u=n[6],h=n[7],d=n[8],p=d*c-l*h,f=l*u-d*s,m=h*s-c*u,v=r*p+o*f+a*m;if(0==v){var g="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return i[0]=p*y,i[1]=(a*h-d*o)*y,i[2]=(l*o-a*c)*y,i[3]=f*y,i[4]=(d*r-a*u)*y,i[5]=(a*s-l*r)*y,i[6]=m*y,i[7]=(o*u-h*r)*y,i[8]=(c*r-o*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,i,r,o,a){var s=Math.cos(r),c=Math.sin(r);this.set(n*s,n*c,-n*(s*o+c*a)+o+e,-i*c,i*s,-i*(-c*o+s*a)+a+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),i=this.elements,r=i[0],o=i[3],a=i[6],s=i[1],c=i[4],l=i[7];return i[0]=t*r+n*s,i[3]=t*o+n*c,i[6]=t*a+n*l,i[1]=-n*r+t*s,i[4]=-n*o+t*c,i[7]=-n*a+t*l,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Ut,Gt,Vt,Wt,qt,Xt,Qt,Yt,Zt,Kt,Jt,$t,en,tn,nn,rn,on,an,sn,cn,ln,un,hn,dn,pn,fn,mn,vn,gn,yn,An={getDataURL:function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===p&&(p=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),p.width=e.width,p.height=e.height;var n=p.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=p}return 2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},bn=0;function wn(e,t,n,i,r,o,a,s,c,l){Object.defineProperty(this,"id",{value:bn++}),this.uuid=kt.generateUUID(),this.name="",this.image=void 0!==e?e:wn.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:wn.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:Se,this.wrapT=void 0!==i?i:Se,this.magFilter=void 0!==r?r:Re,this.minFilter=void 0!==o?o:De,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:Qe,this.type=void 0!==s?s:Ie,this.offset=new jt(0,0),this.repeat=new jt(1,1),this.center=new jt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new zt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:Tt,this.version=0,this.onUpdate=null}function xn(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==i?i:1}function En(e,t,n){this.width=e,this.height=t,this.scissor=new xn(0,0,e,t),this.scissorTest=!1,this.viewport=new xn(0,0,e,t),n=n||{},this.texture=new wn(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Re,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function Mn(e,t,n){En.call(this,e,t,n),this.samples=4}function Tn(e,t,n){En.call(this,e,t,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function Sn(e,t,n,i,r,o,a,s,c,l,u,h){wn.call(this,null,o,a,s,c,l,i,r,u,h),this.image={data:e,width:t,height:n},this.magFilter=void 0!==c?c:Le,this.minFilter=void 0!==l?l:Le,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Cn(e,t){this.min=void 0!==e?e:new Nt(1/0,1/0,1/0),this.max=void 0!==t?t:new Nt(-1/0,-1/0,-1/0)}function Ln(e,t){this.center=void 0!==e?e:new Nt,this.radius=void 0!==t?t:0}function _n(e,t){this.normal=void 0!==e?e:new Nt(1,0,0),this.constant=void 0!==t?t:0}function Bn(e,t,n,i,r,o){this.planes=[void 0!==e?e:new _n,void 0!==t?t:new _n,void 0!==n?n:new _n,void 0!==i?i:new _n,void 0!==r?r:new _n,void 0!==o?o:new _n]}function Rn(e){var t,n;for(t=0,n=e.length-3;t<=n;t+=3){cn.fromArray(e,t);var i=un.x*Math.abs(cn.x)+un.y*Math.abs(cn.y)+un.z*Math.abs(cn.z),r=tn.dot(cn),o=nn.dot(cn),a=rn.dot(cn);if(Math.max(-Math.max(r,o,a),Math.min(r,o,a))>i)return!1}return!0}function Pn(e){var t=e.geometry;if(void 0!==t)if(t.isGeometry){var n=t.vertices;for(pn=0,fn=n.length;pn<fn;pn++)mn.copy(n[pn]),mn.applyMatrix4(e.matrixWorld),dn.expandByPoint(mn)}else if(t.isBufferGeometry){var i=t.attributes.position;if(void 0!==i)for(pn=0,fn=i.count;pn<fn;pn++)mn.fromBufferAttribute(i,pn).applyMatrix4(e.matrixWorld),dn.expandByPoint(mn)}}wn.DEFAULT_IMAGE=void 0,wn.DEFAULT_MAPPING=300,wn.prototype=Object.assign(Object.create(t.prototype),{constructor:wn,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var i=this.image;if(void 0===i.uuid&&(i.uuid=kt.generateUUID()),!t&&void 0===e.images[i.uuid]){var r;if(Array.isArray(i)){r=[];for(var o=0,a=i.length;o<a;o++)r.push(An.getDataURL(i[o]))}else r=An.getDataURL(i);e.images[i.uuid]={uuid:i.uuid,url:r}}n.image=i.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||1<e.x)switch(this.wrapS){case Te:e.x=e.x-Math.floor(e.x);break;case Se:e.x=e.x<0?0:1;break;case Ce:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||1<e.y)switch(this.wrapT){case Te:e.y=e.y-Math.floor(e.y);break;case Se:e.y=e.y<0?0:1;break;case Ce:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(wn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(xn.prototype,{isVector4:!0,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,i,r,o=e.elements,a=o[0],s=o[4],c=o[8],l=o[1],u=o[5],h=o[9],d=o[2],p=o[6],f=o[10];if(Math.abs(s-l)<.01&&Math.abs(c-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(s+l)<.1&&Math.abs(c+d)<.1&&Math.abs(h+p)<.1&&Math.abs(a+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,v=(u+1)/2,g=(f+1)/2,y=(s+l)/4,A=(c+d)/4,b=(h+p)/4;return v<m&&g<m?r=m<.01?(n=0,i=.707106781):(i=y/(n=Math.sqrt(m)),A/n):g<v?r=v<.01?(i=0,n=.707106781):(n=y/(i=Math.sqrt(v)),b/i):g<.01?(i=n=.707106781,r=0):(n=A/(r=Math.sqrt(g)),i=b/r),this.set(n,i,r,t),this}var w=Math.sqrt((p-h)*(p-h)+(c-d)*(c-d)+(l-s)*(l-s));return Math.abs(w)<.001&&(w=1),this.x=(p-h)/w,this.y=(c-d)/w,this.z=(l-s)/w,this.w=Math.acos((a+u+f-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return void 0===gn&&(gn=new xn,yn=new xn),gn.set(e,e,e,e),yn.set(t,t,t,t),this.clamp(gn,yn)},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),En.prototype=Object.assign(Object.create(t.prototype),{constructor:En,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Mn.prototype=Object.assign(Object.create(En.prototype),{constructor:Mn,isWebGLMultisampleRenderTarget:!0,copy:function(e){return En.prototype.copy.call(this,e),this.samples=e.samples,this}}),((Tn.prototype=Object.create(En.prototype)).constructor=Tn).prototype.isWebGLRenderTargetCube=!0,((Sn.prototype=Object.create(wn.prototype)).constructor=Sn).prototype.isDataTexture=!0,Object.assign(Cn.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,c=e.length;s<c;s+=3){var l=e[s],u=e[s+1],h=e[s+2];l<t&&(t=l),u<n&&(n=u),h<i&&(i=h),r<l&&(r=l),o<u&&(o=u),a<h&&(a=h)}return this.min.set(t,n,i),this.max.set(r,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,c=e.count;s<c;s++){var l=e.getX(s),u=e.getY(s),h=e.getZ(s);l<t&&(t=l),u<n&&(n=u),h<i&&(i=h),r<l&&(r=l),o<u&&(o=u),a<h&&(a=h)}return this.min.set(t,n,i),this.max.set(r,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:(vn=new Nt,function(e,t){var n=vn.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Nt),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Nt),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:(mn=new Nt,function(e){return dn=this,e.updateMatrixWorld(!0),e.traverse(Pn),this}),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Nt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:(Gt=new Nt,function(e){return this.clampPoint(e.center,Gt),Gt.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,n;return n=0<e.normal.x?(t=e.normal.x*this.min.x,e.normal.x*this.max.x):(t=e.normal.x*this.max.x,e.normal.x*this.min.x),0<e.normal.y?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:(tn=new Nt,nn=new Nt,rn=new Nt,on=new Nt,an=new Nt,sn=new Nt,cn=new Nt,ln=new Nt,un=new Nt,hn=new Nt,function(e){if(this.isEmpty())return!1;this.getCenter(ln),un.subVectors(this.max,ln),tn.subVectors(e.a,ln),nn.subVectors(e.b,ln),rn.subVectors(e.c,ln),on.subVectors(nn,tn),an.subVectors(rn,nn),sn.subVectors(tn,rn);var t=[0,-on.z,on.y,0,-an.z,an.y,0,-sn.z,sn.y,on.z,0,-on.x,an.z,0,-an.x,sn.z,0,-sn.x,-on.y,on.x,0,-an.y,an.x,0,-sn.y,sn.x,0];return!!Rn(t)&&!!Rn(t=[1,0,0,0,1,0,0,0,1])&&(hn.crossVectors(on,an),Rn(t=[hn.x,hn.y,hn.z]))}),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Nt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:(en=new Nt,function(e){return en.copy(e).clamp(this.min,this.max).sub(e).length()}),getBoundingSphere:($t=new Nt,function(e){return void 0===e&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),e=new Ln),this.getCenter(e.center),e.radius=.5*this.getSize($t).length(),e}),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(Ut=[new Nt,new Nt,new Nt,new Nt,new Nt,new Nt,new Nt,new Nt],function(e){return this.isEmpty()||(Ut[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ut[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ut[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ut[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ut[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ut[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ut[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ut[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ut)),this}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Ln.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(Vt=new Cn,function(e,t){var n=this.center;void 0!==t?n.copy(t):Vt.setFromPoints(e).getCenter(n);for(var i=0,r=0,o=e.length;r<o;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Nt),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Cn),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(_n.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:(Kt=new Nt,Jt=new Nt,function(e,t,n){var i=Kt.subVectors(n,t).cross(Jt.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Nt),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:(Zt=new Nt,function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new Nt);var n=e.delta(Zt),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;var r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||1<r?void 0:t.copy(n).multiplyScalar(r).add(e.start)}),intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&0<n||n<0&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Nt),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(Qt=new Nt,Yt=new zt,function(e,t){var n=t||Yt.getNormalMatrix(e),i=this.coplanarPoint(Qt).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Bn.prototype,{set:function(e,t,n,i,r,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],c=n[5],l=n[6],u=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return t[0].setComponents(a-i,u-s,f-h,y-m).normalize(),t[1].setComponents(a+i,u+s,f+h,y+m).normalize(),t[2].setComponents(a+r,u+c,f+d,y+v).normalize(),t[3].setComponents(a-r,u-c,f-d,y-v).normalize(),t[4].setComponents(a-o,u-l,f-p,y-g).normalize(),t[5].setComponents(a+o,u+l,f+p,y+g).normalize(),this},intersectsObject:(qt=new Ln,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),qt.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(qt)}),intersectsSprite:(Xt=new Ln,function(e){return Xt.center.set(0,0,0),Xt.radius=.7071067811865476,Xt.applyMatrix4(e.matrixWorld),this.intersectsSphere(Xt)}),intersectsSphere:function(e){for(var t=this.planes,n=e.center,i=-e.radius,r=0;r<6;r++){if(t[r].distanceToPoint(n)<i)return!1}return!0},intersectsBox:(Wt=new Nt,function(e){for(var t=this.planes,n=0;n<6;n++){var i=t[n];if(Wt.x=0<i.normal.x?e.max.x:e.min.x,Wt.y=0<i.normal.y?e.max.y:e.min.y,Wt.z=0<i.normal.z?e.max.z:e.min.z,i.distanceToPoint(Wt)<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var Dn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick( specularColor, dotNV );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#endif\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\t\tvec3 diffuse = material.diffuseColor;\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\t#else\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#endif\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"};function In(e){var t={};for(var n in e)for(var i in t[n]={},e[n]){var r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}return t}function On(e){for(var t={},n=0;n<e.length;n++){var i=In(e[n]);for(var r in i)t[r]=i[r]}return t}var kn,jn,Hn,Fn={clone:In,merge:On},Nn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function zn(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}function Un(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function Gn(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Vn(e,t,n){return n<0&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}Object.assign(zn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(e=kt.euclideanModulo(e,1),t=kt.clamp(t,0,1),n=kt.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=Vn(r,i,e+1/3),this.g=Vn(r,i,e),this.b=Vn(r,i,e-1/3)}return this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var i,r=n[1],o=n[2];switch(r){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,e(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,e(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(i[1])/360,s=parseInt(i[2],10)/100,c=parseInt(i[3],10)/100;return e(i[5]),this.setHSL(a,s,c)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l,u=(l=n[1]).length;if(3===u)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}t&&0<t.length&&(void 0!==(l=Nn[t])?this.setHex(l):console.warn("THREE.Color: Unknown color "+t));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=0<t?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=Gn(e.r),this.g=Gn(e.g),this.b=Gn(e.b),this},copyLinearToSRGB:function(e){return this.r=Un(e.r),this.g=Un(e.g),this.b=Un(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,i=this.r,r=this.g,o=this.b,a=Math.max(i,r,o),s=Math.min(i,r,o),c=(s+a)/2;if(s===a)n=t=0;else{var l=a-s;switch(n=c<=.5?l/(a+s):l/(2-a-s),a){case i:t=(r-o)/l+(r<o?6:0);break;case r:t=(o-i)/l+2;break;case o:t=(i-r)/l+4}t/=6}return e.h=t,e.s=n,e.l=c,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:(Hn={},function(e,t,n){return this.getHSL(Hn),Hn.h+=e,Hn.s+=t,Hn.l+=n,this.setHSL(Hn.h,Hn.s,Hn.l),this}),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:(kn={h:0,s:0,l:0},jn={h:0,s:0,l:0},function(e,t){this.getHSL(kn),e.getHSL(jn);var n=kt.lerp(kn.h,jn.h,t),i=kt.lerp(kn.s,jn.s,t),r=kt.lerp(kn.l,jn.l,t);return this.setHSL(n,i,r),this}),equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var Wn,qn,Xn={common:{diffuse:{value:new zn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new zt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new jt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new zn(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new zn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new zt}},sprite:{diffuse:{value:new zn(15658734)},opacity:{value:1},center:{value:new jt(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new zt}}},Qn={basic:{uniforms:On([Xn.common,Xn.specularmap,Xn.envmap,Xn.aomap,Xn.lightmap,Xn.fog]),vertexShader:Dn.meshbasic_vert,fragmentShader:Dn.meshbasic_frag},lambert:{uniforms:On([Xn.common,Xn.specularmap,Xn.envmap,Xn.aomap,Xn.lightmap,Xn.emissivemap,Xn.fog,Xn.lights,{emissive:{value:new zn(0)}}]),vertexShader:Dn.meshlambert_vert,fragmentShader:Dn.meshlambert_frag},phong:{uniforms:On([Xn.common,Xn.specularmap,Xn.envmap,Xn.aomap,Xn.lightmap,Xn.emissivemap,Xn.bumpmap,Xn.normalmap,Xn.displacementmap,Xn.gradientmap,Xn.fog,Xn.lights,{emissive:{value:new zn(0)},specular:{value:new zn(1118481)},shininess:{value:30}}]),vertexShader:Dn.meshphong_vert,fragmentShader:Dn.meshphong_frag},standard:{uniforms:On([Xn.common,Xn.envmap,Xn.aomap,Xn.lightmap,Xn.emissivemap,Xn.bumpmap,Xn.normalmap,Xn.displacementmap,Xn.roughnessmap,Xn.metalnessmap,Xn.fog,Xn.lights,{emissive:{value:new zn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Dn.meshphysical_vert,fragmentShader:Dn.meshphysical_frag},matcap:{uniforms:On([Xn.common,Xn.bumpmap,Xn.normalmap,Xn.displacementmap,Xn.fog,{matcap:{value:null}}]),vertexShader:Dn.meshmatcap_vert,fragmentShader:Dn.meshmatcap_frag},points:{uniforms:On([Xn.points,Xn.fog]),vertexShader:Dn.points_vert,fragmentShader:Dn.points_frag},dashed:{uniforms:On([Xn.common,Xn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Dn.linedashed_vert,fragmentShader:Dn.linedashed_frag},depth:{uniforms:On([Xn.common,Xn.displacementmap]),vertexShader:Dn.depth_vert,fragmentShader:Dn.depth_frag},normal:{uniforms:On([Xn.common,Xn.bumpmap,Xn.normalmap,Xn.displacementmap,{opacity:{value:1}}]),vertexShader:Dn.normal_vert,fragmentShader:Dn.normal_frag},sprite:{uniforms:On([Xn.sprite,Xn.fog]),vertexShader:Dn.sprite_vert,fragmentShader:Dn.sprite_frag},background:{uniforms:{uvTransform:{value:new zt},t2D:{value:null}},vertexShader:Dn.background_vert,fragmentShader:Dn.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Dn.cube_vert,fragmentShader:Dn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Dn.equirect_vert,fragmentShader:Dn.equirect_frag},distanceRGBA:{uniforms:On([Xn.common,Xn.displacementmap,{referencePosition:{value:new Nt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Dn.distanceRGBA_vert,fragmentShader:Dn.distanceRGBA_frag},shadow:{uniforms:On([Xn.lights,Xn.fog,{color:{value:new zn(0)},opacity:{value:1}}]),vertexShader:Dn.shadow_vert,fragmentShader:Dn.shadow_frag}};function Yn(){var n=null,i=!1,r=null;function o(e,t){!1!==i&&(r(e,t),n.requestAnimationFrame(o))}return{start:function(){!0!==i&&null!==r&&(n.requestAnimationFrame(o),i=!0)},stop:function(){i=!1},setAnimationLoop:function(e){r=e},setContext:function(e){n=e}}}function Zn(c){var l=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),l.get(e)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var t=l.get(e);t&&(c.deleteBuffer(t.buffer),l.delete(e))},update:function(e,t){e.isInterleavedBufferAttribute&&(e=e.data);var n,i,r,o,a,s=l.get(e);void 0===s?l.set(e,function(e,t){var n=e.array,i=e.dynamic?35048:35044,r=c.createBuffer();c.bindBuffer(t,r),c.bufferData(t,n,i),e.onUploadCallback();var o=5126;return n instanceof Float32Array?o=5126:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?o=5123:n instanceof Int16Array?o=5122:n instanceof Uint32Array?o=5125:n instanceof Int32Array?o=5124:n instanceof Int8Array?o=5120:n instanceof Uint8Array&&(o=5121),{buffer:r,type:o,bytesPerElement:n.BYTES_PER_ELEMENT,version:e.version}}(e,t)):s.version<e.version&&(n=s.buffer,r=t,o=(i=e).array,a=i.updateRange,c.bindBuffer(r,n),!1===i.dynamic?c.bufferData(r,o,35044):-1===a.count?c.bufferSubData(r,0,o):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(c.bufferSubData(r,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1),s.version=e.version)}}}function Kn(e,t,n,i,r,o){this.a=e,this.b=t,this.c=n,this.normal=i&&i.isVector3?i:new Nt,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new zn,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}function Jn(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._order=i||Jn.DefaultOrder}function $n(){this.mask=1}Qn.physical={uniforms:On([Qn.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Dn.meshphysical_vert,fragmentShader:Dn.meshphysical_frag},Object.assign(Kn.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}),Jn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Jn.DefaultOrder="XYZ",Object.defineProperties(Jn.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(Jn.prototype,{isEuler:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var i=kt.clamp,r=e.elements,o=r[0],a=r[4],s=r[8],c=r[1],l=r[5],u=r[9],h=r[2],d=r[6],p=r[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(i(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,l),this._z=0)):"YXZ"===t?(this._x=Math.asin(-i(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(i(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(c,o))):"ZYX"===t?(this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,l))):"YZX"===t?(this._z=Math.asin(i(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===t?(this._z=Math.asin(-i(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,l),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-u,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:(qn=new Ht,function(e,t,n){return qn.makeRotationFromQuaternion(e),this.setFromRotationMatrix(qn,t,n)}),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(Wn=new Ft,function(e){return Wn.setFromEuler(this),this.setFromQuaternion(Wn,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Nt(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign($n.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var ei,ti,ni,ii,ri,oi,ai,si,ci,li,ui,hi,di,pi,fi,mi,vi,gi,yi=0;function Ai(){Object.defineProperty(this,"id",{value:yi++}),this.uuid=kt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ai.DefaultUp.clone();var e=new Nt,t=new Jn,n=new Ft,i=new Nt(1,1,1);t.onChange(function(){n.setFromEuler(t,!1)}),n.onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ht},normalMatrix:{value:new zt}}),this.matrix=new Ht,this.matrixWorld=new Ht,this.matrixAutoUpdate=Ai.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new $n,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Ai.DefaultUp=new Nt(0,1,0),Ai.DefaultMatrixAutoUpdate=!0,Ai.prototype=Object.assign(Object.create(t.prototype),{constructor:Ai,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(ii=new Ft,function(e,t){return ii.setFromAxisAngle(e,t),this.quaternion.multiply(ii),this}),rotateOnWorldAxis:(gi=new Ft,function(e,t){return gi.setFromAxisAngle(e,t),this.quaternion.premultiply(gi),this}),rotateX:(vi=new Nt(1,0,0),function(e){return this.rotateOnAxis(vi,e)}),rotateY:(mi=new Nt(0,1,0),function(e){return this.rotateOnAxis(mi,e)}),rotateZ:(fi=new Nt(0,0,1),function(e){return this.rotateOnAxis(fi,e)}),translateOnAxis:(pi=new Nt,function(e,t){return pi.copy(e).applyQuaternion(this.quaternion),this.position.add(pi.multiplyScalar(t)),this}),translateX:(di=new Nt(1,0,0),function(e){return this.translateOnAxis(di,e)}),translateY:(hi=new Nt(0,1,0),function(e){return this.translateOnAxis(hi,e)}),translateZ:(ui=new Nt(0,0,1),function(e){return this.translateOnAxis(ui,e)}),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(ni=new Ht,function(e){return e.applyMatrix4(ni.getInverse(this.matrixWorld))}),lookAt:(ai=new Ft,si=new Ht,ci=new Nt,li=new Nt,function(e,t,n){e.isVector3?ci.copy(e):ci.set(e,t,n);var i=this.parent;this.updateWorldMatrix(!0,!1),li.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?si.lookAt(li,ci,this.up):si.lookAt(ci,li,this.up),this.quaternion.setFromRotationMatrix(si),i&&(si.extractRotation(i.matrixWorld),ai.setFromRotationMatrix(si),this.quaternion.premultiply(ai.inverse()))}),add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this},remove:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Nt),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(ei=new Nt,ti=new Nt,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Ft),this.updateMatrixWorld(!0),this.matrixWorld.decompose(ei,e,ti),e}),getWorldScale:(ri=new Nt,oi=new Ft,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new Nt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(ri,oi,e),e}),getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Nt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e=!(this.matrixWorldNeedsUpdate=!1));for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var i=this.children,r=0,o=i.length;r<o;r++)i[r].updateWorldMatrix(!1,!0)},toJSON:function(n){var e=void 0===n||"string"==typeof n,t={};e&&(n={geometries:{},materials:{},textures:{},images:{},shapes:{}},t.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var i={};function r(e,t){return void 0===e[t.uuid]&&(e[t.uuid]=t.toJSON(n)),t.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isMesh&&this.drawMode!==Mt&&(i.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){i.geometry=r(n.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,c=a.length;s<c;s++){var l=a[s];r(n.shapes,l)}else r(n.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var u=[];for(s=0,c=this.material.length;s<c;s++)u.push(r(n.materials,this.material[s]));i.material=u}else i.material=r(n.materials,this.material);if(0<this.children.length){i.children=[];for(s=0;s<this.children.length;s++)i.children.push(this.children[s].toJSON(n).object)}if(e){var h=m(n.geometries),d=m(n.materials),p=m(n.textures),f=m(n.images);a=m(n.shapes);0<h.length&&(t.geometries=h),0<d.length&&(t.materials=d),0<p.length&&(t.textures=p),0<f.length&&(t.images=f),0<a.length&&(t.shapes=a)}return t.object=i,t;function m(e){var t=[];for(var n in e){var i=e[n];delete i.metadata,t.push(i)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var i=e.children[n];this.add(i.clone())}return this}});var bi,wi,xi,Ei,Mi,Ti,Si,Ci=0;function Li(){Object.defineProperty(this,"id",{value:Ci+=2}),this.uuid=kt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function _i(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Bi(e,t,n){_i.call(this,new Int8Array(e),t,n)}function Ri(e,t,n){_i.call(this,new Uint8Array(e),t,n)}function Pi(e,t,n){_i.call(this,new Uint8ClampedArray(e),t,n)}function Di(e,t,n){_i.call(this,new Int16Array(e),t,n)}function Ii(e,t,n){_i.call(this,new Uint16Array(e),t,n)}function Oi(e,t,n){_i.call(this,new Int32Array(e),t,n)}function ki(e,t,n){_i.call(this,new Uint32Array(e),t,n)}function ji(e,t,n){_i.call(this,new Float32Array(e),t,n)}function Hi(e,t,n){_i.call(this,new Float64Array(e),t,n)}function Fi(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Ni(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,i=e.length;n<i;++n)e[n]>t&&(t=e[n]);return t}Li.prototype=Object.assign(Object.create(t.prototype),{constructor:Li,isGeometry:!0,applyMatrix:function(e){for(var t=(new zt).getNormalMatrix(e),n=0,i=this.vertices.length;n<i;n++){this.vertices[n].applyMatrix4(e)}for(n=0,i=this.faces.length;n<i;n++){var r=this.faces[n];r.normal.applyMatrix3(t).normalize();for(var o=0,a=r.vertexNormals.length;o<a;o++)r.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:(Si=new Ht,function(e){return Si.makeRotationX(e),this.applyMatrix(Si),this}),rotateY:(Ti=new Ht,function(e){return Ti.makeRotationY(e),this.applyMatrix(Ti),this}),rotateZ:(Mi=new Ht,function(e){return Mi.makeRotationZ(e),this.applyMatrix(Mi),this}),translate:(Ei=new Ht,function(e,t,n){return Ei.makeTranslation(e,t,n),this.applyMatrix(Ei),this}),scale:(xi=new Ht,function(e,t,n){return xi.makeScale(e,t,n),this.applyMatrix(xi),this}),lookAt:(wi=new Ai,function(e){wi.lookAt(e),wi.updateMatrix(),this.applyMatrix(wi.matrix)}),fromBufferGeometry:function(e){var a=this,t=null!==e.index?e.index.array:void 0,n=e.attributes,i=n.position.array,s=void 0!==n.normal?n.normal.array:void 0,c=void 0!==n.color?n.color.array:void 0,l=void 0!==n.uv?n.uv.array:void 0,u=void 0!==n.uv2?n.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var r=0,o=0;r<i.length;r+=3,o+=2)a.vertices.push((new Nt).fromArray(i,r)),void 0!==c&&a.colors.push((new zn).fromArray(c,r));function h(e,t,n,i){var r=void 0===c?[]:[a.colors[e].clone(),a.colors[t].clone(),a.colors[n].clone()],o=new Kn(e,t,n,void 0===s?[]:[(new Nt).fromArray(s,3*e),(new Nt).fromArray(s,3*t),(new Nt).fromArray(s,3*n)],r,i);a.faces.push(o),void 0!==l&&a.faceVertexUvs[0].push([(new jt).fromArray(l,2*e),(new jt).fromArray(l,2*t),(new jt).fromArray(l,2*n)]),void 0!==u&&a.faceVertexUvs[1].push([(new jt).fromArray(u,2*e),(new jt).fromArray(u,2*t),(new jt).fromArray(u,2*n)])}var d=e.groups;if(0<d.length)for(r=0;r<d.length;r++)for(var p=d[r],f=p.start,m=(o=f,f+p.count);o<m;o+=3)void 0!==t?h(t[o],t[o+1],t[o+2],p.materialIndex):h(o,o+1,o+2,p.materialIndex);else if(void 0!==t)for(r=0;r<t.length;r+=3)h(t[r],t[r+1],t[r+2]);else for(r=0;r<i.length/3;r+=3)h(r,r+1,r+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:(bi=new Nt,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(bi).negate(),this.translate(bi.x,bi.y,bi.z),this}),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,i=new Ht;return i.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var e=new Nt,t=new Nt,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){var t,n,i,r,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)a[t]=new Nt;if(e){var s,c,l,u=new Nt,h=new Nt;for(i=0,r=this.faces.length;i<r;i++)o=this.faces[i],s=this.vertices[o.a],c=this.vertices[o.b],l=this.vertices[o.c],u.subVectors(l,c),h.subVectors(s,c),u.cross(h),a[o.a].add(u),a[o.b].add(u),a[o.c].add(u)}else for(this.computeFaceNormals(),i=0,r=this.faces.length;i<r;i++)a[(o=this.faces[i]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,n=this.vertices.length;t<n;t++)a[t].normalize();for(i=0,r=this.faces.length;i<r;i++){var d=(o=this.faces[i]).vertexNormals;3===d.length?(d[0].copy(a[o.a]),d[1].copy(a[o.b]),d[2].copy(a[o.c])):(d[0]=a[o.a].clone(),d[1]=a[o.b].clone(),d[2]=a[o.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var i=(n=this.faces[e]).vertexNormals;3===i.length?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for((r=this.faces[n]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;e<t;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var o=new Li;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)c=new Nt,l={a:new Nt,b:new Nt,c:new Nt},a.push(c),s.push(l)}var c,l,u=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,i=this.faces.length;n<i;n++)r=this.faces[n],c=u.faceNormals[n],l=u.vertexNormals[n],c.copy(r.normal),l.a.copy(r.vertexNormals[0]),l.b.copy(r.vertexNormals[1]),l.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)(r=this.faces[n]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Cn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ln),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var i,r=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,c=e.faces,l=this.faceVertexUvs[0],u=e.faceVertexUvs[0],h=this.colors,d=e.colors;void 0===n&&(n=0),void 0!==t&&(i=(new zt).getNormalMatrix(t));for(var p=0,f=a.length;p<f;p++){var m=a[p].clone();void 0!==t&&m.applyMatrix4(t),o.push(m)}for(p=0,f=d.length;p<f;p++)h.push(d[p].clone());for(p=0,f=c.length;p<f;p++){var v,g,y,A=c[p],b=A.vertexNormals,w=A.vertexColors;(v=new Kn(A.a+r,A.b+r,A.c+r)).normal.copy(A.normal),void 0!==i&&v.normal.applyMatrix3(i).normalize();for(var x=0,E=b.length;x<E;x++)g=b[x].clone(),void 0!==i&&g.applyMatrix3(i).normalize(),v.vertexNormals.push(g);v.color.copy(A.color);for(x=0,E=w.length;x<E;x++)y=w[x],v.vertexColors.push(y.clone());v.materialIndex=A.materialIndex+n,s.push(v)}for(p=0,f=u.length;p<f;p++){var M=u[p],T=[];if(void 0!==M){for(x=0,E=M.length;x<E;x++)T.push(M[x].clone());l.push(T)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,i,r,o,a,s,c={},l=[],u=[],h=Math.pow(10,4);for(n=0,i=this.vertices.length;n<i;n++)e=this.vertices[n],void 0===c[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(c[t]=n,l.push(this.vertices[n]),u[n]=l.length-1):u[n]=u[c[t]];var d=[];for(n=0,i=this.faces.length;n<i;n++){(r=this.faces[n]).a=u[r.a],r.b=u[r.b],r.c=u[r.c],o=[r.a,r.b,r.c];for(var p=0;p<3;p++)if(o[p]===o[(p+1)%3]){d.push(n);break}}for(n=d.length-1;0<=n;n--){var f=d[n];for(this.faces.splice(f,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(f,1)}var m=this.vertices.length-l.length;return this.vertices=l,m},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var i=e[t];this.vertices.push(new Nt(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var i,r,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===t&&(i=[]),a&&a.length===t&&(r=[]);for(n=0;n<t;n++){var s=e[n]._id;i&&i.push(o[s]),r&&r.push(a[s])}i&&(this.faceVertexUvs[0]=i),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var i=[],r=0;r<this.vertices.length;r++){var o=this.vertices[r];i.push(o.x,o.y,o.z)}var a=[],s=[],c={},l=[],u={},h=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],f=void 0!==this.faceVertexUvs[0][r],m=0<p.normal.length(),v=0<p.vertexNormals.length,g=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=0<p.vertexColors.length,A=0;if(A=E(A,0,0),A=E(A,1,!0),A=E(A,2,!1),A=E(A,3,f),A=E(A,4,m),A=E(A,5,v),A=E(A,6,g),A=E(A,7,y),a.push(A),a.push(p.a,p.b,p.c),a.push(p.materialIndex),f){var b=this.faceVertexUvs[0][r];a.push(S(b[0]),S(b[1]),S(b[2]))}if(m&&a.push(M(p.normal)),v){var w=p.vertexNormals;a.push(M(w[0]),M(w[1]),M(w[2]))}if(g&&a.push(T(p.color)),y){var x=p.vertexColors;a.push(T(x[0]),T(x[1]),T(x[2]))}}function E(e,t,n){return n?e|1<<t:e&~(1<<t)}function M(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==c[t]||(c[t]=s.length/3,s.push(e.x,e.y,e.z)),c[t]}function T(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==u[t]||(u[t]=l.length,l.push(e.getHex())),u[t]}function S(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]||(d[t]=h.length/2,h.push(e.x,e.y)),d[t]}return e.data={},e.data.vertices=i,e.data.normals=s,0<l.length&&(e.data.colors=l),0<h.length&&(e.data.uvs=[h]),e.data.faces=a,e},clone:function(){return(new Li).copy(this)},copy:function(e){var t,n,i,r,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var c=e.colors;for(t=0,n=c.length;t<n;t++)this.colors.push(c[t].clone());var l=e.faces;for(t=0,n=l.length;t<n;t++)this.faces.push(l[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var u=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),i=0,r=u.length;i<r;i++){var h=u[i],d=[];for(o=0,a=h.length;o<a;o++){var p=h[o];d.push(p.clone())}this.faceVertexUvs[t].push(d)}}var f=e.morphTargets;for(t=0,n=f.length;t<n;t++){var m={};if(m.name=f[t].name,void 0!==f[t].vertices)for(m.vertices=[],i=0,r=f[t].vertices.length;i<r;i++)m.vertices.push(f[t].vertices[i].clone());if(void 0!==f[t].normals)for(m.normals=[],i=0,r=f[t].normals.length;i<r;i++)m.normals.push(f[t].normals[i].clone());this.morphTargets.push(m)}var v=e.morphNormals;for(t=0,n=v.length;t<n;t++){var g={};if(void 0!==v[t].vertexNormals)for(g.vertexNormals=[],i=0,r=v[t].vertexNormals.length;i<r;i++){var y=v[t].vertexNormals[i],A={};A.a=y.a.clone(),A.b=y.b.clone(),A.c=y.c.clone(),g.vertexNormals.push(A)}if(void 0!==v[t].faceNormals)for(g.faceNormals=[],i=0,r=v[t].faceNormals.length;i<r;i++)g.faceNormals.push(v[t].faceNormals[i].clone());this.morphNormals.push(g)}var b=e.skinWeights;for(t=0,n=b.length;t<n;t++)this.skinWeights.push(b[t].clone());var w=e.skinIndices;for(t=0,n=w.length;t<n;t++)this.skinIndices.push(w[t].clone());var x=e.lineDistances;for(t=0,n=x.length;t<n;t++)this.lineDistances.push(x[t]);var E=e.boundingBox;null!==E&&(this.boundingBox=E.clone());var M=e.boundingSphere;return null!==M&&(this.boundingSphere=M.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(_i.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(_i.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new zn),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new jt),t[n++]=o.x,t[n++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new Nt),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new xn),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(Bi.prototype=Object.create(_i.prototype)).constructor=Bi,(Ri.prototype=Object.create(_i.prototype)).constructor=Ri,(Pi.prototype=Object.create(_i.prototype)).constructor=Pi,(Di.prototype=Object.create(_i.prototype)).constructor=Di,(Ii.prototype=Object.create(_i.prototype)).constructor=Ii,(Oi.prototype=Object.create(_i.prototype)).constructor=Oi,(ki.prototype=Object.create(_i.prototype)).constructor=ki,(ji.prototype=Object.create(_i.prototype)).constructor=ji,(Hi.prototype=Object.create(_i.prototype)).constructor=Hi,Object.assign(Fi.prototype,{computeGroups:function(e){for(var t,n=[],i=void 0,r=e.faces,o=0;o<r.length;o++){var a=r[o];a.materialIndex!==i&&(i=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,n.push(t)),t={start:3*o,materialIndex:i})}void 0!==t&&(t.count=3*o-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,i=e.vertices,r=e.faceVertexUvs,o=r[0]&&0<r[0].length,a=r[1]&&0<r[1].length,s=e.morphTargets,c=s.length;if(0<c){t=[];for(var l=0;l<c;l++)t[l]={name:s[l].name,data:[]};this.morphTargets.position=t}var u,h=e.morphNormals,d=h.length;if(0<d){u=[];for(l=0;l<d;l++)u[l]={name:h[l].name,data:[]};this.morphTargets.normal=u}var p=e.skinIndices,f=e.skinWeights,m=p.length===i.length,v=f.length===i.length;0<i.length&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(l=0;l<n.length;l++){var g=n[l];this.vertices.push(i[g.a],i[g.b],i[g.c]);var y=g.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var A=g.normal;this.normals.push(A,A,A)}var b,w=g.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var x=g.color;this.colors.push(x,x,x)}if(!0===o)void 0!==(b=r[0][l])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new jt,new jt,new jt));if(!0===a)void 0!==(b=r[1][l])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new jt,new jt,new jt));for(var E=0;E<c;E++){var M=s[E].vertices;t[E].data.push(M[g.a],M[g.b],M[g.c])}for(E=0;E<d;E++){var T=h[E].vertexNormals[l];u[E].data.push(T.a,T.b,T.c)}m&&this.skinIndices.push(p[g.a],p[g.b],p[g.c]),v&&this.skinWeights.push(f[g.a],f[g.b],f[g.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var zi,Ui,Gi,Vi,Wi,qi,Xi,Qi,Yi,Zi,Ki=1;function Ji(){Object.defineProperty(this,"id",{value:Ki+=2}),this.uuid=kt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function $i(e,t,n,i,r,o){Li.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new er(e,t,n,i,r,o)),this.mergeVertices()}function er(e,t,n,i,r,o){Ji.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};var _=this;e=e||1,t=t||1,n=n||1,i=Math.floor(i)||1,r=Math.floor(r)||1,o=Math.floor(o)||1;var B=[],R=[],P=[],D=[],I=0,O=0;function a(e,t,n,i,r,o,a,s,c,l,u){var h,d,p=o/c,f=a/l,m=o/2,v=a/2,g=s/2,y=c+1,A=l+1,b=0,w=0,x=new Nt;for(d=0;d<A;d++){var E=d*f-v;for(h=0;h<y;h++){var M=h*p-m;x[e]=M*i,x[t]=E*r,x[n]=g,R.push(x.x,x.y,x.z),x[e]=0,x[t]=0,x[n]=0<s?1:-1,P.push(x.x,x.y,x.z),D.push(h/c),D.push(1-d/l),b+=1}}for(d=0;d<l;d++)for(h=0;h<c;h++){var T=I+h+y*d,S=I+h+y*(d+1),C=I+(h+1)+y*(d+1),L=I+(h+1)+y*d;B.push(T,S,L),B.push(S,C,L),w+=6}_.addGroup(O,w,u),O+=w,I+=b}a("z","y","x",-1,-1,n,t,e,o,r,0),a("z","y","x",1,-1,n,t,-e,o,r,1),a("x","z","y",1,1,e,n,t,i,o,2),a("x","z","y",1,-1,e,n,-t,i,o,3),a("x","y","z",1,-1,e,t,n,i,r,4),a("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(B),this.addAttribute("position",new ji(R,3)),this.addAttribute("normal",new ji(P,3)),this.addAttribute("uv",new ji(D,2))}function tr(e,t,n,i){Li.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new nr(e,t,n,i)),this.mergeVertices()}function nr(e,t,n,i){Ji.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};var r,o,a=(e=e||1)/2,s=(t=t||1)/2,c=Math.floor(n)||1,l=Math.floor(i)||1,u=c+1,h=l+1,d=e/c,p=t/l,f=[],m=[],v=[],g=[];for(o=0;o<h;o++){var y=o*p-s;for(r=0;r<u;r++){var A=r*d-a;m.push(A,-y,0),v.push(0,0,1),g.push(r/c),g.push(1-o/l)}}for(o=0;o<l;o++)for(r=0;r<c;r++){var b=r+u*o,w=r+u*(o+1),x=r+1+u*(o+1),E=r+1+u*o;f.push(b,w,E),f.push(w,x,E)}this.setIndex(f),this.addAttribute("position",new ji(m,3)),this.addAttribute("normal",new ji(v,3)),this.addAttribute("uv",new ji(g,2))}Ji.prototype=Object.assign(Object.create(t.prototype),{constructor:Ji,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<Ni(e)?ki:Ii)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?("index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t)):this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new _i(t,arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new zt).getNormalMatrix(e).applyToBufferAttribute(n),n.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:(Zi=new Ht,function(e){return Zi.makeRotationX(e),this.applyMatrix(Zi),this}),rotateY:(Yi=new Ht,function(e){return Yi.makeRotationY(e),this.applyMatrix(Yi),this}),rotateZ:(Qi=new Ht,function(e){return Qi.makeRotationZ(e),this.applyMatrix(Qi),this}),translate:(Xi=new Ht,function(e,t,n){return Xi.makeTranslation(e,t,n),this.applyMatrix(Xi),this}),scale:(qi=new Ht,function(e,t,n){return qi.makeScale(e,t,n),this.applyMatrix(qi),this}),lookAt:(Wi=new Ai,function(e){Wi.lookAt(e),Wi.updateMatrix(),this.applyMatrix(Wi.matrix)}),center:(Vi=new Nt,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Vi).negate(),this.translate(Vi.x,Vi.y,Vi.z),this}),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new ji(3*t.vertices.length,3),i=new ji(3*t.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(t.vertices)),this.addAttribute("color",i.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var r=new ji(t.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];t.push(r.x,r.y,r.z||0)}return this.addAttribute("position",new ji(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var i=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(i=void 0,n.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(n);i.verticesNeedUpdate=n.verticesNeedUpdate,i.normalsNeedUpdate=n.normalsNeedUpdate,i.colorsNeedUpdate=n.colorsNeedUpdate,i.uvsNeedUpdate=n.uvsNeedUpdate,i.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=i}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Fi).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new _i(t,3).copyVector3sArray(e.vertices)),0<e.normals.length){var n=new Float32Array(3*e.normals.length);this.addAttribute("normal",new _i(n,3).copyVector3sArray(e.normals))}if(0<e.colors.length){var i=new Float32Array(3*e.colors.length);this.addAttribute("color",new _i(i,3).copyColorsArray(e.colors))}if(0<e.uvs.length){var r=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new _i(r,2).copyVector2sArray(e.uvs))}if(0<e.uvs2.length){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new _i(o,2).copyVector2sArray(e.uvs2))}for(var a in this.groups=e.groups,e.morphTargets){for(var s=[],c=e.morphTargets[a],l=0,u=c.length;l<u;l++){var h=c[l],d=new ji(3*h.data.length,3);d.name=h.name,s.push(d.copyVector3sArray(h.data))}this.morphAttributes[a]=s}if(0<e.skinIndices.length){var p=new ji(4*e.skinIndices.length,4);this.addAttribute("skinIndex",p.copyVector4sArray(e.skinIndices))}if(0<e.skinWeights.length){var f=new ji(4*e.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Cn);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:(Ui=new Cn,Gi=new Nt,function(){null===this.boundingSphere&&(this.boundingSphere=new Ln);var e=this.attributes.position;if(e){var t=this.boundingSphere.center;Ui.setFromBufferAttribute(e),Ui.getCenter(t);for(var n=0,i=0,r=e.count;i<r;i++)Gi.x=e.getX(i),Gi.y=e.getY(i),Gi.z=e.getZ(i),n=Math.max(n,t.distanceToSquared(Gi));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new _i(new Float32Array(n.length),3));else for(var i=t.normal.array,r=0,o=i.length;r<o;r++)i[r]=0;var a,s,c,l=t.normal.array,u=new Nt,h=new Nt,d=new Nt,p=new Nt,f=new Nt;if(e){var m=e.array;for(r=0,o=e.count;r<o;r+=3)a=3*m[r+0],s=3*m[r+1],c=3*m[r+2],u.fromArray(n,a),h.fromArray(n,s),d.fromArray(n,c),p.subVectors(d,h),f.subVectors(u,h),p.cross(f),l[a]+=p.x,l[1+a]+=p.y,l[2+a]+=p.z,l[s]+=p.x,l[1+s]+=p.y,l[2+s]+=p.z,l[c]+=p.x,l[1+c]+=p.y,l[2+c]+=p.z}else for(r=0,o=n.length;r<o;r+=9)u.fromArray(n,r),h.fromArray(n,r+3),d.fromArray(n,r+6),p.subVectors(d,h),f.subVectors(u,h),p.cross(f),l[r]=p.x,l[r+1]=p.y,l[r+2]=p.z,l[r+3]=p.x,l[r+4]=p.y,l[r+5]=p.z,l[r+6]=p.x,l[r+7]=p.y,l[r+8]=p.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var i in n)if(void 0!==e.attributes[i])for(var r=n[i].array,o=e.attributes[i],a=o.array,s=0,c=o.itemSize*t;s<a.length;s++,c++)r[c]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:(zi=new Nt,function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)zi.x=e.getX(t),zi.y=e.getY(t),zi.z=e.getZ(t),zi.normalize(),e.setXYZ(t,zi.x,zi.y,zi.z)}),toNonIndexed:function(){function e(e,t){for(var n=e.array,i=e.itemSize,r=new n.constructor(t.length*i),o=0,a=0,s=0,c=t.length;s<c;s++){o=t[s]*i;for(var l=0;l<i;l++)r[a++]=n[o++]}return new _i(r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Ji,n=this.index.array,i=this.attributes;for(var r in i){var o=e(i[r],n);t.addAttribute(r,o)}var a=this.morphAttributes;for(r in a){for(var s=[],c=a[r],l=0,u=c.length;l<u;l++){o=e(c[l],n);s.push(o)}t.morphAttributes[r]=s}for(var h=this.groups,d=(l=0,h.length);l<d;l++){var p=h[l];t.addGroup(p.start,p.count,p.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),0<Object.keys(this.userData).length&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var i=this.index;if(null!==i){var r=Array.prototype.slice.call(i.array);e.data.index={type:i.array.constructor.name,array:r}}var o=this.attributes;for(var n in o){var a=o[n];r=Array.prototype.slice.call(a.array);e.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:r,normalized:a.normalized}}var s=this.groups;0<s.length&&(e.data.groups=JSON.parse(JSON.stringify(s)));var c=this.boundingSphere;return null!==c&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e},clone:function(){return(new Ji).copy(this)},copy:function(e){var t,n,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var r=e.index;null!==r&&this.setIndex(r.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var c=[],l=s[t];for(n=0,i=l.length;n<i;n++)c.push(l[n].clone());this.morphAttributes[t]=c}var u=e.groups;for(n=0,i=u.length;n<i;n++){var h=u[n];this.addGroup(h.start,h.count,h.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),($i.prototype=Object.create(Li.prototype)).constructor=$i,(er.prototype=Object.create(Ji.prototype)).constructor=er,(tr.prototype=Object.create(Li.prototype)).constructor=tr,(nr.prototype=Object.create(Ji.prototype)).constructor=nr;var ir,rr,or,ar,sr,cr,lr,ur,hr,dr,pr,fr,mr,vr,gr,yr,Ar,br,wr,xr,Er,Mr,Tr,Sr,Cr,Lr,_r,Br,Rr,Pr,Dr,Ir,Or,kr,jr,Hr,Fr,Nr,zr,Ur=0;function Gr(){Object.defineProperty(this,"id",{value:Ur++}),this.uuid=kt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=K,this.side=O,this.flatShading=!1,this.vertexColors=M,this.opacity=1,this.transparent=!1,this.blendSrc=D,this.blendDst=I,this.blendEquation=ne,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ae,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}function Vr(e){Gr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Wr(e,t){this.origin=void 0!==e?e:new Nt,this.direction=void 0!==t?t:new Nt}function qr(e,t,n){this.a=void 0!==e?e:new Nt,this.b=void 0!==t?t:new Nt,this.c=void 0!==n?n:new Nt}function Xr(e){Gr.call(this),this.type="MeshBasicMaterial",this.color=new zn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=G,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Qr(e,t){Ai.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Ji,this.material=void 0!==t?t:new Xr({color:16777215*Math.random()}),this.drawMode=Mt,this.updateMorphTargets()}function Yr(a,n,s,i){var c,l,u=new zn(0),h=0,d=null,p=0;function f(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return u},setClearColor:function(e,t){u.set(e),f(u,h=void 0!==t?t:1)},getClearAlpha:function(){return h},setClearAlpha:function(e){f(u,h=e)},render:function(e,t,n,i){var r=t.background;if(null===r?(f(u,h),d=null,p=0):r&&r.isColor&&(f(r,1),i=!0,d=null,p=0),(a.autoClear||i)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),r&&(r.isCubeTexture||r.isWebGLRenderTargetCube)){void 0===l&&((l=new Qr(new er(1,1,1),new Vr({type:"BackgroundCubeMaterial",uniforms:In(Qn.cube.uniforms),vertexShader:Qn.cube.vertexShader,fragmentShader:Qn.cube.fragmentShader,side:xe,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),l.geometry.removeAttribute("uv"),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.tCube.value}}),s.update(l));var o=r.isWebGLRenderTargetCube?r.texture:r;l.material.uniforms.tCube.value=o,l.material.uniforms.tFlip.value=r.isWebGLRenderTargetCube?1:-1,d===r&&p===o.version||(l.material.needsUpdate=!0,d=r,p=o.version),e.unshift(l,l.geometry,l.material,0,0,null)}else r&&r.isTexture&&(void 0===c&&((c=new Qr(new nr(2,2),new Vr({type:"BackgroundMaterial",uniforms:In(Qn.background.uniforms),vertexShader:Qn.background.vertexShader,fragmentShader:Qn.background.fragmentShader,side:O,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(c)),!0===(c.material.uniforms.t2D.value=r).matrixAutoUpdate&&r.updateMatrix(),c.material.uniforms.uvTransform.value.copy(r.matrix),d===r&&p===r.version||(c.material.needsUpdate=!0,p=(d=r).version),e.unshift(c,c.geometry,c.material,0,0,null))}}}function Zr(r,o,a,s){var c;this.setMode=function(e){c=e},this.render=function(e,t){r.drawArrays(c,e,t),a.update(t,c)},this.renderInstances=function(e,t,n){var i;if(s.isWebGL2)i=r;else if(null===(i=o.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");i[s.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](c,t,n,e.maxInstancedCount),a.update(n,c,e.maxInstancedCount)}}function Kr(t,n,e){var i;function r(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(35633,36338).precision&&0<t.getShaderPrecisionFormat(35632,36338).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(35633,36337).precision&&0<t.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,a=void 0!==e.precision?e.precision:"highp",s=r(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var c=!0===e.logarithmicDepthBuffer,l=t.getParameter(34930),u=t.getParameter(35660),h=t.getParameter(3379),d=t.getParameter(34076),p=t.getParameter(34921),f=t.getParameter(36347),m=t.getParameter(36348),v=t.getParameter(36349),g=0<u,y=o||!!n.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==i)return i;var e=n.get("EXT_texture_filter_anisotropic");return i=null!==e?t.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:c,maxTextures:l,maxVertexTextures:u,maxTextureSize:h,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y,maxSamples:o?t.getParameter(36183):0}}function Jr(){var u=this,h=null,d=0,p=!1,f=!1,m=new _n,v=new zt,g={value:null,needsUpdate:!1};function y(){g.value!==h&&(g.value=h,g.needsUpdate=0<d),u.numPlanes=d,u.numIntersection=0}function A(e,t,n,i){var r=null!==e?e.length:0,o=null;if(0!==r){if(o=g.value,!0!==i||null===o){var a=n+4*r,s=t.matrixWorldInverse;v.getNormalMatrix(s),(null===o||o.length<a)&&(o=new Float32Array(a));for(var c=0,l=n;c!==r;++c,l+=4)m.copy(e[c]).applyMatrix4(s,v),m.normal.toArray(o,l),o[l+3]=m.constant}g.value=o,g.needsUpdate=!0}return u.numPlanes=r,o}this.uniform=g,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,n){var i=0!==e.length||t||0!==d||p;return p=t,h=A(e,n,0),d=e.length,i},this.beginShadows=function(){f=!0,A(null)},this.endShadows=function(){f=!1,y()},this.setState=function(e,t,n,i,r,o){if(!p||null===e||0===e.length||f&&!n)f?A(null):y();else{var a=f?0:d,s=4*a,c=r.clippingState||null;g.value=c,c=A(e,i,s,o);for(var l=0;l!==s;++l)c[l]=h[l];r.clippingState=c,this.numIntersection=t?this.numPlanes:0,this.numPlanes+=a}}}function $r(n){var i={};return{get:function(e){if(void 0!==i[e])return i[e];var t;switch(e){case"WEBGL_depth_texture":t=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":t=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":t=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":t=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:t=n.getExtension(e)}return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),i[e]=t}}}function eo(e,h,o){var a={},d={};function s(e){var t=e.target,n=a[t.id];for(var i in null!==n.index&&h.remove(n.index),n.attributes)h.remove(n.attributes[i]);t.removeEventListener("dispose",s),delete a[t.id];var r=d[n.id];r&&(h.remove(r),delete d[n.id]),o.memory.geometries--}return{get:function(e,t){var n=a[t.id];return n||(t.addEventListener("dispose",s),t.isBufferGeometry?n=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Ji).setFromObject(e)),n=t._bufferGeometry),a[t.id]=n,o.memory.geometries++,n)},update:function(e){var t=e.index,n=e.attributes;for(var i in null!==t&&h.update(t,34963),n)h.update(n[i],34962);var r=e.morphAttributes;for(var i in r)for(var o=r[i],a=0,s=o.length;a<s;a++)h.update(o[a],34962)},getWireframeAttribute:function(e){var t=d[e.id];if(t)return t;var n=[],i=e.index,r=e.attributes;if(null!==i)for(var o=0,a=(u=i.array).length;o<a;o+=3){var s=u[o+0],c=u[o+1],l=u[o+2];n.push(s,c,c,l,l,s)}else{var u;for(o=0,a=(u=r.position.array).length/3-1;o<a;o+=3){s=o+0,c=o+1,l=o+2;n.push(s,c,c,l,l,s)}}return t=new(65535<Ni(n)?ki:Ii)(n,1),h.update(t,34963),d[e.id]=t}}}function to(r,o,a,s){var c,l,u;this.setMode=function(e){c=e},this.setIndex=function(e){l=e.type,u=e.bytesPerElement},this.render=function(e,t){r.drawElements(c,t,l,e*u),a.update(t,c)},this.renderInstances=function(e,t,n){if(s.isWebGL2)i=r;else{var i=o.get("ANGLE_instanced_arrays");if(null===i)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}i[s.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](c,n,l,t*u,e.maxInstancedCount),a.update(n,c,e.maxInstancedCount)}}function no(e){var i={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:i,programs:null,autoReset:!0,reset:function(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0},update:function(e,t,n){switch(n=n||1,i.calls++,t){case 4:i.triangles+=n*(e/3);break;case 5:case 6:i.triangles+=n*(e-2);break;case 1:i.lines+=n*(e/2);break;case 3:i.lines+=n*(e-1);break;case 2:i.lines+=n*e;break;case 0:i.points+=n*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",t)}}}}function io(e,t){return Math.abs(t[1])-Math.abs(e[1])}function ro(p){var f={},m=new Float32Array(8);return{update:function(e,t,n,i){var r=e.morphTargetInfluences,o=r.length,a=f[t.id];if(void 0===a){a=[];for(var s=0;s<o;s++)a[s]=[s,0];f[t.id]=a}var c=n.morphTargets&&t.morphAttributes.position,l=n.morphNormals&&t.morphAttributes.normal;for(s=0;s<o;s++){0!==(u=a[s])[1]&&(c&&t.removeAttribute("morphTarget"+s),l&&t.removeAttribute("morphNormal"+s))}for(s=0;s<o;s++){(u=a[s])[0]=s,u[1]=r[s]}a.sort(io);for(s=0;s<8;s++){var u;if(u=a[s]){var h=u[0],d=u[1];if(d){c&&t.addAttribute("morphTarget"+s,c[h]),l&&t.addAttribute("morphNormal"+s,l[h]),m[s]=d;continue}}m[s]=0}i.getUniforms().setValue(p,"morphTargetInfluences",m)}}}function oo(r,o){var a={};return{update:function(e){var t=o.render.frame,n=e.geometry,i=r.get(e,n);return a[i.id]!==t&&(n.isGeometry&&i.updateFromObject(e),r.update(i),a[i.id]=t),i},dispose:function(){a={}}}}function ao(e,t,n,i,r,o,a,s,c,l){wn.call(this,e=void 0!==e?e:[],t=void 0!==t?t:ve,n,i,r,o,a,s,c,l),this.flipY=!1}function so(e,t,n,i){wn.call(this,null),this.image={data:e,width:t,height:n,depth:i},this.magFilter=Le,this.minFilter=Le,this.generateMipmaps=!1,this.flipY=!1}function co(e,t,n,i,r,o,a,s){if(null===(t.side===xe?i.intersectTriangle(a,o,r,!0,s):i.intersectTriangle(r,o,a,t.side!==Y,s)))return null;Lr.copy(s),Lr.applyMatrix4(e.matrixWorld);var c=n.ray.origin.distanceTo(Lr);return c<n.near||c>n.far?null:{distance:c,point:Lr.clone(),object:e}}function lo(e,t,n,i,r,o,a,s,c){yr.fromBufferAttribute(r,a),Ar.fromBufferAttribute(r,s),br.fromBufferAttribute(r,c);var l=co(e,t,n,i,yr,Ar,br,Cr);if(l){o&&(Mr.fromBufferAttribute(o,a),Tr.fromBufferAttribute(o,s),Sr.fromBufferAttribute(o,c),l.uv=qr.getUV(Cr,yr,Ar,br,Mr,Tr,Sr,new jt));var u=new Kn(a,s,c);qr.getNormal(yr,Ar,br,u.normal),l.face=u}return l}Gr.prototype=Object.assign(Object.create(t.prototype),{constructor:Gr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){var t=[];for(var n in e){var i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==K&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==O&&(n.side=this.side),this.vertexColors!==M&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var r=i(e.textures),o=i(e.images);0<r.length&&(n.textures=r),0<o.length&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(null!==t){var i=t.length;n=new Array(i);for(var r=0;r!==i;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),((Vr.prototype=Object.create(Gr.prototype)).constructor=Vr).prototype.isShaderMaterial=!0,Vr.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=In(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Vr.prototype.toJSON=function(e){var t=Gr.prototype.toJSON.call(this,e);for(var n in t.uniforms={},this.uniforms){var i=this.uniforms[n].value;i&&i.isTexture?t.uniforms[n]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[n]={type:"m4",value:i.toArray()}:t.uniforms[n]={value:i}}0<Object.keys(this.defines).length&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var r={};for(var o in this.extensions)!0===this.extensions[o]&&(r[o]=!0);return 0<Object.keys(r).length&&(t.extensions=r),t},Object.assign(Wr.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Nt),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:(zr=new Nt,function(e){return this.origin.copy(this.at(e,zr)),this}),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Nt),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:(Nr=new Nt,function(e){var t=Nr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Nr.copy(this.direction).multiplyScalar(t).add(this.origin),Nr.distanceToSquared(e))}),distanceSqToSegment:(rr=new Nt,or=new Nt,ar=new Nt,function(e,t,n,i){rr.copy(e).add(t).multiplyScalar(.5),or.copy(t).sub(e).normalize(),ar.copy(this.origin).sub(rr);var r,o,a,s,c=.5*e.distanceTo(t),l=-this.direction.dot(or),u=ar.dot(this.direction),h=-ar.dot(or),d=ar.lengthSq(),p=Math.abs(1-l*l);if(0<p)if(o=l*u-h,s=c*p,0<=(r=l*h-u))if(-s<=o)if(o<=s){var f=1/p;a=(r*=f)*(r+l*(o*=f)+2*u)+o*(l*r+o+2*h)+d}else o=c,a=-(r=Math.max(0,-(l*o+u)))*r+o*(o+2*h)+d;else o=-c,a=-(r=Math.max(0,-(l*o+u)))*r+o*(o+2*h)+d;else a=o<=-s?-(r=Math.max(0,-(-l*c+u)))*r+(o=0<r?-c:Math.min(Math.max(-c,-h),c))*(o+2*h)+d:o<=s?(r=0,(o=Math.min(Math.max(-c,-h),c))*(o+2*h)+d):-(r=Math.max(0,-(l*c+u)))*r+(o=0<r?c:Math.min(Math.max(-c,-h),c))*(o+2*h)+d;else o=0<l?-c:c,a=-(r=Math.max(0,-(l*o+u)))*r+o*(o+2*h)+d;return n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(or).multiplyScalar(o).add(rr),a}),intersectSphere:(Fr=new Nt,function(e,t){Fr.subVectors(e.center,this.origin);var n=Fr.dot(this.direction),i=Fr.dot(Fr)-n*n,r=e.radius*e.radius;if(r<i)return null;var o=Math.sqrt(r-i),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,t):this.at(a,t)}),intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return 0<=n?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,i,r,o,a,s,c=1/this.direction.x,l=1/this.direction.y,u=1/this.direction.z,h=this.origin;return i=0<=c?(n=(e.min.x-h.x)*c,(e.max.x-h.x)*c):(n=(e.max.x-h.x)*c,(e.min.x-h.x)*c),(o=0<=l?(r=(e.min.y-h.y)*l,(e.max.y-h.y)*l):(r=(e.max.y-h.y)*l,(e.min.y-h.y)*l))<n||i<r?null:((n<r||n!=n)&&(n=r),(o<i||i!=i)&&(i=o),(s=0<=u?(a=(e.min.z-h.z)*u,(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,(e.min.z-h.z)*u))<n||i<a?null:((n<a||n!=n)&&(n=a),(s<i||i!=i)&&(i=s),i<0?null:this.at(0<=n?n:i,t)))},intersectsBox:(ir=new Nt,function(e){return null!==this.intersectBox(e,ir)}),intersectTriangle:(Or=new Nt,kr=new Nt,jr=new Nt,Hr=new Nt,function(e,t,n,i,r){kr.subVectors(t,e),jr.subVectors(n,e),Hr.crossVectors(kr,jr);var o,a=this.direction.dot(Hr);if(0<a){if(i)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Or.subVectors(this.origin,e);var s=o*this.direction.dot(jr.crossVectors(Or,jr));if(s<0)return null;var c=o*this.direction.dot(kr.cross(Or));if(c<0)return null;if(a<s+c)return null;var l=-o*Or.dot(Hr);return l<0?null:this.at(l/a,r)}),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(qr,{getNormal:(cr=new Nt,function(e,t,n,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new Nt),i.subVectors(n,t),cr.subVectors(e,t),i.cross(cr);var r=i.lengthSq();return 0<r?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}),getBarycoord:(Pr=new Nt,Dr=new Nt,Ir=new Nt,function(e,t,n,i,r){Pr.subVectors(i,t),Dr.subVectors(n,t),Ir.subVectors(e,t);var o=Pr.dot(Pr),a=Pr.dot(Dr),s=Pr.dot(Ir),c=Dr.dot(Dr),l=Dr.dot(Ir),u=o*c-a*a;if(void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new Nt),0==u)return r.set(-2,-1,-1);var h=1/u,d=(c*s-a*l)*h,p=(o*l-a*s)*h;return r.set(1-d-p,p,d)}),containsPoint:(Rr=new Nt,function(e,t,n,i){return qr.getBarycoord(e,t,n,i,Rr),0<=Rr.x&&0<=Rr.y&&Rr.x+Rr.y<=1}),getUV:(sr=new Nt,function(e,t,n,i,r,o,a,s){return this.getBarycoord(e,t,n,i,sr),s.set(0,0),s.addScaledVector(r,sr.x),s.addScaledVector(o,sr.y),s.addScaledVector(a,sr.z),s})}),Object.assign(qr.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:(_r=new Nt,Br=new Nt,function(){return _r.subVectors(this.c,this.b),Br.subVectors(this.a,this.b),.5*_r.cross(Br).length()}),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Nt),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return qr.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Nt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return qr.getBarycoord(e,this.a,this.b,this.c,t)},containsPoint:function(e){return qr.containsPoint(e,this.a,this.b,this.c)},getUV:function(e,t,n,i,r){return qr.getUV(e,this.a,this.b,this.c,t,n,i,r)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:(lr=new Nt,ur=new Nt,hr=new Nt,dr=new Nt,pr=new Nt,fr=new Nt,function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Nt);var n,i,r=this.a,o=this.b,a=this.c;lr.subVectors(o,r),ur.subVectors(a,r),dr.subVectors(e,r);var s=lr.dot(dr),c=ur.dot(dr);if(s<=0&&c<=0)return t.copy(r);pr.subVectors(e,o);var l=lr.dot(pr),u=ur.dot(pr);if(0<=l&&u<=l)return t.copy(o);var h=s*u-l*c;if(h<=0&&0<=s&&l<=0)return n=s/(s-l),t.copy(r).addScaledVector(lr,n);fr.subVectors(e,a);var d=lr.dot(fr),p=ur.dot(fr);if(0<=p&&d<=p)return t.copy(a);var f=d*c-s*p;if(f<=0&&0<=c&&p<=0)return i=c/(c-p),t.copy(r).addScaledVector(ur,i);var m=l*p-d*u;if(m<=0&&0<=u-l&&0<=d-p)return hr.subVectors(a,o),i=(u-l)/(u-l+(d-p)),t.copy(o).addScaledVector(hr,i);var v=1/(m+f+h);return n=f*v,i=h*v,t.copy(r).addScaledVector(lr,n).addScaledVector(ur,i)}),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),((Xr.prototype=Object.create(Gr.prototype)).constructor=Xr).prototype.isMeshBasicMaterial=!0,Xr.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Qr.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Qr,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return Ai.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,i=this.geometry;if(i.isBufferGeometry){var r=i.morphAttributes,o=Object.keys(r);if(0<o.length){var a=r[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)n=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=i.morphTargets;void 0!==s&&0<s.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:(mr=new Ht,vr=new Wr,gr=new Ln,yr=new Nt,Ar=new Nt,br=new Nt,wr=new Nt,xr=new Nt,Er=new Nt,Mr=new jt,Tr=new jt,Sr=new jt,Cr=new Nt,Lr=new Nt,function(e,t){var n,i=this.geometry,r=this.material,o=this.matrixWorld;if(void 0!==r&&(null===i.boundingSphere&&i.computeBoundingSphere(),gr.copy(i.boundingSphere),gr.applyMatrix4(o),!1!==e.ray.intersectsSphere(gr)&&(mr.getInverse(o),vr.copy(e.ray).applyMatrix4(mr),null===i.boundingBox||!1!==vr.intersectsBox(i.boundingBox))))if(i.isBufferGeometry){var a,s,c,l,u,h,d,p,f,m=i.index,v=i.attributes.position,g=i.attributes.uv,y=i.groups,A=i.drawRange;if(null!==m)if(Array.isArray(r))for(l=0,h=y.length;l<h;l++)for(f=r[(p=y[l]).materialIndex],u=Math.max(p.start,A.start),d=Math.min(p.start+p.count,A.start+A.count);u<d;u+=3)a=m.getX(u),s=m.getX(u+1),c=m.getX(u+2),(n=lo(this,f,e,vr,v,g,a,s,c))&&(n.faceIndex=Math.floor(u/3),n.face.materialIndex=p.materialIndex,t.push(n));else for(l=Math.max(0,A.start),h=Math.min(m.count,A.start+A.count);l<h;l+=3)a=m.getX(l),s=m.getX(l+1),c=m.getX(l+2),(n=lo(this,r,e,vr,v,g,a,s,c))&&(n.faceIndex=Math.floor(l/3),t.push(n));else if(void 0!==v)if(Array.isArray(r))for(l=0,h=y.length;l<h;l++)for(f=r[(p=y[l]).materialIndex],u=Math.max(p.start,A.start),d=Math.min(p.start+p.count,A.start+A.count);u<d;u+=3)(n=lo(this,f,e,vr,v,g,a=u,s=u+1,c=u+2))&&(n.faceIndex=Math.floor(u/3),n.face.materialIndex=p.materialIndex,t.push(n));else for(l=Math.max(0,A.start),h=Math.min(v.count,A.start+A.count);l<h;l+=3)(n=lo(this,r,e,vr,v,g,a=l,s=l+1,c=l+2))&&(n.faceIndex=Math.floor(l/3),t.push(n))}else if(i.isGeometry){var b,w,x,E,M=Array.isArray(r),T=i.vertices,S=i.faces,C=i.faceVertexUvs[0];0<C.length&&(E=C);for(var L=0,_=S.length;L<_;L++){var B=S[L],R=M?r[B.materialIndex]:r;if(void 0!==R){if(b=T[B.a],w=T[B.b],x=T[B.c],!0===R.morphTargets){var P=i.morphTargets,D=this.morphTargetInfluences;yr.set(0,0,0),Ar.set(0,0,0),br.set(0,0,0);for(var I=0,O=P.length;I<O;I++){var k=D[I];if(0!==k){var j=P[I].vertices;yr.addScaledVector(wr.subVectors(j[B.a],b),k),Ar.addScaledVector(xr.subVectors(j[B.b],w),k),br.addScaledVector(Er.subVectors(j[B.c],x),k)}}yr.add(b),Ar.add(w),br.add(x),b=yr,w=Ar,x=br}if(n=co(this,R,e,vr,b,w,x,Cr)){if(E&&E[L]){var H=E[L];Mr.copy(H[0]),Tr.copy(H[1]),Sr.copy(H[2]),n.uv=qr.getUV(Cr,b,w,x,Mr,Tr,Sr,new jt)}n.face=B,n.faceIndex=L,t.push(n)}}}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),((ao.prototype=Object.create(wn.prototype)).constructor=ao).prototype.isCubeTexture=!0,Object.defineProperty(ao.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),((so.prototype=Object.create(wn.prototype)).constructor=so).prototype.isDataTexture3D=!0;var uo=new wn,ho=new so,po=new ao;function fo(){this.seq=[],this.map={}}var mo=[],vo=[],go=new Float32Array(16),yo=new Float32Array(9),Ao=new Float32Array(4);function bo(e,t,n){var i=e[0];if(i<=0||0<i)return e;var r=t*n,o=mo[r];if(void 0===o&&(o=new Float32Array(r),mo[r]=o),0!==t){i.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=n,e[a].toArray(o,s)}return o}function wo(e,t){if(e.length!==t.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function xo(e,t){for(var n=0,i=t.length;n<i;n++)e[n]=t[n]}function Eo(e,t){var n=vo[t];void 0===n&&(n=new Int32Array(t),vo[t]=n);for(var i=0;i!==t;++i)n[i]=e.allocTextureUnit();return n}function Mo(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function To(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function So(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(wo(n,t))return;e.uniform2fv(this.addr,t),xo(n,t)}}function Co(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(wo(n,t))return;e.uniform3fv(this.addr,t),xo(n,t)}}function Lo(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(wo(n,t))return;e.uniform4fv(this.addr,t),xo(n,t)}}function _o(e,t){var n=this.cache,i=t.elements;if(void 0===i){if(wo(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),xo(n,t)}else{if(wo(n,i))return;Ao.set(i),e.uniformMatrix2fv(this.addr,!1,Ao),xo(n,i)}}function Bo(e,t){var n=this.cache,i=t.elements;if(void 0===i){if(wo(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),xo(n,t)}else{if(wo(n,i))return;yo.set(i),e.uniformMatrix3fv(this.addr,!1,yo),xo(n,i)}}function Ro(e,t){var n=this.cache,i=t.elements;if(void 0===i){if(wo(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),xo(n,t)}else{if(wo(n,i))return;go.set(i),e.uniformMatrix4fv(this.addr,!1,go),xo(n,i)}}function Po(e,t,n){var i=this.cache,r=n.allocTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(t||uo,r)}function Do(e,t,n){var i=this.cache,r=n.allocTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||ho,r)}function Io(e,t,n){var i=this.cache,r=n.allocTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(t||po,r)}function Oo(e,t){var n=this.cache;wo(n,t)||(e.uniform2iv(this.addr,t),xo(n,t))}function ko(e,t){var n=this.cache;wo(n,t)||(e.uniform3iv(this.addr,t),xo(n,t))}function jo(e,t){var n=this.cache;wo(n,t)||(e.uniform4iv(this.addr,t),xo(n,t))}function Ho(e,t){var n=this.cache;wo(n,t)||(e.uniform1fv(this.addr,t),xo(n,t))}function Fo(e,t){var n=this.cache;wo(n,t)||(e.uniform1iv(this.addr,t),xo(n,t))}function No(e,t){var n=this.cache,i=bo(t,this.size,2);wo(n,i)||(e.uniform2fv(this.addr,i),this.updateCache(i))}function zo(e,t){var n=this.cache,i=bo(t,this.size,3);wo(n,i)||(e.uniform3fv(this.addr,i),this.updateCache(i))}function Uo(e,t){var n=this.cache,i=bo(t,this.size,4);wo(n,i)||(e.uniform4fv(this.addr,i),this.updateCache(i))}function Go(e,t){var n=this.cache,i=bo(t,this.size,4);wo(n,i)||(e.uniformMatrix2fv(this.addr,!1,i),this.updateCache(i))}function Vo(e,t){var n=this.cache,i=bo(t,this.size,9);wo(n,i)||(e.uniformMatrix3fv(this.addr,!1,i),this.updateCache(i))}function Wo(e,t){var n=this.cache,i=bo(t,this.size,16);wo(n,i)||(e.uniformMatrix4fv(this.addr,!1,i),this.updateCache(i))}function qo(e,t,n){var i=this.cache,r=t.length,o=Eo(n,r);!1===wo(i,o)&&(e.uniform1iv(this.addr,o),xo(i,o));for(var a=0;a!==r;++a)n.setTexture2D(t[a]||uo,o[a])}function Xo(e,t,n){var i=this.cache,r=t.length,o=Eo(n,r);!1===wo(i,o)&&(e.uniform1iv(this.addr,o),xo(i,o));for(var a=0;a!==r;++a)n.setTextureCube(t[a]||po,o[a])}function Qo(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(){switch(t.type){case 5126:return Mo;case 35664:return So;case 35665:return Co;case 35666:return Lo;case 35674:return _o;case 35675:return Bo;case 35676:return Ro;case 35678:case 36198:return Po;case 35679:return Do;case 35680:return Io;case 5124:case 35670:return To;case 35667:case 35671:return Oo;case 35668:case 35672:return ko;case 35669:case 35673:return jo}}()}function Yo(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(){switch(t.type){case 5126:return Ho;case 35664:return No;case 35665:return zo;case 35666:return Uo;case 35674:return Go;case 35675:return Vo;case 35676:return Wo;case 35678:return qo;case 35680:return Xo;case 5124:case 35670:return Fo;case 35667:case 35671:return Oo;case 35668:case 35672:return ko;case 35669:case 35673:return jo}}()}function Zo(e){this.id=e,fo.call(this)}Yo.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),xo(t,e)},Zo.prototype.setValue=function(e,t,n){for(var i=this.seq,r=0,o=i.length;r!==o;++r){var a=i[r];a.setValue(e,t[a.id],n)}};var Ko=/([\w\d_]+)(\])?(\[|\.)?/g;function Jo(e,t){e.seq.push(t),e.map[t.id]=t}function $o(e,t,n){var i=e.name,r=i.length;for(Ko.lastIndex=0;;){var o=Ko.exec(i),a=Ko.lastIndex,s=o[1],c="]"===o[2],l=o[3];if(c&&(s|=0),void 0===l||"["===l&&a+2===r){Jo(n,void 0===l?new Qo(s,e,t):new Yo(s,e,t));break}var u=n.map[s];void 0===u&&Jo(n,u=new Zo(s)),n=u}}function ea(e,t,n){fo.call(this),this.renderer=n;for(var i=e.getProgramParameter(t,35718),r=0;r<i;++r){var o=e.getActiveUniform(t,r);$o(o,e.getUniformLocation(t,o.name),this)}}function ta(e,t,n){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),!1===e.getShaderParameter(i,35713)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",35633===t?"vertex":"fragment",e.getShaderInfoLog(i),function(){for(var e=n.split("\n"),t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}()),i}ea.prototype.setValue=function(e,t,n){var i=this.map[t];void 0!==i&&i.setValue(e,n,this.renderer)},ea.prototype.setOptional=function(e,t,n){var i=t[n];void 0!==i&&this.setValue(e,n,i)},ea.upload=function(e,t,n,i){for(var r=0,o=t.length;r!==o;++r){var a=t[r],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,i)}},ea.seqWithValue=function(e,t){for(var n=[],i=0,r=e.length;i!==r;++i){var o=e[i];o.id in t&&n.push(o)}return n};var na=0;function ia(e){switch(e){case Tt:return["Linear","( value )"];case St:return["sRGB","( value )"];case Lt:return["RGBE","( value )"];case _t:return["RGBM","( value, 7.0 )"];case Bt:return["RGBM","( value, 16.0 )"];case Rt:return["RGBD","( value, 256.0 )"];case Ct:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function ra(e,t){var n=ia(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function oa(e){return""!==e}function aa(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function sa(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function ca(e){return e.replace(/^[ \t]*#include +<([\w\d.\/]+)>/gm,function(e,t){var n=Dn[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return ca(n)})}function la(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,n,i){for(var r="",o=parseInt(t);o<parseInt(n);o++)r+=i.replace(/\[ i \]/g,"[ "+o+" ]");return r})}function ua(e,t,n,i,r,o,a){var s=e.context,c=i.defines,l=r.vertexShader,u=r.fragmentShader,h="SHADOWMAP_TYPE_BASIC";o.shadowMapType===j?h="SHADOWMAP_TYPE_PCF":o.shadowMapType===H&&(h="SHADOWMAP_TYPE_PCF_SOFT");var d="ENVMAP_TYPE_CUBE",p="ENVMAP_MODE_REFLECTION",f="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(i.envMap.mapping){case ve:case ge:d="ENVMAP_TYPE_CUBE";break;case we:case Me:d="ENVMAP_TYPE_CUBE_UV";break;case ye:case Ae:d="ENVMAP_TYPE_EQUIREC";break;case be:d="ENVMAP_TYPE_SPHERE"}switch(i.envMap.mapping){case ge:case Ae:p="ENVMAP_MODE_REFRACTION"}switch(i.combine){case G:f="ENVMAP_BLENDING_MULTIPLY";break;case V:f="ENVMAP_BLENDING_MIX";break;case W:f="ENVMAP_BLENDING_ADD"}}var m,v,g,y,A,b,w=0<e.gammaFactor?e.gammaFactor:1,x=a.isWebGL2?"":(y=i.extensions,A=o,b=t,[(y=y||{}).derivatives||A.envMapCubeUV||A.bumpMap||A.normalMap&&!A.objectSpaceNormalMap||A.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(y.fragDepth||A.logarithmicDepthBuffer)&&b.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",y.drawBuffers&&b.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(y.shaderTextureLOD||A.envMap)&&b.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(oa).join("\n")),E=function(e){var t=[];for(var n in e){var i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(c),M=s.createProgram();if(i.isRawShaderMaterial?(0<(m=[E].filter(oa).join("\n")).length&&(m+="\n"),0<(v=[x,E].filter(oa).join("\n")).length&&(v+="\n")):(m=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+r.name,E,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+w,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+p:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(oa).join("\n"),v=[x,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+r.name,E,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+w,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.matcap?"#define USE_MATCAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+d:"",o.envMap?"#define "+p:"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&(a.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==he?"#define TONE_MAPPING":"",o.toneMapping!==he?Dn.tonemapping_pars_fragment:"",o.toneMapping!==he?function(e,t){var n;switch(t){case Ee:n="Linear";break;case de:n="Reinhard";break;case pe:n="Uncharted2";break;case fe:n="OptimizedCineon";break;case me:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.matcapEncoding||o.envMapEncoding||o.emissiveMapEncoding?Dn.encodings_pars_fragment:"",o.mapEncoding?ra("mapTexelToLinear",o.mapEncoding):"",o.matcapEncoding?ra("matcapTexelToLinear",o.matcapEncoding):"",o.envMapEncoding?ra("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?ra("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?"vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+(g=ia(o.outputEncoding))[0]+g[1]+"; }":"",o.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(oa).join("\n")),l=sa(l=aa(l=ca(l),o),o),u=sa(u=aa(u=ca(u),o),o),l=la(l),u=la(u),a.isWebGL2&&!i.isRawShaderMaterial){var T=!1,S=/^\s*#version\s+300\s+es\s*\n/;i.isShaderMaterial&&null!==l.match(S)&&null!==u.match(S)&&(T=!0,l=l.replace(S,""),u=u.replace(S,"")),m=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,v=["#version 300 es\n","#define varying in",T?"":"out highp vec4 pc_fragColor;",T?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v}var C=v+u,L=ta(s,35633,m+l),_=ta(s,35632,C);s.attachShader(M,L),s.attachShader(M,_),void 0!==i.index0AttributeName?s.bindAttribLocation(M,0,i.index0AttributeName):!0===o.morphTargets&&s.bindAttribLocation(M,0,"position"),s.linkProgram(M);var B,R,P=s.getProgramInfoLog(M).trim(),D=s.getShaderInfoLog(L).trim(),I=s.getShaderInfoLog(_).trim(),O=!0,k=!0;return!1===s.getProgramParameter(M,35714)?(O=!1,console.error("THREE.WebGLProgram: shader error: ",s.getError(),"35715",s.getProgramParameter(M,35715),"gl.getProgramInfoLog",P,D,I)):""!==P?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",P):""!==D&&""!==I||(k=!1),k&&(this.diagnostics={runnable:O,material:i,programLog:P,vertexShader:{log:D,prefix:m},fragmentShader:{log:I,prefix:v}}),s.deleteShader(L),s.deleteShader(_),this.getUniforms=function(){return void 0===B&&(B=new ea(s,M,e)),B},this.getAttributes=function(){return void 0===R&&(R=function(e,t){for(var n={},i=e.getProgramParameter(t,35721),r=0;r<i;r++){var o=e.getActiveAttrib(t,r).name;n[o]=e.getAttribLocation(t,o)}return n}(s,M)),R},this.destroy=function(){s.deleteProgram(M),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=r.name,this.id=na++,this.code=n,this.usedTimes=1,this.program=M,this.vertexShader=L,this.fragmentShader=_,this}function ha(h,c,d){var l=[],p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},o=["precision","supportsVertexTextures","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function f(e,t){var n;return e?e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding):n=Tt,n===Tt&&t&&(n=Ct),n}this.getParameters=function(e,t,n,i,r,o,a){var s=p[e.type],c=a.isSkinnedMesh?function(){var e=a.skeleton.bones;if(d.floatVertexTextures)return 1024;var t=d.maxVertexUniforms,n=Math.floor((t-20)/4),i=Math.min(n,e.length);return i<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+i+"."),0):i}():0,l=d.precision;null!==e.precision&&(l=d.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",l,"instead.");var u=h.getRenderTarget();return{shaderID:s,precision:l,supportsVertexTextures:d.vertexTextures,outputEncoding:f(u?u.texture:null,h.gammaOutput),map:!!e.map,mapEncoding:f(e.map,h.gammaInput),matcap:!!e.matcap,matcapEncoding:f(e.matcap,h.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:f(e.envMap,h.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===we||e.envMap.mapping===Me),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:f(e.emissiveMap,h.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,objectSpaceNormalMap:e.normalMapType===Ot,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!i,useFog:e.fog,fogExp:i&&i.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:d.logarithmicDepthBuffer,skinning:e.skinning&&0<c,maxBones:c,useVertexTexture:d.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:h.maxMorphTargets,maxMorphNormals:h.maxMorphNormals,numDirLights:t.directional.length,numPointLights:t.point.length,numSpotLights:t.spot.length,numRectAreaLights:t.rectArea.length,numHemiLights:t.hemi.length,numClippingPlanes:r,numClipIntersection:o,dithering:e.dithering,shadowMapEnabled:h.shadowMap.enabled&&a.receiveShadow&&0<n.length,shadowMapType:h.shadowMap.type,toneMapping:h.toneMapping,physicallyCorrectLights:h.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===Y,flipSided:e.side===xe,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)n.push(i),n.push(e.defines[i]);for(var r=0;r<o.length;r++)n.push(t[o[r]]);return n.push(e.onBeforeCompile.toString()),n.push(h.gammaOutput),n.push(h.gammaFactor),n.join()},this.acquireProgram=function(e,t,n,i){for(var r,o=0,a=l.length;o<a;o++){var s=l[o];if(s.code===i){++(r=s).usedTimes;break}}return void 0===r&&(r=new ua(h,c,i,e,t,n,d),l.push(r)),r},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=l.indexOf(e);l[t]=l[l.length-1],l.pop(),e.destroy()}},this.programs=l}function da(){var i=new WeakMap;return{get:function(e){var t=i.get(e);return void 0===t&&(t={},i.set(e,t)),t},remove:function(e){i.delete(e)},update:function(e,t,n){i.get(e)[t]=n},dispose:function(){i=new WeakMap}}}function pa(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function fa(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function ma(){var s=[],c=0,l=[],u=[];function h(e,t,n,i,r,o){var a=s[c];return void 0===a?(a={id:e.id,object:e,geometry:t,material:n,program:n.program,groupOrder:i,renderOrder:e.renderOrder,z:r,group:o},s[c]=a):(a.id=e.id,a.object=e,a.geometry=t,a.material=n,a.program=n.program,a.groupOrder=i,a.renderOrder=e.renderOrder,a.z=r,a.group=o),c++,a}return{opaque:l,transparent:u,init:function(){c=0,l.length=0,u.length=0},push:function(e,t,n,i,r,o){var a=h(e,t,n,i,r,o);(!0===n.transparent?u:l).push(a)},unshift:function(e,t,n,i,r,o){var a=h(e,t,n,i,r,o);(!0===n.transparent?u:l).unshift(a)},sort:function(){1<l.length&&l.sort(pa),1<u.length&&u.sort(fa)}}}function va(){var r={};function o(e){var t=e.target;t.removeEventListener("dispose",o),delete r[t.id]}return{get:function(e,t){var n,i=r[e.id];return void 0===i?(n=new ma,r[e.id]={},r[e.id][t.id]=n,e.addEventListener("dispose",o)):void 0===(n=i[t.id])&&(n=new ma,i[t.id]=n),n},dispose:function(){r={}}}}function ga(){var n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":t={direction:new Nt,color:new zn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new jt};break;case"SpotLight":t={position:new Nt,direction:new Nt,color:new zn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new jt};break;case"PointLight":t={position:new Nt,color:new zn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new jt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":t={direction:new Nt,skyColor:new zn,groundColor:new zn};break;case"RectAreaLight":t={color:new zn,position:new Nt,halfWidth:new Nt,halfHeight:new Nt}}return n[e.id]=t}}}var ya=0;function Aa(){var w=new ga,x={id:ya++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},E=new Nt,M=new Ht,T=new Ht;return{setup:function(e,t,n){for(var i=0,r=0,o=0,a=0,s=0,c=0,l=0,u=0,h=n.matrixWorldInverse,d=0,p=e.length;d<p;d++){var f=e[d],m=f.color,v=f.intensity,g=f.distance,y=f.shadow&&f.shadow.map?f.shadow.map.texture:null;if(f.isAmbientLight)i+=m.r*v,r+=m.g*v,o+=m.b*v;else if(f.isDirectionalLight){if((b=w.get(f)).color.copy(f.color).multiplyScalar(f.intensity),b.direction.setFromMatrixPosition(f.matrixWorld),E.setFromMatrixPosition(f.target.matrixWorld),b.direction.sub(E),b.direction.transformDirection(h),b.shadow=f.castShadow,f.castShadow){var A=f.shadow;b.shadowBias=A.bias,b.shadowRadius=A.radius,b.shadowMapSize=A.mapSize}x.directionalShadowMap[a]=y,x.directionalShadowMatrix[a]=f.shadow.matrix,x.directional[a]=b,a++}else if(f.isSpotLight){if((b=w.get(f)).position.setFromMatrixPosition(f.matrixWorld),b.position.applyMatrix4(h),b.color.copy(m).multiplyScalar(v),b.distance=g,b.direction.setFromMatrixPosition(f.matrixWorld),E.setFromMatrixPosition(f.target.matrixWorld),b.direction.sub(E),b.direction.transformDirection(h),b.coneCos=Math.cos(f.angle),b.penumbraCos=Math.cos(f.angle*(1-f.penumbra)),b.decay=f.decay,b.shadow=f.castShadow,f.castShadow){A=f.shadow;b.shadowBias=A.bias,b.shadowRadius=A.radius,b.shadowMapSize=A.mapSize}x.spotShadowMap[c]=y,x.spotShadowMatrix[c]=f.shadow.matrix,x.spot[c]=b,c++}else if(f.isRectAreaLight){(b=w.get(f)).color.copy(m).multiplyScalar(v),b.position.setFromMatrixPosition(f.matrixWorld),b.position.applyMatrix4(h),T.identity(),M.copy(f.matrixWorld),M.premultiply(h),T.extractRotation(M),b.halfWidth.set(.5*f.width,0,0),b.halfHeight.set(0,.5*f.height,0),b.halfWidth.applyMatrix4(T),b.halfHeight.applyMatrix4(T),x.rectArea[l]=b,l++}else if(f.isPointLight){if((b=w.get(f)).position.setFromMatrixPosition(f.matrixWorld),b.position.applyMatrix4(h),b.color.copy(f.color).multiplyScalar(f.intensity),b.distance=f.distance,b.decay=f.decay,b.shadow=f.castShadow,f.castShadow){A=f.shadow;b.shadowBias=A.bias,b.shadowRadius=A.radius,b.shadowMapSize=A.mapSize,b.shadowCameraNear=A.camera.near,b.shadowCameraFar=A.camera.far}x.pointShadowMap[s]=y,x.pointShadowMatrix[s]=f.shadow.matrix,x.point[s]=b,s++}else if(f.isHemisphereLight){var b;(b=w.get(f)).direction.setFromMatrixPosition(f.matrixWorld),b.direction.transformDirection(h),b.direction.normalize(),b.skyColor.copy(f.color).multiplyScalar(v),b.groundColor.copy(f.groundColor).multiplyScalar(v),x.hemi[u]=b,u++}}x.ambient[0]=i,x.ambient[1]=r,x.ambient[2]=o,x.directional.length=a,x.spot.length=c,x.rectArea.length=l,x.point.length=s,x.hemi.length=u,x.hash.stateID=x.id,x.hash.directionalLength=a,x.hash.pointLength=s,x.hash.spotLength=c,x.hash.rectAreaLength=l,x.hash.hemiLength=u,x.hash.shadowsLength=t.length},state:x}}function ba(){var t=new Aa,n=[],i=[];return{init:function(){n.length=0,i.length=0},state:{lightsArray:n,shadowsArray:i,lights:t},setupLights:function(e){t.setup(n,i,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){i.push(e)}}}function wa(){var i={};function r(e){var t=e.target;t.removeEventListener("dispose",r),delete i[t.id]}return{get:function(e,t){var n;return void 0===i[e.id]?(n=new ba,i[e.id]={},i[e.id][t.id]=n,e.addEventListener("dispose",r)):void 0===i[e.id][t.id]?(n=new ba,i[e.id][t.id]=n):n=i[e.id][t.id],n},dispose:function(){i={}}}}function xa(e){Gr.call(this),this.type="MeshDepthMaterial",this.depthPacking=Pt,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function Ea(e){Gr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Nt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function Ma(y,m,e){for(var A=new Bn,b=new Ht,w=new jt,x=new jt(e,e),E=new Nt,M=new Nt,g=1,T=2,t=1+(g|T),S=new Array(t),C=new Array(t),L={},_={0:xe,1:O,2:Y},B=[new Nt(1,0,0),new Nt(-1,0,0),new Nt(0,0,1),new Nt(0,0,-1),new Nt(0,1,0),new Nt(0,-1,0)],R=[new Nt(0,1,0),new Nt(0,1,0),new Nt(0,1,0),new Nt(0,1,0),new Nt(0,0,1),new Nt(0,0,-1)],P=[new xn,new xn,new xn,new xn,new xn,new xn],n=0;n!==t;++n){var i=0!=(n&g),r=0!=(n&T),o=new xa({depthPacking:Dt,morphTargets:i,skinning:r});S[n]=o;var a=new Ea({morphTargets:i,skinning:r});C[n]=a}var D=this;function v(e,t,n,i,r,o){var a=e.geometry,s=null,c=S,l=e.customDepthMaterial;if(n&&(c=C,l=e.customDistanceMaterial),l)s=l;else{var u=!1;t.morphTargets&&(a&&a.isBufferGeometry?u=a.morphAttributes&&a.morphAttributes.position&&0<a.morphAttributes.position.length:a&&a.isGeometry&&(u=a.morphTargets&&0<a.morphTargets.length)),e.isSkinnedMesh&&!1===t.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var h=e.isSkinnedMesh&&t.skinning,d=0;u&&(d|=g),h&&(d|=T),s=c[d]}if(y.localClippingEnabled&&!0===t.clipShadows&&0!==t.clippingPlanes.length){var p=s.uuid,f=t.uuid,m=L[p];void 0===m&&(m={},L[p]=m);var v=m[f];void 0===v&&(v=s.clone(),m[f]=v),s=v}return s.visible=t.visible,s.wireframe=t.wireframe,s.side=null!=t.shadowSide?t.shadowSide:_[t.side],s.clipShadows=t.clipShadows,s.clippingPlanes=t.clippingPlanes,s.clipIntersection=t.clipIntersection,s.wireframeLinewidth=t.wireframeLinewidth,s.linewidth=t.linewidth,n&&s.isMeshDistanceMaterial&&(s.referencePosition.copy(i),s.nearDistance=r,s.farDistance=o),s}function I(e,t,n,i){if(!1!==e.visible){if(e.layers.test(t.layers)&&(e.isMesh||e.isLine||e.isPoints)&&e.castShadow&&(!e.frustumCulled||A.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld);var r=m.update(e),o=e.material;if(Array.isArray(o))for(var a=r.groups,s=0,c=a.length;s<c;s++){var l=a[s],u=o[l.materialIndex];if(u&&u.visible){var h=v(e,u,i,M,n.near,n.far);y.renderBufferDirect(n,null,r,h,e,l)}}else if(o.visible){h=v(e,o,i,M,n.near,n.far);y.renderBufferDirect(n,null,r,h,e,null)}}for(var d=e.children,p=0,f=d.length;p<f;p++)I(d[p],t,n,i)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=j,this.render=function(e,t,n){if(!1!==D.enabled&&(!1!==D.autoUpdate||!1!==D.needsUpdate)&&0!==e.length){var i,r=y.state;r.setBlending(Z),r.buffers.color.setClear(1,1,1,1),r.buffers.depth.setTest(!0),r.setScissorTest(!1);for(var o=0,a=e.length;o<a;o++){var s=e[o],c=s.shadow,l=s&&s.isPointLight;if(void 0!==c){var u=c.camera;if(w.copy(c.mapSize),w.min(x),l){var h=w.x,d=w.y;P[0].set(2*h,d,h,d),P[1].set(0,d,h,d),P[2].set(3*h,d,h,d),P[3].set(h,d,h,d),P[4].set(3*h,0,h,d),P[5].set(h,0,h,d),w.x*=4,w.y*=2}if(null===c.map){var p={minFilter:Le,magFilter:Le,format:Qe};c.map=new En(w.x,w.y,p),c.map.texture.name=s.name+".shadowMap",u.updateProjectionMatrix()}c.isSpotLightShadow&&c.update(s);var f=c.map,m=c.matrix;M.setFromMatrixPosition(s.matrixWorld),u.position.copy(M),l?(i=6,m.makeTranslation(-M.x,-M.y,-M.z)):(i=1,E.setFromMatrixPosition(s.target.matrixWorld),u.lookAt(E),u.updateMatrixWorld(),m.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),m.multiply(u.projectionMatrix),m.multiply(u.matrixWorldInverse)),y.setRenderTarget(f),y.clear();for(var v=0;v<i;v++){if(l){E.copy(u.position),E.add(B[v]),u.up.copy(R[v]),u.lookAt(E),u.updateMatrixWorld();var g=P[v];r.viewport(g)}b.multiplyMatrices(u.projectionMatrix,u.matrixWorldInverse),A.setFromMatrix(b),I(t,n,u,l)}}else console.warn("THREE.WebGLShadowMap:",s,"has no shadow.")}D.needsUpdate=!1}}}function Ta(u,n,c,i){var r=new function(){var t=!1,o=new xn,n=null,a=new xn(0,0,0,0);return{setMask:function(e){n===e||t||(u.colorMask(e,e,e,e),n=e)},setLocked:function(e){t=e},setClear:function(e,t,n,i,r){!0===r&&(e*=i,t*=i,n*=i),o.set(e,t,n,i),!1===a.equals(o)&&(u.clearColor(e,t,n,i),a.copy(o))},reset:function(){t=!1,n=null,a.set(-1,0,0,0)}}},o=new function(){var t=!1,n=null,i=null,r=null;return{setTest:function(e){e?F(2929):N(2929)},setMask:function(e){n===e||t||(u.depthMask(e),n=e)},setFunc:function(e){if(i!==e){if(e)switch(e){case ie:u.depthFunc(512);break;case re:u.depthFunc(519);break;case oe:u.depthFunc(513);break;case ae:u.depthFunc(515);break;case se:u.depthFunc(514);break;case ce:u.depthFunc(518);break;case le:u.depthFunc(516);break;case ue:u.depthFunc(517);break;default:u.depthFunc(515)}else u.depthFunc(515);i=e}},setLocked:function(e){t=e},setClear:function(e){r!==e&&(u.clearDepth(e),r=e)},reset:function(){t=!1,r=i=n=null}}},t=new function(){var t=!1,n=null,i=null,r=null,o=null,a=null,s=null,c=null,l=null;return{setTest:function(e){e?F(2960):N(2960)},setMask:function(e){n===e||t||(u.stencilMask(e),n=e)},setFunc:function(e,t,n){i===e&&r===t&&o===n||(u.stencilFunc(e,t,n),i=e,r=t,o=n)},setOp:function(e,t,n){a===e&&s===t&&c===n||(u.stencilOp(e,t,n),a=e,s=t,c=n)},setLocked:function(e){t=e},setClear:function(e){l!==e&&(u.clearStencil(e),l=e)},reset:function(){t=!1,l=c=s=a=o=r=i=n=null}}},e=u.getParameter(34921),a=new Uint8Array(e),s=new Uint8Array(e),l=new Uint8Array(e),h={},d=null,p=null,f=null,m=null,v=null,g=null,y=null,A=null,b=null,w=null,x=!1,E=null,M=null,T=null,S=null,C=null,L=u.getParameter(35661),_=!1,B=0,R=u.getParameter(7938);-1!==R.indexOf("WebGL")?(B=parseFloat(/^WebGL\ ([0-9])/.exec(R)[1]),_=1<=B):-1!==R.indexOf("OpenGL ES")&&(B=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(R)[1]),_=2<=B);var P=null,D={},I=new xn,O=new xn;function k(e,t,n){var i=new Uint8Array(4),r=u.createTexture();u.bindTexture(e,r),u.texParameteri(e,10241,9728),u.texParameteri(e,10240,9728);for(var o=0;o<n;o++)u.texImage2D(t+o,0,6408,1,1,0,6408,5121,i);return r}var j={};function H(e,t){a[e]=1,0===s[e]&&(u.enableVertexAttribArray(e),s[e]=1),l[e]!==t&&((i.isWebGL2?u:n.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](e,t),l[e]=t)}function F(e){!0!==h[e]&&(u.enable(e),h[e]=!0)}function N(e){!1!==h[e]&&(u.disable(e),h[e]=!1)}function z(e,t,n,i,r,o,a,s){if(e!==Z){if(f||(F(3042),f=!0),e===te)r=r||t,o=o||n,a=a||i,t===v&&r===A||(u.blendEquationSeparate(c.convert(t),c.convert(r)),v=t,A=r),n===g&&i===y&&o===b&&a===w||(u.blendFuncSeparate(c.convert(n),c.convert(i),c.convert(o),c.convert(a)),g=n,y=i,b=o,w=a),m=e,x=null;else if(e!==m||s!==x){if(v===ne&&A===ne||(u.blendEquation(32774),A=v=ne),s)switch(e){case K:u.blendFuncSeparate(1,771,1,771);break;case J:u.blendFunc(1,1);break;case $:u.blendFuncSeparate(0,0,769,771);break;case ee:u.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case K:u.blendFuncSeparate(770,771,1,771);break;case J:u.blendFunc(770,1);break;case $:u.blendFunc(0,769);break;case ee:u.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}w=b=y=g=null,m=e,x=s}}else f&&(N(3042),f=!1)}function U(e){E!==e&&(e?u.frontFace(2304):u.frontFace(2305),E=e)}function G(e){e!==q?(F(2884),e!==M&&(e===X?u.cullFace(1029):e===Q?u.cullFace(1028):u.cullFace(1032))):N(2884),M=e}function V(e,t,n){e?(F(32823),S===t&&C===n||(u.polygonOffset(t,n),S=t,C=n)):N(32823)}function W(e){void 0===e&&(e=33984+L-1),P!==e&&(u.activeTexture(e),P=e)}return j[3553]=k(3553,3553,1),j[34067]=k(34067,34069,6),r.setClear(0,0,0,1),o.setClear(1),t.setClear(0),F(2929),o.setFunc(ae),U(!1),G(X),F(2884),z(Z),{buffers:{color:r,depth:o,stencil:t},initAttributes:function(){for(var e=0,t=a.length;e<t;e++)a[e]=0},enableAttribute:function(e){H(e,0)},enableAttributeAndDivisor:H,disableUnusedAttributes:function(){for(var e=0,t=s.length;e!==t;++e)s[e]!==a[e]&&(u.disableVertexAttribArray(e),s[e]=0)},enable:F,disable:N,getCompressedTextureFormats:function(){if(null===d&&(d=[],n.get("WEBGL_compressed_texture_pvrtc")||n.get("WEBGL_compressed_texture_s3tc")||n.get("WEBGL_compressed_texture_etc1")||n.get("WEBGL_compressed_texture_astc")))for(var e=u.getParameter(34467),t=0;t<e.length;t++)d.push(e[t]);return d},useProgram:function(e){return p!==e&&(u.useProgram(e),p=e,!0)},setBlending:z,setMaterial:function(e,t){e.side===Y?N(2884):F(2884);var n=e.side===xe;t&&(n=!n),U(n),e.blending===K&&!1===e.transparent?z(Z):z(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),o.setFunc(e.depthFunc),o.setTest(e.depthTest),o.setMask(e.depthWrite),r.setMask(e.colorWrite),V(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:U,setCullFace:G,setLineWidth:function(e){e!==T&&(_&&u.lineWidth(e),T=e)},setPolygonOffset:V,setScissorTest:function(e){e?F(3089):N(3089)},activeTexture:W,bindTexture:function(e,t){null===P&&W();var n=D[P];void 0===n&&(n={type:void 0,texture:void 0},D[P]=n),n.type===e&&n.texture===t||(u.bindTexture(e,t||j[e]),n.type=e,n.texture=t)},compressedTexImage2D:function(){try{u.compressedTexImage2D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{u.texImage2D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{u.texImage3D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===I.equals(e)&&(u.scissor(e.x,e.y,e.z,e.w),I.copy(e))},viewport:function(e){!1===O.equals(e)&&(u.viewport(e.x,e.y,e.z,e.w),O.copy(e))},reset:function(){for(var e=0;e<s.length;e++)1===s[e]&&(u.disableVertexAttribArray(e),s[e]=0);h={},D={},M=E=m=p=P=d=null,r.reset(),o.reset(),t.reset()}}}function Sa(v,r,g,y,A,b,w){var s,c={};function x(e,t,n,i){var r=1;if((e.width>i||e.height>i)&&(r=i/Math.max(e.width,e.height)),r<1||!0===t){if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap){void 0===s&&(s=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"));var o=n?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):s,a=t?kt.floorPowerOfTwo:Math.floor;return o.width=a(r*e.width),o.height=a(r*e.height),o.getContext("2d").drawImage(e,0,0,o.width,o.height),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o.width+"x"+o.height+")."),o}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function E(e){return kt.isPowerOfTwo(e.width)&&kt.isPowerOfTwo(e.height)}function M(e,t){return e.generateMipmaps&&t&&e.minFilter!==Le&&e.minFilter!==Re}function T(e,t,n,i){v.generateMipmap(e),y.get(t).__maxMipLevel=Math.log(Math.max(n,i))*Math.LOG2E}function S(e,t){if(!A.isWebGL2)return e;var n=e;return 6403===e&&(5126===t&&(n=33326),5131===t&&(n=33325),5121===t&&(n=33321)),6407===e&&(5126===t&&(n=34837),5131===t&&(n=34843),5121===t&&(n=32849)),6408===e&&(5126===t&&(n=34836),5131===t&&(n=34842),5121===t&&(n=32856)),33325===n||33326===n||34842===n||34836===n?r.get("EXT_color_buffer_float"):34843!==n&&34837!==n||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),n}function o(e){return e===Le||e===_e||e===Be?9728:9729}function C(e){var t=e.target;t.removeEventListener("dispose",C),function(e){var t=y.get(e);if(e.image&&t.__image__webglTextureCube)v.deleteTexture(t.__image__webglTextureCube);else{if(void 0===t.__webglInit)return;v.deleteTexture(t.__webglTexture)}y.remove(e)}(t),t.isVideoTexture&&delete c[t.id],w.memory.textures--}function l(e){var t=e.target;t.removeEventListener("dispose",l),function(e){var t=y.get(e),n=y.get(e.texture);if(e){if(void 0!==n.__webglTexture&&v.deleteTexture(n.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(var i=0;i<6;i++)v.deleteFramebuffer(t.__webglFramebuffer[i]),t.__webglDepthbuffer&&v.deleteRenderbuffer(t.__webglDepthbuffer[i]);else v.deleteFramebuffer(t.__webglFramebuffer),t.__webglDepthbuffer&&v.deleteRenderbuffer(t.__webglDepthbuffer);y.remove(e.texture),y.remove(e)}}(t),w.memory.textures--}function u(e,t){var n,i,r,o=y.get(e);if(e.isVideoTexture&&(i=(n=e).id,r=w.render.frame,c[i]!==r&&(c[i]=r,n.update())),0<e.version&&o.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void h(o,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}g.activeTexture(33984+t),g.bindTexture(3553,o.__webglTexture)}function L(e,t,n){var i;if(n?(v.texParameteri(e,10242,b.convert(t.wrapS)),v.texParameteri(e,10243,b.convert(t.wrapT)),v.texParameteri(e,10240,b.convert(t.magFilter)),v.texParameteri(e,10241,b.convert(t.minFilter))):(v.texParameteri(e,10242,33071),v.texParameteri(e,10243,33071),t.wrapS===Se&&t.wrapT===Se||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),v.texParameteri(e,10240,o(t.magFilter)),v.texParameteri(e,10241,o(t.minFilter)),t.minFilter!==Le&&t.minFilter!==Re&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),i=r.get("EXT_texture_filter_anisotropic")){if(t.type===Ne&&null===r.get("OES_texture_float_linear"))return;if(t.type===ze&&null===(A.isWebGL2||r.get("OES_texture_half_float_linear")))return;(1<t.anisotropy||y.get(t).__currentAnisotropy)&&(v.texParameterf(e,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,A.getMaxAnisotropy())),y.get(t).__currentAnisotropy=t.anisotropy)}}function h(e,t,n){var i;i=t.isDataTexture3D?32879:3553,void 0===e.__webglInit&&(e.__webglInit=!0,t.addEventListener("dispose",C),e.__webglTexture=v.createTexture(),w.memory.textures++),g.activeTexture(33984+n),g.bindTexture(i,e.__webglTexture),v.pixelStorei(37440,t.flipY),v.pixelStorei(37441,t.premultiplyAlpha),v.pixelStorei(3317,t.unpackAlignment);var r=!A.isWebGL2&&(t.wrapS!==Se||t.wrapT!==Se||t.minFilter!==Le&&t.minFilter!==Re)&&!1===E(t.image),o=x(t.image,r,!1,A.maxTextureSize),a=E(o)||A.isWebGL2,s=b.convert(t.format),c=b.convert(t.type),l=S(s,c);L(i,t,a);var u,h=t.mipmaps;if(t.isDepthTexture){if(l=6402,t.type===Ne){if(!A.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");l=36012}else A.isWebGL2&&(l=33189);t.format===Je&&6402===l&&t.type!==je&&t.type!==Fe&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),t.type=je,c=b.convert(t.type)),t.format===$e&&(l=34041,t.type!==We&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),t.type=We,c=b.convert(t.type))),g.texImage2D(3553,0,l,o.width,o.height,0,s,c,null)}else if(t.isDataTexture)if(0<h.length&&a){for(var d=0,p=h.length;d<p;d++)u=h[d],g.texImage2D(3553,d,l,u.width,u.height,0,s,c,u.data);t.generateMipmaps=!1,e.__maxMipLevel=h.length-1}else g.texImage2D(3553,0,l,o.width,o.height,0,s,c,o.data),e.__maxMipLevel=0;else if(t.isCompressedTexture){for(d=0,p=h.length;d<p;d++)u=h[d],t.format!==Qe&&t.format!==Xe?-1<g.getCompressedTextureFormats().indexOf(s)?g.compressedTexImage2D(3553,d,l,u.width,u.height,0,u.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):g.texImage2D(3553,d,l,u.width,u.height,0,s,c,u.data);e.__maxMipLevel=h.length-1}else if(t.isDataTexture3D)g.texImage3D(32879,0,l,o.width,o.height,o.depth,0,s,c,o.data),e.__maxMipLevel=0;else if(0<h.length&&a){for(d=0,p=h.length;d<p;d++)u=h[d],g.texImage2D(3553,d,l,s,c,u);t.generateMipmaps=!1,e.__maxMipLevel=h.length-1}else g.texImage2D(3553,0,l,s,c,o),e.__maxMipLevel=0;M(t,a)&&T(3553,t,o.width,o.height),e.__version=t.version,t.onUpdate&&t.onUpdate(t)}function d(e,t,n,i){var r=b.convert(t.texture.format),o=b.convert(t.texture.type),a=S(r,o);g.texImage2D(i,0,a,t.width,t.height,0,r,o,null),v.bindFramebuffer(36160,e),v.framebufferTexture2D(36160,n,i,y.get(t.texture).__webglTexture,0),v.bindFramebuffer(36160,null)}function p(e,t,n){if(v.bindRenderbuffer(36161,e),t.depthBuffer&&!t.stencilBuffer){if(n){var i=f(t);v.renderbufferStorageMultisample(36161,i,33189,t.width,t.height)}else v.renderbufferStorage(36161,33189,t.width,t.height);v.framebufferRenderbuffer(36160,36096,36161,e)}else if(t.depthBuffer&&t.stencilBuffer){if(n){i=f(t);v.renderbufferStorageMultisample(36161,i,34041,t.width,t.height)}else v.renderbufferStorage(36161,34041,t.width,t.height);v.framebufferRenderbuffer(36160,33306,36161,e)}else{var r=S(b.convert(t.texture.format),b.convert(t.texture.type));if(n){i=f(t);v.renderbufferStorageMultisample(36161,i,r,t.width,t.height)}else v.renderbufferStorage(36161,r,t.width,t.height)}v.bindRenderbuffer(36161,null)}function f(e){return A.isWebGL2&&e.isWebGLMultisampleRenderTarget?Math.min(A.maxSamples,e.samples):0}this.setTexture2D=u,this.setTexture3D=function(e,t){var n=y.get(e);0<e.version&&n.__version!==e.version?h(n,e,t):(g.activeTexture(33984+t),g.bindTexture(32879,n.__webglTexture))},this.setTextureCube=function(e,t){var n=y.get(e);if(6===e.image.length)if(0<e.version&&n.__version!==e.version){n.__image__webglTextureCube||(e.addEventListener("dispose",C),n.__image__webglTextureCube=v.createTexture(),w.memory.textures++),g.activeTexture(33984+t),g.bindTexture(34067,n.__image__webglTextureCube),v.pixelStorei(37440,e.flipY);for(var i=e&&e.isCompressedTexture,r=e.image[0]&&e.image[0].isDataTexture,o=[],a=0;a<6;a++)o[a]=i||r?r?e.image[a].image:e.image[a]:x(e.image[a],!1,!0,A.maxCubemapSize);var s=o[0],c=E(s)||A.isWebGL2,l=b.convert(e.format),u=b.convert(e.type),h=S(l,u);L(34067,e,c);for(a=0;a<6;a++)if(i)for(var d,p=o[a].mipmaps,f=0,m=p.length;f<m;f++)d=p[f],e.format!==Qe&&e.format!==Xe?-1<g.getCompressedTextureFormats().indexOf(l)?g.compressedTexImage2D(34069+a,f,h,d.width,d.height,0,d.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g.texImage2D(34069+a,f,h,d.width,d.height,0,l,u,d.data);else r?g.texImage2D(34069+a,0,h,o[a].width,o[a].height,0,l,u,o[a].data):g.texImage2D(34069+a,0,h,l,u,o[a]);n.__maxMipLevel=i?p.length-1:0,M(e,c)&&T(34067,e,s.width,s.height),n.__version=e.version,e.onUpdate&&e.onUpdate(e)}else g.activeTexture(33984+t),g.bindTexture(34067,n.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,t){g.activeTexture(33984+t),g.bindTexture(34067,y.get(e).__webglTexture)},this.setupRenderTarget=function(e){var t=y.get(e),n=y.get(e.texture);e.addEventListener("dispose",l),n.__webglTexture=v.createTexture(),w.memory.textures++;var i=!0===e.isWebGLRenderTargetCube,r=!0===e.isWebGLMultisampleRenderTarget,o=E(e)||A.isWebGL2;if(i){t.__webglFramebuffer=[];for(var a=0;a<6;a++)t.__webglFramebuffer[a]=v.createFramebuffer()}else if(t.__webglFramebuffer=v.createFramebuffer(),r)if(A.isWebGL2){t.__webglMultisampledFramebuffer=v.createFramebuffer(),t.__webglColorRenderbuffer=v.createRenderbuffer(),v.bindRenderbuffer(36161,t.__webglColorRenderbuffer);var s=S(b.convert(e.texture.format),b.convert(e.texture.type)),c=f(e);v.renderbufferStorageMultisample(36161,c,s,e.width,e.height),v.bindFramebuffer(36160,t.__webglMultisampledFramebuffer),v.framebufferRenderbuffer(36160,36064,36161,t.__webglColorRenderbuffer),v.bindRenderbuffer(36161,null),e.depthBuffer&&(t.__webglDepthRenderbuffer=v.createRenderbuffer(),p(t.__webglDepthRenderbuffer,e,!0)),v.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(i){g.bindTexture(34067,n.__webglTexture),L(34067,e.texture,o);for(a=0;a<6;a++)d(t.__webglFramebuffer[a],e,36064,34069+a);M(e.texture,o)&&T(34067,e.texture,e.width,e.height),g.bindTexture(34067,null)}else g.bindTexture(3553,n.__webglTexture),L(3553,e.texture,o),d(t.__webglFramebuffer,e,36064,3553),M(e.texture,o)&&T(3553,e.texture,e.width,e.height),g.bindTexture(3553,null);e.depthBuffer&&function(e){var t=y.get(e),n=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(n)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,t){if(t&&t.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(v.bindFramebuffer(36160,e),!t.depthTexture||!t.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");y.get(t.depthTexture).__webglTexture&&t.depthTexture.image.width===t.width&&t.depthTexture.image.height===t.height||(t.depthTexture.image.width=t.width,t.depthTexture.image.height=t.height,t.depthTexture.needsUpdate=!0),u(t.depthTexture,0);var n=y.get(t.depthTexture).__webglTexture;if(t.depthTexture.format===Je)v.framebufferTexture2D(36160,36096,3553,n,0);else{if(t.depthTexture.format!==$e)throw new Error("Unknown depthTexture format");v.framebufferTexture2D(36160,33306,3553,n,0)}}(t.__webglFramebuffer,e)}else if(n){t.__webglDepthbuffer=[];for(var i=0;i<6;i++)v.bindFramebuffer(36160,t.__webglFramebuffer[i]),t.__webglDepthbuffer[i]=v.createRenderbuffer(),p(t.__webglDepthbuffer[i],e)}else v.bindFramebuffer(36160,t.__webglFramebuffer),t.__webglDepthbuffer=v.createRenderbuffer(),p(t.__webglDepthbuffer,e);v.bindFramebuffer(36160,null)}(e)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(M(t,E(e)||A.isWebGL2)){var n=e.isWebGLRenderTargetCube?34067:3553,i=y.get(t).__webglTexture;g.bindTexture(n,i),T(n,t,e.width,e.height),g.bindTexture(n,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(A.isWebGL2){var t=y.get(e);v.bindFramebuffer(36008,t.__webglMultisampledFramebuffer),v.bindFramebuffer(36009,t.__webglFramebuffer);var n=e.width,i=e.height,r=16384;e.depthBuffer&&(r|=256),e.stencilBuffer&&(r|=1024),v.blitFramebuffer(0,0,n,i,0,0,n,i,r,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}}function Ca(e,n,i){return{convert:function(e){var t;if(e===Te)return 10497;if(e===Se)return 33071;if(e===Ce)return 33648;if(e===Le)return 9728;if(e===_e)return 9984;if(e===Be)return 9986;if(e===Re)return 9729;if(e===Pe)return 9985;if(e===De)return 9987;if(e===Ie)return 5121;if(e===Ue)return 32819;if(e===Ge)return 32820;if(e===Ve)return 33635;if(e===Oe)return 5120;if(e===ke)return 5122;if(e===je)return 5123;if(e===He)return 5124;if(e===Fe)return 5125;if(e===Ne)return 5126;if(e===ze){if(i.isWebGL2)return 5131;if(null!==(t=n.get("OES_texture_half_float")))return t.HALF_FLOAT_OES}if(e===qe)return 6406;if(e===Xe)return 6407;if(e===Qe)return 6408;if(e===Ye)return 6409;if(e===Ze)return 6410;if(e===Je)return 6402;if(e===$e)return 34041;if(e===et)return 6403;if(e===ne)return 32774;if(e===T)return 32778;if(e===S)return 32779;if(e===_)return 0;if(e===B)return 1;if(e===R)return 768;if(e===P)return 769;if(e===D)return 770;if(e===I)return 771;if(e===k)return 772;if(e===F)return 773;if(e===N)return 774;if(e===z)return 775;if(e===U)return 776;if((e===tt||e===nt||e===it||e===rt)&&null!==(t=n.get("WEBGL_compressed_texture_s3tc"))){if(e===tt)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===nt)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===it)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===rt)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===ot||e===at||e===st||e===ct)&&null!==(t=n.get("WEBGL_compressed_texture_pvrtc"))){if(e===ot)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===at)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===st)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===ct)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===lt&&null!==(t=n.get("WEBGL_compressed_texture_etc1")))return t.COMPRESSED_RGB_ETC1_WEBGL;if((e===ut||e===ht||e===dt||e===pt||e===ft||e===mt||e===vt||e===gt||e===yt||e===At||e===bt||e===wt||e===xt||e===Et)&&null!==(t=n.get("WEBGL_compressed_texture_astc")))return e;if(e===C||e===L){if(i.isWebGL2){if(e===C)return 32775;if(e===L)return 32776}if(null!==(t=n.get("EXT_blend_minmax"))){if(e===C)return t.MIN_EXT;if(e===L)return t.MAX_EXT}}if(e===We){if(i.isWebGL2)return 34042;if(null!==(t=n.get("WEBGL_depth_texture")))return t.UNSIGNED_INT_24_8_WEBGL}return 0}}}function La(){Ai.call(this),this.type="Group"}function _a(){Ai.call(this),this.type="Camera",this.matrixWorldInverse=new Ht,this.projectionMatrix=new Ht,this.projectionMatrixInverse=new Ht}function Ba(e,t,n,i){_a.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Ra(e){Ba.call(this),this.cameras=e||[]}((xa.prototype=Object.create(Gr.prototype)).constructor=xa).prototype.isMeshDepthMaterial=!0,xa.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},((Ea.prototype=Object.create(Gr.prototype)).constructor=Ea).prototype.isMeshDistanceMaterial=!0,Ea.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},La.prototype=Object.assign(Object.create(Ai.prototype),{constructor:La,isGroup:!0}),_a.prototype=Object.assign(Object.create(Ai.prototype),{constructor:_a,isCamera:!0,copy:function(e,t){return Ai.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Nt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Ai.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Ba.prototype=Object.assign(Object.create(_a.prototype),{constructor:Ba,isPerspectiveCamera:!0,copy:function(e,t){return _a.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*kt.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*kt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*kt.RAD2DEG*Math.atan(Math.tan(.5*kt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,i,r,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*kt.DEG2RAD*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;r+=o.offsetX*i/a,t-=o.offsetY*n/s,i*=o.width/a,n*=o.height/s}var c=this.filmOffset;0!==c&&(r+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Ai.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Ra.prototype=Object.assign(Object.create(Ba.prototype),{constructor:Ra,isArrayCamera:!0});var Pa,Da,Ia,Oa,ka,ja,Ha,Fa,Na,za,Ua,Ga,Va,Wa,qa,Xa,Qa,Ya,Za,Ka,Ja,$a,es,ts,ns,is,rs,os,as=new Nt,ss=new Nt;function cs(e,t,n){as.setFromMatrixPosition(t.matrixWorld),ss.setFromMatrixPosition(n.matrixWorld);var i=as.distanceTo(ss),r=t.projectionMatrix.elements,o=n.projectionMatrix.elements,a=r[14]/(r[10]-1),s=r[14]/(r[10]+1),c=(r[9]+1)/r[5],l=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(o[8]+1)/o[0],d=a*u,p=a*h,f=i/(h-u),m=f*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var v=a+f,g=s+f,y=d-m,A=i-m+p,b=c*s/g*v,w=l*s/g*v;e.projectionMatrix.makePerspective(y,A,b,w,v,g)}function ls(i){var r=this,c=null,l=null,u=null,h=[],d=new Ht,p=new Ht,o=1,f="stage";"undefined"!=typeof window&&"VRFrameData"in window&&(l=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",e,!1));var m=new Ht,v=new Ft,g=new Nt,y=new Ba;y.bounds=new xn(0,0,.5,1),y.layers.enable(1);var A=new Ba;A.bounds=new xn(.5,0,.5,1),A.layers.enable(2);var a,s,b=new Ra([y,A]);function w(){return null!==c&&!0===c.isPresenting}function e(){if(w()){var e=c.getEyeParameters("left"),t=e.renderWidth*o,n=e.renderHeight*o;s=i.getPixelRatio(),a=i.getSize(),i.setDrawingBufferSize(2*t,n,1),M.start()}else r.enabled&&i.setDrawingBufferSize(a.width,a.height,s),M.stop()}b.layers.enable(1),b.layers.enable(2);var x=[];function E(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),n=0,i=0,r=t.length;n<r;n++){var o=t[n];if(o&&("Daydream Controller"===o.id||"Gear VR Controller"===o.id||"Oculus Go Controller"===o.id||"OpenVR Gamepad"===o.id||o.id.startsWith("Oculus Touch")||o.id.startsWith("Spatial Controller"))){if(i===e)return o;i++}}}this.enabled=!1,this.getController=function(e){var t=h[e];return void 0===t&&((t=new La).matrixAutoUpdate=!1,t.visible=!1,h[e]=t),t},this.getDevice=function(){return c},this.setDevice=function(e){void 0!==e&&(c=e),M.setContext(e)},this.setFramebufferScaleFactor=function(e){o=e},this.setFrameOfReferenceType=function(e){f=e},this.setPoseTarget=function(e){void 0!==e&&(u=e)},this.getCamera=function(e){var t="stage"===f?1.6:0;if(null===c)return e.position.set(0,t,0),e;if(c.depthNear=e.near,c.depthFar=e.far,c.getFrameData(l),"stage"===f){var n=c.stageParameters;n?d.fromArray(n.sittingToStandingTransform):d.makeTranslation(0,t,0)}var i=l.pose,r=null!==u?u:e;if(r.matrix.copy(d),r.matrix.decompose(r.position,r.quaternion,r.scale),null!==i.orientation&&(v.fromArray(i.orientation),r.quaternion.multiply(v)),null!==i.position&&(v.setFromRotationMatrix(d),g.fromArray(i.position),g.applyQuaternion(v),r.position.add(g)),r.updateMatrixWorld(),!1===c.isPresenting)return e;y.near=e.near,A.near=e.near,y.far=e.far,A.far=e.far,y.matrixWorldInverse.fromArray(l.leftViewMatrix),A.matrixWorldInverse.fromArray(l.rightViewMatrix),p.getInverse(d),"stage"===f&&(y.matrixWorldInverse.multiply(p),A.matrixWorldInverse.multiply(p));var o=r.parent;null!==o&&(m.getInverse(o.matrixWorld),y.matrixWorldInverse.multiply(m),A.matrixWorldInverse.multiply(m)),y.matrixWorld.getInverse(y.matrixWorldInverse),A.matrixWorld.getInverse(A.matrixWorldInverse),y.projectionMatrix.fromArray(l.leftProjectionMatrix),A.projectionMatrix.fromArray(l.rightProjectionMatrix),cs(b,y,A);var a=c.getLayers();if(a.length){var s=a[0];null!==s.leftBounds&&4===s.leftBounds.length&&y.bounds.fromArray(s.leftBounds),null!==s.rightBounds&&4===s.rightBounds.length&&A.bounds.fromArray(s.rightBounds)}return function(){for(var e=0;e<h.length;e++){var t=h[e],n=E(e);if(void 0!==n&&void 0!==n.pose){if(null===n.pose)return;var i=n.pose;!1===i.hasPosition&&t.position.set(.2,-.6,-.05),null!==i.position&&t.position.fromArray(i.position),null!==i.orientation&&t.quaternion.fromArray(i.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(d),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var r="Daydream Controller"===n.id?0:1;x[e]!==n.buttons[r].pressed&&(x[e]=n.buttons[r].pressed,!0===x[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}(),b},this.getStandingMatrix=function(){return d},this.isPresenting=w;var M=new Yn;this.setAnimationLoop=function(e){M.setAnimationLoop(e)},this.submitFrame=function(){w()&&c.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",e)}}function us(t){var n=t.context,i=null,d=null,r=1,p=null,o="stage",f=null,s=null,m=[],v=[];function c(){return null!==d&&null!==p}var l=new Ba;l.layers.enable(1),l.viewport=new xn;var u=new Ba;u.layers.enable(2),u.viewport=new xn;var g=new Ra([l,u]);function a(e){var t=m[v.indexOf(e.inputSource)];t&&t.dispatchEvent({type:e.type})}function h(){t.setFramebuffer(null),b.stop()}function y(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}g.layers.enable(1),g.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=m[e];return void 0===t&&((t=new La).matrixAutoUpdate=!1,t.visible=!1,m[e]=t),t},this.getDevice=function(){return i},this.setDevice=function(e){void 0!==e&&(i=e),e instanceof XRDevice&&n.setCompatibleXRDevice(e)},this.setFramebufferScaleFactor=function(e){r=e},this.setFrameOfReferenceType=function(e){o=e},this.setSession=function(e){null!==(d=e)&&(d.addEventListener("select",a),d.addEventListener("selectstart",a),d.addEventListener("selectend",a),d.addEventListener("end",h),d.baseLayer=new XRWebGLLayer(d,n,{framebufferScaleFactor:r}),d.requestFrameOfReference(o).then(function(e){p=e,t.setFramebuffer(d.baseLayer.framebuffer),b.setContext(d),b.start()}),v=d.getInputSources(),d.addEventListener("inputsourceschange",function(){v=d.getInputSources(),console.log(v);for(var e=0;e<m.length;e++){m[e].userData.inputSource=v[e]}}))},this.setPoseTarget=function(e){void 0!==e&&(s=e)},this.getCamera=function(e){if(c()){var t=e.parent,n=g.cameras,i=s||e;y(g,t);for(var r=0;r<n.length;r++)y(n[r],t);i.matrixWorld.copy(g.matrixWorld);for(var o=i.children,a=(r=0,o.length);r<a;r++)o[r].updateMatrixWorld(!0);return cs(g,l,u),g}return e},this.getCameraPose=function(){return f},this.isPresenting=c;var A=null,b=new Yn;b.setAnimationLoop(function(e,t){if(null!==(f=t.getDevicePose(p)))for(var n=d.baseLayer,i=t.views,r=0;r<i.length;r++){var o=i[r],a=n.getViewport(o),s=f.getViewMatrix(o),c=g.cameras[r];c.matrix.fromArray(s).getInverse(c.matrix),c.projectionMatrix.fromArray(o.projectionMatrix),c.viewport.set(a.x,a.y,a.width,a.height),0===r&&g.matrix.copy(c.matrix)}for(r=0;r<m.length;r++){var l=m[r],u=v[r];if(u){var h=t.getInputPose(u,p);if(null!==h){"targetRay"in h?l.matrix.elements=h.targetRay.transformMatrix:"pointerMatrix"in h&&(l.matrix.elements=h.pointerMatrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.visible=!0;continue}}l.visible=!1}A&&A(e,t)}),this.setAnimationLoop=function(e){A=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new THREE.Matrix4},this.submitFrame=function(){}}function hs(e){console.log("THREE.WebGLRenderer","101");var i=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,r=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,c=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,l=void 0!==e.powerPreference?e.powerPreference:"default",p=null,q=null;this.domElement=i,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Ee,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var X,E,Q,Y,u,Z,h,M,T,f,y,d,m,v,S,C,L,g,K=this,A=!1,b=null,w=null,x=null,J=-1,_={geometry:null,program:null,wireframe:!1},$=null,B=null,R=new xn,P=new xn,D=null,ee=0,I=i.width,te=i.height,ne=1,O=new xn(0,0,I,te),k=new xn(0,0,I,te),j=!1,H=new Bn,ie=new Jr,re=!1,oe=!1,F=new Ht,ae=new Nt;function N(){return null===w?ne:1}try{var z={alpha:n,depth:r,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:c,powerPreference:l};if(i.addEventListener("webglcontextlost",W,!1),i.addEventListener("webglcontextrestored",se,!1),null===(X=t||i.getContext("webgl",z)||i.getContext("experimental-webgl",z)))throw null!==i.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===X.getShaderPrecisionFormat&&(X.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){console.error("THREE.WebGLRenderer: "+e.message)}function U(){E=new $r(X),(Q=new Kr(X,E,e)).isWebGL2||(E.get("WEBGL_depth_texture"),E.get("OES_texture_float"),E.get("OES_texture_half_float"),E.get("OES_texture_half_float_linear"),E.get("OES_standard_derivatives"),E.get("OES_element_index_uint"),E.get("ANGLE_instanced_arrays")),E.get("OES_texture_float_linear"),g=new Ca(X,E,Q),(Y=new Ta(X,E,g,Q)).scissor(P.copy(k).multiplyScalar(ne)),Y.viewport(R.copy(O).multiplyScalar(ne)),u=new no(X),Z=new da,h=new Sa(X,E,Y,Z,Q,g,u),M=new Zn(X),T=new eo(X,M,u),f=new oo(T,u),S=new ro(X),y=new ha(K,E,Q),d=new va,m=new wa,v=new Yr(K,Y,f,s),C=new Zr(X,E,u,Q),L=new to(X,E,u,Q),u.programs=y.programs,K.context=X,K.capabilities=Q,K.extensions=E,K.properties=Z,K.renderLists=d,K.state=Y,K.info=u}U();var G=null;"undefined"!=typeof navigator&&(G="xr"in navigator?new us(K):new ls(K)),this.vr=G;var V=new Ma(K,f,Q.maxTextureSize);function W(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),A=!0}function se(){console.log("THREE.WebGLRenderer: Context Restored."),A=!1,U()}function ce(e){var t,n=e.target;n.removeEventListener("dispose",ce),le(t=n),Z.remove(t)}function le(e){var t=Z.get(e).program;(e.program=void 0)!==t&&y.releaseProgram(t)}this.shadowMap=V,this.getContext=function(){return X},this.getContextAttributes=function(){return X.getContextAttributes()},this.forceContextLoss=function(){var e=E.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=E.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return ne},this.setPixelRatio=function(e){void 0!==e&&(ne=e,this.setSize(I,te,!1))},this.getSize=function(){return{width:I,height:te}},this.setSize=function(e,t,n){G.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(I=e,te=t,i.width=e*ne,i.height=t*ne,!1!==n&&(i.style.width=e+"px",i.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(){return{width:I*ne,height:te*ne}},this.setDrawingBufferSize=function(e,t,n){I=e,te=t,ne=n,i.width=e*n,i.height=t*n,this.setViewport(0,0,e,t)},this.getCurrentViewport=function(){return R},this.setViewport=function(e,t,n,i){O.set(e,te-t-i,n,i),Y.viewport(R.copy(O).multiplyScalar(ne))},this.setScissor=function(e,t,n,i){k.set(e,te-t-i,n,i),Y.scissor(P.copy(k).multiplyScalar(ne))},this.setScissorTest=function(e){Y.setScissorTest(j=e)},this.getClearColor=function(){return v.getClearColor()},this.setClearColor=function(){v.setClearColor.apply(v,arguments)},this.getClearAlpha=function(){return v.getClearAlpha()},this.setClearAlpha=function(){v.setClearAlpha.apply(v,arguments)},this.clear=function(e,t,n){var i=0;void 0!==e&&!e||(i|=16384),void 0!==t&&!t||(i|=256),void 0!==n&&!n||(i|=1024),X.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",W,!1),i.removeEventListener("webglcontextrestored",se,!1),d.dispose(),m.dispose(),Z.dispose(),f.dispose(),G.dispose(),fe.stop()},this.renderBufferImmediate=function(e,t){Y.initAttributes();var n=Z.get(e);e.hasPositions&&!n.position&&(n.position=X.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=X.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=X.createBuffer()),e.hasColors&&!n.color&&(n.color=X.createBuffer());var i=t.getAttributes();e.hasPositions&&(X.bindBuffer(34962,n.position),X.bufferData(34962,e.positionArray,35048),Y.enableAttribute(i.position),X.vertexAttribPointer(i.position,3,5126,!1,0,0)),e.hasNormals&&(X.bindBuffer(34962,n.normal),X.bufferData(34962,e.normalArray,35048),Y.enableAttribute(i.normal),X.vertexAttribPointer(i.normal,3,5126,!1,0,0)),e.hasUvs&&(X.bindBuffer(34962,n.uv),X.bufferData(34962,e.uvArray,35048),Y.enableAttribute(i.uv),X.vertexAttribPointer(i.uv,2,5126,!1,0,0)),e.hasColors&&(X.bindBuffer(34962,n.color),X.bufferData(34962,e.colorArray,35048),Y.enableAttribute(i.color),X.vertexAttribPointer(i.color,3,5126,!1,0,0)),Y.disableUnusedAttributes(),X.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,i,r,o){var a=r.isMesh&&r.normalMatrix.determinant()<0;Y.setMaterial(i,a);var s=ye(e,t,i,r),c=!1;_.geometry===n.id&&_.program===s.id&&_.wireframe===(!0===i.wireframe)||(_.geometry=n.id,_.program=s.id,_.wireframe=!0===i.wireframe,c=!0),r.morphTargetInfluences&&(S.update(r,n,i,s),c=!0);var l,u=n.index,h=n.attributes.position,d=1;!0===i.wireframe&&(u=T.getWireframeAttribute(n),d=2);var p=C;null!==u&&(l=M.get(u),(p=L).setIndex(l)),c&&(function(e,t,n){if(n&&n.isInstancedBufferGeometry&!Q.isWebGL2&&null===E.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{Y.initAttributes();var i=n.attributes,r=t.getAttributes(),o=e.defaultAttributeValues;for(var a in r){var s=r[a];if(0<=s){var c=i[a];if(void 0!==c){var l=c.normalized,u=c.itemSize,h=M.get(c);if(void 0===h)continue;var d=h.buffer,p=h.type,f=h.bytesPerElement;if(c.isInterleavedBufferAttribute){var m=c.data,v=m.stride,g=c.offset;m&&m.isInstancedInterleavedBuffer?(Y.enableAttributeAndDivisor(s,m.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=m.meshPerAttribute*m.count)):Y.enableAttribute(s),X.bindBuffer(34962,d),X.vertexAttribPointer(s,u,p,l,v*f,g*f)}else c.isInstancedBufferAttribute?(Y.enableAttributeAndDivisor(s,c.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=c.meshPerAttribute*c.count)):Y.enableAttribute(s),X.bindBuffer(34962,d),X.vertexAttribPointer(s,u,p,l,0,0)}else if(void 0!==o){var y=o[a];if(void 0!==y)switch(y.length){case 2:X.vertexAttrib2fv(s,y);break;case 3:X.vertexAttrib3fv(s,y);break;case 4:X.vertexAttrib4fv(s,y);break;default:X.vertexAttrib1fv(s,y)}}}}Y.disableUnusedAttributes()}}(i,s,n),null!==u&&X.bindBuffer(34963,l.buffer));var f=1/0;null!==u?f=u.count:void 0!==h&&(f=h.count);var m=n.drawRange.start*d,v=n.drawRange.count*d,g=null!==o?o.start*d:0,y=null!==o?o.count*d:1/0,A=Math.max(m,g),b=Math.min(f,m+v,g+y)-1,w=Math.max(0,b-A+1);if(0!==w){if(r.isMesh)if(!0===i.wireframe)Y.setLineWidth(i.wireframeLinewidth*N()),p.setMode(1);else switch(r.drawMode){case Mt:p.setMode(4);break;case 1:p.setMode(5);break;case 2:p.setMode(6)}else if(r.isLine){var x=i.linewidth;void 0===x&&(x=1),Y.setLineWidth(x*N()),r.isLineSegments?p.setMode(1):r.isLineLoop?p.setMode(2):p.setMode(3)}else r.isPoints?p.setMode(0):r.isSprite&&p.setMode(4);n&&n.isInstancedBufferGeometry?0<n.maxInstancedCount&&p.renderInstances(n,A,w):p.render(A,w)}},this.compile=function(n,e){(q=m.get(n,e)).init(),n.traverse(function(e){e.isLight&&(q.pushLight(e),e.castShadow&&q.pushShadow(e))}),q.setupLights(e),n.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var t=0;t<e.material.length;t++)ge(e.material[t],n.fog,e);else ge(e.material,n.fog,e)})};var ue,he,de,pe=null,fe=new Yn;function me(e,t,n,i){for(var r=0,o=e.length;r<o;r++){var a=e[r],s=a.object,c=a.geometry,l=void 0===i?a.material:i,u=a.group;if(n.isArrayCamera)for(var h=(B=n).cameras,d=0,p=h.length;d<p;d++){var f=h[d];if(s.layers.test(f.layers)){if("viewport"in f)Y.viewport(R.copy(f.viewport));else{var m=f.bounds,v=m.x*I,g=m.y*te,y=m.z*I,A=m.w*te;Y.viewport(R.set(v,g,y,A).multiplyScalar(ne))}q.setupLights(f),ve(s,t,f,c,l,u)}}else B=null,ve(s,t,n,c,l,u)}}function ve(e,t,n,i,r,o){if(e.onBeforeRender(K,t,n,i,r,o),q=m.get(t,B||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){Y.setMaterial(r);var a=ye(n,t.fog,r,e);_.geometry=null,_.program=null,_.wireframe=!1,s=a,e.render(function(e){K.renderBufferImmediate(e,s)})}else K.renderBufferDirect(n,t.fog,i,r,e,o);var s;e.onAfterRender(K,t,n,i,r,o),q=m.get(t,B||n)}function ge(e,t,n){var i=Z.get(e),r=q.state.lights,o=q.state.shadowsArray,a=i.lightsHash,s=r.state.hash,c=y.getParameters(e,r.state,o,t,ie.numPlanes,ie.numIntersection,n),l=y.getProgramCode(e,c),u=i.program,h=!0;if(void 0===u)e.addEventListener("dispose",ce);else if(u.code!==l)le(e);else if(a.stateID!==s.stateID||a.directionalLength!==s.directionalLength||a.pointLength!==s.pointLength||a.spotLength!==s.spotLength||a.rectAreaLength!==s.rectAreaLength||a.hemiLength!==s.hemiLength||a.shadowsLength!==s.shadowsLength)a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,h=!1;else{if(void 0!==c.shaderID)return;h=!1}if(h){if(c.shaderID){var d=Qn[c.shaderID];i.shader={name:e.type,uniforms:In(d.uniforms),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader}}else i.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(i.shader,K),l=y.getProgramCode(e,c),u=y.acquireProgram(e,i.shader,c,l),i.program=u,e.program=u}var p=u.getAttributes();if(e.morphTargets)for(var f=e.numSupportedMorphTargets=0;f<K.maxMorphTargets;f++)0<=p["morphTarget"+f]&&e.numSupportedMorphTargets++;if(e.morphNormals)for(f=e.numSupportedMorphNormals=0;f<K.maxMorphNormals;f++)0<=p["morphNormal"+f]&&e.numSupportedMorphNormals++;var m=i.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(i.numClippingPlanes=ie.numPlanes,i.numIntersection=ie.numIntersection,m.clippingPlanes=ie.uniform),i.fog=t,void 0===a&&(i.lightsHash=a={}),a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,e.lights&&(m.ambientLightColor.value=r.state.ambient,m.directionalLights.value=r.state.directional,m.spotLights.value=r.state.spot,m.rectAreaLights.value=r.state.rectArea,m.pointLights.value=r.state.point,m.hemisphereLights.value=r.state.hemi,m.directionalShadowMap.value=r.state.directionalShadowMap,m.directionalShadowMatrix.value=r.state.directionalShadowMatrix,m.spotShadowMap.value=r.state.spotShadowMap,m.spotShadowMatrix.value=r.state.spotShadowMatrix,m.pointShadowMap.value=r.state.pointShadowMap,m.pointShadowMatrix.value=r.state.pointShadowMatrix);var v=i.program.getUniforms(),g=ea.seqWithValue(v.seq,m);i.uniformsList=g}function ye(e,t,n,i){ee=0;var r=Z.get(n),o=q.state.lights,a=r.lightsHash,s=o.state.hash;if(re&&(oe||e!==$)){var c=e===$&&n.id===J;ie.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,r,c)}!1===n.needsUpdate&&(void 0===r.program?n.needsUpdate=!0:n.fog&&r.fog!==t?n.needsUpdate=!0:(!n.lights||a.stateID===s.stateID&&a.directionalLength===s.directionalLength&&a.pointLength===s.pointLength&&a.spotLength===s.spotLength&&a.rectAreaLength===s.rectAreaLength&&a.hemiLength===s.hemiLength&&a.shadowsLength===s.shadowsLength)&&(void 0===r.numClippingPlanes||r.numClippingPlanes===ie.numPlanes&&r.numIntersection===ie.numIntersection)||(n.needsUpdate=!0)),n.needsUpdate&&(ge(n,t,i),n.needsUpdate=!1);var l,u,h,d,p,f,m,v,g,y,A,b,w,x,E,M,T,S,C,L,_,B,R,P,D,I=!1,O=!1,k=!1,j=r.program,H=j.getUniforms(),F=r.shader.uniforms;if(Y.useProgram(j.program)&&(k=O=I=!0),n.id!==J&&(J=n.id,O=!0),I||$!==e){if(H.setValue(X,"projectionMatrix",e.projectionMatrix),Q.logarithmicDepthBuffer&&H.setValue(X,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),$!==e&&($=e,k=O=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var N=H.map.cameraPosition;void 0!==N&&N.setValue(X,ae.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&H.setValue(X,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){H.setOptional(X,i,"bindMatrix"),H.setOptional(X,i,"bindMatrixInverse");var z=i.skeleton;if(z){var U=z.bones;if(Q.floatVertexTextures){if(void 0===z.boneTexture){var G=Math.sqrt(4*U.length);G=kt.ceilPowerOfTwo(G),G=Math.max(G,4);var V=new Float32Array(G*G*4);V.set(z.boneMatrices);var W=new Sn(V,G,G,Qe,Ne);W.needsUpdate=!0,z.boneMatrices=V,z.boneTexture=W,z.boneTextureSize=G}H.setValue(X,"boneTexture",z.boneTexture),H.setValue(X,"boneTextureSize",z.boneTextureSize)}else H.setOptional(X,z,"boneMatrices")}}return O&&(H.setValue(X,"toneMappingExposure",K.toneMappingExposure),H.setValue(X,"toneMappingWhitePoint",K.toneMappingWhitePoint),n.lights&&(u=k,(l=F).ambientLightColor.needsUpdate=u,l.directionalLights.needsUpdate=u,l.pointLights.needsUpdate=u,l.spotLights.needsUpdate=u,l.rectAreaLights.needsUpdate=u,l.hemisphereLights.needsUpdate=u),t&&n.fog&&(D=t,(P=F).fogColor.value=D.color,D.isFog?(P.fogNear.value=D.near,P.fogFar.value=D.far):D.isFogExp2&&(P.fogDensity.value=D.density)),n.isMeshBasicMaterial?Ae(F,n):n.isMeshLambertMaterial?(Ae(F,n),R=F,n.emissiveMap&&(R.emissiveMap.value=n.emissiveMap)):n.isMeshPhongMaterial?(Ae(F,n),n.isMeshToonMaterial?(be(_=F,B=n),B.gradientMap&&(_.gradientMap.value=B.gradientMap)):be(F,n)):n.isMeshStandardMaterial?(Ae(F,n),n.isMeshPhysicalMaterial?(we(C=F,L=n),C.reflectivity.value=L.reflectivity,C.clearCoat.value=L.clearCoat,C.clearCoatRoughness.value=L.clearCoatRoughness):we(F,n)):n.isMeshMatcapMaterial?(Ae(F,n),T=F,(S=n).matcap&&(T.matcap.value=S.matcap),S.bumpMap&&(T.bumpMap.value=S.bumpMap,T.bumpScale.value=S.bumpScale,S.side===xe&&(T.bumpScale.value*=-1)),S.normalMap&&(T.normalMap.value=S.normalMap,T.normalScale.value.copy(S.normalScale),S.side===xe&&T.normalScale.value.negate()),S.displacementMap&&(T.displacementMap.value=S.displacementMap,T.displacementScale.value=S.displacementScale,T.displacementBias.value=S.displacementBias)):n.isMeshDepthMaterial?(Ae(F,n),E=F,(M=n).displacementMap&&(E.displacementMap.value=M.displacementMap,E.displacementScale.value=M.displacementScale,E.displacementBias.value=M.displacementBias)):n.isMeshDistanceMaterial?(Ae(F,n),w=F,(x=n).displacementMap&&(w.displacementMap.value=x.displacementMap,w.displacementScale.value=x.displacementScale,w.displacementBias.value=x.displacementBias),w.referencePosition.value.copy(x.referencePosition),w.nearDistance.value=x.nearDistance,w.farDistance.value=x.farDistance):n.isMeshNormalMaterial?(Ae(F,n),A=F,(b=n).bumpMap&&(A.bumpMap.value=b.bumpMap,A.bumpScale.value=b.bumpScale,b.side===xe&&(A.bumpScale.value*=-1)),b.normalMap&&(A.normalMap.value=b.normalMap,A.normalScale.value.copy(b.normalScale),b.side===xe&&A.normalScale.value.negate()),b.displacementMap&&(A.displacementMap.value=b.displacementMap,A.displacementScale.value=b.displacementScale,A.displacementBias.value=b.displacementBias)):n.isLineBasicMaterial?(y=n,(g=F).diffuse.value=y.color,g.opacity.value=y.opacity,n.isLineDashedMaterial&&(v=n,(m=F).dashSize.value=v.dashSize,m.totalSize.value=v.dashSize+v.gapSize,m.scale.value=v.scale)):n.isPointsMaterial?(f=n,(p=F).diffuse.value=f.color,p.opacity.value=f.opacity,p.size.value=f.size*ne,p.scale.value=.5*te,p.map.value=f.map,null!==f.map&&(!0===f.map.matrixAutoUpdate&&f.map.updateMatrix(),p.uvTransform.value.copy(f.map.matrix))):n.isSpriteMaterial?(d=n,(h=F).diffuse.value=d.color,h.opacity.value=d.opacity,h.rotation.value=d.rotation,h.map.value=d.map,null!==d.map&&(!0===d.map.matrixAutoUpdate&&d.map.updateMatrix(),h.uvTransform.value.copy(d.map.matrix))):n.isShadowMaterial&&(F.color.value=n.color,F.opacity.value=n.opacity),void 0!==F.ltc_1&&(F.ltc_1.value=Xn.LTC_1),void 0!==F.ltc_2&&(F.ltc_2.value=Xn.LTC_2),ea.upload(X,r.uniformsList,F,K)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(ea.upload(X,r.uniformsList,F,K),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&H.setValue(X,"center",i.center),H.setValue(X,"modelViewMatrix",i.modelViewMatrix),H.setValue(X,"normalMatrix",i.normalMatrix),H.setValue(X,"modelMatrix",i.matrixWorld),j}function Ae(e,t){var n;e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=Z.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}function be(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===xe&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===xe&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function we(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===xe&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===xe&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}fe.setAnimationLoop(function(e){G.isPresenting()||pe&&pe(e)}),"undefined"!=typeof window&&fe.setContext(window),this.setAnimationLoop=function(e){pe=e,G.setAnimationLoop(e),fe.start()},this.render=function(e,t,n,i){if(t&&t.isCamera){if(!A){_.geometry=null,_.program=null,_.wireframe=!1,J=-1,!($=null)===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),G.enabled&&(t=G.getCamera(t)),(q=m.get(e,t)).init(),e.onBeforeRender(K,e,t,n),F.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),H.setFromMatrix(F),oe=this.localClippingEnabled,re=ie.init(this.clippingPlanes,oe,t),(p=d.get(e,t)).init(),function e(t,n,i,r){if(!1!==t.visible){if(t.layers.test(n.layers))if(t.isGroup)i=t.renderOrder;else if(t.isLight)q.pushLight(t),t.castShadow&&q.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||H.intersectsSprite(t)){r&&ae.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F);var o=f.update(t),a=t.material;p.push(t,o,a,i,ae.z,null)}}else if(t.isImmediateRenderObject)r&&ae.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F),p.push(t,null,t.material,i,ae.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||H.intersectsObject(t))){r&&ae.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F);o=f.update(t),a=t.material;if(Array.isArray(a))for(var s=o.groups,c=0,l=s.length;c<l;c++){var u=s[c],h=a[u.materialIndex];h&&h.visible&&p.push(t,o,h,i,ae.z,u)}else a.visible&&p.push(t,o,a,i,ae.z,null)}var d=t.children;for(c=0,l=d.length;c<l;c++)e(d[c],n,i,r)}}(e,t,0,K.sortObjects),!0===K.sortObjects&&p.sort(),re&&ie.beginShadows();var r=q.state.shadowsArray;V.render(r,e,t),q.setupLights(t),re&&ie.endShadows(),this.info.autoReset&&this.info.reset(),void 0===n&&(n=null),this.setRenderTarget(n),v.render(p,e,t,i);var o=p.opaque,a=p.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;o.length&&me(o,e,t,s),a.length&&me(a,e,t,s)}else o.length&&me(o,e,t),a.length&&me(a,e,t);n&&(h.updateRenderTargetMipmap(n),h.updateMultisampleRenderTarget(n)),Y.buffers.depth.setTest(!0),Y.buffers.depth.setMask(!0),Y.buffers.color.setMask(!0),Y.setPolygonOffset(!1),e.onAfterRender(K,e,t),G.enabled&&G.submitFrame(),q=p=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=function(){var e=ee;return e>=Q.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+Q.maxTextures),ee+=1,e},this.setTexture2D=(ue=!1,function(e,t){e&&e.isWebGLRenderTarget&&(ue||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),ue=!0),e=e.texture),h.setTexture2D(e,t)}),this.setTexture3D=function(e,t){h.setTexture3D(e,t)},this.setTexture=(de=!1,function(e,t){de||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),de=!0),h.setTexture2D(e,t)}),this.setTextureCube=(he=!1,function(e,t){e&&e.isWebGLRenderTargetCube&&(he||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),he=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?h.setTextureCube(e,t):h.setTextureCubeDynamic(e,t)}),this.setFramebuffer=function(e){b=e},this.getRenderTarget=function(){return w},this.setRenderTarget=function(e){(w=e)&&void 0===Z.get(e).__webglFramebuffer&&h.setupRenderTarget(e);var t=b,n=!1;if(e){var i=Z.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(t=i[e.activeCubeFace],n=!0):t=e.isWebGLMultisampleRenderTarget?Z.get(e).__webglMultisampledFramebuffer:i,R.copy(e.viewport),P.copy(e.scissor),D=e.scissorTest}else R.copy(O).multiplyScalar(ne),P.copy(k).multiplyScalar(ne),D=j;if(x!==t&&(X.bindFramebuffer(36160,t),x=t),Y.viewport(R),Y.scissor(P),Y.setScissorTest(D),n){var r=Z.get(e.texture);X.framebufferTexture2D(36160,36064,34069+e.activeCubeFace,r.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,n,i,r,o){if(e&&e.isWebGLRenderTarget){var a=Z.get(e).__webglFramebuffer;if(a){var s=!1;a!==x&&(X.bindFramebuffer(36160,a),s=!0);try{var c=e.texture,l=c.format,u=c.type;if(l!==Qe&&g.convert(l)!==X.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(u===Ie||g.convert(u)===X.getParameter(35738)||u===Ne&&(Q.isWebGL2||E.get("OES_texture_float")||E.get("WEBGL_color_buffer_float"))||u===ze&&(Q.isWebGL2?E.get("EXT_color_buffer_float"):E.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===X.checkFramebufferStatus(36160)?0<=t&&t<=e.width-i&&0<=n&&n<=e.height-r&&X.readPixels(t,n,i,r,g.convert(l),g.convert(u),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&X.bindFramebuffer(36160,x)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){var i=t.image.width,r=t.image.height,o=g.convert(t.format);this.setTexture2D(t,0),X.copyTexImage2D(3553,n||0,o,e.x,e.y,i,r,0)},this.copyTextureToTexture=function(e,t,n,i){var r=t.image.width,o=t.image.height,a=g.convert(n.format),s=g.convert(n.type);this.setTexture2D(n,0),t.isDataTexture?X.texSubImage2D(3553,i||0,e.x,e.y,r,o,a,s,t.image.data):X.texSubImage2D(3553,i||0,e.x,e.y,a,s,t.image)}}function ds(e,t){this.name="",this.color=new zn(e),this.density=void 0!==t?t:25e-5}function ps(e,t,n){this.name="",this.color=new zn(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function fs(){Ai.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function ms(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function vs(e,t,n,i){this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===i}function gs(e){Gr.call(this),this.type="SpriteMaterial",this.color=new zn(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(e)}function ys(e){if(Ai.call(this),this.type="Sprite",void 0===Pa){Pa=new Ji;var t=new ms(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Pa.setIndex([0,1,2,0,2,3]),Pa.addAttribute("position",new vs(t,3,0,!1)),Pa.addAttribute("uv",new vs(t,2,3,!1))}this.geometry=Pa,this.material=void 0!==e?e:new gs,this.center=new jt(.5,.5)}function As(){Ai.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function bs(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Qr.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ht,this.bindMatrixInverse=new Ht}function ws(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new Ht)}}function xs(){Ai.call(this),this.type="Bone"}function Es(e){Gr.call(this),this.type="LineBasicMaterial",this.color=new zn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function Ms(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Ai.call(this),this.type="Line",this.geometry=void 0!==e?e:new Ji,this.material=void 0!==t?t:new Es({color:16777215*Math.random()})}function Ts(e,t){Ms.call(this,e,t),this.type="LineSegments"}function Ss(e,t){Ms.call(this,e,t),this.type="LineLoop"}function Cs(e){Gr.call(this),this.type="PointsMaterial",this.color=new zn(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Ls(e,t){Ai.call(this),this.type="Points",this.geometry=void 0!==e?e:new Ji,this.material=void 0!==t?t:new Cs({color:16777215*Math.random()})}function _s(e,t,n,i,r,o,a,s,c){wn.call(this,e,t,n,i,r,o,a,s,c),this.format=void 0!==a?a:Xe,this.minFilter=void 0!==o?o:Re,this.magFilter=void 0!==r?r:Re,this.generateMipmaps=!1}function Bs(e,t,n,i,r,o,a,s,c,l,u,h){wn.call(this,null,o,a,s,c,l,i,r,u,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Rs(e,t,n,i,r,o,a,s,c){wn.call(this,e,t,n,i,r,o,a,s,c),this.needsUpdate=!0}function Ps(e,t,n,i,r,o,a,s,c,l){if((l=void 0!==l?l:Je)!==Je&&l!==$e)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===Je&&(n=je),void 0===n&&l===$e&&(n=We),wn.call(this,null,i,r,o,a,s,l,n,c),this.image={width:e,height:t},this.magFilter=void 0!==a?a:Le,this.minFilter=void 0!==s?s:Le,this.flipY=!1,this.generateMipmaps=!1}function Ds(e){Ji.call(this),this.type="WireframeGeometry";var t,n,i,r,o,a,s,c,l,u,h=[],d=[0,0],p={},f=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,i=m.length;t<i;t++){var v=m[t];for(n=0;n<3;n++)s=v[f[n]],c=v[f[(n+1)%3]],d[0]=Math.min(s,c),d[1]=Math.max(s,c),void 0===p[l=d[0]+","+d[1]]&&(p[l]={index1:d[0],index2:d[1]})}for(l in p)a=p[l],u=e.vertices[a.index1],h.push(u.x,u.y,u.z),u=e.vertices[a.index2],h.push(u.x,u.y,u.z)}else if(e&&e.isBufferGeometry){var g,y,A,b,w,x;if(u=new Nt,null!==e.index){for(g=e.attributes.position,y=e.index,0===(A=e.groups).length&&(A=[{start:0,count:y.count,materialIndex:0}]),r=0,o=A.length;r<o;++r)for(i=(t=(b=A[r]).start)+b.count;t<i;t+=3)for(n=0;n<3;n++)s=y.getX(t+n),c=y.getX(t+(n+1)%3),d[0]=Math.min(s,c),d[1]=Math.max(s,c),void 0===p[l=d[0]+","+d[1]]&&(p[l]={index1:d[0],index2:d[1]});for(l in p)a=p[l],u.fromBufferAttribute(g,a.index1),h.push(u.x,u.y,u.z),u.fromBufferAttribute(g,a.index2),h.push(u.x,u.y,u.z)}else for(t=0,i=(g=e.attributes.position).count/3;t<i;t++)for(n=0;n<3;n++)w=3*t+n,u.fromBufferAttribute(g,w),h.push(u.x,u.y,u.z),x=3*t+(n+1)%3,u.fromBufferAttribute(g,x),h.push(u.x,u.y,u.z)}this.addAttribute("position",new ji(h,3))}function Is(e,t,n){Li.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new Os(e,t,n)),this.mergeVertices()}function Os(e,t,n){Ji.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var i,r,o=[],a=[],s=[],c=[],l=new Nt,u=new Nt,h=new Nt,d=new Nt,p=new Nt;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var f=t+1;for(i=0;i<=n;i++){var m=i/n;for(r=0;r<=t;r++){var v=r/t;e(v,m,u),a.push(u.x,u.y,u.z),0<=v-1e-5?(e(v-1e-5,m,h),d.subVectors(u,h)):(e(1e-5+v,m,h),d.subVectors(h,u)),0<=m-1e-5?(e(v,m-1e-5,h),p.subVectors(u,h)):(e(v,1e-5+m,h),p.subVectors(h,u)),l.crossVectors(d,p).normalize(),s.push(l.x,l.y,l.z),c.push(v,m)}}for(i=0;i<n;i++)for(r=0;r<t;r++){var g=i*f+r,y=i*f+r+1,A=(i+1)*f+r+1,b=(i+1)*f+r;o.push(g,y,b),o.push(y,A,b)}this.setIndex(o),this.addAttribute("position",new ji(a,3)),this.addAttribute("normal",new ji(s,3)),this.addAttribute("uv",new ji(c,2))}function ks(e,t,n,i){Li.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},this.fromBufferGeometry(new js(e,t,n,i)),this.mergeVertices()}function js(i,o,e,t){Ji.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:i,indices:o,radius:e,detail:t},e=e||1;var u=[],h=[];function a(e,t,n,i){var r,o,a=Math.pow(2,i),s=[];for(r=0;r<=a;r++){s[r]=[];var c=e.clone().lerp(n,r/a),l=t.clone().lerp(n,r/a),u=a-r;for(o=0;o<=u;o++)s[r][o]=0===o&&r===a?c:c.clone().lerp(l,o/u)}for(r=0;r<a;r++)for(o=0;o<2*(a-r)-1;o++){var h=Math.floor(o/2);o%2==0?(d(s[r][h+1]),d(s[r+1][h]),d(s[r][h])):(d(s[r][h+1]),d(s[r+1][h+1]),d(s[r+1][h]))}}function d(e){u.push(e.x,e.y,e.z)}function s(e,t){var n=3*e;t.x=i[0+n],t.y=i[1+n],t.z=i[2+n]}function p(e,t,n,i){i<0&&1===e.x&&(h[t]=e.x-1),0===n.x&&0===n.z&&(h[t]=i/2/Math.PI+.5)}function f(e){return Math.atan2(e.z,-e.x)}!function(e){for(var t=new Nt,n=new Nt,i=new Nt,r=0;r<o.length;r+=3)s(o[r+0],t),s(o[r+1],n),s(o[r+2],i),a(t,n,i,e)}(t=t||0),function(e){for(var t=new Nt,n=0;n<u.length;n+=3)t.x=u[n+0],t.y=u[n+1],t.z=u[n+2],t.normalize().multiplyScalar(e),u[n+0]=t.x,u[n+1]=t.y,u[n+2]=t.z}(e),function(){for(var e=new Nt,t=0;t<u.length;t+=3){e.x=u[t+0],e.y=u[t+1],e.z=u[t+2];var n=f(e)/2/Math.PI+.5,i=Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5;h.push(n,1-i)}(function(){for(var e=new Nt,t=new Nt,n=new Nt,i=new Nt,r=new jt,o=new jt,a=new jt,s=0,c=0;s<u.length;s+=9,c+=6){e.set(u[s+0],u[s+1],u[s+2]),t.set(u[s+3],u[s+4],u[s+5]),n.set(u[s+6],u[s+7],u[s+8]),r.set(h[c+0],h[c+1]),o.set(h[c+2],h[c+3]),a.set(h[c+4],h[c+5]),i.copy(e).add(t).add(n).divideScalar(3);var l=f(i);p(r,c+0,e,l),p(o,c+2,t,l),p(a,c+4,n,l)}})(),function(){for(var e=0;e<h.length;e+=6){var t=h[e+0],n=h[e+2],i=h[e+4],r=Math.max(t,n,i),o=Math.min(t,n,i);.9<r&&o<.1&&(t<.2&&(h[e+0]+=1),n<.2&&(h[e+2]+=1),i<.2&&(h[e+4]+=1))}}()}(),this.addAttribute("position",new ji(u,3)),this.addAttribute("normal",new ji(u.slice(),3)),this.addAttribute("uv",new ji(h,2)),0===t?this.computeVertexNormals():this.normalizeNormals()}function Hs(e,t){Li.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Fs(e,t)),this.mergeVertices()}function Fs(e,t){js.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ns(e,t){Li.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new zs(e,t)),this.mergeVertices()}function zs(e,t){js.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Us(e,t){Li.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Gs(e,t)),this.mergeVertices()}function Gs(e,t){var n=(1+Math.sqrt(5))/2;js.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Vs(e,t){Li.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ws(e,t)),this.mergeVertices()}function Ws(e,t){var n=(1+Math.sqrt(5))/2,i=1/n;js.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function qs(e,t,n,i,r,o){Li.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new Xs(e,t,n,i,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Xs(a,s,c,l,e){Ji.call(this),this.type="TubeBufferGeometry",this.parameters={path:a,tubularSegments:s,radius:c,radialSegments:l,closed:e},s=s||64,c=c||1,l=l||8,e=e||!1;var u=a.computeFrenetFrames(s,e);this.tangents=u.tangents,this.normals=u.normals,this.binormals=u.binormals;var r,h,d=new Nt,p=new Nt,t=new jt,f=new Nt,m=[],v=[],n=[],o=[];function i(e){f=a.getPointAt(e/s,f);var t=u.normals[e],n=u.binormals[e];for(h=0;h<=l;h++){var i=h/l*Math.PI*2,r=Math.sin(i),o=-Math.cos(i);p.x=o*t.x+r*n.x,p.y=o*t.y+r*n.y,p.z=o*t.z+r*n.z,p.normalize(),v.push(p.x,p.y,p.z),d.x=f.x+c*p.x,d.y=f.y+c*p.y,d.z=f.z+c*p.z,m.push(d.x,d.y,d.z)}}!function(){for(r=0;r<s;r++)i(r);i(!1===e?s:0),function(){for(r=0;r<=s;r++)for(h=0;h<=l;h++)t.x=r/s,t.y=h/l,n.push(t.x,t.y)}(),function(){for(h=1;h<=s;h++)for(r=1;r<=l;r++){var e=(l+1)*(h-1)+(r-1),t=(l+1)*h+(r-1),n=(l+1)*h+r,i=(l+1)*(h-1)+r;o.push(e,t,i),o.push(t,n,i)}}()}(),this.setIndex(o),this.addAttribute("position",new ji(m,3)),this.addAttribute("normal",new ji(v,3)),this.addAttribute("uv",new ji(n,2))}function Qs(e,t,n,i,r,o,a){Li.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Ys(e,t,n,i,r,o)),this.mergeVertices()}function Ys(e,t,n,i,r,o){Ji.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},e=e||1,t=t||.4,n=Math.floor(n)||64,i=Math.floor(i)||8,r=r||2,o=o||3;var a,s,c=[],l=[],u=[],h=[],d=new Nt,p=new Nt,f=new Nt,m=new Nt,v=new Nt,g=new Nt,y=new Nt;for(a=0;a<=n;++a){var A=a/n*r*Math.PI*2;for(C(A,r,o,e,f),C(.01+A,r,o,e,m),g.subVectors(m,f),y.addVectors(m,f),v.crossVectors(g,y),y.crossVectors(v,g),v.normalize(),y.normalize(),s=0;s<=i;++s){var b=s/i*Math.PI*2,w=-t*Math.cos(b),x=t*Math.sin(b);d.x=f.x+(w*y.x+x*v.x),d.y=f.y+(w*y.y+x*v.y),d.z=f.z+(w*y.z+x*v.z),l.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),u.push(p.x,p.y,p.z),h.push(a/n),h.push(s/i)}}for(s=1;s<=n;s++)for(a=1;a<=i;a++){var E=(i+1)*(s-1)+(a-1),M=(i+1)*s+(a-1),T=(i+1)*s+a,S=(i+1)*(s-1)+a;c.push(E,M,S),c.push(M,T,S)}function C(e,t,n,i,r){var o=Math.cos(e),a=Math.sin(e),s=n/t*e,c=Math.cos(s);r.x=i*(2+c)*.5*o,r.y=i*(2+c)*a*.5,r.z=i*Math.sin(s)*.5}this.setIndex(c),this.addAttribute("position",new ji(l,3)),this.addAttribute("normal",new ji(u,3)),this.addAttribute("uv",new ji(h,2))}function Zs(e,t,n,i,r){Li.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new Ks(e,t,n,i,r)),this.mergeVertices()}function Ks(e,t,n,i,r){Ji.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},e=e||1,t=t||.4,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;var o,a,s=[],c=[],l=[],u=[],h=new Nt,d=new Nt,p=new Nt;for(o=0;o<=n;o++)for(a=0;a<=i;a++){var f=a/i*r,m=o/n*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(f),d.y=(e+t*Math.cos(m))*Math.sin(f),d.z=t*Math.sin(m),c.push(d.x,d.y,d.z),h.x=e*Math.cos(f),h.y=e*Math.sin(f),p.subVectors(d,h).normalize(),l.push(p.x,p.y,p.z),u.push(a/i),u.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=i;a++){var v=(i+1)*o+a-1,g=(i+1)*(o-1)+a-1,y=(i+1)*(o-1)+a,A=(i+1)*o+a;s.push(v,g,A),s.push(g,y,A)}this.setIndex(s),this.addAttribute("position",new ji(c,3)),this.addAttribute("normal",new ji(l,3)),this.addAttribute("uv",new ji(u,2))}function Js(e,t,n,i,r,o){Ka.subVectors(e,n).addScalar(.5).multiply(i),void 0!==r?(Ja.x=o*Ka.x-r*Ka.y,Ja.y=r*Ka.x+o*Ka.y):Ja.copy(Ka),e.copy(t),e.x+=Ja.x,e.y+=Ja.y,e.applyMatrix4($a)}ds.prototype.isFogExp2=!0,ds.prototype.clone=function(){return new ds(this.color,this.density)},ds.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},ps.prototype.isFog=!0,ps.prototype.clone=function(){return new ps(this.color,this.near,this.far)},ps.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},fs.prototype=Object.assign(Object.create(Ai.prototype),{constructor:fs,isScene:!0,copy:function(e,t){return Ai.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=Ai.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(ms.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ms.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(vs.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(vs.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}}),((gs.prototype=Object.create(Gr.prototype)).constructor=gs).prototype.isSpriteMaterial=!0,gs.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},ys.prototype=Object.assign(Object.create(Ai.prototype),{constructor:ys,isSprite:!0,raycast:(Qa=new Nt,Ya=new Nt,Za=new Nt,Ka=new jt,Ja=new jt,$a=new Ht,es=new Nt,ts=new Nt,ns=new Nt,is=new jt,rs=new jt,os=new jt,function(e,t){Ya.setFromMatrixScale(this.matrixWorld),$a.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),Za.setFromMatrixPosition(this.modelViewMatrix);var n,i,r=this.material.rotation;0!==r&&(i=Math.cos(r),n=Math.sin(r));var o=this.center;Js(es.set(-.5,-.5,0),Za,o,Ya,n,i),Js(ts.set(.5,-.5,0),Za,o,Ya,n,i),Js(ns.set(.5,.5,0),Za,o,Ya,n,i),is.set(0,0),rs.set(1,0),os.set(1,1);var a=e.ray.intersectTriangle(es,ts,ns,!1,Qa);if(null!==a||(Js(ts.set(-.5,.5,0),Za,o,Ya,n,i),rs.set(0,1),null!==(a=e.ray.intersectTriangle(es,ns,ts,!1,Qa)))){var s=e.ray.origin.distanceTo(Qa);s<e.near||s>e.far||t.push({distance:s,point:Qa.clone(),uv:qr.getUV(Qa,es,ts,ns,is,rs,os,new jt),face:null,object:this})}}),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return Ai.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),As.prototype=Object.assign(Object.create(Ai.prototype),{constructor:As,copy:function(e){Ai.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,i=t.length;n<i;n++){var r=t[n];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,i=0;i<n.length&&!(t<n[i].distance);i++);n.splice(i,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object},raycast:(Da=new Nt,function(e,t){Da.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Da);this.getObjectForDistance(n).raycast(e,t)}),update:(qa=new Nt,Xa=new Nt,function(e){var t=this.levels;if(1<t.length){qa.setFromMatrixPosition(e.matrixWorld),Xa.setFromMatrixPosition(this.matrixWorld);var n=qa.distanceTo(Xa);t[0].object.visible=!0;for(var i=1,r=t.length;i<r&&n>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(;i<r;i++)t[i].object.visible=!1}}),toJSON:function(e){var t=Ai.prototype.toJSON.call(this,e);t.object.levels=[];for(var n=this.levels,i=0,r=n.length;i<r;i++){var o=n[i];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),bs.prototype=Object.assign(Object.create(Qr.prototype),{constructor:bs,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new xn,t=this.geometry.attributes.skinWeight,n=0,i=t.count;n<i;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var r=1/e.manhattanLength();r!=1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Qr.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(ws.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Ht;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(Ia=new Ht,Oa=new Ht,function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture,r=0,o=e.length;r<o;r++){var a=e[r]?e[r].matrixWorld:Oa;Ia.multiplyMatrices(a,t[r]),Ia.toArray(n,16*r)}void 0!==i&&(i.needsUpdate=!0)}),clone:function(){return new ws(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var i=this.bones[t];if(i.name===e)return i}}}),xs.prototype=Object.assign(Object.create(Ai.prototype),{constructor:xs,isBone:!0}),((Es.prototype=Object.create(Gr.prototype)).constructor=Es).prototype.isLineBasicMaterial=!0,Es.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},Ms.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Ms,isLine:!0,computeLineDistances:(ka=new Nt,ja=new Nt,function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],i=1,r=t.count;i<r;i++)ka.fromBufferAttribute(t,i-1),ja.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=ka.distanceTo(ja);e.addAttribute("lineDistance",new ji(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var o=e.vertices;(n=e.lineDistances)[0]=0;for(i=1,r=o.length;i<r;i++)n[i]=n[i-1],n[i]+=o[i-1].distanceTo(o[i])}return this}),raycast:(Ga=new Ht,Va=new Wr,Wa=new Ln,function(e,t){var n=e.linePrecision,i=this.geometry,r=this.matrixWorld;if(null===i.boundingSphere&&i.computeBoundingSphere(),Wa.copy(i.boundingSphere),Wa.applyMatrix4(r),Wa.radius+=n,!1!==e.ray.intersectsSphere(Wa)){Ga.getInverse(r),Va.copy(e.ray).applyMatrix4(Ga);var o=n/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,s=new Nt,c=new Nt,l=new Nt,u=new Nt,h=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var d=i.index,p=i.attributes.position.array;if(null!==d)for(var f=d.array,m=0,v=f.length-1;m<v;m+=h){var g=f[m],y=f[m+1];s.fromArray(p,3*g),c.fromArray(p,3*y),a<Va.distanceSqToSegment(s,c,u,l)||(u.applyMatrix4(this.matrixWorld),(w=e.ray.origin.distanceTo(u))<e.near||w>e.far||t.push({distance:w,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this}))}else for(m=0,v=p.length/3-1;m<v;m+=h)s.fromArray(p,3*m),c.fromArray(p,3*m+3),a<Va.distanceSqToSegment(s,c,u,l)||(u.applyMatrix4(this.matrixWorld),(w=e.ray.origin.distanceTo(u))<e.near||w>e.far||t.push({distance:w,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this}))}else if(i.isGeometry){var A=i.vertices,b=A.length;for(m=0;m<b-1;m+=h){var w;a<Va.distanceSqToSegment(A[m],A[m+1],u,l)||(u.applyMatrix4(this.matrixWorld),(w=e.ray.origin.distanceTo(u))<e.near||w>e.far||t.push({distance:w,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this}))}}}}),copy:function(e){return Ai.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}}),Ts.prototype=Object.assign(Object.create(Ms.prototype),{constructor:Ts,isLineSegments:!0,computeLineDistances:(za=new Nt,Ua=new Nt,function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],i=0,r=t.count;i<r;i+=2)za.fromBufferAttribute(t,i),Ua.fromBufferAttribute(t,i+1),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+za.distanceTo(Ua);e.addAttribute("lineDistance",new ji(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var o=e.vertices;for(n=e.lineDistances,i=0,r=o.length;i<r;i+=2)za.copy(o[i]),Ua.copy(o[i+1]),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+za.distanceTo(Ua)}return this})}),Ss.prototype=Object.assign(Object.create(Ms.prototype),{constructor:Ss,isLineLoop:!0}),((Cs.prototype=Object.create(Gr.prototype)).constructor=Cs).prototype.isPointsMaterial=!0,Cs.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},Ls.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Ls,isPoints:!0,raycast:(Ha=new Ht,Fa=new Wr,Na=new Ln,function(r,o){var a=this,e=this.geometry,s=this.matrixWorld,t=r.params.Points.threshold;if(null===e.boundingSphere&&e.computeBoundingSphere(),Na.copy(e.boundingSphere),Na.applyMatrix4(s),Na.radius+=t,!1!==r.ray.intersectsSphere(Na)){Ha.getInverse(s),Fa.copy(r.ray).applyMatrix4(Ha);var n=t/((this.scale.x+this.scale.y+this.scale.z)/3),c=n*n,i=new Nt,l=new Nt;if(e.isBufferGeometry){var u=e.index,h=e.attributes.position.array;if(null!==u)for(var d=u.array,p=0,f=d.length;p<f;p++){var m=d[p];i.fromArray(h,3*m),y(i,m)}else{p=0;for(var v=h.length/3;p<v;p++)i.fromArray(h,3*p),y(i,p)}}else{var g=e.vertices;for(p=0,v=g.length;p<v;p++)y(g[p],p)}}function y(e,t){var n=Fa.distanceSqToPoint(e);if(n<c){Fa.closestPointToPoint(e,l),l.applyMatrix4(s);var i=r.ray.origin.distanceTo(l);if(i<r.near||i>r.far)return;o.push({distance:i,distanceToRay:Math.sqrt(n),point:l.clone(),index:t,face:null,object:a})}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),_s.prototype=Object.assign(Object.create(wn.prototype),{constructor:_s,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),((Bs.prototype=Object.create(wn.prototype)).constructor=Bs).prototype.isCompressedTexture=!0,((Rs.prototype=Object.create(wn.prototype)).constructor=Rs).prototype.isCanvasTexture=!0,((Ps.prototype=Object.create(wn.prototype)).constructor=Ps).prototype.isDepthTexture=!0,(Ds.prototype=Object.create(Ji.prototype)).constructor=Ds,(Is.prototype=Object.create(Li.prototype)).constructor=Is,(Os.prototype=Object.create(Ji.prototype)).constructor=Os,(ks.prototype=Object.create(Li.prototype)).constructor=ks,(js.prototype=Object.create(Ji.prototype)).constructor=js,(Hs.prototype=Object.create(Li.prototype)).constructor=Hs,(Fs.prototype=Object.create(js.prototype)).constructor=Fs,(Ns.prototype=Object.create(Li.prototype)).constructor=Ns,(zs.prototype=Object.create(js.prototype)).constructor=zs,(Us.prototype=Object.create(Li.prototype)).constructor=Us,(Gs.prototype=Object.create(js.prototype)).constructor=Gs,(Vs.prototype=Object.create(Li.prototype)).constructor=Vs,(Ws.prototype=Object.create(js.prototype)).constructor=Ws,(qs.prototype=Object.create(Li.prototype)).constructor=qs,(Xs.prototype=Object.create(Ji.prototype)).constructor=Xs,(Qs.prototype=Object.create(Li.prototype)).constructor=Qs,(Ys.prototype=Object.create(Ji.prototype)).constructor=Ys,(Zs.prototype=Object.create(Li.prototype)).constructor=Zs,(Ks.prototype=Object.create(Ji.prototype)).constructor=Ks;var $s=function(e,t,n){n=n||2;var i,r,o,a,s,c,l,u=t&&t.length,h=u?t[0]*n:e.length,d=ec(e,0,h,n,!0),p=[];if(!d)return p;if(u&&(d=function(e,t,n,i){var r,o,a,s=[];for(r=0,o=t.length;r<o;r++)(a=ec(e,t[r]*i,r<o-1?t[r+1]*i:e.length,i,!1))===a.next&&(a.steiner=!0),s.push(uc(a));for(s.sort(sc),r=0;r<s.length;r++)cc(s[r],n),n=tc(n,n.next);return n}(e,t,d,n)),e.length>80*n){i=o=e[0],r=a=e[1];for(var f=n;f<h;f+=n)(s=e[f])<i&&(i=s),(c=e[f+1])<r&&(r=c),o<s&&(o=s),a<c&&(a=c);l=0!==(l=Math.max(o-i,a-r))?1/l:0}return nc(d,p,n,i,r,l),p};function ec(e,a,t,n,i){var r,o;if(i===0<function(e,t,n){for(var i=0,r=a,o=t-n;r<t;r+=n)i+=(e[o]-e[r])*(e[r+1]+e[o+1]),o=r;return i}(e,t,n))for(r=a;r<t;r+=n)o=gc(r,e[r],e[r+1],o);else for(r=t-n;a<=r;r-=n)o=gc(r,e[r],e[r+1],o);return o&&pc(o,o.next)&&(yc(o),o=o.next),o}function tc(e,t){if(!e)return e;t=t||e;var n,i=e;do{if(n=!1,i.steiner||!pc(i,i.next)&&0!==dc(i.prev,i,i.next))i=i.next;else{if(yc(i),(i=t=i.prev)===i.next)break;n=!0}}while(n||i!==t);return t}function nc(e,t,n,i,r,o,a){if(e){!a&&o&&function(e,t,n,i){for(var r=e;null===r.z&&(r.z=lc(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,(r=r.next)!==e;);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,n,i,r,o,a,s,c,l=1;do{for(n=e,o=e=null,a=0;n;){for(a++,i=n,t=s=0;t<l&&(s++,i=i.nextZ);t++);for(c=l;0<s||0<c&&i;)0!==s&&(0===c||!i||n.z<=i.z)?(n=(r=n).nextZ,s--):(i=(r=i).nextZ,c--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(1<a)}(r)}(e,i,r,o);for(var s,c,l=e;e.prev!==e.next;)if(s=e.prev,c=e.next,o?rc(e,i,r,o):ic(e))t.push(s.i/n),t.push(e.i/n),t.push(c.i/n),yc(e),e=c.next,l=c.next;else if((e=c)===l){a?1===a?nc(e=oc(e,t,n),t,n,i,r,o,2):2===a&&ac(e,t,n,i,r,o):nc(tc(e),t,n,i,r,o,1);break}}}function ic(e){var t=e.prev,n=e,i=e.next;if(0<=dc(t,n,i))return!1;for(var r=e.next.next;r!==e.prev;){if(hc(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=dc(r.prev,r,r.next))return!1;r=r.next}return!0}function rc(e,t,n,i){var r=e.prev,o=e,a=e.next;if(0<=dc(r,o,a))return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,c=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,l=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,u=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,h=lc(s,c,t,n,i),d=lc(l,u,t,n,i),p=e.nextZ;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&hc(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=dc(p.prev,p,p.next))return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&hc(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=dc(p.prev,p,p.next))return!1;p=p.prevZ}return!0}function oc(e,t,n){var i=e;do{var r=i.prev,o=i.next.next;!pc(r,o)&&fc(r,i,i.next,o)&&mc(r,o)&&mc(o,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(o.i/n),yc(i),yc(i.next),i=e=o),i=i.next}while(i!==e);return i}function ac(e,t,n,i,r,o){var a,s,c=e;do{for(var l=c.next.next;l!==c.prev;){if(c.i!==l.i&&(s=l,(a=c).next.i!==s.i&&a.prev.i!==s.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&fc(n,n.next,e,t))return 1;n=n.next}while(n!==e);return 0}(a,s)&&mc(a,s)&&mc(s,a)&&function(e,t){for(var n=e,i=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),(n=n.next)!==e;);return i}(a,s))){var u=vc(c,l);return c=tc(c,c.next),u=tc(u,u.next),nc(c,t,n,i,r,o),void nc(u,t,n,i,r,o)}l=l.next}c=c.next}while(c!==e)}function sc(e,t){return e.x-t.x}function cc(e,t){if(t=function(e,t){var n,i=t,r=e.x,o=e.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&a<s){if((a=s)===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===a)return n.prev;var c,l=n,u=n.x,h=n.y,d=1/0;for(i=n.next;i!==l;)r>=i.x&&i.x>=u&&r!==i.x&&hc(o<h?r:a,o,u,h,o<h?a:r,o,i.x,i.y)&&((c=Math.abs(o-i.y)/(r-i.x))<d||c===d&&i.x>n.x)&&mc(i,e)&&(n=i,d=c),i=i.next;return n}(e,t)){var n=vc(t,e);tc(n,n.next)}}function lc(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function uc(e){for(var t=e,n=e;t.x<n.x&&(n=t),(t=t.next)!==e;);return n}function hc(e,t,n,i,r,o,a,s){return 0<=(r-a)*(t-s)-(e-a)*(o-s)&&0<=(e-a)*(i-s)-(n-a)*(t-s)&&0<=(n-a)*(o-s)-(r-a)*(i-s)}function dc(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function pc(e,t){return e.x===t.x&&e.y===t.y}function fc(e,t,n,i){return!!(pc(e,t)&&pc(n,i)||pc(e,i)&&pc(n,t))||0<dc(e,t,n)!=0<dc(e,t,i)&&0<dc(n,i,e)!=0<dc(n,i,t)}function mc(e,t){return dc(e.prev,e,e.next)<0?0<=dc(e,t,e.next)&&0<=dc(e,e.prev,t):dc(e,t,e.prev)<0||dc(e,e.next,t)<0}function vc(e,t){var n=new Ac(e.i,e.x,e.y),i=new Ac(t.i,t.x,t.y),r=e.next,o=t.prev;return(e.next=t).prev=e,(n.next=r).prev=n,(i.next=n).prev=i,(o.next=i).prev=o,i}function gc(e,t,n,i){var r=new Ac(e,t,n);return i?(r.next=i.next,(r.prev=i).next.prev=r,i.next=r):(r.prev=r).next=r,r}function yc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ac(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var bc={area:function(e){for(var t=e.length,n=0,i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n},isClockWise:function(e){return bc.area(e)<0},triangulateShape:function(e,t){var n=[],i=[],r=[];wc(e),xc(n,e);var o=e.length;t.forEach(wc);for(var a=0;a<t.length;a++)i.push(o),o+=t[a].length,xc(n,t[a]);var s=$s(n,i);for(a=0;a<s.length;a+=3)r.push(s.slice(a,a+3));return r}};function wc(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function xc(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function Ec(e,t){Li.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Mc(e,t)),this.mergeVertices()}function Mc(e,Z){Ji.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:Z},e=Array.isArray(e)?e:[e];for(var K=this,J=[],$=[],t=0,n=e.length;t<n;t++){i(e[t])}function i(e){var i=[],t=void 0!==Z.curveSegments?Z.curveSegments:12,c=void 0!==Z.steps?Z.steps:1,n=void 0!==Z.depth?Z.depth:100,r=void 0===Z.bevelEnabled||Z.bevelEnabled,o=void 0!==Z.bevelThickness?Z.bevelThickness:6,a=void 0!==Z.bevelSize?Z.bevelSize:o-2,l=void 0!==Z.bevelSegments?Z.bevelSegments:3,s=Z.extrudePath,u=void 0!==Z.UVGenerator?Z.UVGenerator:Tc;void 0!==Z.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),n=Z.amount);var h,d,p,f,m,v,g,y,A=!1;s&&(h=s.getSpacedPoints(c),r=!(A=!0),d=s.computeFrenetFrames(c,!1),p=new Nt,f=new Nt,m=new Nt),r||(a=o=l=0);var b=e.extractPoints(t),w=b.shape,x=b.holes;if(!bc.isClockWise(w))for(w=w.reverse(),g=0,y=x.length;g<y;g++)v=x[g],bc.isClockWise(v)&&(x[g]=v.reverse());var E=bc.triangulateShape(w,x),M=w;for(g=0,y=x.length;g<y;g++)v=x[g],w=w.concat(v);function T(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var S,C,L,_,B,R,P=w.length,D=E.length;function I(e,t,n){var i,r,o,a=e.x-t.x,s=e.y-t.y,c=n.x-e.x,l=n.y-e.y,u=a*a+s*s,h=a*l-s*c;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(u),p=Math.sqrt(c*c+l*l),f=t.x-s/d,m=t.y+a/d,v=((n.x-l/p-f)*l-(n.y+c/p-m)*c)/(a*l-s*c),g=(i=f+a*v-e.x)*i+(r=m+s*v-e.y)*r;if(g<=2)return new jt(i,r);o=Math.sqrt(g/2)}else{var y=!1;a>Number.EPSILON?c>Number.EPSILON&&(y=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(l)&&(y=!0),o=y?(i=-s,r=a,Math.sqrt(u)):(i=a,r=s,Math.sqrt(u/2))}return new jt(i/o,r/o)}for(var O=[],k=0,j=M.length,H=j-1,F=k+1;k<j;k++,H++,F++)H===j&&(H=0),F===j&&(F=0),O[k]=I(M[k],M[H],M[F]);var N,z,U=[],G=O.concat();for(g=0,y=x.length;g<y;g++){for(v=x[g],N=[],k=0,H=(j=v.length)-1,F=k+1;k<j;k++,H++,F++)H===j&&(H=0),F===j&&(F=0),N[k]=I(v[k],v[H],v[F]);U.push(N),G=G.concat(N)}for(S=0;S<l;S++){for(L=S/l,_=o*Math.cos(L*Math.PI/2),C=a*Math.sin(L*Math.PI/2),k=0,j=M.length;k<j;k++)W((B=T(M[k],O[k],C)).x,B.y,-_);for(g=0,y=x.length;g<y;g++)for(v=x[g],N=U[g],k=0,j=v.length;k<j;k++)W((B=T(v[k],N[k],C)).x,B.y,-_)}for(C=a,k=0;k<P;k++)B=r?T(w[k],G[k],C):w[k],A?(f.copy(d.normals[0]).multiplyScalar(B.x),p.copy(d.binormals[0]).multiplyScalar(B.y),m.copy(h[0]).add(f).add(p),W(m.x,m.y,m.z)):W(B.x,B.y,0);for(z=1;z<=c;z++)for(k=0;k<P;k++)B=r?T(w[k],G[k],C):w[k],A?(f.copy(d.normals[z]).multiplyScalar(B.x),p.copy(d.binormals[z]).multiplyScalar(B.y),m.copy(h[z]).add(f).add(p),W(m.x,m.y,m.z)):W(B.x,B.y,n/c*z);for(S=l-1;0<=S;S--){for(L=S/l,_=o*Math.cos(L*Math.PI/2),C=a*Math.sin(L*Math.PI/2),k=0,j=M.length;k<j;k++)W((B=T(M[k],O[k],C)).x,B.y,n+_);for(g=0,y=x.length;g<y;g++)for(v=x[g],N=U[g],k=0,j=v.length;k<j;k++)B=T(v[k],N[k],C),A?W(B.x,B.y+h[c-1].y,h[c-1].x+_):W(B.x,B.y,n+_)}function V(e,t){var n,i;for(k=e.length;0<=--k;){(i=(n=k)-1)<0&&(i=e.length-1);var r=0,o=c+2*l;for(r=0;r<o;r++){var a=P*r,s=P*(r+1);X(t+n+a,t+i+a,t+i+s,t+n+s)}}}function W(e,t,n){i.push(e),i.push(t),i.push(n)}function q(e,t,n){Q(e),Q(t),Q(n);var i=J.length/3,r=u.generateTopUV(K,J,i-3,i-2,i-1);Y(r[0]),Y(r[1]),Y(r[2])}function X(e,t,n,i){Q(e),Q(t),Q(i),Q(t),Q(n),Q(i);var r=J.length/3,o=u.generateSideWallUV(K,J,r-6,r-3,r-2,r-1);Y(o[0]),Y(o[1]),Y(o[3]),Y(o[1]),Y(o[2]),Y(o[3])}function Q(e){J.push(i[3*e+0]),J.push(i[3*e+1]),J.push(i[3*e+2])}function Y(e){$.push(e.x),$.push(e.y)}!function(){var e=J.length/3;if(r){var t=0,n=P*t;for(k=0;k<D;k++)q((R=E[k])[2]+n,R[1]+n,R[0]+n);for(n=P*(t=c+2*l),k=0;k<D;k++)q((R=E[k])[0]+n,R[1]+n,R[2]+n)}else{for(k=0;k<D;k++)q((R=E[k])[2],R[1],R[0]);for(k=0;k<D;k++)q((R=E[k])[0]+P*c,R[1]+P*c,R[2]+P*c)}K.addGroup(e,J.length/3-e,0)}(),function(){var e=J.length/3,t=0;for(V(M,t),t+=M.length,g=0,y=x.length;g<y;g++)V(v=x[g],t),t+=v.length;K.addGroup(e,J.length/3-e,1)}()}this.addAttribute("position",new ji(J,3)),this.addAttribute("uv",new ji($,2)),this.computeVertexNormals()}((Ec.prototype=Object.create(Li.prototype)).constructor=Ec).prototype.toJSON=function(){var e=Li.prototype.toJSON.call(this);return Sc(this.parameters.shapes,this.parameters.options,e)},((Mc.prototype=Object.create(Ji.prototype)).constructor=Mc).prototype.toJSON=function(){var e=Ji.prototype.toJSON.call(this);return Sc(this.parameters.shapes,this.parameters.options,e)};var Tc={generateTopUV:function(e,t,n,i,r){var o=t[3*n],a=t[3*n+1],s=t[3*i],c=t[3*i+1],l=t[3*r],u=t[3*r+1];return[new jt(o,a),new jt(s,c),new jt(l,u)]},generateSideWallUV:function(e,t,n,i,r,o){var a=t[3*n],s=t[3*n+1],c=t[3*n+2],l=t[3*i],u=t[3*i+1],h=t[3*i+2],d=t[3*r],p=t[3*r+1],f=t[3*r+2],m=t[3*o],v=t[3*o+1],g=t[3*o+2];return Math.abs(s-u)<.01?[new jt(a,1-c),new jt(l,1-h),new jt(d,1-f),new jt(m,1-g)]:[new jt(s,1-c),new jt(u,1-h),new jt(p,1-f),new jt(v,1-g)]}};function Sc(e,t,n){if(n.shapes=[],Array.isArray(e))for(var i=0,r=e.length;i<r;i++){var o=e[i];n.shapes.push(o.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function Cc(e,t){Li.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Lc(e,t)),this.mergeVertices()}function Lc(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Li;var i=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Mc.call(this,i,t),this.type="TextBufferGeometry"}function _c(e,t,n,i,r,o,a){Li.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Bc(e,t,n,i,r,o,a)),this.mergeVertices()}function Bc(e,t,n,i,r,o,a){Ji.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI;var s,c,l=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),u=0,h=[],d=new Nt,p=new Nt,f=[],m=[],v=[],g=[];for(c=0;c<=n;c++){var y=[],A=c/n;for(s=0;s<=t;s++){var b=s/t;d.x=-e*Math.cos(i+b*r)*Math.sin(o+A*a),d.y=e*Math.cos(o+A*a),d.z=e*Math.sin(i+b*r)*Math.sin(o+A*a),m.push(d.x,d.y,d.z),p.set(d.x,d.y,d.z).normalize(),v.push(p.x,p.y,p.z),g.push(b,1-A),y.push(u++)}h.push(y)}for(c=0;c<n;c++)for(s=0;s<t;s++){var w=h[c][s+1],x=h[c][s],E=h[c+1][s],M=h[c+1][s+1];(0!==c||0<o)&&f.push(w,x,M),(c!==n-1||l<Math.PI)&&f.push(x,E,M)}this.setIndex(f),this.addAttribute("position",new ji(m,3)),this.addAttribute("normal",new ji(v,3)),this.addAttribute("uv",new ji(g,2))}function Rc(e,t,n,i,r,o){Li.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new Pc(e,t,n,i,r,o)),this.mergeVertices()}function Pc(e,t,n,i,r,o){Ji.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},e=e||.5,t=t||1,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,c,l=[],u=[],h=[],d=[],p=e,f=(t-e)/(i=void 0!==i?Math.max(1,i):1),m=new Nt,v=new jt;for(s=0;s<=i;s++){for(c=0;c<=n;c++)a=r+c/n*o,m.x=p*Math.cos(a),m.y=p*Math.sin(a),u.push(m.x,m.y,m.z),h.push(0,0,1),v.x=(m.x/t+1)/2,v.y=(m.y/t+1)/2,d.push(v.x,v.y);p+=f}for(s=0;s<i;s++){var g=s*(n+1);for(c=0;c<n;c++){var y=a=c+g,A=a+n+1,b=a+n+2,w=a+1;l.push(y,A,w),l.push(A,b,w)}}this.setIndex(l),this.addAttribute("position",new ji(u,3)),this.addAttribute("normal",new ji(h,3)),this.addAttribute("uv",new ji(d,2))}function Dc(e,t,n,i){Li.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},this.fromBufferGeometry(new Ic(e,t,n,i)),this.mergeVertices()}function Ic(e,t,n,i){Ji.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t)||12,n=n||0,i=i||2*Math.PI,i=kt.clamp(i,0,2*Math.PI);var r,o,a,s=[],c=[],l=[],u=1/t,h=new Nt,d=new jt;for(o=0;o<=t;o++){var p=n+o*u*i,f=Math.sin(p),m=Math.cos(p);for(a=0;a<=e.length-1;a++)h.x=e[a].x*f,h.y=e[a].y,h.z=e[a].x*m,c.push(h.x,h.y,h.z),d.x=o/t,d.y=a/(e.length-1),l.push(d.x,d.y)}for(o=0;o<t;o++)for(a=0;a<e.length-1;a++){var v=r=a+o*e.length,g=r+e.length,y=r+e.length+1,A=r+1;s.push(v,g,A),s.push(g,y,A)}if(this.setIndex(s),this.addAttribute("position",new ji(c,3)),this.addAttribute("uv",new ji(l,2)),this.computeVertexNormals(),i===2*Math.PI){var b=this.attributes.normal.array,w=new Nt,x=new Nt,E=new Nt;for(r=t*e.length*3,a=o=0;o<e.length;o++,a+=3)w.x=b[a+0],w.y=b[a+1],w.z=b[a+2],x.x=b[r+a+0],x.y=b[r+a+1],x.z=b[r+a+2],E.addVectors(w,x).normalize(),b[a+0]=b[r+a+0]=E.x,b[a+1]=b[r+a+1]=E.y,b[a+2]=b[r+a+2]=E.z}}function Oc(e,t){Li.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new kc(e,t)),this.mergeVertices()}function kc(e,f){Ji.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:f},f=f||12;var m=[],v=[],g=[],y=[],t=0,A=0;if(!1===Array.isArray(e))i(e);else for(var n=0;n<e.length;n++)i(e[n]),this.addGroup(t,A,n),t+=A,A=0;function i(e){var t,n,i,r=v.length/3,o=e.extractPoints(f),a=o.shape,s=o.holes;for(!1===bc.isClockWise(a)&&(a=a.reverse()),t=0,n=s.length;t<n;t++)i=s[t],!0===bc.isClockWise(i)&&(s[t]=i.reverse());var c=bc.triangulateShape(a,s);for(t=0,n=s.length;t<n;t++)i=s[t],a=a.concat(i);for(t=0,n=a.length;t<n;t++){var l=a[t];v.push(l.x,l.y,0),g.push(0,0,1),y.push(l.x,l.y)}for(t=0,n=c.length;t<n;t++){var u=c[t],h=u[0]+r,d=u[1]+r,p=u[2]+r;m.push(h,d,p),A+=3}}this.setIndex(m),this.addAttribute("position",new ji(v,3)),this.addAttribute("normal",new ji(g,3)),this.addAttribute("uv",new ji(y,2))}function jc(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}function Hc(e,t){Ji.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,i,r,o,a=[],s=Math.cos(kt.DEG2RAD*t),c=[0,0],l={},u=["a","b","c"];e.isBufferGeometry?(o=new Li).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,d=o.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],v=0;v<3;v++)n=m[u[v]],i=m[u[(v+1)%3]],c[0]=Math.min(n,i),c[1]=Math.max(n,i),void 0===l[r=c[0]+","+c[1]]?l[r]={index1:c[0],index2:c[1],face1:p,face2:void 0}:l[r].face2=p;for(r in l){var g=l[r];if(void 0===g.face2||d[g.face1].normal.dot(d[g.face2].normal)<=s){var y=h[g.index1];a.push(y.x,y.y,y.z),y=h[g.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new ji(a,3))}function Fc(e,t,n,i,r,o,a,s){Li.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Nc(e,t,n,i,r,o,a,s)),this.mergeVertices()}function Nc(g,y,A,b,w,e,x,E){Ji.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:g,radiusBottom:y,height:A,radialSegments:b,heightSegments:w,openEnded:e,thetaStart:x,thetaLength:E};var M=this;g=void 0!==g?g:1,y=void 0!==y?y:1,A=A||1,b=Math.floor(b)||8,w=Math.floor(w)||1,e=void 0!==e&&e,x=void 0!==x?x:0,E=void 0!==E?E:2*Math.PI;var T=[],S=[],C=[],L=[],_=0,B=[],R=A/2,P=0;function t(e){var t,n,i,r=new jt,o=new Nt,a=0,s=!0===e?g:y,c=!0===e?1:-1;for(n=_,t=1;t<=b;t++)S.push(0,R*c,0),C.push(0,c,0),L.push(.5,.5),_++;for(i=_,t=0;t<=b;t++){var l=t/b*E+x,u=Math.cos(l),h=Math.sin(l);o.x=s*h,o.y=R*c,o.z=s*u,S.push(o.x,o.y,o.z),C.push(0,c,0),r.x=.5*u+.5,r.y=.5*h*c+.5,L.push(r.x,r.y),_++}for(t=0;t<b;t++){var d=n+t,p=i+t;!0===e?T.push(p,p+1,d):T.push(p+1,p,d),a+=3}M.addGroup(P,a,!0===e?1:2),P+=a}!function(){var e,t,n=new Nt,i=new Nt,r=0,o=(y-g)/A;for(t=0;t<=w;t++){var a=[],s=t/w,c=s*(y-g)+g;for(e=0;e<=b;e++){var l=e/b,u=l*E+x,h=Math.sin(u),d=Math.cos(u);i.x=c*h,i.y=-s*A+R,i.z=c*d,S.push(i.x,i.y,i.z),n.set(h,o,d).normalize(),C.push(n.x,n.y,n.z),L.push(l,1-s),a.push(_++)}B.push(a)}for(e=0;e<b;e++)for(t=0;t<w;t++){var p=B[t][e],f=B[t+1][e],m=B[t+1][e+1],v=B[t][e+1];T.push(p,f,v),T.push(f,m,v),r+=6}M.addGroup(P,r,0),P+=r}(),!1===e&&(0<g&&t(!0),0<y&&t(!1)),this.setIndex(T),this.addAttribute("position",new ji(S,3)),this.addAttribute("normal",new ji(C,3)),this.addAttribute("uv",new ji(L,2))}function zc(e,t,n,i,r,o,a){Fc.call(this,0,e,t,n,i,r,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}function Uc(e,t,n,i,r,o,a){Nc.call(this,0,e,t,n,i,r,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}function Gc(e,t,n,i){Li.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new Vc(e,t,n,i)),this.mergeVertices()}function Vc(e,t,n,i){Ji.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var r,o,a=[],s=[],c=[],l=[],u=new Nt,h=new jt;for(s.push(0,0,0),c.push(0,0,1),l.push(.5,.5),o=0,r=3;o<=t;o++,r+=3){var d=n+o/t*i;u.x=e*Math.cos(d),u.y=e*Math.sin(d),s.push(u.x,u.y,u.z),c.push(0,0,1),h.x=(s[r]/e+1)/2,h.y=(s[r+1]/e+1)/2,l.push(h.x,h.y)}for(r=1;r<=t;r++)a.push(r,r+1,0);this.setIndex(a),this.addAttribute("position",new ji(s,3)),this.addAttribute("normal",new ji(c,3)),this.addAttribute("uv",new ji(l,2))}(Cc.prototype=Object.create(Li.prototype)).constructor=Cc,(Lc.prototype=Object.create(Mc.prototype)).constructor=Lc,(_c.prototype=Object.create(Li.prototype)).constructor=_c,(Bc.prototype=Object.create(Ji.prototype)).constructor=Bc,(Rc.prototype=Object.create(Li.prototype)).constructor=Rc,(Pc.prototype=Object.create(Ji.prototype)).constructor=Pc,(Dc.prototype=Object.create(Li.prototype)).constructor=Dc,(Ic.prototype=Object.create(Ji.prototype)).constructor=Ic,((Oc.prototype=Object.create(Li.prototype)).constructor=Oc).prototype.toJSON=function(){var e=Li.prototype.toJSON.call(this);return jc(this.parameters.shapes,e)},((kc.prototype=Object.create(Ji.prototype)).constructor=kc).prototype.toJSON=function(){var e=Ji.prototype.toJSON.call(this);return jc(this.parameters.shapes,e)},(Hc.prototype=Object.create(Ji.prototype)).constructor=Hc,(Fc.prototype=Object.create(Li.prototype)).constructor=Fc,(Nc.prototype=Object.create(Ji.prototype)).constructor=Nc,(zc.prototype=Object.create(Fc.prototype)).constructor=zc,(Uc.prototype=Object.create(Nc.prototype)).constructor=Uc,(Gc.prototype=Object.create(Li.prototype)).constructor=Gc,(Vc.prototype=Object.create(Ji.prototype)).constructor=Vc;var Wc=Object.freeze({WireframeGeometry:Ds,ParametricGeometry:Is,ParametricBufferGeometry:Os,TetrahedronGeometry:Hs,TetrahedronBufferGeometry:Fs,OctahedronGeometry:Ns,OctahedronBufferGeometry:zs,IcosahedronGeometry:Us,IcosahedronBufferGeometry:Gs,DodecahedronGeometry:Vs,DodecahedronBufferGeometry:Ws,PolyhedronGeometry:ks,PolyhedronBufferGeometry:js,TubeGeometry:qs,TubeBufferGeometry:Xs,TorusKnotGeometry:Qs,TorusKnotBufferGeometry:Ys,TorusGeometry:Zs,TorusBufferGeometry:Ks,TextGeometry:Cc,TextBufferGeometry:Lc,SphereGeometry:_c,SphereBufferGeometry:Bc,RingGeometry:Rc,RingBufferGeometry:Pc,PlaneGeometry:tr,PlaneBufferGeometry:nr,LatheGeometry:Dc,LatheBufferGeometry:Ic,ShapeGeometry:Oc,ShapeBufferGeometry:kc,ExtrudeGeometry:Ec,ExtrudeBufferGeometry:Mc,EdgesGeometry:Hc,ConeGeometry:zc,ConeBufferGeometry:Uc,CylinderGeometry:Fc,CylinderBufferGeometry:Nc,CircleGeometry:Gc,CircleBufferGeometry:Vc,BoxGeometry:$i,BoxBufferGeometry:er});function qc(e){Gr.call(this),this.type="ShadowMaterial",this.color=new zn(0),this.transparent=!0,this.setValues(e)}function Xc(e){Vr.call(this,e),this.type="RawShaderMaterial"}function Qc(e){Gr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new zn(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=It,this.normalScale=new jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Yc(e){Qc.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function Zc(e){Gr.call(this),this.type="MeshPhongMaterial",this.color=new zn(16777215),this.specular=new zn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=It,this.normalScale=new jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=G,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Kc(e){Zc.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function Jc(e){Gr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=It,this.normalScale=new jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function $c(e){Gr.call(this),this.type="MeshLambertMaterial",this.color=new zn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=G,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function el(e){Gr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new zn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=It,this.normalScale=new jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(e)}function tl(e){Es.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}((qc.prototype=Object.create(Gr.prototype)).constructor=qc).prototype.isShadowMaterial=!0,qc.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.color.copy(e.color),this},((Xc.prototype=Object.create(Vr.prototype)).constructor=Xc).prototype.isRawShaderMaterial=!0,((Qc.prototype=Object.create(Gr.prototype)).constructor=Qc).prototype.isMeshStandardMaterial=!0,Qc.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Yc.prototype=Object.create(Qc.prototype)).constructor=Yc).prototype.isMeshPhysicalMaterial=!0,Yc.prototype.copy=function(e){return Qc.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},((Zc.prototype=Object.create(Gr.prototype)).constructor=Zc).prototype.isMeshPhongMaterial=!0,Zc.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Kc.prototype=Object.create(Zc.prototype)).constructor=Kc).prototype.isMeshToonMaterial=!0,Kc.prototype.copy=function(e){return Zc.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},((Jc.prototype=Object.create(Gr.prototype)).constructor=Jc).prototype.isMeshNormalMaterial=!0,Jc.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},(($c.prototype=Object.create(Gr.prototype)).constructor=$c).prototype.isMeshLambertMaterial=!0,$c.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((el.prototype=Object.create(Gr.prototype)).constructor=el).prototype.isMeshMatcapMaterial=!0,el.prototype.copy=function(e){return Gr.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((tl.prototype=Object.create(Es.prototype)).constructor=tl).prototype.isLineDashedMaterial=!0,tl.prototype.copy=function(e){return Es.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var nl=Object.freeze({ShadowMaterial:qc,SpriteMaterial:gs,RawShaderMaterial:Xc,ShaderMaterial:Vr,PointsMaterial:Cs,MeshPhysicalMaterial:Yc,MeshStandardMaterial:Qc,MeshPhongMaterial:Zc,MeshToonMaterial:Kc,MeshNormalMaterial:Jc,MeshLambertMaterial:$c,MeshDepthMaterial:xa,MeshDistanceMaterial:Ea,MeshBasicMaterial:Xr,MeshMatcapMaterial:el,LineDashedMaterial:tl,LineBasicMaterial:Es,Material:Gr}),il={arraySlice:function(e,t,n){return il.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(n){for(var e=n.length,t=new Array(e),i=0;i!==e;++i)t[i]=i;return t.sort(function(e,t){return n[e]-n[t]}),t},sortedArray:function(e,t,n){for(var i=e.length,r=new e.constructor(i),o=0,a=0;a!==i;++o)for(var s=n[o]*t,c=0;c!==t;++c)r[a++]=e[s+c];return r},flattenJSON:function(e,t,n,i){for(var r=1,o=e[0];void 0!==o&&void 0===o[i];)o=e[r++];if(void 0!==o){var a=o[i];if(void 0!==a)if(Array.isArray(a))for(;void 0!==(a=o[i])&&(t.push(o.time),n.push.apply(n,a)),void 0!==(o=e[r++]););else if(void 0!==a.toArray)for(;void 0!==(a=o[i])&&(t.push(o.time),a.toArray(n,n.length)),void 0!==(o=e[r++]););else for(;void 0!==(a=o[i])&&(t.push(o.time),n.push(a)),void 0!==(o=e[r++]););}}};function rl(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function ol(e,t,n,i){rl.call(this,e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function al(e,t,n,i){rl.call(this,e,t,n,i)}function sl(e,t,n,i){rl.call(this,e,t,n,i)}function cl(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=il.convertArray(t,this.TimeBufferType),this.values=il.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}function ll(e,t,n){cl.call(this,e,t,n)}function ul(e,t,n,i){cl.call(this,e,t,n,i)}function hl(e,t,n,i){cl.call(this,e,t,n,i)}function dl(e,t,n,i){rl.call(this,e,t,n,i)}function pl(e,t,n,i){cl.call(this,e,t,n,i)}function fl(e,t,n,i){cl.call(this,e,t,n,i)}function ml(e,t,n,i){cl.call(this,e,t,n,i)}function vl(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=kt.generateUUID(),this.duration<0&&this.resetDuration()}function gl(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return hl;case"vector":case"vector2":case"vector3":case"vector4":return ml;case"color":return ul;case"quaternion":return pl;case"bool":case"boolean":return ll;case"string":return fl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],i=[];il.flattenJSON(e.keys,n,i,"value"),e.times=n,e.values=i}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(rl.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{var o;n:{i:if(!(e<i)){for(var a=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,r)}if(n===a)break;if(r=i,e<(i=t[++n]))break t}o=t.length;break n}if(r<=e)break e;var s=t[1];e<s&&(n=2,r=s);for(a=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===a)break;if(i=r,(r=t[--n-1])<=e)break t}o=n,n=0}for(;n<o;){var c=n+o>>>1;e<t[c]?o=c:n=1+c}if(i=t[n],void 0===(r=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,r,e)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i,o=0;o!==i;++o)t[o]=n[r+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(rl.prototype,{beforeStart_:rl.prototype.copySampleValue_,afterEnd_:rl.prototype.copySampleValue_}),ol.prototype=Object.assign(Object.create(rl.prototype),{constructor:ol,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,t,n){var i=this.parameterPositions,r=e-2,o=e+1,a=i[r],s=i[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:r=e,a=2*t-n;break;case 2402:a=t+i[r=i.length-2]-i[r+1];break;default:r=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=e,s=2*n-t;break;case 2402:s=n+i[o=1]-i[0];break;default:o=e-1,s=t}var c=.5*(n-t),l=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(s-n),this._offsetPrev=r*l,this._offsetNext=o*l},interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,l=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),f=p*p,m=f*p,v=-h*m+2*h*f-h*p,g=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,A=d*m-d*f,b=0;b!==a;++b)r[b]=v*o[l+b]+g*o[c+b]+y*o[s+b]+A*o[u+b];return r}}),al.prototype=Object.assign(Object.create(rl.prototype),{constructor:al,interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,l=(n-t)/(i-t),u=1-l,h=0;h!==a;++h)r[h]=o[c+h]*u+o[s+h]*l;return r}}),sl.prototype=Object.assign(Object.create(rl.prototype),{constructor:sl,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(cl,{toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:il.convertArray(e.times,Array),values:il.convertArray(e.values,Array)};var i=e.getInterpolation();i!==e.DefaultInterpolation&&(t.interpolation=i)}return t.type=e.ValueTypeName,t}}),Object.assign(cl.prototype,{constructor:cl,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new sl(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new al(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new ol(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0!==t)return this.createInterpolant=t,this;var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,i=n.length,r=0,o=i-1;r!==i&&n[r]<e;)++r;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==r||o!==i){o<=r&&(r=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=il.arraySlice(n,r,o),this.values=il.arraySlice(this.values,r*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==r;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&s<o){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==i&&il.isTypedArray(i)){a=0;for(var c=i.length;a!==c;++a){var l=i[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),i=2302===this.getInterpolation(),r=1,o=e.length-1,a=1;a<o;++a){var s=!1,c=e[a];if(c!==e[a+1]&&(1!==a||c!==c[0]))if(i)s=!0;else for(var l=a*n,u=l-n,h=l+n,d=0;d!==n;++d){var p=t[l+d];if(p!==t[u+d]||p!==t[h+d]){s=!0;break}}if(s){if(a!==r){e[r]=e[a];var f=a*n,m=r*n;for(d=0;d!==n;++d)t[m+d]=t[f+d]}++r}}if(0<o){e[r]=e[o];for(f=o*n,m=r*n,d=0;d!==n;++d)t[m+d]=t[f+d];++r}return r!==e.length&&(this.times=il.arraySlice(e,0,r),this.values=il.arraySlice(t,0,r*n)),this},clone:function(){var e=il.arraySlice(this.times,0),t=il.arraySlice(this.values,0),n=new this.constructor(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}),ll.prototype=Object.assign(Object.create(cl.prototype),{constructor:ll,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ul.prototype=Object.assign(Object.create(cl.prototype),{constructor:ul,ValueTypeName:"color"}),hl.prototype=Object.assign(Object.create(cl.prototype),{constructor:hl,ValueTypeName:"number"}),dl.prototype=Object.assign(Object.create(rl.prototype),{constructor:dl,interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=(n-t)/(i-t),l=s+a;s!==l;s+=4)Ft.slerpFlat(r,0,o,s-a,o,s,c);return r}}),pl.prototype=Object.assign(Object.create(cl.prototype),{constructor:pl,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new dl(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),fl.prototype=Object.assign(Object.create(cl.prototype),{constructor:fl,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ml.prototype=Object.assign(Object.create(cl.prototype),{constructor:ml,ValueTypeName:"vector"}),Object.assign(vl,{parse:function(e){for(var t=[],n=e.tracks,i=1/(e.fps||1),r=0,o=n.length;r!==o;++r)t.push(gl(n[r]).scale(i));return new vl(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},r=0,o=n.length;r!==o;++r)t.push(cl.toJSON(n[r]));return i},CreateFromMorphTargetSequence:function(e,t,n,i){for(var r=t.length,o=[],a=0;a<r;a++){var s=[],c=[];s.push((a+r-1)%r,a,(a+1)%r),c.push(0,1,0);var l=il.getKeyframeOrder(s);s=il.sortedArray(s,1,l),c=il.sortedArray(c,1,l),i||0!==s[0]||(s.push(r),c.push(c[0])),o.push(new hl(".morphTargetInfluences["+t[a].name+"]",s,c).scale(1/n))}return new vl(e,-1,o)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){n=e.geometry&&e.geometry.animations||e.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],c=s.name.match(r);if(c&&1<c.length){var l=i[h=c[1]];l||(i[h]=l=[]),l.push(s)}}var u=[];for(var h in i)u.push(vl.CreateFromMorphTargetSequence(h,i[h],t,n));return u},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,i,r){if(0!==n.length){var o=[],a=[];il.flattenJSON(n,o,a,i),0!==o.length&&r.push(new e(t,o,a))}},i=[],r=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],c=0;c<s.length;c++){var l=s[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var u={},h=0;h<l.length;h++)if(l[h].morphTargets)for(var d=0;d<l[h].morphTargets.length;d++)u[l[h].morphTargets[d]]=-1;for(var p in u){var f=[],m=[];for(d=0;d!==l[h].morphTargets.length;++d){var v=l[h];f.push(v.time),m.push(v.morphTarget===p?1:0)}i.push(new hl(".morphTargetInfluence["+p+"]",f,m))}o=u.length*(a||1)}else{var g=".bones["+t[c].name+"]";n(ml,g+".position",l,"pos",i),n(pl,g+".quaternion",l,"rot",i),n(ml,g+".scale",l,"scl",i)}}return 0===i.length?null:new vl(r,o,i)}}),Object.assign(vl.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var i=this.tracks[t];e=Math.max(e,i.times[i.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new vl(this.name,this.duration,e)}});var yl={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Al(e,t,n){var i=this,r=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===r&&void 0!==i.onStart&&i.onStart(e,o,a),r=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,a),o===a&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var bl=new Al,wl={};function xl(e){this.manager=void 0!==e?e:bl}function El(e){this.manager=void 0!==e?e:bl}function Ml(e){this.manager=void 0!==e?e:bl,this._parser=null}function Tl(e){this.manager=void 0!==e?e:bl,this._parser=null}function Sl(e){this.manager=void 0!==e?e:bl}function Cl(e){this.manager=void 0!==e?e:bl}function Ll(e){this.manager=void 0!==e?e:bl}function _l(){this.type="Curve",this.arcLengthDivisions=200}function Bl(e,t,n,i,r,o,a,s){_l.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Rl(e,t,n,i,r,o){Bl.call(this,e,t,n,n,i,r,o),this.type="ArcCurve"}function Pl(){var r=0,o=0,a=0,s=0;function l(e,t,n,i){a=-3*(r=e)+3*t-2*(o=n)-i,s=2*e-2*t+n+i}return{initCatmullRom:function(e,t,n,i,r){l(t,n,r*(n-e),r*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,r,o,a){var s=(t-e)/r-(n-e)/(r+o)+(n-t)/o,c=(n-t)/o-(i-t)/(o+a)+(i-n)/a;l(t,n,s*=o,c*=o)},calc:function(e){var t=e*e;return r+o*e+a*t+s*(t*e)}}}Object.assign(xl.prototype,{load:function(a,e,t,n){void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);var s=this,i=yl.get(a);if(void 0!==i)return s.manager.itemStart(a),setTimeout(function(){e&&e(i),s.manager.itemEnd(a)},0),i;if(void 0===wl[a]){var r=a.match(/^data:(.*?)(;base64)?,(.*)$/);if(r){var o=r[1],c=!!r[2],l=r[3];l=decodeURIComponent(l),c&&(l=atob(l));try{var u,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var d=new Uint8Array(l.length),p=0;p<l.length;p++)d[p]=l.charCodeAt(p);u="blob"===h?new Blob([d.buffer],{type:o}):d.buffer;break;case"document":var f=new DOMParser;u=f.parseFromString(l,o);break;case"json":u=JSON.parse(l);break;default:u=l}setTimeout(function(){e&&e(u),s.manager.itemEnd(a)},0)}catch(e){setTimeout(function(){n&&n(e),s.manager.itemError(a),s.manager.itemEnd(a)},0)}}else{wl[a]=[],wl[a].push({onLoad:e,onProgress:t,onError:n});var m=new XMLHttpRequest;for(var v in m.open("GET",a,!0),m.addEventListener("load",function(e){var t=this.response;yl.add(a,t);var n=wl[a];if(delete wl[a],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var i=0,r=n.length;i<r;i++){(o=n[i]).onLoad&&o.onLoad(t)}s.manager.itemEnd(a)}else{for(i=0,r=n.length;i<r;i++){var o;(o=n[i]).onError&&o.onError(e)}s.manager.itemError(a),s.manager.itemEnd(a)}},!1),m.addEventListener("progress",function(e){for(var t=wl[a],n=0,i=t.length;n<i;n++){var r=t[n];r.onProgress&&r.onProgress(e)}},!1),m.addEventListener("error",function(e){var t=wl[a];delete wl[a];for(var n=0,i=t.length;n<i;n++){var r=t[n];r.onError&&r.onError(e)}s.manager.itemError(a),s.manager.itemEnd(a)},!1),m.addEventListener("abort",function(e){var t=wl[a];delete wl[a];for(var n=0,i=t.length;n<i;n++){var r=t[n];r.onError&&r.onError(e)}s.manager.itemError(a),s.manager.itemEnd(a)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(v,this.requestHeader[v]);m.send(null)}return s.manager.itemStart(a),m}wl[a].push({onLoad:e,onProgress:t,onError:n})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(El.prototype,{load:function(e,t,n,i){var r=this,o=new xl(r.manager);o.setPath(r.path),o.load(e,function(e){t(r.parse(JSON.parse(e)))},n,i)},parse:function(e,t){for(var n=[],i=0;i<e.length;i++){var r=vl.parse(e[i]);n.push(r)}t(n)},setPath:function(e){return this.path=e,this}}),Object.assign(Ml.prototype,{load:function(e,o,t,i){var a=this,s=[],c=new Bs;c.image=s;var r=new xl(this.manager);function n(n){r.load(e[n],function(e){var t=a._parser(e,!0);s[n]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(l+=1)&&(1===t.mipmapCount&&(c.minFilter=Re),c.format=t.format,c.needsUpdate=!0,o&&o(c))},t,i)}if(r.setPath(this.path),r.setResponseType("arraybuffer"),Array.isArray(e))for(var l=0,u=0,h=e.length;u<h;++u)n(u);else r.load(e,function(e){var t=a._parser(e,!0);if(t.isCubemap)for(var n=t.mipmaps.length/t.mipmapCount,i=0;i<n;i++){s[i]={mipmaps:[]};for(var r=0;r<t.mipmapCount;r++)s[i].mipmaps.push(t.mipmaps[i*t.mipmapCount+r]),s[i].format=t.format,s[i].width=t.width,s[i].height=t.height}else c.image.width=t.width,c.image.height=t.height,c.mipmaps=t.mipmaps;1===t.mipmapCount&&(c.minFilter=Re),c.format=t.format,c.needsUpdate=!0,o&&o(c)},t,i);return c},setPath:function(e){return this.path=e,this}}),Object.assign(Tl.prototype,{load:function(e,n,t,i){var r=this,o=new Sn,a=new xl(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(e,function(e){var t=r._parser(e);t&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:Se,o.wrapT=void 0!==t.wrapT?t.wrapT:Se,o.magFilter=void 0!==t.magFilter?t.magFilter:Re,o.minFilter=void 0!==t.minFilter?t.minFilter:De,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps),1===t.mipmapCount&&(o.minFilter=Re),o.needsUpdate=!0,n&&n(o,t))},t,i),o},setPath:function(e){return this.path=e,this}}),Object.assign(Sl.prototype,{crossOrigin:"anonymous",load:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,o=yl.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),yl.add(t,this),e&&e(this),r.manager.itemEnd(t)}function c(e){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}return a.addEventListener("load",s,!1),a.addEventListener("error",c,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Cl.prototype,{crossOrigin:"anonymous",load:function(e,n,t,i){var r=new ao,o=new Sl(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(t){o.load(e[t],function(e){r.images[t]=e,6==++a&&(r.needsUpdate=!0,n&&n(r))},void 0,i)}for(var c=0;c<e.length;++c)s(c);return r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Ll.prototype,{crossOrigin:"anonymous",load:function(n,i,e,t){var r=new wn,o=new Sl(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(n,function(e){r.image=e;var t=0<n.search(/\.jpe?g($|\?)/i)||0===n.search(/^data\:image\/jpeg/);r.format=t?Xe:Qe,r.needsUpdate=!0,void 0!==i&&i(r)},e,t),r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(_l.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,i=[],r=this.getPoint(0),o=0;for(i.push(0),n=1;n<=e;n++)o+=(t=this.getPoint(n/e)).distanceTo(r),i.push(o),r=t;return this.cacheArcLengths=i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,i=this.getLengths(),r=0,o=i.length;n=t||e*i[o-1];for(var a,s=0,c=o-1;s<=c;)if((a=i[r=Math.floor(s+(c-s)/2)]-n)<0)s=r+1;else{if(!(0<a)){c=r;break}c=r-1}if(i[r=c]===n)return r/(o-1);var l=i[r];return(r+(n-l)/(i[r+1]-l))/(o-1)},getTangent:function(e){var t=e-1e-4,n=e+1e-4;t<0&&(t=0),1<n&&(n=1);var i=this.getPoint(t);return this.getPoint(n).clone().sub(i).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,i,r,o=new Nt,a=[],s=[],c=[],l=new Nt,u=new Ht;for(n=0;n<=e;n++)i=n/e,a[n]=this.getTangentAt(i),a[n].normalize();s[0]=new Nt,c[0]=new Nt;var h=Number.MAX_VALUE,d=Math.abs(a[0].x),p=Math.abs(a[0].y),f=Math.abs(a[0].z);for(d<=h&&(h=d,o.set(1,0,0)),p<=h&&(h=p,o.set(0,1,0)),f<=h&&o.set(0,0,1),l.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],l),c[0].crossVectors(a[0],s[0]),n=1;n<=e;n++)s[n]=s[n-1].clone(),c[n]=c[n-1].clone(),l.crossVectors(a[n-1],a[n]),l.length()>Number.EPSILON&&(l.normalize(),r=Math.acos(kt.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(u.makeRotationAxis(l,r))),c[n].crossVectors(a[n],s[n]);if(!0===t)for(r=Math.acos(kt.clamp(s[0].dot(s[e]),-1,1)),r/=e,0<a[0].dot(l.crossVectors(s[0],s[e]))&&(r=-r),n=1;n<=e;n++)s[n].applyMatrix4(u.makeRotationAxis(a[n],r*n)),c[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),((Bl.prototype=Object.create(_l.prototype)).constructor=Bl).prototype.isEllipseCurve=!0,Bl.prototype.getPoint=function(e,t){for(var n=t||new jt,i=2*Math.PI,r=this.aEndAngle-this.aStartAngle,o=Math.abs(r)<Number.EPSILON;r<0;)r+=i;for(;i<r;)r-=i;r<Number.EPSILON&&(r=o?0:i),!0!==this.aClockwise||o||(r===i?r=-i:r-=i);var a=this.aStartAngle+e*r,s=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var l=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=s-this.aX,d=c-this.aY;s=h*l-d*u+this.aX,c=h*u+d*l+this.aY}return n.set(s,c)},Bl.prototype.copy=function(e){return _l.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Bl.prototype.toJSON=function(){var e=_l.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Bl.prototype.fromJSON=function(e){return _l.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},((Rl.prototype=Object.create(Bl.prototype)).constructor=Rl).prototype.isArcCurve=!0;var Dl=new Nt,Il=new Pl,Ol=new Pl,kl=new Pl;function jl(e,t,n,i){_l.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=i||.5}function Hl(e,t,n,i,r){var o=.5*(i-t),a=.5*(r-n),s=e*e;return(2*n-2*i+o+a)*(e*s)+(-3*n+3*i-2*o-a)*s+o*e+n}function Fl(e,t,n,i){return(r=1-e)*r*t+2*(1-e)*e*n+e*e*i;var r}function Nl(e,t,n,i,r){return(a=1-e)*a*a*t+3*(o=1-e)*o*e*n+3*(1-e)*e*e*i+e*e*e*r;var o,a}function zl(e,t,n,i){_l.call(this),this.type="CubicBezierCurve",this.v0=e||new jt,this.v1=t||new jt,this.v2=n||new jt,this.v3=i||new jt}function Ul(e,t,n,i){_l.call(this),this.type="CubicBezierCurve3",this.v0=e||new Nt,this.v1=t||new Nt,this.v2=n||new Nt,this.v3=i||new Nt}function Gl(e,t){_l.call(this),this.type="LineCurve",this.v1=e||new jt,this.v2=t||new jt}function Vl(e,t){_l.call(this),this.type="LineCurve3",this.v1=e||new Nt,this.v2=t||new Nt}function Wl(e,t,n){_l.call(this),this.type="QuadraticBezierCurve",this.v0=e||new jt,this.v1=t||new jt,this.v2=n||new jt}function ql(e,t,n){_l.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Nt,this.v1=t||new Nt,this.v2=n||new Nt}function Xl(e){_l.call(this),this.type="SplineCurve",this.points=e||[]}((jl.prototype=Object.create(_l.prototype)).constructor=jl).prototype.isCatmullRomCurve3=!0,jl.prototype.getPoint=function(e,t){var n,i,r,o,a=t||new Nt,s=this.points,c=s.length,l=(c-(this.closed?0:1))*e,u=Math.floor(l),h=l-u;if(this.closed?u+=0<u?0:(Math.floor(Math.abs(u)/c)+1)*c:0===h&&u===c-1&&(u=c-2,h=1),n=this.closed||0<u?s[(u-1)%c]:(Dl.subVectors(s[0],s[1]).add(s[0]),Dl),i=s[u%c],r=s[(u+1)%c],o=this.closed||u+2<c?s[(u+2)%c]:(Dl.subVectors(s[c-1],s[c-2]).add(s[c-1]),Dl),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(n.distanceToSquared(i),d),f=Math.pow(i.distanceToSquared(r),d),m=Math.pow(r.distanceToSquared(o),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),Il.initNonuniformCatmullRom(n.x,i.x,r.x,o.x,p,f,m),Ol.initNonuniformCatmullRom(n.y,i.y,r.y,o.y,p,f,m),kl.initNonuniformCatmullRom(n.z,i.z,r.z,o.z,p,f,m)}else"catmullrom"===this.curveType&&(Il.initCatmullRom(n.x,i.x,r.x,o.x,this.tension),Ol.initCatmullRom(n.y,i.y,r.y,o.y,this.tension),kl.initCatmullRom(n.z,i.z,r.z,o.z,this.tension));return a.set(Il.calc(h),Ol.calc(h),kl.calc(h)),a},jl.prototype.copy=function(e){_l.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},jl.prototype.toJSON=function(){var e=_l.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},jl.prototype.fromJSON=function(e){_l.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push((new Nt).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},((zl.prototype=Object.create(_l.prototype)).constructor=zl).prototype.isCubicBezierCurve=!0,zl.prototype.getPoint=function(e,t){var n=t||new jt,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(Nl(e,i.x,r.x,o.x,a.x),Nl(e,i.y,r.y,o.y,a.y)),n},zl.prototype.copy=function(e){return _l.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},zl.prototype.toJSON=function(){var e=_l.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},zl.prototype.fromJSON=function(e){return _l.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},((Ul.prototype=Object.create(_l.prototype)).constructor=Ul).prototype.isCubicBezierCurve3=!0,Ul.prototype.getPoint=function(e,t){var n=t||new Nt,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(Nl(e,i.x,r.x,o.x,a.x),Nl(e,i.y,r.y,o.y,a.y),Nl(e,i.z,r.z,o.z,a.z)),n},Ul.prototype.copy=function(e){return _l.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Ul.prototype.toJSON=function(){var e=_l.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Ul.prototype.fromJSON=function(e){return _l.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},((Gl.prototype=Object.create(_l.prototype)).constructor=Gl).prototype.isLineCurve=!0,Gl.prototype.getPoint=function(e,t){var n=t||new jt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Gl.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Gl.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Gl.prototype.copy=function(e){return _l.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Gl.prototype.toJSON=function(){var e=_l.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Gl.prototype.fromJSON=function(e){return _l.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((Vl.prototype=Object.create(_l.prototype)).constructor=Vl).prototype.isLineCurve3=!0,Vl.prototype.getPoint=function(e,t){var n=t||new Nt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Vl.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Vl.prototype.copy=function(e){return _l.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Vl.prototype.toJSON=function(){var e=_l.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Vl.prototype.fromJSON=function(e){return _l.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((Wl.prototype=Object.create(_l.prototype)).constructor=Wl).prototype.isQuadraticBezierCurve=!0,Wl.prototype.getPoint=function(e,t){var n=t||new jt,i=this.v0,r=this.v1,o=this.v2;return n.set(Fl(e,i.x,r.x,o.x),Fl(e,i.y,r.y,o.y)),n},Wl.prototype.copy=function(e){return _l.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Wl.prototype.toJSON=function(){var e=_l.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Wl.prototype.fromJSON=function(e){return _l.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((ql.prototype=Object.create(_l.prototype)).constructor=ql).prototype.isQuadraticBezierCurve3=!0,ql.prototype.getPoint=function(e,t){var n=t||new Nt,i=this.v0,r=this.v1,o=this.v2;return n.set(Fl(e,i.x,r.x,o.x),Fl(e,i.y,r.y,o.y),Fl(e,i.z,r.z,o.z)),n},ql.prototype.copy=function(e){return _l.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ql.prototype.toJSON=function(){var e=_l.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ql.prototype.fromJSON=function(e){return _l.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((Xl.prototype=Object.create(_l.prototype)).constructor=Xl).prototype.isSplineCurve=!0,Xl.prototype.getPoint=function(e,t){var n=t||new jt,i=this.points,r=(i.length-1)*e,o=Math.floor(r),a=r-o,s=i[0===o?o:o-1],c=i[o],l=i[o>i.length-2?i.length-1:o+1],u=i[o>i.length-3?i.length-1:o+2];return n.set(Hl(a,s.x,c.x,l.x,u.x),Hl(a,s.y,c.y,l.y,u.y)),n},Xl.prototype.copy=function(e){_l.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this},Xl.prototype.toJSON=function(){var e=_l.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e},Xl.prototype.fromJSON=function(e){_l.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push((new jt).fromArray(i))}return this};var Ql=Object.freeze({ArcCurve:Rl,CatmullRomCurve3:jl,CubicBezierCurve:zl,CubicBezierCurve3:Ul,EllipseCurve:Bl,LineCurve:Gl,LineCurve3:Vl,QuadraticBezierCurve:Wl,QuadraticBezierCurve3:ql,SplineCurve:Xl});function Yl(){_l.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Zl(e){Yl.call(this),this.type="Path",this.currentPoint=new jt,e&&this.setFromPoints(e)}function Kl(e){Zl.call(this,e),this.uuid=kt.generateUUID(),this.type="Shape",this.holes=[]}function Jl(e,t){Ai.call(this),this.type="Light",this.color=new zn(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function $l(e,t,n){Jl.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Ai.DefaultUp),this.updateMatrix(),this.groundColor=new zn(t)}function eu(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new jt(512,512),this.map=null,this.matrix=new Ht}function tu(){eu.call(this,new Ba(50,1,.5,500))}function nu(e,t,n,i,r,o){Jl.call(this,e,t),this.type="SpotLight",this.position.copy(Ai.DefaultUp),this.updateMatrix(),this.target=new Ai,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new tu}function iu(e,t,n,i){Jl.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new eu(new Ba(90,1,.5,500))}function ru(e,t,n,i,r,o){_a.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==n?n:1,this.bottom=void 0!==i?i:-1,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function ou(){eu.call(this,new ru(-5,5,5,-5,.5,500))}function au(e,t){Jl.call(this,e,t),this.type="DirectionalLight",this.position.copy(Ai.DefaultUp),this.updateMatrix(),this.target=new Ai,this.shadow=new ou}function su(e,t){Jl.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function cu(e,t,n,i){Jl.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==i?i:10}function lu(e){this.manager=void 0!==e?e:bl,this.textures={}}Yl.prototype=Object.assign(Object.create(_l.prototype),{constructor:Yl,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Gl(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=t){var r=n[i]-t,o=this.curves[i],a=o.getLength(),s=0===a?0:1-r/a;return o.getPointAt(s)}i++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],i=0,r=this.curves;i<r.length;i++)for(var o=r[i],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),c=0;c<s.length;c++){var l=s[c];t&&t.equals(l)||(n.push(l),t=l)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){_l.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=_l.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e},fromJSON:function(e){_l.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push((new Ql[i.type]).fromJSON(i))}return this}}),Zl.prototype=Object.assign(Object.create(Yl.prototype),{constructor:Zl,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new Gl(this.currentPoint.clone(),new jt(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,i){var r=new Wl(this.currentPoint.clone(),new jt(e,t),new jt(n,i));this.curves.push(r),this.currentPoint.set(n,i)},bezierCurveTo:function(e,t,n,i,r,o){var a=new zl(this.currentPoint.clone(),new jt(e,t),new jt(n,i),new jt(r,o));this.curves.push(a),this.currentPoint.set(r,o)},splineThru:function(e){var t=new Xl([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,i,r,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,n,i,r,o)},absarc:function(e,t,n,i,r,o){this.absellipse(e,t,n,n,i,r,o)},ellipse:function(e,t,n,i,r,o,a,s){var c=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(e+c,t+l,n,i,r,o,a,s)},absellipse:function(e,t,n,i,r,o,a,s){var c=new Bl(e,t,n,i,r,o,a,s);if(0<this.curves.length){var l=c.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(c);var u=c.getPoint(1);this.currentPoint.copy(u)},copy:function(e){return Yl.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Yl.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Yl.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Kl.prototype=Object.assign(Object.create(Zl.prototype),{constructor:Kl,getPointsHoles:function(e){for(var t=[],n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Zl.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push(i.clone())}return this},toJSON:function(){var e=Zl.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e},fromJSON:function(e){Zl.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push((new Zl).fromJSON(i))}return this}}),Jl.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Jl,isLight:!0,copy:function(e){return Ai.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=Ai.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),$l.prototype=Object.assign(Object.create(Jl.prototype),{constructor:$l,isHemisphereLight:!0,copy:function(e){return Jl.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(eu.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),tu.prototype=Object.assign(Object.create(eu.prototype),{constructor:tu,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=2*kt.RAD2DEG*e.angle,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix())}}),nu.prototype=Object.assign(Object.create(Jl.prototype),{constructor:nu,isSpotLight:!0,copy:function(e){return Jl.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),iu.prototype=Object.assign(Object.create(Jl.prototype),{constructor:iu,isPointLight:!0,copy:function(e){return Jl.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),ru.prototype=Object.assign(Object.create(_a.prototype),{constructor:ru,isOrthographicCamera:!0,copy:function(e,t){return _a.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,i,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-e,o=n+e,a=i+t,s=i-t;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),u=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;o=(r+=u*(this.view.offsetX/c))+u*(this.view.width/c),s=(a-=h*(this.view.offsetY/l))-h*(this.view.height/l)}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Ai.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),ou.prototype=Object.assign(Object.create(eu.prototype),{constructor:ou}),au.prototype=Object.assign(Object.create(Jl.prototype),{constructor:au,isDirectionalLight:!0,copy:function(e){return Jl.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),su.prototype=Object.assign(Object.create(Jl.prototype),{constructor:su,isAmbientLight:!0}),cu.prototype=Object.assign(Object.create(Jl.prototype),{constructor:cu,isRectAreaLight:!0,copy:function(e){return Jl.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Jl.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign(lu.prototype,{load:function(e,t,n,i){var r=this,o=new xl(r.manager);o.setPath(r.path),o.load(e,function(e){t(r.parse(JSON.parse(e)))},n,i)},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var i=new nl[e.type];if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&i.specular.setHex(e.specular),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearCoat&&(i.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(i.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.vertexColors&&(i.vertexColors=e.vertexColors),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(i.skinning=e.skinning),void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.uniforms)for(var r in e.uniforms){var o=e.uniforms[r];switch(i.uniforms[r]={},o.type){case"t":i.uniforms[r].value=n(o.value);break;case"c":i.uniforms[r].value=(new zn).setHex(o.value);break;case"v2":i.uniforms[r].value=(new jt).fromArray(o.value);break;case"v3":i.uniforms[r].value=(new Nt).fromArray(o.value);break;case"v4":i.uniforms[r].value=(new xn).fromArray(o.value);break;case"m3":i.uniforms[r].value=(new zt).fromArray(o.value);case"m4":i.uniforms[r].value=(new Ht).fromArray(o.value);break;default:i.uniforms[r].value=o.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var a in e.extensions)i.extensions[a]=e.extensions[a];if(void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap),i.transparent=!0),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),i.normalScale=(new jt).fromArray(s)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),i},setPath:function(e){return this.path=e,this},setTextures:function(e){return this.textures=e,this}});var uu={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);return decodeURIComponent(escape(t))},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function hu(e){this.manager=void 0!==e?e:bl}Object.assign(hu.prototype,{load:function(e,t,n,i){var r=this,o=new xl(r.manager);o.setPath(r.path),o.load(e,function(e){t(r.parse(JSON.parse(e)))},n,i)},parse:function(e){var t=new Ji,n=e.data.index;if(void 0!==n){var i=new du[n.type](n.array);t.setIndex(new _i(i,1))}var r=e.data.attributes;for(var o in r){var a=r[o];i=new du[a.type](a.array);t.addAttribute(o,new _i(i,a.itemSize,a.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var c=0,l=s.length;c!==l;++c){var u=s[c];t.addGroup(u.start,u.count,u.materialIndex)}var h=e.data.boundingSphere;if(void 0!==h){var d=new Nt;void 0!==h.center&&d.fromArray(h.center),t.boundingSphere=new Ln(d,h.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t},setPath:function(e){return this.path=e,this}});var du={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function pu(e){this.manager=void 0!==e?e:bl,this.resourcePath=""}Object.assign(pu.prototype,{crossOrigin:"anonymous",load:function(i,r,e,o){var a=this,t=void 0===this.path?uu.extractUrlBase(i):this.path;this.resourcePath=this.resourcePath||t;var n=new xl(a.manager);n.setPath(this.path),n.load(i,function(e){var t=null;try{t=JSON.parse(e)}catch(e){return void 0!==o&&o(e),void console.error("THREE:ObjectLoader: Can't parse "+i+".",e.message)}var n=t.metadata;void 0!==n&&void 0!==n.type&&"geometry"!==n.type.toLowerCase()?a.parse(t,r):console.error("THREE.ObjectLoader: Can't load "+i)},e,o)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var n=this.parseShape(e.shapes),i=this.parseGeometries(e.geometries,n),r=this.parseImages(e.images,function(){void 0!==t&&t(s)}),o=this.parseTextures(e.textures,r),a=this.parseMaterials(e.materials,o),s=this.parseObject(e.object,i,a);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,i=e.length;n<i;n++){var r=(new Kl).fromJSON(e[n]);t[r.uuid]=r}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var i=new hu,r=0,o=e.length;r<o;r++){var a,s=e[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Wc[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Wc[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Wc[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Wc[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Wc[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Wc[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new Wc[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Wc[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Wc[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Wc[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Wc[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new Wc[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var c=[],l=0,u=s.shapes.length;l<u;l++){var h=t[s.shapes[l]];c.push(h)}a=new Wc[s.type](c,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(c=[],l=0,u=s.shapes.length;l<u;l++){h=t[s.shapes[l]];c.push(h)}var d=s.options.extrudePath;void 0!==d&&(s.options.extrudePath=(new Ql[d.type]).fromJSON(d)),a=new Wc[s.type](c,s.options);break;case"BufferGeometry":a=i.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE)a=(new THREE.LegacyJSONLoader).parse(s,this.resourcePath).geometry;else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}return n},parseMaterials:function(e,t){var n={},i={};if(void 0!==e){var r=new lu;r.setTextures(t);for(var o=0,a=e.length;o<a;o++){var s=e[o];if("MultiMaterial"===s.type){for(var c=[],l=0;l<s.materials.length;l++){var u=s.materials[l];void 0===n[u.uuid]&&(n[u.uuid]=r.parse(u)),c.push(n[u.uuid])}i[s.uuid]=c}else void 0===n[s.uuid]&&(n[s.uuid]=r.parse(s)),i[s.uuid]=n[s.uuid]}}return i},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],r=vl.parse(i);void 0!==i.uuid&&(r.uuid=i.uuid),t.push(r)}return t},parseImages:function(e,t){var n=this,i={};function r(e){return n.manager.itemStart(e),o.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemError(e),n.manager.itemEnd(e)})}if(void 0!==e&&0<e.length){var o=new Sl(new Al(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var c=e[a],l=c.url;if(Array.isArray(l)){i[c.uuid]=[];for(var u=0,h=l.length;u<h;u++){var d=l[u],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:n.resourcePath+d;i[c.uuid].push(r(p))}}else{p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.resourcePath+c.url;i[c.uuid]=r(p)}}}return i},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var i={};if(void 0!==e)for(var r=0,o=e.length;r<o;r++){var a,s=e[r];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(a=Array.isArray(t[s.image])?new ao(t[s.image]):new wn(t[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,Au)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],bu),a.wrapT=n(s.wrap[1],bu)),void 0!==s.format&&(a.format=s.format),void 0!==s.type&&(a.type=s.type),void 0!==s.encoding&&(a.encoding=s.encoding),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,wu)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,wu)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),i[s.uuid]=a}return i},parseObject:function(e,t,o){var n;function i(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function r(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];void 0===o[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),t.push(o[r])}return t}return void 0===o[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),o[e]}}switch(e.type){case"Scene":n=new fs,void 0!==e.background&&Number.isInteger(e.background)&&(n.background=new zn(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?n.fog=new ps(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(n.fog=new ds(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":n=new Ba(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(n.focus=e.focus),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.filmGauge&&(n.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(n.filmOffset=e.filmOffset),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"OrthographicCamera":n=new ru(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"AmbientLight":n=new su(e.color,e.intensity);break;case"DirectionalLight":n=new au(e.color,e.intensity);break;case"PointLight":n=new iu(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":n=new cu(e.color,e.intensity,e.width,e.height);break;case"SpotLight":n=new nu(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":n=new $l(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=i(e.geometry),s=r(e.material);n=a.bones&&0<a.bones.length?new bs(a,s):new Qr(a,s),void 0!==e.drawMode&&n.setDrawMode(e.drawMode);break;case"LOD":n=new As;break;case"Line":n=new Ms(i(e.geometry),r(e.material),e.mode);break;case"LineLoop":n=new Ss(i(e.geometry),r(e.material));break;case"LineSegments":n=new Ts(i(e.geometry),r(e.material));break;case"PointCloud":case"Points":n=new Ls(i(e.geometry),r(e.material));break;case"Sprite":n=new ys(r(e.material));break;case"Group":n=new La;break;default:n=new Ai}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(n.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(n.matrixAutoUpdate=e.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.quaternion&&n.quaternion.fromArray(e.quaternion),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.castShadow&&(n.castShadow=e.castShadow),void 0!==e.receiveShadow&&(n.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(n.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(n.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&n.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(n.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.frustumCulled&&(n.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(n.renderOrder=e.renderOrder),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.layers&&(n.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,l=0;l<c.length;l++)n.add(this.parseObject(c[l],t,o));if("LOD"===e.type)for(var u=e.levels,h=0;h<u.length;h++){var d=u[h],p=n.getObjectByProperty("uuid",d.object);void 0!==p&&n.addLevel(p,d.distance)}return n}});var fu,mu,vu,gu,yu,Au={UVMapping:300,CubeReflectionMapping:ve,CubeRefractionMapping:ge,EquirectangularReflectionMapping:ye,EquirectangularRefractionMapping:Ae,SphericalReflectionMapping:be,CubeUVReflectionMapping:we,CubeUVRefractionMapping:Me},bu={RepeatWrapping:Te,ClampToEdgeWrapping:Se,MirroredRepeatWrapping:Ce},wu={NearestFilter:Le,NearestMipMapNearestFilter:_e,NearestMipMapLinearFilter:Be,LinearFilter:Re,LinearMipMapNearestFilter:Pe,LinearMipMapLinearFilter:De};function xu(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:bl,this.options=void 0}function Eu(){this.type="ShapePath",this.color=new zn,this.subPaths=[],this.currentPath=null}function Mu(e){this.type="Font",this.data=e}function Tu(e,t,n,i,r){var o=r.glyphs[e]||r.glyphs["?"];if(o){var a,s,c,l,u,h,d,p,f=new Eu;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),v=0,g=m.length;v<g;){switch(m[v++]){case"m":a=m[v++]*t+n,s=m[v++]*t+i,f.moveTo(a,s);break;case"l":a=m[v++]*t+n,s=m[v++]*t+i,f.lineTo(a,s);break;case"q":c=m[v++]*t+n,l=m[v++]*t+i,u=m[v++]*t+n,h=m[v++]*t+i,f.quadraticCurveTo(u,h,c,l);break;case"b":c=m[v++]*t+n,l=m[v++]*t+i,u=m[v++]*t+n,h=m[v++]*t+i,d=m[v++]*t+n,p=m[v++]*t+i,f.bezierCurveTo(u,h,d,p,c,l)}}return{offsetX:o.ha*t,path:f}}}function Su(e){this.manager=void 0!==e?e:bl}function Cu(){}xu.prototype={constructor:xu,setOptions:function(e){return this.options=e,this},load:function(t,n,e,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,o=yl.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){n&&n(o),r.manager.itemEnd(t)},0),o;fetch(t).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,r.options)}).then(function(e){yl.add(t,e),n&&n(e),r.manager.itemEnd(t)}).catch(function(e){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)})},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(Eu.prototype,{moveTo:function(e,t){this.currentPath=new Zl,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,i){this.currentPath.quadraticCurveTo(e,t,n,i)},bezierCurveTo:function(e,t,n,i,r,o){this.currentPath.bezierCurveTo(e,t,n,i,r,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n],o=new Kl;o.curves=r.curves,t.push(o)}return t}function i(e,t){for(var n=t.length,i=!1,r=n-1,o=0;o<n;r=o++){var a=t[r],s=t[o],c=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(a=t[o],c=-c,s=t[r],l=-l),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var u=l*(e.x-a.x)-c*(e.y-a.y);if(0==u)return!0;if(u<0)continue;i=!i}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return i}var r=bc.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);var a,s,c,l=[];if(1===o.length)return s=o[0],(c=new Kl).curves=s.curves,l.push(c),l;var u=!r(o[0].getPoints());u=e?!u:u;var h,d,p=[],f=[],m=[],v=0;f[v]=void 0,m[v]=[];for(var g=0,y=o.length;g<y;g++)a=r(h=(s=o[g]).getPoints()),(a=e?!a:a)?(!u&&f[v]&&v++,f[v]={s:new Kl,p:h},f[v].s.curves=s.curves,u&&v++,m[v]=[]):m[v].push({h:s,p:h[0]});if(!f[0])return n(o);if(1<f.length){for(var A=!1,b=[],w=0,x=f.length;w<x;w++)p[w]=[];for(w=0,x=f.length;w<x;w++)for(var E=m[w],M=0;M<E.length;M++){for(var T=E[M],S=!0,C=0;C<f.length;C++)i(T.p,f[C].p)&&(w!==C&&b.push({froms:w,tos:C,hole:M}),S?(S=!1,p[C].push(T)):A=!0);S&&p[w].push(T)}0<b.length&&(A||(m=p))}g=0;for(var L=f.length;g<L;g++){c=f[g].s,l.push(c);for(var _=0,B=(d=m[g]).length;_<B;_++)c.holes.push(d[_].h)}return l}}),Object.assign(Mu.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var n=[],i=function(e,t,n){for(var i=Array.from?Array.from(e):String(e).split(""),r=t/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,a=[],s=0,c=0,l=0;l<i.length;l++){var u=i[l];if("\n"===u)s=0,c-=o;else{var h=Tu(u,r,s,c,n);s+=h.offsetX,a.push(h.path)}}return a}(e,t,this.data),r=0,o=i.length;r<o;r++)Array.prototype.push.apply(n,i[r].toShapes());return n}}),Object.assign(Su.prototype,{load:function(e,i,t,n){var r=this,o=new xl(this.manager);o.setPath(this.path),o.load(e,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var e=r.parse(n);i&&i(e)},t,n)},parse:function(e){return new Mu(e)},setPath:function(e){return this.path=e,this}}),Cu.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,n=0,i=t.length;n<i;n+=2){var r=t[n],o=t[n+1];if(r.test(e))return o}return null}},Object.assign(Cu.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,n){for(var i=[],r=0;r<e.length;++r)i[r]=this.createMaterial(e[r],t,n);return i},createMaterial:(fu={NoBlending:Z,NormalBlending:K,AdditiveBlending:J,SubtractiveBlending:$,MultiplyBlending:ee,CustomBlending:te},mu=new zn,vu=new Ll,gu=new lu,function(e,l,u){var h={};function t(e,t,n,i,r){var o,a=l+e,s=Cu.Handlers.get(a);o=null!==s?s.load(a):(vu.setCrossOrigin(u),vu.load(a)),void 0!==t&&(o.repeat.fromArray(t),1!==t[0]&&(o.wrapS=Te),1!==t[1]&&(o.wrapT=Te)),void 0!==n&&o.offset.fromArray(n),void 0!==i&&("repeat"===i[0]&&(o.wrapS=Te),"mirror"===i[0]&&(o.wrapS=Ce),"repeat"===i[1]&&(o.wrapT=Te),"mirror"===i[1]&&(o.wrapT=Ce)),void 0!==r&&(o.anisotropy=r);var c=kt.generateUUID();return h[c]=o,c}var n={uuid:kt.generateUUID(),type:"MeshLambertMaterial"};for(var i in e){var r=e[i];switch(i){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":n.name=r;break;case"blending":n.blending=fu[r];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",i,"is no longer supported.");break;case"colorDiffuse":n.color=mu.fromArray(r).getHex();break;case"colorSpecular":n.specular=mu.fromArray(r).getHex();break;case"colorEmissive":n.emissive=mu.fromArray(r).getHex();break;case"specularCoef":n.shininess=r;break;case"shading":"basic"===r.toLowerCase()&&(n.type="MeshBasicMaterial"),"phong"===r.toLowerCase()&&(n.type="MeshPhongMaterial"),"standard"===r.toLowerCase()&&(n.type="MeshStandardMaterial");break;case"mapDiffuse":n.map=t(r,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":n.emissiveMap=t(r,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":n.lightMap=t(r,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":n.aoMap=t(r,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":n.bumpMap=t(r,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":n.bumpScale=r;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":n.normalMap=t(r,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":n.normalScale=r;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":n.specularMap=t(r,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":n.metalnessMap=t(r,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":n.roughnessMap=t(r,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":n.alphaMap=t(r,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":n.side=xe;break;case"doubleSided":n.side=Y;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),n.opacity=r;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":n[i]=r;break;case"vertexColors":!0===r&&(n.vertexColors=2),"face"===r&&(n.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",i,r)}}return"MeshBasicMaterial"===n.type&&delete n.emissive,"MeshPhongMaterial"!==n.type&&delete n.specular,n.opacity<1&&(n.transparent=!0),gu.setTextures(h),gu.parse(n)})});var Lu,_u,Bu,Ru,Pu,Du,Iu,Ou,ku,ju,Hu,Fu,Nu,zu,Uu,Gu,Vu,Wu,qu,Xu,Qu,Yu,Zu,Ku,Ju,$u,eh,th,nh,ih,rh,oh,ah,sh,ch,lh,uh,hh,dh,ph,fh,mh,vh,gh,yh,Ah,bh,wh,xh,Eh,Mh,Th,Sh,Ch,Lh,_h,Bh,Rh,Ph={getContext:function(){return void 0===yu&&(yu=new(window.AudioContext||window.webkitAudioContext)),yu},setContext:function(e){yu=e}};function Dh(e){this.manager=void 0!==e?e:bl}function Ih(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ba,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ba,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Oh(e,t,n,i){Ai.call(this),this.type="CubeCamera";var o=new Ba(90,1,e,t);o.up.set(0,-1,0),o.lookAt(new Nt(1,0,0)),this.add(o);var a=new Ba(90,1,e,t);a.up.set(0,-1,0),a.lookAt(new Nt(-1,0,0)),this.add(a);var s=new Ba(90,1,e,t);s.up.set(0,0,1),s.lookAt(new Nt(0,1,0)),this.add(s);var c=new Ba(90,1,e,t);c.up.set(0,0,-1),c.lookAt(new Nt(0,-1,0)),this.add(c);var l=new Ba(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new Nt(0,0,1)),this.add(l);var u=new Ba(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new Nt(0,0,-1)),this.add(u),i=i||{format:Xe,magFilter:Re,minFilter:Re},this.renderTarget=new Tn(n,n,i),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=e.getRenderTarget(),i=this.renderTarget,r=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,e.render(t,o,i),i.activeCubeFace=1,e.render(t,a,i),i.activeCubeFace=2,e.render(t,s,i),i.activeCubeFace=3,e.render(t,c,i),i.activeCubeFace=4,e.render(t,l,i),i.texture.generateMipmaps=r,i.activeCubeFace=5,e.render(t,u,i),e.setRenderTarget(n)},this.clear=function(e,t,n,i){for(var r=e.getRenderTarget(),o=this.renderTarget,a=0;a<6;a++)o.activeCubeFace=a,e.setRenderTarget(o),e.clear(t,n,i);e.setRenderTarget(r)}}function kh(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function jh(){Ai.call(this),this.type="AudioListener",this.context=Ph.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function Hh(e){Ai.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Fh(e){Hh.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Nh(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function zh(e,t,n){this.binding=e,this.valueSize=n;var i,r=Float64Array;switch(t){case"quaternion":i=this._slerp;break;case"string":case"bool":r=Array,i=this._select;break;default:i=this._lerp}this.buffer=new r(4*n),this._mixBufferRegion=i,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Uh(e,t,n){var i=n||Gh.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}function Gh(e,t,n){this.path=t,this.parsedPath=n||Gh.parseTrackName(t),this.node=Gh.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Vh(){this.uuid=kt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function Wh(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var i=t.tracks,r=i.length,o=new Array(r),a={endingStart:2400,endingEnd:2400},s=0;s!==r;++s){var c=i[s].createInterpolant(null);(o[s]=c).settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function qh(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Xh(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Qh(){Ji.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Yh(e,t,n){ms.call(this,e,t),this.meshPerAttribute=n||1}function Zh(e,t,n,i){"number"==typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),_i.call(this,e,t,n),this.meshPerAttribute=i||1}function Kh(e,t,n,i){this.ray=new Wr(e,t),this.near=n||0,this.far=i||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Jh(e,t){return e.distance-t.distance}function $h(e,t,n,i){if(!1!==e.visible&&(e.raycast(t,n),!0===i))for(var r=e.children,o=0,a=r.length;o<a;o++)$h(r[o],t,n,!0)}function ed(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}function td(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}function nd(e,t){this.min=void 0!==e?e:new jt(1/0,1/0),this.max=void 0!==t?t:new jt(-1/0,-1/0)}function id(e,t){this.start=void 0!==e?e:new Nt,this.end=void 0!==t?t:new Nt}function rd(e){Ai.call(this),this.material=e,this.render=function(){}}function od(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==n?n:16711680,o=void 0!==i?i:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var c=new Ji,l=new ji(2*a*3,3);c.addAttribute("position",l),Ts.call(this,c,new Es({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function ad(e,t){Ai.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new Ji,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,o=1;r<32;r++,o++){var a=r/32*Math.PI*2,s=o/32*Math.PI*2;i.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new ji(i,3));var c=new Es({fog:!1});this.cone=new Ts(n,c),this.add(this.cone),this.update()}function sd(e){for(var t=function e(t){var n=[];t&&t.isBone&&n.push(t);for(var i=0;i<t.children.length;i++)n.push.apply(n,e(t.children[i]));return n}(e),n=new Ji,i=[],r=[],o=new zn(0,0,1),a=new zn(0,1,0),s=0;s<t.length;s++){var c=t[s];c.parent&&c.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}n.addAttribute("position",new ji(i,3)),n.addAttribute("color",new ji(r,3));var l=new Es({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});Ts.call(this,n,l),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function cd(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var i=new Bc(t,4,2),r=new Xr({wireframe:!0,fog:!1});Qr.call(this,i,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function ld(e,t){this.type="RectAreaLightHelper",this.light=e,this.color=t;var n=new Ji;n.addAttribute("position",new ji([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),n.computeBoundingSphere();var i=new Es({fog:!1});Ms.call(this,n,i);var r=new Ji;r.addAttribute("position",new ji([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),r.computeBoundingSphere(),this.add(new Qr(r,new Xr({side:xe,fog:!1}))),this.update()}function ud(e,t,n){Ai.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var i=new zs(t);i.rotateY(.5*Math.PI),this.material=new Xr({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2);var r=i.getAttribute("position"),o=new Float32Array(3*r.count);i.addAttribute("color",new _i(o,3)),this.add(new Qr(i,this.material)),this.update()}function hd(e,t,n,i){e=e||10,t=t||10,n=new zn(void 0!==n?n:4473924),i=new zn(void 0!==i?i:8947848);for(var r=t/2,o=e/t,a=e/2,s=[],c=[],l=0,u=0,h=-a;l<=t;l++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var d=l===r?n:i;d.toArray(c,u),u+=3,d.toArray(c,u),u+=3,d.toArray(c,u),u+=3,d.toArray(c,u),u+=3}var p=new Ji;p.addAttribute("position",new ji(s,3)),p.addAttribute("color",new ji(c,3));var f=new Es({vertexColors:2});Ts.call(this,p,f)}function dd(e,t,n,i,r,o){e=e||10,t=t||16,n=n||8,i=i||64,r=new zn(void 0!==r?r:4473924),o=new zn(void 0!==o?o:8947848);var a,s,c,l,u,h,d,p=[],f=[];for(l=0;l<=t;l++)c=l/t*(2*Math.PI),a=Math.sin(c)*e,s=Math.cos(c)*e,p.push(0,0,0),p.push(a,0,s),d=1&l?r:o,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(l=0;l<=n;l++)for(d=1&l?r:o,h=e-e/n*l,u=0;u<i;u++)c=u/i*(2*Math.PI),a=Math.sin(c)*h,s=Math.cos(c)*h,p.push(a,0,s),f.push(d.r,d.g,d.b),c=(u+1)/i*(2*Math.PI),a=Math.sin(c)*h,s=Math.cos(c)*h,p.push(a,0,s),f.push(d.r,d.g,d.b);var m=new Ji;m.addAttribute("position",new ji(p,3)),m.addAttribute("color",new ji(f,3));var v=new Es({vertexColors:2});Ts.call(this,m,v)}function pd(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==n?n:16776960,o=void 0!==i?i:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new Ji,l=new ji(2*a*3,3);c.addAttribute("position",l),Ts.call(this,c,new Es({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function fd(e,t,n){Ai.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);var i=new Ji;i.addAttribute("position",new ji([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var r=new Es({fog:!1});this.lightPlane=new Ms(i,r),this.add(this.lightPlane),(i=new Ji).addAttribute("position",new ji([0,0,0,0,0,1],3)),this.targetLine=new Ms(i,r),this.add(this.targetLine),this.update()}function md(e){var t=new Ji,n=new Es({color:16777215,vertexColors:1}),i=[],r=[],o={},a=new zn(16755200),s=new zn(16711680),c=new zn(43775),l=new zn(16777215),u=new zn(3355443);function h(e,t,n){d(e,n),d(t,n)}function d(e,t){i.push(0,0,0),r.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(i.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",c),h("u2","u3",c),h("u3","u1",c),h("c","t",l),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),t.addAttribute("position",new ji(i,3)),t.addAttribute("color",new ji(r,3)),Ts.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function vd(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new Ji;r.setIndex(new _i(n,1)),r.addAttribute("position",new _i(i,3)),Ts.call(this,r,new Es({color:t})),this.matrixAutoUpdate=!1,this.update()}function gd(e,t){this.type="Box3Helper",this.box=e;var n=void 0!==t?t:16776960,i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Ji;r.setIndex(new _i(i,1)),r.addAttribute("position",new ji([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Ts.call(this,r,new Es({color:n})),this.geometry.computeBoundingSphere()}function yd(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var i=void 0!==n?n:16776960,r=new Ji;r.addAttribute("position",new ji([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),Ms.call(this,r,new Es({color:i}));var o=new Ji;o.addAttribute("position",new ji([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Qr(o,new Xr({color:i,opacity:.2,transparent:!0,depthWrite:!1})))}function Ad(e,t,n,i,r,o){Ai.call(this),void 0===e&&(e=new Nt(0,0,1)),void 0===t&&(t=new Nt(0,0,0)),void 0===n&&(n=1),void 0===i&&(i=16776960),void 0===r&&(r=.2*n),void 0===o&&(o=.2*r),void 0===Yu&&((Yu=new Ji).addAttribute("position",new ji([0,0,0,0,1,0],3)),(Zu=new Nc(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Ms(Yu,new Es({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Qr(Zu,new Xr({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}function bd(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new Ji;n.addAttribute("position",new ji(t,3)),n.addAttribute("color",new ji([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var i=new Es({vertexColors:2});Ts.call(this,n,i)}function wd(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),jl.call(this,e),this.type="catmullrom",this.closed=!0}function xd(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),jl.call(this,e),this.type="catmullrom"}function Ed(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),jl.call(this,e),this.type="catmullrom"}function Md(e,t,n,i){ih.set(t,n,i).unproject(rh);var r=nh[e];if(void 0!==r)for(var o=th.getAttribute("position"),a=0,s=r.length;a<s;a++)o.setXYZ(r[a],ih.x,ih.y,ih.z)}Object.assign(Dh.prototype,{load:function(e,n,t,i){var r=new xl(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.load(e,function(e){var t=e.slice(0);Ph.getContext().decodeAudioData(t,function(e){n(e)})},t,i)},setPath:function(e){return this.path=e,this}}),Object.assign(Ih.prototype,{update:(ku=new Ht,ju=new Ht,function(e){if(Lu!==this||_u!==e.focus||Bu!==e.fov||Ru!==e.aspect*this.aspect||Pu!==e.near||Du!==e.far||Iu!==e.zoom||Ou!==this.eyeSep){Lu=this,_u=e.focus,Bu=e.fov,Ru=e.aspect*this.aspect,Pu=e.near,Du=e.far,Iu=e.zoom;var t,n,i=e.projectionMatrix.clone(),r=(Ou=this.eyeSep/2)*Pu/_u,o=Pu*Math.tan(kt.DEG2RAD*Bu*.5)/Iu;ju.elements[12]=-Ou,ku.elements[12]=Ou,t=-o*Ru+r,n=o*Ru+r,i.elements[0]=2*Pu/(n-t),i.elements[8]=(n+t)/(n-t),this.cameraL.projectionMatrix.copy(i),t=-o*Ru-r,n=o*Ru-r,i.elements[0]=2*Pu/(n-t),i.elements[8]=(n+t)/(n-t),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(ju),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ku)})}),(Oh.prototype=Object.create(Ai.prototype)).constructor=Oh,Object.assign(kh.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),jh.prototype=Object.assign(Object.create(Ai.prototype),{constructor:jh,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:(Ch=new Nt,Lh=new Ft,_h=new Nt,Bh=new Nt,Rh=new kh,function(e){Ai.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,n=this.up;if(this.timeDelta=Rh.getDelta(),this.matrixWorld.decompose(Ch,Lh,_h),Bh.set(0,0,-1).applyQuaternion(Lh),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Ch.x,i),t.positionY.linearRampToValueAtTime(Ch.y,i),t.positionZ.linearRampToValueAtTime(Ch.z,i),t.forwardX.linearRampToValueAtTime(Bh.x,i),t.forwardY.linearRampToValueAtTime(Bh.y,i),t.forwardZ.linearRampToValueAtTime(Bh.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(Ch.x,Ch.y,Ch.z),t.setOrientation(Bh.x,Bh.y,Bh.z,n.x,n.y,n.z)})}),Hh.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Hh,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e=e||[],!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),Fh.prototype=Object.assign(Object.create(Hh.prototype),{constructor:Fh,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:(Eh=new Nt,Mh=new Ft,Th=new Nt,Sh=new Nt,function(e){if(Ai.prototype.updateMatrixWorld.call(this,e),!1!==this.isPlaying){this.matrixWorld.decompose(Eh,Mh,Th),Sh.set(0,0,1).applyQuaternion(Mh);var t=this.panner;if(t.positionX){var n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Eh.x,n),t.positionY.linearRampToValueAtTime(Eh.y,n),t.positionZ.linearRampToValueAtTime(Eh.z,n),t.orientationX.linearRampToValueAtTime(Sh.x,n),t.orientationY.linearRampToValueAtTime(Sh.y,n),t.orientationZ.linearRampToValueAtTime(Sh.z,n)}else t.setPosition(Eh.x,Eh.y,Eh.z),t.setOrientation(Sh.x,Sh.y,Sh.z)}})}),Object.assign(Nh.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(zh.prototype,{accumulate:function(e,t){var n=this.buffer,i=this.valueSize,r=e*i+i,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==i;++a)n[r+a]=n[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(n,r,0,s,i)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,r<1){var a=3*t;this._mixBufferRegion(n,i,a,1-r,t)}for(var s=t,c=t+t;s!==c;++s)if(n[s]!==n[s+t]){o.setValue(n,i);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,i=3*n;e.getValue(t,i);for(var r=n,o=i;r!==o;++r)t[r]=t[i+r%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,i,r){if(.5<=i)for(var o=0;o!==r;++o)e[t+o]=e[n+o]},_slerp:function(e,t,n,i){Ft.slerpFlat(e,t,e,t,e,n,i)},_lerp:function(e,t,n,i,r){for(var o=1-i,a=0;a!==r;++a){var s=t+a;e[s]=e[s]*o+e[n+a]*i}}}),Object.assign(Uh.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Gh,{Composite:Uh,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Gh.Composite(e,t,n):new Gh(e,t,n)},sanitizeNodeName:(qu=new RegExp("[\\[\\]\\.:\\/]","g"),function(e){return e.replace(/\s/g,"_").replace(qu,"")}),parseTrackName:(Hu="[^\\[\\]\\.:\\/]",Fu="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Nu=/((?:WC+[\/:])*)/.source.replace("WC",Hu),zu=/(WCOD+)?/.source.replace("WCOD",Fu),Uu=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Hu),Gu=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Hu),Vu=new RegExp("^"+Nu+zu+Uu+Gu+"$"),Wu=["material","materials","bones"],function(e){var t=Vu.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){var r=n.nodeName.substring(i+1);-1!==Wu.indexOf(r)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}),findNode:function(e,r){if(!r||""===r||"root"===r||"."===r||-1===r||r===e.name||r===e.uuid)return e;if(e.skeleton){var t=e.skeleton.getBoneByName(r);if(void 0!==t)return t}if(e.children){var o=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.name===r||n.uuid===r)return n;var i=o(n.children);if(i)return i}return null},n=o(e.children);if(n)return n}return null}}),Object.assign(Gh.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)e[t++]=n[i]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++]},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,i=t.propertyName,r=t.propertyIndex;if(e||(e=Gh.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var o=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[i];if(void 0!==s){var c=this.Versioning.None;void 0!==(this.targetObject=e).needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===r){r=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===r){r=a;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}else{var u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Gh.prototype,{_getValue_unbound:Gh.prototype.getValue,_setValue_unbound:Gh.prototype.setValue}),Object.assign(Vh.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,c=void 0,l=0,u=arguments.length;l!==u;++l){var h=arguments[l],d=h.uuid,p=i[d];if(void 0===p){p=t++,i[d]=p,e.push(h);for(var f=0,m=s;f!==m;++f)a[f].push(new Gh(h,r[f],o[f]))}else if(p<n){c=e[p];var v=--n,g=e[v];e[i[g.uuid]=p]=g,e[i[d]=v]=h;for(f=0,m=s;f!==m;++f){var y=a[f],A=y[v],b=y[p];y[p]=A,void 0===b&&(b=new Gh(h,r[f],o[f])),y[v]=b}}else e[p]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,r=i.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],c=s.uuid,l=n[c];if(void 0!==l&&t<=l){var u=t++,h=e[u];e[n[h.uuid]=l]=h,e[n[c]=u]=s;for(var d=0,p=r;d!==p;++d){var f=i[d],m=f[u],v=f[l];f[l]=m,f[u]=v}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,o=r.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a].uuid,l=i[c];if(void 0!==l)if(delete i[c],l<n){var u=--n,h=e[u],d=e[g=--t];e[i[h.uuid]=l]=h,e[i[d.uuid]=u]=d,e.pop();for(var p=0,f=o;p!==f;++p){var m=(y=r[p])[u],v=y[g];y[l]=m,y[u]=v,y.pop()}}else{var g;e[i[(d=e[g=--t]).uuid]=l]=d,e.pop();for(p=0,f=o;p!==f;++p){var y;(y=r[p])[l]=y[g],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,i=n[e],r=this._bindings;if(void 0!==i)return r[i];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,u=new Array(c);i=r.length,n[e]=i,o.push(e),a.push(t),r.push(u);for(var h=l,d=s.length;h!==d;++h){var p=s[h];u[h]=new Gh(p,e,t)}return u},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];o[t[e[a]]=n]=s,o.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}}),Object.assign(Wh.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var i=this._clip.duration,r=e._clip.duration,o=r/i,a=i/r;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var i=this._mixer,r=i.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,c=o.sampleValues;return s[0]=r,s[1]=r+n,c[0]=e/a,c[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,i){if(this.enabled){var r=this._startTime;if(null!==r){var o=(e-r)*n;if(o<0||0===n)return;this._startTime=null,t=n*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(0<s)for(var c=this._interpolants,l=this._propertyBindings,u=0,h=c.length;u!==h;++u)c[u].evaluate(a),l[u].accumulate(i,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t},_updateTime:function(e){var t=this.time+e,n=this._clip.duration,i=this.loop,r=this._loopCount,o=2202===i;if(0===e)return-1===r?t:o&&1==(1&r)?n-t:t;if(2200===i){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n<=t)t=n;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(0<=e?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),n<=t||t<0){var a=Math.floor(t/n);t-=n*a,r+=Math.abs(a);var s=this.repetitions-r;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=0<e?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1});else{if(1==s){var c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&r))return n-(this.time=t)}return this.time=t},_setEndings:function(e,t,n){var i=this._interpolantSettings;n?(i.endingStart=2401,i.endingEnd=2401):(i.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,i.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(e,t,n){var i=this._mixer,r=i.time,o=this._weightInterpolant;null===o&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=t,a[1]=r+e,s[1]=n,this}}),qh.prototype=Object.assign(Object.create(t.prototype),{constructor:qh,_bindAction:function(e,t){var n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,o=e._propertyBindings,a=e._interpolants,s=n.uuid,c=this._bindingsByRootAndName,l=c[s];void 0===l&&(l={},c[s]=l);for(var u=0;u!==r;++u){var h=i[u],d=h.name,p=l[d];if(void 0!==p)o[u]=p;else{if(void 0!==(p=o[u])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=t&&t._propertyBindings[u].binding.parsedPath;++(p=new zh(Gh.create(n,d,f),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),o[u]=p}a[u].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}for(var r=e._propertyBindings,o=0,a=r.length;o!==a;++o){var s=r[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var i=this._actions,r=this._actionsByClip,o=r[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],i=e._cacheIndex;t[n._cacheIndex=i]=n,t.pop(),e._cacheIndex=null;var r=e._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,c=s[s.length-1],l=e._byClipCacheIndex;s[c._byClipCacheIndex=l]=c,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];t[e._cacheIndex=i]=e,t[r._cacheIndex=n]=r},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];t[e._cacheIndex=i]=e,t[r._cacheIndex=n]=r},_addInactiveBinding:function(e,t,n){var i=this._bindingsByRootAndName,r=i[t],o=this._bindings;void 0===r&&(r={},i[t]=r),(r[n]=e)._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,a=o[i],s=t[t.length-1],c=e._cacheIndex;t[s._cacheIndex=c]=s,t.pop(),delete a[r];e:{for(var l in a)break e;delete o[i]}},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];t[e._cacheIndex=i]=e,t[r._cacheIndex=n]=r},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];t[e._cacheIndex=i]=e,t[r._cacheIndex=n]=r},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&(e[(n=new al(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];t[e.__cacheIndex=i]=e,t[r.__cacheIndex=n]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,i=n.uuid,r="string"==typeof e?vl.findByName(n,e):e,o=null!==r?r.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var c=a.actionByRoot[i];if(void 0!==c)return c;s=a.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var l=new Wh(this,r,t);return this._bindAction(l,s),this._addInactiveAction(l,o,i),l},existingAction:function(e,t){var n=t||this._root,i=n.uuid,r="string"==typeof e?vl.findByName(n,e):e,o=r?r.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[i]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,i=this._nActiveBindings;this._nActiveActions=0;for(var r=this._nActiveBindings=0;r!==t;++r)e[r].reset();for(r=0;r!==i;++r)n[r].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1,a=0;a!==n;++a){t[a]._update(i,e,r,o)}var s=this._bindings,c=this._nActiveBindings;for(a=0;a!==c;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){for(var o=r.knownActions,a=0,s=o.length;a!==s;++a){var c=o[a];this._deactivateAction(c);var l=c._cacheIndex,u=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,t[u._cacheIndex=l]=u,t.pop(),this._removeInactiveBindingsForAction(c)}delete i[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var i in n){var r=n[i].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Xh.prototype.clone=function(){return new Xh(void 0===this.value.clone?this.value:this.value.clone())},Qh.prototype=Object.assign(Object.create(Ji.prototype),{constructor:Qh,isInstancedBufferGeometry:!0,copy:function(e){return Ji.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Yh.prototype=Object.assign(Object.create(ms.prototype),{constructor:Yh,isInstancedInterleavedBuffer:!0,copy:function(e){return ms.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Zh.prototype=Object.assign(Object.create(_i.prototype),{constructor:Zh,isInstancedBufferAttribute:!0,copy:function(e){return _i.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Kh.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var i=n||[];return $h(e,this,i,t),i.sort(Jh),i},intersectObjects:function(e,t,n){var i=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var r=0,o=e.length;r<o;r++)$h(e[r],this,i,t);return i.sort(Jh),i}}),Object.assign(ed.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(kt.clamp(t/this.radius,-1,1))),this}}),Object.assign(td.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}}),Object.assign(nd.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:(xh=new jt,function(e,t){var n=xh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new jt),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new jt),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new jt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new jt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:(wh=new jt,function(e){return wh.copy(e).clamp(this.min,this.max).sub(e).length()}),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(id.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Nt),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Nt),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Nt),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(Xu=new Nt,Qu=new Nt,function(e,t){Xu.subVectors(e,this.start),Qu.subVectors(this.end,this.start);var n=Qu.dot(Qu),i=Qu.dot(Xu)/n;return t&&(i=kt.clamp(i,0,1)),i}),closestPointToPoint:function(e,t,n){var i=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Nt),this.delta(n).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),((rd.prototype=Object.create(Ai.prototype)).constructor=rd).prototype.isImmediateRenderObject=!0,((od.prototype=Object.create(Ts.prototype)).constructor=od).prototype.update=(yh=new Nt,Ah=new Nt,bh=new zt,function(){var e=["a","b","c"];this.object.updateMatrixWorld(!0),bh.getNormalMatrix(this.object.matrixWorld);var t=this.object.matrixWorld,n=this.geometry.attributes.position,i=this.object.geometry;if(i&&i.isGeometry)for(var r=i.vertices,o=i.faces,a=0,s=0,c=o.length;s<c;s++)for(var l=o[s],u=0,h=l.vertexNormals.length;u<h;u++){var d=r[l[e[u]]],p=l.vertexNormals[u];yh.copy(d).applyMatrix4(t),Ah.copy(p).applyMatrix3(bh).normalize().multiplyScalar(this.size).add(yh),n.setXYZ(a,yh.x,yh.y,yh.z),a+=1,n.setXYZ(a,Ah.x,Ah.y,Ah.z),a+=1}else if(i&&i.isBufferGeometry){var f=i.attributes.position,m=i.attributes.normal;for(u=a=0,h=f.count;u<h;u++)yh.set(f.getX(u),f.getY(u),f.getZ(u)).applyMatrix4(t),Ah.set(m.getX(u),m.getY(u),m.getZ(u)),Ah.applyMatrix3(bh).normalize().multiplyScalar(this.size).add(yh),n.setXYZ(a,yh.x,yh.y,yh.z),a+=1,n.setXYZ(a,Ah.x,Ah.y,Ah.z),a+=1}n.needsUpdate=!0}),((ad.prototype=Object.create(Ai.prototype)).constructor=ad).prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},ad.prototype.update=(gh=new Nt,function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),gh.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(gh),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}),((sd.prototype=Object.create(Ts.prototype)).constructor=sd).prototype.updateMatrixWorld=(fh=new Nt,mh=new Ht,vh=new Ht,function(e){var t=this.bones,n=this.geometry,i=n.getAttribute("position");vh.getInverse(this.root.matrixWorld);for(var r=0,o=0;r<t.length;r++){var a=t[r];a.parent&&a.parent.isBone&&(mh.multiplyMatrices(vh,a.matrixWorld),fh.setFromMatrixPosition(mh),i.setXYZ(o,fh.x,fh.y,fh.z),mh.multiplyMatrices(vh,a.parent.matrixWorld),fh.setFromMatrixPosition(mh),i.setXYZ(o+1,fh.x,fh.y,fh.z),o+=2)}n.getAttribute("position").needsUpdate=!0,Ai.prototype.updateMatrixWorld.call(this,e)}),((cd.prototype=Object.create(Qr.prototype)).constructor=cd).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},cd.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},((ld.prototype=Object.create(Ms.prototype)).constructor=ld).prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color,t=Math.max(e.r,e.g,e.b);1<t&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}},ld.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},((ud.prototype=Object.create(Ai.prototype)).constructor=ud).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ud.prototype.update=(hh=new Nt,dh=new zn,ph=new zn,function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");dh.copy(this.light.color),ph.copy(this.light.groundColor);for(var n=0,i=t.count;n<i;n++){var r=n<i/2?dh:ph;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(hh.setFromMatrixPosition(this.light.matrixWorld).negate())}),(hd.prototype=Object.create(Ts.prototype)).constructor=hd,(dd.prototype=Object.create(Ts.prototype)).constructor=dd,((pd.prototype=Object.create(Ts.prototype)).constructor=pd).prototype.update=(ch=new Nt,lh=new Nt,uh=new zt,function(){this.object.updateMatrixWorld(!0),uh.getNormalMatrix(this.object.matrixWorld);for(var e=this.object.matrixWorld,t=this.geometry.attributes.position,n=this.object.geometry,i=n.vertices,r=n.faces,o=0,a=0,s=r.length;a<s;a++){var c=r[a],l=c.normal;ch.copy(i[c.a]).add(i[c.b]).add(i[c.c]).divideScalar(3).applyMatrix4(e),lh.copy(l).applyMatrix3(uh).normalize().multiplyScalar(this.size).add(ch),t.setXYZ(o,ch.x,ch.y,ch.z),o+=1,t.setXYZ(o,lh.x,lh.y,lh.z),o+=1}t.needsUpdate=!0}),((fd.prototype=Object.create(Ai.prototype)).constructor=fd).prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},fd.prototype.update=(oh=new Nt,ah=new Nt,sh=new Nt,function(){oh.setFromMatrixPosition(this.light.matrixWorld),ah.setFromMatrixPosition(this.light.target.matrixWorld),sh.subVectors(ah,oh),this.lightPlane.lookAt(ah),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(ah),this.targetLine.scale.z=sh.length()}),((md.prototype=Object.create(Ts.prototype)).constructor=md).prototype.update=(ih=new Nt,rh=new _a,function(){th=this.geometry,nh=this.pointMap,rh.projectionMatrix.copy(this.camera.projectionMatrix),Md("c",0,0,-1),Md("t",0,0,1),Md("n1",-1,-1,-1),Md("n2",1,-1,-1),Md("n3",-1,1,-1),Md("n4",1,1,-1),Md("f1",-1,-1,1),Md("f2",1,-1,1),Md("f3",-1,1,1),Md("f4",1,1,1),Md("u1",.7,1.1,-1),Md("u2",-.7,1.1,-1),Md("u3",0,2,-1),Md("cf1",-1,0,1),Md("cf2",1,0,1),Md("cf3",0,-1,1),Md("cf4",0,1,1),Md("cn1",-1,0,-1),Md("cn2",1,0,-1),Md("cn3",0,-1,-1),Md("cn4",0,1,-1),th.getAttribute("position").needsUpdate=!0}),((vd.prototype=Object.create(Ts.prototype)).constructor=vd).prototype.update=(eh=new Cn,function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&eh.setFromObject(this.object),!eh.isEmpty()){var t=eh.min,n=eh.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}),vd.prototype.setFromObject=function(e){return this.object=e,this.update(),this},vd.prototype.copy=function(e){return Ts.prototype.copy.call(this,e),this.object=e.object,this},vd.prototype.clone=function(){return(new this.constructor).copy(this)},((gd.prototype=Object.create(Ts.prototype)).constructor=gd).prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Ai.prototype.updateMatrixWorld.call(this,e))},((yd.prototype=Object.create(Ms.prototype)).constructor=yd).prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?xe:O,this.lookAt(this.plane.normal),Ai.prototype.updateMatrixWorld.call(this,e)},((Ad.prototype=Object.create(Ai.prototype)).constructor=Ad).prototype.setDirection=(Ju=new Nt,function(e){.99999<e.y?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(Ju.set(e.z,0,-e.x).normalize(),Ku=Math.acos(e.y),this.quaternion.setFromAxisAngle(Ju,Ku))}),Ad.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},Ad.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},Ad.prototype.copy=function(e){return Ai.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},Ad.prototype.clone=function(){return(new this.constructor).copy(this)},(bd.prototype=Object.create(Ts.prototype)).constructor=bd,_l.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(_l.prototype),(e.prototype.constructor=e).prototype.getPoint=t,e},Object.assign(Yl.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new Li,n=0,i=e.length;n<i;n++){var r=e[n];t.vertices.push(new Nt(r.x,r.y,r.z||0))}return t}}),Object.assign(Zl.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),wd.prototype=Object.create(jl.prototype),xd.prototype=Object.create(jl.prototype),Ed.prototype=Object.create(jl.prototype),Object.assign(Ed.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),hd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},sd.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Cu.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),uu.extractUrlBase(e)}}),Object.assign(pu.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(nd.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Cn.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),id.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(kt,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),kt.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),kt.ceilPowerOfTwo(e)}}),Object.assign(zt.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Ht.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return void 0===$u&&($u=new Nt),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),$u.setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,i,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,n,r,o)}}),_n.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Ft.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Wr.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(qr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(qr,{barycoordFromPoint:function(e,t,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),qr.getBarycoord(e,t,n,i,r)},normal:function(e,t,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),qr.getNormal(e,t,n,i)}}),Object.assign(Kl.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ec(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Oc(this,e)}}),Object.assign(jt.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Nt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(xn.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Li.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(Ai.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(Ai.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(As.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(ws.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),bs.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(_l.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ba.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Jl.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(_i.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(Ji.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Ji.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Mc.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Xh.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Gr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new zn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}}}),Object.defineProperties(Zc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Vr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(hs.prototype,{clearTarget:function(e,t,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,i)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(hs.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Ma.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(En.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(ls.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),Hh.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Dh).load(e,function(e){t.setBuffer(e)}),this},Nh.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Oh.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var Td={merge:function(e,t,n){var i;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),i=t.matrix,t=t.geometry),e.merge(t,i,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};An.crossOrigin=void 0,An.loadTexture=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new Ll;r.setCrossOrigin(this.crossOrigin);var o=r.load(e,n,void 0,i);return t&&(o.mapping=t),o},An.loadTextureCube=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new Cl;r.setCrossOrigin(this.crossOrigin);var o=r.load(e,n,void 0,i);return t&&(o.mapping=t),o},An.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},An.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Sd={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};e.WebGLMultisampleRenderTarget=Mn,e.WebGLRenderTargetCube=Tn,e.WebGLRenderTarget=En,e.WebGLRenderer=hs,e.ShaderLib=Qn,e.UniformsLib=Xn,e.UniformsUtils=Fn,e.ShaderChunk=Dn,e.FogExp2=ds,e.Fog=ps,e.Scene=fs,e.Sprite=ys,e.LOD=As,e.SkinnedMesh=bs,e.Skeleton=ws,e.Bone=xs,e.Mesh=Qr,e.LineSegments=Ts,e.LineLoop=Ss,e.Line=Ms,e.Points=Ls,e.Group=La,e.VideoTexture=_s,e.DataTexture=Sn,e.DataTexture3D=so,e.CompressedTexture=Bs,e.CubeTexture=ao,e.CanvasTexture=Rs,e.DepthTexture=Ps,e.Texture=wn,e.AnimationLoader=El,e.CompressedTextureLoader=Ml,e.DataTextureLoader=Tl,e.CubeTextureLoader=Cl,e.TextureLoader=Ll,e.ObjectLoader=pu,e.MaterialLoader=lu,e.BufferGeometryLoader=hu,e.DefaultLoadingManager=bl,e.LoadingManager=Al,e.ImageLoader=Sl,e.ImageBitmapLoader=xu,e.FontLoader=Su,e.FileLoader=xl,e.Loader=Cu,e.LoaderUtils=uu,e.Cache=yl,e.AudioLoader=Dh,e.SpotLightShadow=tu,e.SpotLight=nu,e.PointLight=iu,e.RectAreaLight=cu,e.HemisphereLight=$l,e.DirectionalLightShadow=ou,e.DirectionalLight=au,e.AmbientLight=su,e.LightShadow=eu,e.Light=Jl,e.StereoCamera=Ih,e.PerspectiveCamera=Ba,e.OrthographicCamera=ru,e.CubeCamera=Oh,e.ArrayCamera=Ra,e.Camera=_a,e.AudioListener=jh,e.PositionalAudio=Fh,e.AudioContext=Ph,e.AudioAnalyser=Nh,e.Audio=Hh,e.VectorKeyframeTrack=ml,e.StringKeyframeTrack=fl,e.QuaternionKeyframeTrack=pl,e.NumberKeyframeTrack=hl,e.ColorKeyframeTrack=ul,e.BooleanKeyframeTrack=ll,e.PropertyMixer=zh,e.PropertyBinding=Gh,e.KeyframeTrack=cl,e.AnimationUtils=il,e.AnimationObjectGroup=Vh,e.AnimationMixer=qh,e.AnimationClip=vl,e.Uniform=Xh,e.InstancedBufferGeometry=Qh,e.BufferGeometry=Ji,e.Geometry=Li,e.InterleavedBufferAttribute=vs,e.InstancedInterleavedBuffer=Yh,e.InterleavedBuffer=ms,e.InstancedBufferAttribute=Zh,e.Face3=Kn,e.Object3D=Ai,e.Raycaster=Kh,e.Layers=$n,e.EventDispatcher=t,e.Clock=kh,e.QuaternionLinearInterpolant=dl,e.LinearInterpolant=al,e.DiscreteInterpolant=sl,e.CubicInterpolant=ol,e.Interpolant=rl,e.Triangle=qr,e.Math=kt,e.Spherical=ed,e.Cylindrical=td,e.Plane=_n,e.Frustum=Bn,e.Sphere=Ln,e.Ray=Wr,e.Matrix4=Ht,e.Matrix3=zt,e.Box3=Cn,e.Box2=nd,e.Line3=id,e.Euler=Jn,e.Vector4=xn,e.Vector3=Nt,e.Vector2=jt,e.Quaternion=Ft,e.Color=zn,e.ImmediateRenderObject=rd,e.VertexNormalsHelper=od,e.SpotLightHelper=ad,e.SkeletonHelper=sd,e.PointLightHelper=cd,e.RectAreaLightHelper=ld,e.HemisphereLightHelper=ud,e.GridHelper=hd,e.PolarGridHelper=dd,e.FaceNormalsHelper=pd,e.DirectionalLightHelper=fd,e.CameraHelper=md,e.BoxHelper=vd,e.Box3Helper=gd,e.PlaneHelper=yd,e.ArrowHelper=Ad,e.AxesHelper=bd,e.Shape=Kl,e.Path=Zl,e.ShapePath=Eu,e.Font=Mu,e.CurvePath=Yl,e.Curve=_l,e.ImageUtils=An,e.ShapeUtils=bc,e.WebGLUtils=Ca,e.WireframeGeometry=Ds,e.ParametricGeometry=Is,e.ParametricBufferGeometry=Os,e.TetrahedronGeometry=Hs,e.TetrahedronBufferGeometry=Fs,e.OctahedronGeometry=Ns,e.OctahedronBufferGeometry=zs,e.IcosahedronGeometry=Us,e.IcosahedronBufferGeometry=Gs,e.DodecahedronGeometry=Vs,e.DodecahedronBufferGeometry=Ws,e.PolyhedronGeometry=ks,e.PolyhedronBufferGeometry=js,e.TubeGeometry=qs,e.TubeBufferGeometry=Xs,e.TorusKnotGeometry=Qs,e.TorusKnotBufferGeometry=Ys,e.TorusGeometry=Zs,e.TorusBufferGeometry=Ks,e.TextGeometry=Cc,e.TextBufferGeometry=Lc,e.SphereGeometry=_c,e.SphereBufferGeometry=Bc,e.RingGeometry=Rc,e.RingBufferGeometry=Pc,e.PlaneGeometry=tr,e.PlaneBufferGeometry=nr,e.LatheGeometry=Dc,e.LatheBufferGeometry=Ic,e.ShapeGeometry=Oc,e.ShapeBufferGeometry=kc,e.ExtrudeGeometry=Ec,e.ExtrudeBufferGeometry=Mc,e.EdgesGeometry=Hc,e.ConeGeometry=zc,e.ConeBufferGeometry=Uc,e.CylinderGeometry=Fc,e.CylinderBufferGeometry=Nc,e.CircleGeometry=Gc,e.CircleBufferGeometry=Vc,e.BoxGeometry=$i,e.BoxBufferGeometry=er,e.ShadowMaterial=qc,e.SpriteMaterial=gs,e.RawShaderMaterial=Xc,e.ShaderMaterial=Vr,e.PointsMaterial=Cs,e.MeshPhysicalMaterial=Yc,e.MeshStandardMaterial=Qc,e.MeshPhongMaterial=Zc,e.MeshToonMaterial=Kc,e.MeshNormalMaterial=Jc,e.MeshLambertMaterial=$c,e.MeshDepthMaterial=xa,e.MeshDistanceMaterial=Ea,e.MeshBasicMaterial=Xr,e.MeshMatcapMaterial=el,e.LineDashedMaterial=tl,e.LineBasicMaterial=Es,e.Material=Gr,e.Float64BufferAttribute=Hi,e.Float32BufferAttribute=ji,e.Uint32BufferAttribute=ki,e.Int32BufferAttribute=Oi,e.Uint16BufferAttribute=Ii,e.Int16BufferAttribute=Di,e.Uint8ClampedBufferAttribute=Pi,e.Uint8BufferAttribute=Ri,e.Int8BufferAttribute=Bi,e.BufferAttribute=_i,e.ArcCurve=Rl,e.CatmullRomCurve3=jl,e.CubicBezierCurve=zl,e.CubicBezierCurve3=Ul,e.EllipseCurve=Bl,e.LineCurve=Gl,e.LineCurve3=Vl,e.QuadraticBezierCurve=Wl,e.QuadraticBezierCurve3=ql,e.SplineCurve=Xl,e.REVISION="101",e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},e.CullFaceNone=q,e.CullFaceBack=X,e.CullFaceFront=Q,e.CullFaceFrontBack=3,e.FrontFaceDirectionCW=0,e.FrontFaceDirectionCCW=1,e.BasicShadowMap=0,e.PCFShadowMap=j,e.PCFSoftShadowMap=H,e.FrontSide=O,e.BackSide=xe,e.DoubleSide=Y,e.FlatShading=1,e.SmoothShading=2,e.NoColors=M,e.FaceColors=1,e.VertexColors=2,e.NoBlending=Z,e.NormalBlending=K,e.AdditiveBlending=J,e.SubtractiveBlending=$,e.MultiplyBlending=ee,e.CustomBlending=te,e.AddEquation=ne,e.SubtractEquation=T,e.ReverseSubtractEquation=S,e.MinEquation=C,e.MaxEquation=L,e.ZeroFactor=_,e.OneFactor=B,e.SrcColorFactor=R,e.OneMinusSrcColorFactor=P,e.SrcAlphaFactor=D,e.OneMinusSrcAlphaFactor=I,e.DstAlphaFactor=k,e.OneMinusDstAlphaFactor=F,e.DstColorFactor=N,e.OneMinusDstColorFactor=z,e.SrcAlphaSaturateFactor=U,e.NeverDepth=ie,e.AlwaysDepth=re,e.LessDepth=oe,e.LessEqualDepth=ae,e.EqualDepth=se,e.GreaterEqualDepth=ce,e.GreaterDepth=le,e.NotEqualDepth=ue,e.MultiplyOperation=G,e.MixOperation=V,e.AddOperation=W,e.NoToneMapping=he,e.LinearToneMapping=Ee,e.ReinhardToneMapping=de,e.Uncharted2ToneMapping=pe,e.CineonToneMapping=fe,e.ACESFilmicToneMapping=me,e.UVMapping=300,e.CubeReflectionMapping=ve,e.CubeRefractionMapping=ge,e.EquirectangularReflectionMapping=ye,e.EquirectangularRefractionMapping=Ae,e.SphericalReflectionMapping=be,e.CubeUVReflectionMapping=we,e.CubeUVRefractionMapping=Me,e.RepeatWrapping=Te,e.ClampToEdgeWrapping=Se,e.MirroredRepeatWrapping=Ce,e.NearestFilter=Le,e.NearestMipMapNearestFilter=_e,e.NearestMipMapLinearFilter=Be,e.LinearFilter=Re,e.LinearMipMapNearestFilter=Pe,e.LinearMipMapLinearFilter=De,e.UnsignedByteType=Ie,e.ByteType=Oe,e.ShortType=ke,e.UnsignedShortType=je,e.IntType=He,e.UnsignedIntType=Fe,e.FloatType=Ne,e.HalfFloatType=ze,e.UnsignedShort4444Type=Ue,e.UnsignedShort5551Type=Ge,e.UnsignedShort565Type=Ve,e.UnsignedInt248Type=We,e.AlphaFormat=qe,e.RGBFormat=Xe,e.RGBAFormat=Qe,e.LuminanceFormat=Ye,e.LuminanceAlphaFormat=Ze,e.RGBEFormat=Ke,e.DepthFormat=Je,e.DepthStencilFormat=$e,e.RedFormat=et,e.RGB_S3TC_DXT1_Format=tt,e.RGBA_S3TC_DXT1_Format=nt,e.RGBA_S3TC_DXT3_Format=it,e.RGBA_S3TC_DXT5_Format=rt,e.RGB_PVRTC_4BPPV1_Format=ot,e.RGB_PVRTC_2BPPV1_Format=at,e.RGBA_PVRTC_4BPPV1_Format=st,e.RGBA_PVRTC_2BPPV1_Format=ct,e.RGB_ETC1_Format=lt,e.RGBA_ASTC_4x4_Format=ut,e.RGBA_ASTC_5x4_Format=ht,e.RGBA_ASTC_5x5_Format=dt,e.RGBA_ASTC_6x5_Format=pt,e.RGBA_ASTC_6x6_Format=ft,e.RGBA_ASTC_8x5_Format=mt,e.RGBA_ASTC_8x6_Format=vt,e.RGBA_ASTC_8x8_Format=gt,e.RGBA_ASTC_10x5_Format=yt,e.RGBA_ASTC_10x6_Format=At,e.RGBA_ASTC_10x8_Format=bt,e.RGBA_ASTC_10x10_Format=wt,e.RGBA_ASTC_12x10_Format=xt,e.RGBA_ASTC_12x12_Format=Et,e.LoopOnce=2200,e.LoopRepeat=2201,e.LoopPingPong=2202,e.InterpolateDiscrete=2300,e.InterpolateLinear=2301,e.InterpolateSmooth=2302,e.ZeroCurvatureEnding=2400,e.ZeroSlopeEnding=2401,e.WrapAroundEnding=2402,e.TrianglesDrawMode=Mt,e.TriangleStripDrawMode=1,e.TriangleFanDrawMode=2,e.LinearEncoding=Tt,e.sRGBEncoding=St,e.GammaEncoding=Ct,e.RGBEEncoding=Lt,e.LogLuvEncoding=3003,e.RGBM7Encoding=_t,e.RGBM16Encoding=Bt,e.RGBDEncoding=Rt,e.BasicDepthPacking=Pt,e.RGBADepthPacking=Dt,e.TangentSpaceNormalMap=It,e.ObjectSpaceNormalMap=Ot,e.CubeGeometry=$i,e.Face4=function(e,t,n,i,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Kn(e,t,n,r,o,a)},e.LineStrip=0,e.LinePieces=1,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,(e.materials=e).clone=function(){return e.slice()},e},e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ls(e,t)},e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ys(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ls(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Cs(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Cs(e)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Cs(e)},e.Vertex=function(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Nt(e,t,n)},e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new _i(e,t).setDynamic(!0)},e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Bi(e,t)},e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Ri(e,t)},e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Pi(e,t)},e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Di(e,t)},e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Ii(e,t)},e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Oi(e,t)},e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new ki(e,t)},e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new ji(e,t)},e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Hi(e,t)},e.ClosedSplineCurve3=wd,e.SplineCurve3=xd,e.Spline=Ed,e.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new bd(e)},e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new vd(e,t)},e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ts(new Hc(e.geometry),new Es({color:void 0!==t?t:16777215}))},e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ts(new Ds(e.geometry),new Es({color:void 0!==t?t:16777215}))},e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new xl(e)},e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Tl(e)},e.GeometryUtils=Td,e.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},e.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},e.SceneUtils=Sd,e.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")},Object.defineProperty(e,"__esModule",{value:!0})})("object"==typeof n&&void 0!==t?n:this.THREE={})},{}],37:[function(e,t,n){"use strict";THREE.DRACOLoader=function(e){this.timeLoaded=0,this.manager=e||THREE.DefaultLoadingManager,this.materials=null,this.verbosity=0,this.attributeOptions={},this.drawMode=THREE.TrianglesDrawMode,this.nativeAttributeMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"}},THREE.DRACOLoader.prototype={constructor:THREE.DRACOLoader,load:function(e,t,n,i){var r=this,o=new THREE.FileLoader(r.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.load(e,function(e){r.decodeDracoFile(e,t)},n,i)},setPath:function(e){return this.path=e,this},setVerbosity:function(e){return this.verbosity=e,this},setDrawMode:function(e){return this.drawMode=e,this},setSkipDequantization:function(e,t){var n=!0;return void 0!==t&&(n=t),this.getAttributeOptions(e).skipDequantization=n,this},decodeDracoFile:function(t,n,i,r){var o=this;THREE.DRACOLoader.getDecoderModule().then(function(e){o.decodeDracoFileInternal(t,e.decoder,n,i,r)})},decodeDracoFileInternal:function(e,t,n,i,r){var o=new t.DecoderBuffer;o.Init(new Int8Array(e),e.byteLength);var a=new t.Decoder,s=a.GetEncodedGeometryType(o);if(s==t.TRIANGULAR_MESH)0<this.verbosity&&console.log("Loaded a mesh.");else{if(s!=t.POINT_CLOUD){var c="THREE.DRACOLoader: Unknown geometry type.";throw console.error(c),new Error(c)}0<this.verbosity&&console.log("Loaded a point cloud.")}n(this.convertDracoGeometryTo3JS(t,a,s,o,i,r))},addAttributeToGeometry:function(e,t,n,i,r,o,a,s){if(0===o.ptr){var c="THREE.DRACOLoader: No attribute "+i;throw console.error(c),new Error(c)}var l,u,h=o.num_components(),d=n.num_points()*h;switch(r){case Float32Array:l=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(n,o,l),s[i]=new Float32Array(d),u=THREE.Float32BufferAttribute;break;case Int8Array:l=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(n,o,l),s[i]=new Int8Array(d),u=THREE.Int8BufferAttribute;break;case Int16Array:l=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(n,o,l),s[i]=new Int16Array(d),u=THREE.Int16BufferAttribute;break;case Int32Array:l=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(n,o,l),s[i]=new Int32Array(d),u=THREE.Int32BufferAttribute;break;case Uint8Array:l=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(n,o,l),s[i]=new Uint8Array(d),u=THREE.Uint8BufferAttribute;break;case Uint16Array:l=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(n,o,l),s[i]=new Uint16Array(d),u=THREE.Uint16BufferAttribute;break;case Uint32Array:l=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(n,o,l),s[i]=new Uint32Array(d),u=THREE.Uint32BufferAttribute;break;default:c="THREE.DRACOLoader: Unexpected attribute type.";throw console.error(c),new Error(c)}for(var p=0;p<d;p++)s[i][p]=l.GetValue(p);a.addAttribute(i,new u(s[i],h)),e.destroy(l)},convertDracoGeometryTo3JS:function(e,t,n,i,r,o){var a,s;!0===this.getAttributeOptions("position").skipDequantization&&t.SkipAttributeTransform(e.POSITION);var c=performance.now();if(!(s=n===e.TRIANGULAR_MESH?(a=new e.Mesh,t.DecodeBufferToMesh(i,a)):(a=new e.PointCloud,t.DecodeBufferToPointCloud(i,a))).ok()||0==a.ptr){var l="THREE.DRACOLoader: Decoding failed: ";throw l+=s.error_msg(),console.error(l),e.destroy(t),e.destroy(a),new Error(l)}var u,h=performance.now();e.destroy(i),n==e.TRIANGULAR_MESH?(u=a.num_faces(),0<this.verbosity&&console.log("Number of faces loaded: "+u.toString())):u=0;var d=a.num_points(),p=a.num_attributes();0<this.verbosity&&(console.log("Number of points loaded: "+d.toString()),console.log("Number of attributes loaded: "+p.toString()));var f=t.GetAttributeId(a,e.POSITION);if(-1==f){l="THREE.DRACOLoader: No position attribute found.";throw console.error(l),e.destroy(t),e.destroy(a),new Error(l)}var m=t.GetAttribute(a,f),v={},g=new THREE.BufferGeometry;if(r)for(var y in r){var A=o[y],b=r[y],w=t.GetAttributeByUniqueId(a,b);this.addAttributeToGeometry(e,t,a,y,A,w,g,v)}else for(var y in this.nativeAttributeMap){var x=t.GetAttributeId(a,e[this.nativeAttributeMap[y]]);if(-1!==x){0<this.verbosity&&console.log("Loaded "+y+" attribute.");w=t.GetAttribute(a,x);this.addAttributeToGeometry(e,t,a,y,Float32Array,w,g,v)}}if(n==e.TRIANGULAR_MESH)if(this.drawMode===THREE.TriangleStripDrawMode){var E=new e.DracoInt32Array;t.GetTriangleStripsFromMesh(a,E),v.indices=new Uint32Array(E.size());for(var M=0;M<E.size();++M)v.indices[M]=E.GetValue(M);e.destroy(E)}else{var T=3*u;v.indices=new Uint32Array(T);var S=new e.DracoInt32Array;for(M=0;M<u;++M){t.GetFaceFromMesh(a,M,S);var C=3*M;v.indices[C]=S.GetValue(0),v.indices[1+C]=S.GetValue(1),v.indices[2+C]=S.GetValue(2)}e.destroy(S)}g.drawMode=this.drawMode,n==e.TRIANGULAR_MESH&&g.setIndex(new(65535<v.indices.length?THREE.Uint32BufferAttribute:THREE.Uint16BufferAttribute)(v.indices,1));var L=new e.AttributeQuantizationTransform;if(L.InitFromAttribute(m)){g.attributes.position.isQuantized=!0,g.attributes.position.maxRange=L.range(),g.attributes.position.numQuantizationBits=L.quantization_bits(),g.attributes.position.minValues=new Float32Array(3);for(M=0;M<3;++M)g.attributes.position.minValues[M]=L.min_value(M)}return e.destroy(L),e.destroy(t),e.destroy(a),this.decode_time=h-c,this.import_time=performance.now()-h,0<this.verbosity&&(console.log("Decode time: "+this.decode_time),console.log("Import time: "+this.import_time)),g},isVersionSupported:function(t,n){THREE.DRACOLoader.getDecoderModule().then(function(e){n(e.decoder.isVersionSupported(t))})},getAttributeOptions:function(e){return void 0===this.attributeOptions[e]&&(this.attributeOptions[e]={}),this.attributeOptions[e]}},THREE.DRACOLoader.decoderPath="./",THREE.DRACOLoader.decoderConfig={},THREE.DRACOLoader.decoderModulePromise=null,THREE.DRACOLoader.setDecoderPath=function(e){THREE.DRACOLoader.decoderPath=e},THREE.DRACOLoader.setDecoderConfig=function(e){var t=THREE.DRACOLoader.decoderConfig.wasmBinary;THREE.DRACOLoader.decoderConfig=e||{},THREE.DRACOLoader.releaseDecoderModule(),t&&(THREE.DRACOLoader.decoderConfig.wasmBinary=t)},THREE.DRACOLoader.releaseDecoderModule=function(){THREE.DRACOLoader.decoderModulePromise=null},THREE.DRACOLoader.getDecoderModule=function(){var n=this,e=THREE.DRACOLoader.decoderPath,i=THREE.DRACOLoader.decoderConfig,t=THREE.DRACOLoader.decoderModulePromise;return t||(t=(t="undefined"!=typeof DracoDecoderModule?Promise.resolve():"object"!=typeof WebAssembly||"js"===i.type?THREE.DRACOLoader._loadScript(e+"draco_decoder.js"):(i.wasmBinaryFile=e+"draco_decoder.wasm",THREE.DRACOLoader._loadScript(e+"draco_wasm_wrapper.js").then(function(){return THREE.DRACOLoader._loadArrayBuffer(i.wasmBinaryFile)}).then(function(e){i.wasmBinary=e}))).then(function(){return new Promise(function(t){i.onModuleLoaded=function(e){n.timeLoaded=performance.now(),t({decoder:e})},DracoDecoderModule(i)})}),THREE.DRACOLoader.decoderModulePromise=t)},THREE.DRACOLoader._loadScript=function(e){var t=document.getElementById("decoder_script");null!==t&&t.parentNode.removeChild(t);var n=document.getElementsByTagName("head")[0],i=document.createElement("script");return i.id="decoder_script",i.type="text/javascript",i.src=e,new Promise(function(e){i.onload=e,n.appendChild(i)})},THREE.DRACOLoader._loadArrayBuffer=function(n){var i=new THREE.FileLoader;return i.setResponseType("arraybuffer"),new Promise(function(e,t){i.load(n,e,void 0,t)})}},{}],38:[function(e,t,n){THREE.GLTFLoader=function(){function e(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.dracoLoader=null}function i(){var n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(t,n,e,i){var r,o=this;r=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(t),o.manager.itemStart(t);function a(e){i?i(e):console.error(e),o.manager.itemError(t),o.manager.itemEnd(t)}var s=new THREE.FileLoader(o.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.load(t,function(e){try{o.parse(e,r,function(e){n(e),o.manager.itemEnd(t)},a)}catch(e){a(e)}},e,a)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},parse:function(e,t,a,n){var i,s={};if("string"==typeof e)i=e;else if(THREE.LoaderUtils.decodeText(new Uint8Array(e,0,4))===f){try{s[L.KHR_BINARY_GLTF]=new m(e)}catch(e){return void(n&&n(e))}i=s[L.KHR_BINARY_GLTF].content}else i=THREE.LoaderUtils.decodeText(new Uint8Array(e));var r=JSON.parse(i);if(void 0===r.asset||r.asset.version[0]<2)n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(r.extensionsUsed)for(var o=0;o<r.extensionsUsed.length;++o){var c=r.extensionsUsed[o],l=r.extensionsRequired||[];switch(c){case L.KHR_LIGHTS_PUNCTUAL:s[c]=new d(r);break;case L.KHR_MATERIALS_UNLIT:s[c]=new p(r);break;case L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[c]=new y(r);break;case L.KHR_DRACO_MESH_COMPRESSION:s[c]=new v(r,this.dracoLoader);break;case L.MSFT_TEXTURE_DDS:s[L.MSFT_TEXTURE_DDS]=new h(r);break;case L.KHR_TEXTURE_TRANSFORM:s[L.KHR_TEXTURE_TRANSFORM]=new g(r);break;default:0<=l.indexOf(c)&&console.warn('THREE.GLTFLoader: Unknown extension "'+c+'".')}}var u=new q(r,s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});u.parse(function(e,t,n,i,r){var o={scene:e,scenes:t,cameras:n,animations:i,asset:r.asset,parser:u,userData:{}};N(s,o,r),a(o)},n)}}};var L={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function h(){if(!THREE.DDSLoader)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=L.MSFT_TEXTURE_DDS,this.ddsLoader=new THREE.DDSLoader}function d(e){this.name=L.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[L.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function p(e){this.name=L.KHR_MATERIALS_UNLIT}d.prototype.loadLight=function(e){var t,n=this.lightDefs[e],i=new THREE.Color(16777215);void 0!==n.color&&i.fromArray(n.color);var r=void 0!==n.range?n.range:0;switch(n.type){case"directional":(t=new THREE.DirectionalLight(i)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new THREE.PointLight(i)).distance=r;break;case"spot":(t=new THREE.SpotLight(i)).distance=r,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,t.angle=n.spot.outerConeAngle,t.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+n.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==n.intensity&&(t.intensity=n.intensity),t.name=n.name||"light_"+e,Promise.resolve(t)},p.prototype.getMaterialType=function(e){return THREE.MeshBasicMaterial},p.prototype.extendParams=function(e,t,n){var i=[];e.color=new THREE.Color(1,1,1),e.opacity=1;var r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){var o=r.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==r.baseColorTexture&&i.push(n.assignTexture(e,"map",r.baseColorTexture))}return Promise.all(i)};var f="glTF",c=12,l={JSON:1313821514,BIN:5130562};function m(e){this.name=L.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,c);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==f)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var n=new DataView(e,c),i=0;i<n.byteLength;){var r=n.getUint32(i,!0);i+=4;var o=n.getUint32(i,!0);if(i+=4,o===l.JSON){var a=new Uint8Array(e,c+i,r);this.content=THREE.LoaderUtils.decodeText(a)}else if(o===l.BIN){var s=c+i;this.body=e.slice(s,s+r)}i+=r}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function v(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=L.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,THREE.DRACOLoader.getDecoderModule()}function g(e){this.name=L.KHR_TEXTURE_TRANSFORM}function y(){return{name:L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return THREE.ShaderMaterial},extendParams:function(e,t,n){var i=t.extensions[this.name],r=THREE.ShaderLib.standard,o=THREE.UniformsUtils.clone(r.uniforms),a=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),c=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),l=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),u=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),h=r.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",a).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",c).replace("#include <metalnessmap_fragment>",l).replace("#include <lights_physical_fragment>",u);delete o.roughness,delete o.metalness,delete o.roughnessMap,delete o.metalnessMap,o.specular={value:(new THREE.Color).setHex(1118481)},o.glossiness={value:.5},o.specularMap={value:null},o.glossinessMap={value:null},e.vertexShader=r.vertexShader,e.fragmentShader=h,e.uniforms=o,e.defines={STANDARD:""},e.color=new THREE.Color(1,1,1),e.opacity=1;var d=[];if(Array.isArray(i.diffuseFactor)){var p=i.diffuseFactor;e.color.fromArray(p),e.opacity=p[3]}if(void 0!==i.diffuseTexture&&d.push(n.assignTexture(e,"map",i.diffuseTexture)),e.emissive=new THREE.Color(0,0,0),e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,e.specular=new THREE.Color(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var f=i.specularGlossinessTexture;d.push(n.assignTexture(e,"glossinessMap",f)),d.push(n.assignTexture(e,"specularMap",f))}return Promise.all(d)},createMaterial:function(e){var t=new THREE.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var n=this.specularGlossinessParams,i=0,r=n.length;i<r;i++)t[n[i]]=e[n[i]];return t},refreshUniforms:function(e,t,n,i,r,o){if(!0===r.isGLTFSpecularGlossinessMaterial){var a,s=r.uniforms,c=r.defines;s.opacity.value=r.opacity,s.diffuse.value.copy(r.color),s.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),s.map.value=r.map,s.specularMap.value=r.specularMap,s.alphaMap.value=r.alphaMap,s.lightMap.value=r.lightMap,s.lightMapIntensity.value=r.lightMapIntensity,s.aoMap.value=r.aoMap,s.aoMapIntensity.value=r.aoMapIntensity,r.map?a=r.map:r.specularMap?a=r.specularMap:r.displacementMap?a=r.displacementMap:r.normalMap?a=r.normalMap:r.bumpMap?a=r.bumpMap:r.glossinessMap?a=r.glossinessMap:r.alphaMap?a=r.alphaMap:r.emissiveMap&&(a=r.emissiveMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),s.uvTransform.value.copy(a.matrix)),r.envMap&&(s.envMap.value=r.envMap,s.envMapIntensity.value=r.envMapIntensity,s.flipEnvMap.value=r.envMap.isCubeTexture?-1:1,s.reflectivity.value=r.reflectivity,s.refractionRatio.value=r.refractionRatio,s.maxMipLevel.value=e.properties.get(r.envMap).__maxMipLevel),s.specular.value.copy(r.specular),s.glossiness.value=r.glossiness,s.glossinessMap.value=r.glossinessMap,s.emissiveMap.value=r.emissiveMap,s.bumpMap.value=r.bumpMap,s.normalMap.value=r.normalMap,s.displacementMap.value=r.displacementMap,s.displacementScale.value=r.displacementScale,s.displacementBias.value=r.displacementBias,null!==s.glossinessMap.value&&void 0===c.USE_GLOSSINESSMAP&&(c.USE_GLOSSINESSMAP="",c.USE_ROUGHNESSMAP=""),null===s.glossinessMap.value&&void 0!==c.USE_GLOSSINESSMAP&&(delete c.USE_GLOSSINESSMAP,delete c.USE_ROUGHNESSMAP)}}}}function M(e,t,n,i){THREE.Interpolant.call(this,e,t,n,i)}v.prototype.decodePrimitive=function(e,t){var n=this.json,i=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},s={},c={};for(var l in o)l in w&&(a[w[l]]=o[l]);for(l in e.attributes)if(void 0!==w[l]&&void 0!==o[l]){var u=n.accessors[e.attributes[l]],h=T[u.componentType];c[w[l]]=h,s[w[l]]=!0===u.normalized}return t.getDependency("bufferView",r).then(function(e){return new Promise(function(r){i.decodeDracoFile(e,function(e){for(var t in e.attributes){var n=e.attributes[t],i=s[t];void 0!==i&&(n.normalized=i)}r(e)},a,c)})})},g.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},((M.prototype=Object.create(THREE.Interpolant.prototype)).constructor=M).prototype.beforeStart_=M.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i*3+i,o=0;o!==i;o++)t[o]=n[r+o];return t},M.prototype.afterEnd_=M.prototype.copySampleValue_,M.prototype.interpolate_=function(e,t,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,c=3*a,l=i-t,u=(n-t)/l,h=u*u,d=h*u,p=e*c,f=p-c,m=-2*d+3*h,v=d-h,g=1-m,y=v-h+u,A=0;A!==a;A++){var b=o[f+A+a],w=o[f+A+s]*l,x=o[p+A+a],E=o[p+A]*l;r[A]=g*b+y*w+m*x+v*E}return r};var _=0,B=1,R=2,P=3,D=4,I=5,O=6,T=(Number,THREE.Matrix3,THREE.Matrix4,THREE.Vector2,THREE.Vector3,THREE.Vector4,THREE.Texture,{5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array}),A={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipMapNearestFilter,9985:THREE.LinearMipMapNearestFilter,9986:THREE.NearestMipMapLinearFilter,9987:THREE.LinearMipMapLinearFilter},b={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},S=(THREE.BackSide,THREE.FrontSide,THREE.NeverDepth,THREE.LessDepth,THREE.EqualDepth,THREE.LessEqualDepth,THREE.GreaterEqualDepth,THREE.NotEqualDepth,THREE.GreaterEqualDepth,THREE.AlwaysDepth,THREE.AddEquation,THREE.SubtractEquation,THREE.ReverseSubtractEquation,THREE.ZeroFactor,THREE.OneFactor,THREE.SrcColorFactor,THREE.OneMinusSrcColorFactor,THREE.SrcAlphaFactor,THREE.OneMinusSrcAlphaFactor,THREE.DstAlphaFactor,THREE.OneMinusDstAlphaFactor,THREE.DstColorFactor,THREE.OneMinusDstColorFactor,THREE.SrcAlphaSaturateFactor,{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),w={POSITION:"position",NORMAL:"normal",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},C={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},k={CUBICSPLINE:THREE.InterpolateSmooth,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},x="OPAQUE",E="MASK",j="BLEND",H={"image/png":THREE.RGBAFormat,"image/jpeg":THREE.RGBFormat};function F(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function N(e,t,n){for(var i in n.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=n.extensions[i])}function z(e,t){void 0!==t.extras&&("object"==typeof t.extras?e.userData=t.extras:console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function U(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,i=t.weights.length;n<i;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(n=0,i=r.length;n<i;n++)e.morphTargetDictionary[r[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function G(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0}function V(e,t){if(e.length!==t.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function W(e,t){for(var n=0,i=e.length;n<i;n++){var r=e[n];if(a=t,void 0,s=(o=r.primitive).extensions?o.extensions[L.KHR_DRACO_MESH_COMPRESSION]:void 0,c=a.extensions?a.extensions[L.KHR_DRACO_MESH_COMPRESSION]:void 0,s&&c?s.bufferView===c.bufferView&&G(s.attributes,c.attributes):o.indices===a.indices&&G(o.attributes,a.attributes))return r.promise}var o,a,s,c;return null}function u(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,n=e.itemSize,i=e.array.slice(0,t*n),r=0,o=0;r<t;++r)i[o++]=e.getX(r),2<=n&&(i[o++]=e.getY(r)),3<=n&&(i[o++]=e.getZ(r)),4<=n&&(i[o++]=e.getW(r));return new THREE.BufferAttribute(i,n,e.normalized)}return e.clone()}function q(e,t,n){this.json=e||{},this.extensions=t||{},this.options=n||{},this.cache=new i,this.primitiveCache=[],this.multiplePrimitivesCache=[],this.multiPassGeometryCache=[],this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function X(n,e,i){var t=e.attributes,r=[];function o(e,t){return i.getDependency("accessor",e).then(function(e){n.addAttribute(t,e)})}for(var a in t){var s=w[a];s&&(s in n.attributes||r.push(o(t[a],s)))}if(void 0!==e.indices&&!n.index){var c=i.getDependency("accessor",e.indices).then(function(e){n.setIndex(e)});r.push(c)}return z(n,e),Promise.all(r).then(function(){return void 0!==e.targets?function(p,f,e){for(var m=!1,v=!1,t=0,n=f.length;t<n;t++){if(void 0!==(o=f[t]).POSITION&&(m=!0),void 0!==o.NORMAL&&(v=!0),m&&v)break}if(!m&&!v)return Promise.resolve(p);var i=[],r=[];for(t=0,n=f.length;t<n;t++){var o=f[t];if(m){var a=void 0!==o.POSITION?e.getDependency("accessor",o.POSITION).then(function(e){return u(e)}):p.attributes.position;i.push(a)}if(v){a=void 0!==o.NORMAL?e.getDependency("accessor",o.NORMAL).then(function(e){return u(e)}):p.attributes.normal;r.push(a)}}return Promise.all([Promise.all(i),Promise.all(r)]).then(function(e){for(var t=e[0],n=e[1],i=0,r=f.length;i<r;i++){var o=f[i],a="morphTarget"+i;if(m&&void 0!==o.POSITION){var s=t[i];s.name=a;for(var c=p.attributes.position,l=0,u=s.count;l<u;l++)s.setXYZ(l,s.getX(l)+c.getX(l),s.getY(l)+c.getY(l),s.getZ(l)+c.getZ(l))}if(v&&void 0!==o.NORMAL){var h=n[i];h.name=a;var d=p.attributes.normal;for(l=0,u=h.count;l<u;l++)h.setXYZ(l,h.getX(l)+d.getX(l),h.getY(l)+d.getY(l),h.getZ(l)+d.getZ(l))}}return m&&(p.morphAttributes.position=t),v&&(p.morphAttributes.normal=n),p})}(n,e.targets,i):n})}return q.prototype.parse=function(o,e){var a=this.json;this.cache.removeAll(),this.markDefs(),this.getMultiDependencies(["scene","animation","camera"]).then(function(e){var t=e.scenes||[],n=t[a.scene||0],i=e.animations||[],r=e.cameras||[];o(n,t,r,i,a)}).catch(e)},q.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],i={},r={},o=0,a=t.length;o<a;o++)for(var s=t[o].joints,c=0,l=s.length;c<l;c++)e[s[c]].isBone=!0;for(var u=0,h=e.length;u<h;u++){var d=e[u];void 0!==d.mesh&&(void 0===i[d.mesh]&&(i[d.mesh]=r[d.mesh]=0),i[d.mesh]++,void 0!==d.skin&&(n[d.mesh].isSkinnedMesh=!0))}this.json.meshReferences=i,this.json.meshUses=r},q.prototype.getDependency=function(e,t){var n=e+":"+t,i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this.loadNode(t);break;case"mesh":i=this.loadMesh(t);break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this.loadBufferView(t);break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this.loadMaterial(t);break;case"texture":i=this.loadTexture(t);break;case"skin":i=this.loadSkin(t);break;case"animation":i=this.loadAnimation(t);break;case"camera":i=this.loadCamera(t);break;case"light":i=this.extensions[L.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,i)}return i},q.prototype.getDependencies=function(n){var e=this.cache.get(n);if(!e){var i=this,t=this.json[n+("mesh"===n?"es":"s")]||[];e=Promise.all(t.map(function(e,t){return i.getDependency(n,t)})),this.cache.add(n,e)}return e},q.prototype.getMultiDependencies=function(e){for(var n={},t=[],i=0,r=e.length;i<r;i++){var o=e[i],a=this.getDependencies(o);a=a.then(function(e,t){n[e]=t}.bind(this,o+("mesh"===o?"es":"s"))),t.push(a)}return Promise.all(t).then(function(){return n})},q.prototype.loadBuffer=function(e){var n=this.json.buffers[e],i=this.fileLoader;if(n.type&&"arraybuffer"!==n.type)throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(void 0===n.uri&&0===e)return Promise.resolve(this.extensions[L.KHR_BINARY_GLTF].body);var r=this.options;return new Promise(function(e,t){i.load(F(n.uri,r.path),e,void 0,function(){t(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})},q.prototype.loadBufferView=function(e){var i=this.json.bufferViews[e];return this.getDependency("buffer",i.buffer).then(function(e){var t=i.byteLength||0,n=i.byteOffset||0;return e.slice(n,n+t)})},q.prototype.loadAccessor=function(e){var x=this,E=this.json,M=this.json.accessors[e];if(void 0===M.bufferView&&void 0===M.sparse)return Promise.resolve(null);var t=[];return void 0!==M.bufferView?t.push(this.getDependency("bufferView",M.bufferView)):t.push(null),void 0!==M.sparse&&(t.push(this.getDependency("bufferView",M.sparse.indices.bufferView)),t.push(this.getDependency("bufferView",M.sparse.values.bufferView))),Promise.all(t).then(function(e){var t,n,i=e[0],r=S[M.type],o=T[M.componentType],a=o.BYTES_PER_ELEMENT,s=a*r,c=M.byteOffset||0,l=void 0!==M.bufferView?E.bufferViews[M.bufferView].byteStride:void 0,u=!0===M.normalized;if(l&&l!==s){var h="InterleavedBuffer:"+M.bufferView+":"+M.componentType,d=x.cache.get(h);d||(t=new o(i),d=new THREE.InterleavedBuffer(t,l/a),x.cache.add(h,d)),n=new THREE.InterleavedBufferAttribute(d,r,c/a,u)}else t=null===i?new o(M.count*r):new o(i,c,M.count*r),n=new THREE.BufferAttribute(t,r,u);if(void 0!==M.sparse){var p=S.SCALAR,f=T[M.sparse.indices.componentType],m=M.sparse.indices.byteOffset||0,v=M.sparse.values.byteOffset||0,g=new f(e[1],m,M.sparse.count*p),y=new o(e[2],v,M.sparse.count*r);null!==i&&n.setArray(n.array.slice());for(var A=0,b=g.length;A<b;A++){var w=g[A];if(n.setX(w,y[A*r]),2<=r&&n.setY(w,y[A*r+1]),3<=r&&n.setZ(w,y[A*r+2]),4<=r&&n.setW(w,y[A*r+3]),5<=r)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return n})},q.prototype.loadTexture=function(e){var n,t=this,i=this.json,r=this.options,o=this.textureLoader,a=window.URL||window.webkitURL,s=i.textures[e],c=s.extensions||{},l=(n=c[L.MSFT_TEXTURE_DDS]?i.images[c[L.MSFT_TEXTURE_DDS].source]:i.images[s.source]).uri,u=!1;return void 0!==n.bufferView&&(l=t.getDependency("bufferView",n.bufferView).then(function(e){u=!0;var t=new Blob([e],{type:n.mimeType});return l=a.createObjectURL(t)})),Promise.resolve(l).then(function(n){var i=THREE.Loader.Handlers.get(n);return i=i||(c[L.MSFT_TEXTURE_DDS]?t.extensions[L.MSFT_TEXTURE_DDS].ddsLoader:o),new Promise(function(e,t){i.load(F(n,r.path),e,void 0,t)})}).then(function(e){!0===u&&a.revokeObjectURL(l),e.flipY=!1,void 0!==s.name&&(e.name=s.name),n.mimeType in H&&(e.format=H[n.mimeType]);var t=(i.samplers||{})[s.sampler]||{};return e.magFilter=A[t.magFilter]||THREE.LinearFilter,e.minFilter=A[t.minFilter]||THREE.LinearMipMapLinearFilter,e.wrapS=b[t.wrapS]||THREE.RepeatWrapping,e.wrapT=b[t.wrapT]||THREE.RepeatWrapping,e})},q.prototype.assignTexture=function(n,i,r){var o=this;return this.getDependency("texture",r.index).then(function(e){if(o.extensions[L.KHR_TEXTURE_TRANSFORM]){var t=void 0!==r.extensions?r.extensions[L.KHR_TEXTURE_TRANSFORM]:void 0;t&&(e=o.extensions[L.KHR_TEXTURE_TRANSFORM].extendTexture(e,t))}n[i]=e})},q.prototype.loadMaterial=function(e){var t,n=this.json,i=this.extensions,r=n.materials[e],o={},a=r.extensions||{},s=[];if(a[L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var c=i[L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=c.getMaterialType(r),s.push(c.extendParams(o,r,this))}else if(a[L.KHR_MATERIALS_UNLIT]){var l=i[L.KHR_MATERIALS_UNLIT];t=l.getMaterialType(r),s.push(l.extendParams(o,r,this))}else{t=THREE.MeshStandardMaterial;var u=r.pbrMetallicRoughness||{};if(o.color=new THREE.Color(1,1,1),o.opacity=1,Array.isArray(u.baseColorFactor)){var h=u.baseColorFactor;o.color.fromArray(h),o.opacity=h[3]}void 0!==u.baseColorTexture&&s.push(this.assignTexture(o,"map",u.baseColorTexture)),o.metalness=void 0!==u.metallicFactor?u.metallicFactor:1,o.roughness=void 0!==u.roughnessFactor?u.roughnessFactor:1,void 0!==u.metallicRoughnessTexture&&(s.push(this.assignTexture(o,"metalnessMap",u.metallicRoughnessTexture)),s.push(this.assignTexture(o,"roughnessMap",u.metallicRoughnessTexture)))}!0===r.doubleSided&&(o.side=THREE.DoubleSide);var d=r.alphaMode||x;return d===j?o.transparent=!0:(o.transparent=!1,d===E&&(o.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&t!==THREE.MeshBasicMaterial&&(s.push(this.assignTexture(o,"normalMap",r.normalTexture)),o.normalScale=new THREE.Vector2(1,1),void 0!==r.normalTexture.scale&&o.normalScale.set(r.normalTexture.scale,r.normalTexture.scale)),void 0!==r.occlusionTexture&&t!==THREE.MeshBasicMaterial&&(s.push(this.assignTexture(o,"aoMap",r.occlusionTexture)),void 0!==r.occlusionTexture.strength&&(o.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&t!==THREE.MeshBasicMaterial&&(o.emissive=(new THREE.Color).fromArray(r.emissiveFactor)),void 0!==r.emissiveTexture&&t!==THREE.MeshBasicMaterial&&s.push(this.assignTexture(o,"emissiveMap",r.emissiveTexture)),Promise.all(s).then(function(){var e;return e=t===THREE.ShaderMaterial?i[L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new t(o),void 0!==r.name&&(e.name=r.name),e.normalScale&&(e.normalScale.y=-e.normalScale.y),e.map&&(e.map.encoding=THREE.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=THREE.sRGBEncoding),e.specularMap&&(e.specularMap.encoding=THREE.sRGBEncoding),z(e,r),r.extensions&&N(i,e,r),e})},q.prototype.loadGeometries=function(a){var h,s=this,e=this.extensions,t=this.primitiveCache,d=function(e){if(e.length<2)return!1;var t=e[0],n=t.targets||[];if(void 0===t.indices)return!1;for(var i=1,r=e.length;i<r;i++){var o=e[i];if(t.mode!==o.mode)return!1;if(void 0===o.indices)return!1;if(o.extensions&&o.extensions[L.KHR_DRACO_MESH_COMPRESSION])return!1;if(!G(t.attributes,o.attributes))return!1;var a=o.targets||[];if(n.length!==a.length)return!1;for(var s=0,c=n.length;s<c;s++)if(!G(n[s],a[s]))return!1}return!0}(a);function n(t){return e[L.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,s).then(function(e){return X(e,t,s)})}d&&(a=[(h=a)[0]]);for(var i=[],r=0,o=a.length;r<o;r++){var c,l=a[r],u=W(t,l);u?i.push(u):(c=l.extensions&&l.extensions[L.KHR_DRACO_MESH_COMPRESSION]?n(l):X(new THREE.BufferGeometry,l,s),t.push({primitive:l,promise:c}),i.push(c))}return Promise.all(i).then(function(e){if(d){var c=e[0];if(null!==(o=function(e,t,n){for(var i=0,r=e.length;i<r;i++){var o=e[i];if(t===o.baseGeometry&&V(n,o.primitives))return o.geometry}return null}(u=s.multiPassGeometryCache,c,h)))return[o.geometry];var l=new THREE.BufferGeometry;for(var t in l.name=c.name,l.userData=c.userData,c.attributes)l.addAttribute(t,c.attributes[t]);for(var t in c.morphAttributes)l.morphAttributes[t]=c.morphAttributes[t];for(var n=[],i=0,r=h.length;i<r;i++)n.push(s.getDependency("accessor",h[i].indices));return Promise.all(n).then(function(e){for(var t=[],n=0,i=0,r=h.length;i<r;i++){for(var o=e[i],a=0,s=o.count;a<s;a++)t.push(o.array[a]);l.addGroup(n,o.count,i),n+=o.count}return l.setIndex(t),u.push({geometry:l,baseGeometry:c,primitives:h}),[l]})}if(1<e.length&&void 0!==THREE.BufferGeometryUtils){for(i=1,r=a.length;i<r;i++)if(a[0].mode!==a[i].mode)return e;var u,o;if(o=function(e,t){for(var n=0,i=e.length;n<i;n++){var r=e[n];if(V(t,r.baseGeometries))return r.geometry}return null}(u=s.multiplePrimitivesCache,e)){if(null!==o.geometry)return[o.geometry]}else{l=THREE.BufferGeometryUtils.mergeBufferGeometries(e,!0);if(u.push({geometry:l,baseGeometries:e}),null!==l)return[l]}}return e})},q.prototype.loadMesh=function(E){for(var M=this,e=this.json,T=this.extensions,S=e.meshes[E],C=S.primitives,t=[],n=0,i=C.length;n<i;n++){var r=void 0===C[n].material?new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide}):this.getDependency("material",C[n].material);t.push(r)}return Promise.all(t).then(function(x){return M.loadGeometries(C).then(function(e){for(var t=1===e.length&&0<e[0].groups.length,n=[],i=0,r=e.length;i<r;i++){var o,a=e[i],s=C[i],c=t?x:x[i];if(s.mode===D||s.mode===I||s.mode===O||void 0===s.mode)!0===(o=!0===S.isSkinnedMesh?new THREE.SkinnedMesh(a,c):new THREE.Mesh(a,c)).isSkinnedMesh&&o.normalizeSkinWeights(),s.mode===I?o.drawMode=THREE.TriangleStripDrawMode:s.mode===O&&(o.drawMode=THREE.TriangleFanDrawMode);else if(s.mode===B)o=new THREE.LineSegments(a,c);else if(s.mode===P)o=new THREE.Line(a,c);else if(s.mode===R)o=new THREE.LineLoop(a,c);else{if(s.mode!==_)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+s.mode);o=new THREE.Points(a,c)}0<Object.keys(o.geometry.morphAttributes).length&&U(o,S),o.name=S.name||"mesh_"+E,1<e.length&&(o.name+="_"+i),z(o,S),n.push(o);for(var l=t?o.material:[o.material],u=void 0!==a.attributes.color,h=void 0===a.attributes.normal,d=!0===o.isSkinnedMesh,p=0<Object.keys(a.morphAttributes).length,f=p&&void 0!==a.morphAttributes.normal,m=0,v=l.length;m<v;m++){c=l[m];if(o.isPoints){var g="PointsMaterial:"+c.uuid,y=M.cache.get(g);y||(y=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(y,c),y.color.copy(c.color),y.map=c.map,y.lights=!1,M.cache.add(g,y)),c=y}else if(o.isLine){g="LineBasicMaterial:"+c.uuid;var A=M.cache.get(g);A||(A=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(A,c),A.color.copy(c.color),A.lights=!1,M.cache.add(g,A)),c=A}if(u||h||d||p){g="ClonedMaterial:"+c.uuid+":";c.isGLTFSpecularGlossinessMaterial&&(g+="specular-glossiness:"),d&&(g+="skinning:"),u&&(g+="vertex-colors:"),h&&(g+="flat-shading:"),p&&(g+="morph-targets:"),f&&(g+="morph-normals:");var b=M.cache.get(g);b||(b=c.isGLTFSpecularGlossinessMaterial?T[L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(c):c.clone(),d&&(b.skinning=!0),u&&(b.vertexColors=THREE.VertexColors),h&&(b.flatShading=!0),p&&(b.morphTargets=!0),f&&(b.morphNormals=!0),M.cache.add(g,b)),c=b}(l[m]=c).aoMap&&void 0===a.attributes.uv2&&void 0!==a.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),a.addAttribute("uv2",new THREE.BufferAttribute(a.attributes.uv.array,2))),c.isGLTFSpecularGlossinessMaterial&&(o.onBeforeRender=T[L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}o.material=t?l:l[0]}if(1===n.length)return n[0];var w=new THREE.Group;for(i=0,r=n.length;i<r;i++)w.add(n[i]);return w})})},q.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],i=n[n.type];if(i)return"perspective"===n.type?t=new THREE.PerspectiveCamera(THREE.Math.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(t=new THREE.OrthographicCamera(i.xmag/-2,i.xmag/2,i.ymag/2,i.ymag/-2,i.znear,i.zfar)),void 0!==n.name&&(t.name=n.name),z(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},q.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return n.inverseBindMatrices=e,n})},q.prototype.loadAnimation=function(x){for(var E=this.json.animations[x],e=[],t=[],n=[],i=[],r=[],o=0,a=E.channels.length;o<a;o++){var s=E.channels[o],c=E.samplers[s.sampler],l=s.target,u=void 0!==l.node?l.node:l.id,h=void 0!==E.parameters?E.parameters[c.input]:c.input,d=void 0!==E.parameters?E.parameters[c.output]:c.output;e.push(this.getDependency("node",u)),t.push(this.getDependency("accessor",h)),n.push(this.getDependency("accessor",d)),i.push(c),r.push(l)}return Promise.all([Promise.all(e),Promise.all(t),Promise.all(n),Promise.all(i),Promise.all(r)]).then(function(e){for(var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=[],s=0,c=t.length;s<c;s++){var l=t[s],u=n[s],h=i[s],d=r[s],p=o[s];if(void 0!==l){var f;switch(l.updateMatrix(),l.matrixAutoUpdate=!0,C[p.path]){case C.weights:f=THREE.NumberKeyframeTrack;break;case C.rotation:f=THREE.QuaternionKeyframeTrack;break;case C.position:case C.scale:default:f=THREE.VectorKeyframeTrack}var m=l.name?l.name:l.uuid,v=void 0!==d.interpolation?k[d.interpolation]:THREE.InterpolateLinear,g=[];C[p.path]===C.weights?l.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&g.push(e.name?e.name:e.uuid)}):g.push(m);for(var y=0,A=g.length;y<A;y++){var b=new f(g[y]+"."+C[p.path],THREE.AnimationUtils.arraySlice(u.array,0),THREE.AnimationUtils.arraySlice(h.array,0),v);"CUBICSPLINE"===d.interpolation&&(b.createInterpolant=function(e){return new M(this.times,this.values,this.getValueSize()/3,e)},b.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),a.push(b)}}}var w=void 0!==E.name?E.name:"animation_"+x;return new THREE.AnimationClip(w,void 0,a)})},q.prototype.loadNode=function(e){var t=this.json,n=this.extensions,o=t.meshReferences,a=t.meshUses,s=t.nodes[e];return(!0===s.isBone?Promise.resolve(new THREE.Bone):void 0!==s.mesh?this.getDependency("mesh",s.mesh).then(function(e){var t;if(1<o[s.mesh]){var n=a[s.mesh]++;(t=e.clone()).name+="_instance_"+n,t.onBeforeRender=e.onBeforeRender;for(var i=0,r=t.children.length;i<r;i++)t.children[i].name+="_instance_"+n,t.children[i].onBeforeRender=e.children[i].onBeforeRender}else t=e;return void 0!==s.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,n=s.weights.length;t<n;t++)e.morphTargetInfluences[t]=s.weights[t]}),t}):void 0!==s.camera?this.getDependency("camera",s.camera):s.extensions&&s.extensions[L.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[L.KHR_LIGHTS_PUNCTUAL].light?this.getDependency("light",s.extensions[L.KHR_LIGHTS_PUNCTUAL].light):Promise.resolve(new THREE.Object3D)).then(function(e){if(void 0!==s.name&&(e.name=THREE.PropertyBinding.sanitizeNodeName(s.name)),z(e,s),s.extensions&&N(n,e,s),void 0!==s.matrix){var t=new THREE.Matrix4;t.fromArray(s.matrix),e.applyMatrix(t)}else void 0!==s.translation&&e.position.fromArray(s.translation),void 0!==s.rotation&&e.quaternion.fromArray(s.rotation),void 0!==s.scale&&e.scale.fromArray(s.scale);return e})},q.prototype.loadScene=function(e){var t=this.json,n=this.extensions,i=this.json.scenes[e],r=new THREE.Scene;void 0!==i.name&&(r.name=i.name),z(r,i),i.extensions&&N(n,r,i);for(var o=i.nodes||[],a=[],s=0,c=o.length;s<c;s++)a.push(Q(o[s],r,t,this));return Promise.all(a).then(function(){return r})},e;function Q(e,a,s,c){var l=s.nodes[e];return c.getDependency("node",e).then(function(h){return void 0===l.skin?h:c.getDependency("skin",l.skin).then(function(e){for(var t=[],n=0,i=(d=e).joints.length;n<i;n++)t.push(c.getDependency("node",d.joints[n]));return Promise.all(t)}).then(function(e){for(var t=!0===h.isGroup?h.children:[h],n=0,i=t.length;n<i;n++){for(var r=t[n],o=[],a=[],s=0,c=e.length;s<c;s++){var l=e[s];if(l){o.push(l);var u=new THREE.Matrix4;void 0!==d.inverseBindMatrices&&u.fromArray(d.inverseBindMatrices.array,16*s),a.push(u)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',d.joints[s])}r.bind(new THREE.Skeleton(o,a),r.matrixWorld)}return h});var d}).then(function(e){a.add(e);var t=[];if(l.children)for(var n=l.children,i=0,r=n.length;i<r;i++){var o=n[i];t.push(Q(o,e,s,c))}return Promise.all(t)})}}()},{}],39:[function(e,t,n){THREE.MTLLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(e,t,n,i){var r=this,o=void 0===this.path?THREE.LoaderUtils.extractUrlBase(e):this.path,a=new THREE.FileLoader(this.manager);a.setPath(this.path),a.load(e,function(e){t(r.parse(e,o))},n,i)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setTexturePath:function(e){return console.warn("THREE.MTLLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setMaterialOptions:function(e){return this.materialOptions=e,this},parse:function(e,t){for(var n=e.split("\n"),i={},r=/\s+/,o={},a=0;a<n.length;a++){var s=n[a];if(0!==(s=s.trim()).length&&"#"!==s.charAt(0)){var c=s.indexOf(" "),l=0<=c?s.substring(0,c):s;l=l.toLowerCase();var u=0<=c?s.substring(c+1):"";if(u=u.trim(),"newmtl"===l)i={name:u},o[u]=i;else if("ka"===l||"kd"===l||"ks"===l||"ke"===l){var h=u.split(r,3);i[l]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else i[l]=u}}var d=new THREE.MTLLoader.MaterialCreator(this.resourcePath||t,this.materialOptions);return d.setCrossOrigin(this.crossOrigin),d.setManager(this.manager),d.setMaterials(o),d}},THREE.MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var n in e){var i=e[n],r={};for(var o in t[n]=r,i){var a=!0,s=i[o],c=o.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(a=!1)}a&&(r[c]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var a=this,t=this.materialsInfo[e],s={name:e,side:this.side};function n(e,t){if(!s[e]){var n,i,r=a.getTextureParams(t,s),o=a.loadTexture((n=a.baseUrl,"string"!=typeof(i=r.url)||""===i?"":/^https?:\/\//i.test(i)?i:n+i));o.repeat.copy(r.scale),o.offset.copy(r.offset),o.wrapS=a.wrap,o.wrapT=a.wrap,s[e]=o}}for(var i in t){var r,o=t[i];if(""!==o)switch(i.toLowerCase()){case"kd":s.color=(new THREE.Color).fromArray(o);break;case"ks":s.specular=(new THREE.Color).fromArray(o);break;case"ke":s.emissive=(new THREE.Color).fromArray(o);break;case"map_kd":n("map",o);break;case"map_ks":n("specularMap",o);break;case"map_ke":n("emissiveMap",o);break;case"norm":n("normalMap",o);break;case"map_bump":case"bump":n("bumpMap",o);break;case"map_d":n("alphaMap",o),s.transparent=!0;break;case"ns":s.shininess=parseFloat(o);break;case"d":(r=parseFloat(o))<1&&(s.opacity=r,s.transparent=!0);break;case"tr":r=parseFloat(o),this.options&&this.options.invertTrProperty&&(r=1-r),0<r&&(s.opacity=1-r,s.transparent=!0)}}return this.materials[e]=new THREE.MeshPhongMaterial(s),this.materials[e]},getTextureParams:function(e,t){var n,i={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},r=e.split(/\s+/);return 0<=(n=r.indexOf("-bm"))&&(t.bumpScale=parseFloat(r[n+1]),r.splice(n,2)),0<=(n=r.indexOf("-s"))&&(i.scale.set(parseFloat(r[n+1]),parseFloat(r[n+2])),r.splice(n,4)),0<=(n=r.indexOf("-o"))&&(i.offset.set(parseFloat(r[n+1]),parseFloat(r[n+2])),r.splice(n,4)),i.url=r.join(" ").trim(),i},loadTexture:function(e,t,n,i,r){var o,a=THREE.Loader.Handlers.get(e),s=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null===a&&(a=new THREE.TextureLoader(s)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin),o=a.load(e,n,i,r),void 0!==t&&(o.mapping=t),o}}},{}],40:[function(e,t,n){function V(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);var i={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&0<t.length?t[t.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(i),i},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&1<this.materials.length)for(var n=this.materials.length-1;0<=n;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},n&&n.name&&"function"==typeof n.clone){var i=n.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var n=parseInt(e,10);return 3*(0<=n?n-1:n+t/3)},parseNormalIndex:function(e,t){var n=parseInt(e,10);return 3*(0<=n?n-1:n+t/3)},parseUVIndex:function(e,t){var n=parseInt(e,10);return 2*(0<=n?n-1:n+t/2)},addVertex:function(e,t,n){var i=this.vertices,r=this.object.geometry.vertices;r.push(i[e+0],i[e+1],i[e+2]),r.push(i[t+0],i[t+1],i[t+2]),r.push(i[n+0],i[n+1],i[n+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){var i=this.normals,r=this.object.geometry.normals;r.push(i[e+0],i[e+1],i[e+2]),r.push(i[t+0],i[t+1],i[t+2]),r.push(i[n+0],i[n+1],i[n+2])},addColor:function(e,t,n){var i=this.colors,r=this.object.geometry.colors;r.push(i[e+0],i[e+1],i[e+2]),r.push(i[t+0],i[t+1],i[t+2]),r.push(i[n+0],i[n+1],i[n+2])},addUV:function(e,t,n){var i=this.uvs,r=this.object.geometry.uvs;r.push(i[e+0],i[e+1]),r.push(i[t+0],i[t+1]),r.push(i[n+0],i[n+1])},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,n,i,r,o,a,s,c){var l=this.vertices.length,u=this.parseVertexIndex(e,l),h=this.parseVertexIndex(t,l),d=this.parseVertexIndex(n,l);if(this.addVertex(u,h,d),void 0!==i&&""!==i){var p=this.uvs.length;u=this.parseUVIndex(i,p),h=this.parseUVIndex(r,p),d=this.parseUVIndex(o,p),this.addUV(u,h,d)}if(void 0!==a&&""!==a){var f=this.normals.length;u=this.parseNormalIndex(a,f),h=a===s?u:this.parseNormalIndex(s,f),d=a===c?u:this.parseNormalIndex(c,f),this.addNormal(u,h,d)}0<this.colors.length&&this.addColor(u,h,d)},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,n=0,i=e.length;n<i;n++)this.addVertexPoint(this.parseVertexIndex(e[n],t))},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var n=this.vertices.length,i=this.uvs.length,r=0,o=e.length;r<o;r++)this.addVertexLine(this.parseVertexIndex(e[r],n));var a=0;for(o=t.length;a<o;a++)this.addUVLine(this.parseUVIndex(t[a],i))}};return e.startObject("",!1),e}function i(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null}var W,q,X;THREE.OBJLoader=(W=/^[og]\s*(.+)?/,q=/^mtllib /,X=/^usemtl /,i.prototype={constructor:i,load:function(e,t,n,i){var r=this,o=new THREE.FileLoader(r.manager);o.setPath(this.path),o.load(e,function(e){t(r.parse(e))},n,i)},setPath:function(e){return this.path=e,this},setMaterials:function(e){return this.materials=e,this},parse:function(e){console.time("OBJLoader");var t=new V;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));for(var n=e.split("\n"),i="",r="",o=[],a="function"==typeof"".trimLeft,s=0,c=n.length;s<c;s++)if(i=n[s],0!==(i=a?i.trimLeft():i.trim()).length&&"#"!==(r=i.charAt(0)))if("v"===r){var l=i.split(/\s+/);switch(l[0]){case"v":t.vertices.push(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3])),8===l.length&&t.colors.push(parseFloat(l[4]),parseFloat(l[5]),parseFloat(l[6]));break;case"vn":t.normals.push(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]));break;case"vt":t.uvs.push(parseFloat(l[1]),parseFloat(l[2]))}}else if("f"===r){for(var u=i.substr(1).trim().split(/\s+/),h=[],d=0,p=u.length;d<p;d++){var f=u[d];if(0<f.length){var m=f.split("/");h.push(m)}}var v=h[0];for(d=1,p=h.length-1;d<p;d++){var g=h[d],y=h[d+1];t.addFace(v[0],g[0],y[0],v[1],g[1],y[1],v[2],g[2],y[2])}}else if("l"===r){var A=i.substring(1).trim().split(" "),b=[],w=[];if(-1===i.indexOf("/"))b=A;else for(var x=0,E=A.length;x<E;x++){var M=A[x].split("/");""!==M[0]&&b.push(M[0]),""!==M[1]&&w.push(M[1])}t.addLineGeometry(b,w)}else if("p"===r){var T=i.substr(1).trim().split(" ");t.addPointGeometry(T)}else if(null!==(o=W.exec(i))){var S=(" "+o[0].substr(1).trim()).substr(1);t.startObject(S)}else if(X.test(i))t.object.startMaterial(i.substring(7).trim(),t.materialLibraries);else if(q.test(i))t.materialLibraries.push(i.substring(7).trim());else{if("s"!==r){if("\0"===i)continue;throw new Error('THREE.OBJLoader: Unexpected line: "'+i+'"')}if(1<(o=i.split(" ")).length){var C=o[1].trim().toLowerCase();t.object.smooth="0"!==C&&"off"!==C}else t.object.smooth=!0;(z=t.object.currentMaterial())&&(z.smooth=t.object.smooth)}t.finalize();var L=new THREE.Group;for(L.materialLibraries=[].concat(t.materialLibraries),s=0,c=t.objects.length;s<c;s++){var _=t.objects[s],B=_.geometry,R=_.materials,P="Line"===B.type,D="Points"===B.type,I=!1;if(0!==B.vertices.length){var O=new THREE.BufferGeometry;O.addAttribute("position",new THREE.Float32BufferAttribute(B.vertices,3)),0<B.normals.length?O.addAttribute("normal",new THREE.Float32BufferAttribute(B.normals,3)):O.computeVertexNormals(),0<B.colors.length&&(I=!0,O.addAttribute("color",new THREE.Float32BufferAttribute(B.colors,3))),0<B.uvs.length&&O.addAttribute("uv",new THREE.Float32BufferAttribute(B.uvs,2));for(var k,j=[],H=0,F=R.length;H<F;H++){var N=R[H],z=void 0;if(null!==this.materials)if(z=this.materials.create(N.name),!P||!z||z instanceof THREE.LineBasicMaterial){if(D&&z&&!(z instanceof THREE.PointsMaterial)){var U=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(U,z),U.color.copy(z.color),U.map=z.map,U.lights=!1,z=U}}else{var G=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(G,z),G.color.copy(z.color),G.lights=!1,z=G}z||((z=P?new THREE.LineBasicMaterial:D?new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):new THREE.MeshPhongMaterial).name=N.name),z.flatShading=!N.smooth,z.vertexColors=I?THREE.VertexColors:THREE.NoColors,j.push(z)}if(1<j.length){for(H=0,F=R.length;H<F;H++)N=R[H],O.addGroup(N.groupStart,N.groupCount,H);k=P?new THREE.LineSegments(O,j):D?new THREE.Points(O,j):new THREE.Mesh(O,j)}else k=P?new THREE.LineSegments(O,j[0]):D?new THREE.Points(O,j[0]):new THREE.Mesh(O,j[0]);k.name=_.name,L.add(k)}}return console.timeEnd("OBJLoader"),L}},i)},{}],41:[function(e,t,n){var u=e("layout-bmfont-text"),i=e("inherits"),h=e("quad-indices"),d=e("three-buffer-vertex-data"),p=e("object-assign"),f=e("./lib/vertices"),r=e("./lib/utils"),o=THREE.BufferGeometry;function a(e){o.call(this),"string"==typeof e&&(e={text:e}),this._opt=p({},e),e&&this.update(e)}t.exports=function(e){return new a(e)},i(a,o),a.prototype.update=function(e){if("string"==typeof e&&(e={text:e}),!(e=p({},this._opt,e)).font)throw new TypeError("must specify a { font } in options");this.layout=u(e);var t=!1!==e.flipY,n=e.font,i=n.common.scaleW,r=n.common.scaleH,o=this.layout.glyphs.filter(function(e){var t=e.data;return 0<t.width*t.height});this.visibleGlyphs=o;var a=f.positions(o),s=f.uvs(o,i,r,t),c=h({clockwise:!0,type:"uint16",count:o.length});if(d.index(this,c,1,"uint16"),d.attr(this,"position",a,2),d.attr(this,"uv",s,2),!e.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(e.multipage){var l=f.pages(o);d.attr(this,"page",l,1)}},a.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var e=this.attributes.position.array,t=this.attributes.position.itemSize;if(!e||!t||e.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);r.computeSphere(e,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},a.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var e=this.boundingBox,t=this.attributes.position.array,n=this.attributes.position.itemSize;!t||!n||t.length<2?e.makeEmpty():r.computeBox(t,e)}},{"./lib/utils":42,"./lib/vertices":43,inherits:18,"layout-bmfont-text":23,"object-assign":26,"quad-indices":35,"three-buffer-vertex-data":44}],42:[function(e,t,n){var s={min:[0,0],max:[0,0]};function c(e){var t=e.length/2;s.min[0]=e[0],s.min[1]=e[1],s.max[0]=e[0],s.max[1]=e[1];for(var n=0;n<t;n++){var i=e[2*n+0],r=e[2*n+1];s.min[0]=Math.min(i,s.min[0]),s.min[1]=Math.min(r,s.min[1]),s.max[0]=Math.max(i,s.max[0]),s.max[1]=Math.max(r,s.max[1])}}t.exports.computeBox=function(e,t){c(e),t.min.set(s.min[0],s.min[1],0),t.max.set(s.max[0],s.max[1],0)},t.exports.computeSphere=function(e,t){c(e);var n=s.min[0],i=s.min[1],r=s.max[0]-n,o=s.max[1]-i,a=Math.sqrt(r*r+o*o);t.center.set(n+r/2,i+o/2,0),t.radius=a/2}},{}],43:[function(e,t,n){t.exports.pages=function(e){var n=new Float32Array(4*e.length*1),i=0;return e.forEach(function(e){var t=e.data.page||0;n[i++]=t,n[i++]=t,n[i++]=t,n[i++]=t}),n},t.exports.uvs=function(e,c,l,u){var h=new Float32Array(4*e.length*2),d=0;return e.forEach(function(e){var t=e.data,n=t.x+t.width,i=t.y+t.height,r=t.x/c,o=t.y/l,a=n/c,s=i/l;u&&(o=(l-t.y)/l,s=(l-i)/l),h[d++]=r,h[d++]=o,h[d++]=r,h[d++]=s,h[d++]=a,h[d++]=s,h[d++]=a,h[d++]=o}),h},t.exports.positions=function(e){var a=new Float32Array(4*e.length*2),s=0;return e.forEach(function(e){var t=e.data,n=e.position[0]+t.xoffset,i=e.position[1]+t.yoffset,r=t.width,o=t.height;a[s++]=n,a[s++]=i,a[s++]=n,a[s++]=i+o,a[s++]=n+r,a[s++]=i+o,a[s++]=n+r,a[s++]=i}),a}},{}],44:[function(e,t,n){var o=e("flatten-vertex-data"),a=!1;function s(i,e,t,n){if(e=e||[],i&&!function(e,t){if(i.itemSize!==t)return 1;if(!i.array)return 1;var n=i.array.length;return Array.isArray(e)&&Array.isArray(e[0])?n!==e.length*t:n!==e.length}(e,t))return o(e,i.array),i.needsUpdate=!0,null;e=o(e,n);var r=i&&"function"!=typeof i.setArray;return i&&!r||(r&&!a&&(a=!0,console.warn(["A WebGL buffer is being updated with a new size or itemSize, ","however this version of ThreeJS only supports fixed-size buffers.","\nThe old buffer may still be kept in memory.\n","To avoid memory leaks, it is recommended that you dispose ","your geometries and create new ones, or update to ThreeJS r82 or newer.\n","See here for discussion:\n","https://github.com/mrdoob/three.js/pull/9631"].join(""))),i=new THREE.BufferAttribute(e,t)),i.itemSize=t,i.needsUpdate=!0,"function"==typeof i.setArray&&i.setArray(e),i}t.exports.attr=function(e,t,n,i,r){if("number"!=typeof i&&(i=3),"string"!=typeof r&&(r="float32"),Array.isArray(n)&&Array.isArray(n[0])&&n[0].length!==i)throw new Error("Nested vertex array has unexpected size; expected "+i+" but found "+n[0].length);var o=s(e.getAttribute(t),n,i,r);o&&e.addAttribute(t,o)},t.exports.index=function(e,t,n,i){"number"!=typeof n&&(n=1),"string"!=typeof i&&(i="uint16");var r=!e.index&&"function"!=typeof e.setIndex,o=s(r?e.getAttribute("index"):e.index,t,n,i);o&&(r?e.addAttribute("index",o):e.index=o)}},{"flatten-vertex-data":14}],45:[function(e,t,n){(n=t.exports=function(e){return e.replace(/^\s*|\s*$/g,"")}).left=function(e){return e.replace(/^\s*/,"")},n.right=function(e){return e.replace(/\s*$/,"")}},{}],46:[function(e,n,i){(function(h){var e,t;e=this,t=function(){"use strict";function t(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)}function r(e,t){for(var n=0,i=e.length;n<i;n++)t[n]=e[n]}function n(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var e,i,o="undefined"!=typeof window?window:void 0!==h?h:"undefined"!=typeof self?self:{},a=(i=((e={exports:{}}).exports=function(){function w(e,t,n){return e+(t-e)*n}function o(){var e=90==window.orientation||-90==window.orientation;return M()?!e:e}function l(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio}function u(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio}function h(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0}function r(e,t,n,i){var r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,t),e.compileShader(r);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,n),e.compileShader(o);var a=e.createProgram();for(var s in e.attachShader(a,r),e.attachShader(a,o),i)e.bindAttribLocation(a,i[s],s);return e.linkProgram(a),e.deleteShader(r),e.deleteShader(o),a}function a(e,t){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r="",o=0;o<i;o++){n[r=e.getActiveUniform(t,o).name.replace("[0]","")]=e.getUniformLocation(t,r)}return n}function n(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function i(e){if(y()){var t=e.style.width,n=e.style.height;e.style.width=parseInt(t)+1+"px",e.style.height=parseInt(n)+"px",setTimeout(function(){e.style.width=t,e.style.height=n},100)}window.canvas=e}function s(e){var t,n=e.indexOf("://");t=-1!==n?n+3:0;var i=e.indexOf("/",t);return-1===i&&(i=e.length),e.substring(0,i)}function c(e,t,n){if(t){for(var i=[],r=null,o=0;o<t.length;++o){switch(a=t[o]){case e.TEXTURE_BINDING_2D:case e.TEXTURE_BINDING_CUBE_MAP:if((c=t[++o])<e.TEXTURE0||c>e.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),i.push(null,null);break}r=r||e.getParameter(e.ACTIVE_TEXTURE),e.activeTexture(c),i.push(e.getParameter(a),null);break;case e.ACTIVE_TEXTURE:r=e.getParameter(e.ACTIVE_TEXTURE),i.push(null);break;default:i.push(e.getParameter(a))}}n(e);for(o=0;o<t.length;++o){var a=t[o],s=i[o];switch(a){case e.ACTIVE_TEXTURE:break;case e.ARRAY_BUFFER_BINDING:e.bindBuffer(e.ARRAY_BUFFER,s);break;case e.COLOR_CLEAR_VALUE:e.clearColor(s[0],s[1],s[2],s[3]);break;case e.COLOR_WRITEMASK:e.colorMask(s[0],s[1],s[2],s[3]);break;case e.CURRENT_PROGRAM:e.useProgram(s);break;case e.ELEMENT_ARRAY_BUFFER_BINDING:e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s);break;case e.FRAMEBUFFER_BINDING:e.bindFramebuffer(e.FRAMEBUFFER,s);break;case e.RENDERBUFFER_BINDING:e.bindRenderbuffer(e.RENDERBUFFER,s);break;case e.TEXTURE_BINDING_2D:if((c=t[++o])<e.TEXTURE0||c>e.TEXTURE31)break;e.activeTexture(c),e.bindTexture(e.TEXTURE_2D,s);break;case e.TEXTURE_BINDING_CUBE_MAP:var c;if((c=t[++o])<e.TEXTURE0||c>e.TEXTURE31)break;e.activeTexture(c),e.bindTexture(e.TEXTURE_CUBE_MAP,s);break;case e.VIEWPORT:e.viewport(s[0],s[1],s[2],s[3]);break;case e.BLEND:case e.CULL_FACE:case e.DEPTH_TEST:case e.SCISSOR_TEST:case e.STENCIL_TEST:s?e.enable(a):e.disable(a);break;default:console.log("No GL restore behavior for 0x"+a.toString(16))}r&&e.activeTexture(r)}}else n(e)}var d,e,t,J,$,ee,te,p,f,m,v,g=function(e,t,n){return t&&P(e.prototype,t),n&&P(e,n),e},y=(v=/iPad|iPhone|iPod/.test(navigator.platform),function(){return v}),A=(m=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome"),function(){return m}),b=(/^((?!chrome|android).)*safari/i.test(navigator.userAgent),f=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android"),function(){return f}),x=(e=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),t=e?parseInt(e[1],10):null,function(){return t}),E=function(){var e=!1;if(65===x()){var t=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(t){var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(t[1].split("."),4),i=(n[0],n[1],n[2]),r=n[3];e=3325===parseInt(i,10)&&parseInt(r,10)<148}}return function(){return e}}(),M=(p=-1!==navigator.userAgent.indexOf("R7 Build"),function(){return p}),T=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},S=(J=Math.PI/180,$=.25*Math.PI,ee=new Float32Array([0,0,0,1]),te=new Float32Array([0,0,0]),function(e,t,n){return!(!e||!t||(e.pose=t,e.timestamp=t.timestamp,R(e.leftProjectionMatrix,e.leftViewMatrix,t,n._getFieldOfView("left"),n._getEyeOffset("left"),n),R(e.rightProjectionMatrix,e.rightViewMatrix,t,n._getFieldOfView("right"),n._getEyeOffset("right"),n),0))}),C=(d={},function(e,t){void 0===d[e]&&(console.warn("webvr-polyfill: "+t),d[e]=!0)}),L=function(e,t){C(e,e+" has been deprecated. This may not work on native WebVR displays. "+(t?"Please use "+t+" instead.":""))},_=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join("\n"),B=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join("\n");function R(e,B,t,n,i,r){var o,a,s,c,l,u,h,d,p,f;o=e,a=n||null,s=r.depthNear,c=r.depthFar,l=Math.tan(a?a.upDegrees*J:$),u=Math.tan(a?a.downDegrees*J:$),h=Math.tan(a?a.leftDegrees*J:$),d=Math.tan(a?a.rightDegrees*J:$),p=2/(h+d),f=2/(l+u),o[0]=p,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=f,o[6]=0,o[7]=0,o[8]=-(h-d)*p*.5,o[9]=(l-u)*f*.5,o[10]=c/(s-c),o[11]=-1,o[12]=0,o[13]=0,o[14]=c*s/(s-c),o[15]=0;var m,v,g,y,A,b,w,x,E,M,T,S,C,L,_,R,P,D,I,O,k,j,H,F,N,z,U,G,V,W,q,X,Q,Y,Z,K=t.orientation||ee;m=B,v=t.position||te,M=(g=K[0])*(w=g+g),T=g*(x=(y=K[1])+y),S=g*(E=(A=K[2])+A),C=y*x,L=y*E,_=A*E,R=(b=K[3])*w,P=b*x,D=b*E,m[0]=1-(C+_),m[1]=T+D,m[2]=S-P,m[3]=0,m[4]=T-D,m[5]=1-(M+_),m[6]=L+R,m[7]=0,m[8]=S+P,m[9]=L-R,m[10]=1-(M+C),m[11]=0,m[12]=v[0],m[13]=v[1],m[14]=v[2],m[15]=1,i&&(O=I=B,Q=i[0],Y=i[1],Z=i[2],O===I?(I[12]=O[0]*Q+O[4]*Y+O[8]*Z+O[12],I[13]=O[1]*Q+O[5]*Y+O[9]*Z+O[13],I[14]=O[2]*Q+O[6]*Y+O[10]*Z+O[14],I[15]=O[3]*Q+O[7]*Y+O[11]*Z+O[15]):(k=O[0],j=O[1],H=O[2],F=O[3],N=O[4],z=O[5],U=O[6],G=O[7],V=O[8],W=O[9],q=O[10],X=O[11],I[0]=k,I[1]=j,I[2]=H,I[3]=F,I[4]=N,I[5]=z,I[6]=U,I[7]=G,I[8]=V,I[9]=W,I[10]=q,I[11]=X,I[12]=k*Q+N*Y+V*Z+O[12],I[13]=j*Q+z*Y+W*Z+O[13],I[14]=H*Q+U*Y+q*Z+O[14],I[15]=F*Q+G*Y+X*Z+O[15])),function(e){var t=B[0],n=B[1],i=B[2],r=B[3],o=B[4],a=B[5],s=B[6],c=B[7],l=B[8],u=B[9],h=B[10],d=B[11],p=B[12],f=B[13],m=B[14],v=B[15],g=t*a-n*o,y=t*s-i*o,A=t*c-r*o,b=n*s-i*a,w=n*c-r*a,x=i*c-r*s,E=l*f-u*p,M=l*m-h*p,T=l*v-d*p,S=u*m-h*f,C=u*v-d*f,L=h*v-d*m,_=g*L-y*C+A*S+b*T-w*M+x*E;if(!_)return;_=1/_,e[0]=(a*L-s*C+c*S)*_,e[1]=(i*C-n*L-r*S)*_,e[2]=(f*x-m*w+v*b)*_,e[3]=(h*w-u*x-d*b)*_,e[4]=(s*T-o*L-c*M)*_,e[5]=(t*L-i*T+r*M)*_,e[6]=(m*A-p*x-v*y)*_,e[7]=(l*x-h*A+d*y)*_,e[8]=(o*C-a*T+c*E)*_,e[9]=(n*T-t*C-r*E)*_,e[10]=(p*w-f*A+v*g)*_,e[11]=(u*A-l*w-d*g)*_,e[12]=(a*M-o*S-s*E)*_,e[13]=(t*S-n*M+i*E)*_,e[14]=(f*y-p*b-m*g)*_,e[15]=(l*b-u*y+h*g)*_}(B)}function P(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function D(e,t,n,i){this.gl=e,this.cardboardUI=t,this.bufferScale=n,this.dirtySubmitFrameBindings=i,this.ctxAttribs=e.getContextAttributes(),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=e.drawingBufferWidth,this.bufferHeight=e.drawingBufferHeight,this.realBindFramebuffer=e.bindFramebuffer,this.realEnable=e.enable,this.realDisable=e.disable,this.realColorMask=e.colorMask,this.realClearColor=e.clearColor,this.realViewport=e.viewport,y()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=r(e,_,B,this.attribs),this.uniforms=a(e,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.indexCount=0,this.renderTarget=e.createTexture(),this.framebuffer=e.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=e.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=e.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=e.createRenderbuffer()),this.patch(),this.onResize()}D.prototype.destroy=function(){var e=this.gl;this.unpatch(),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteTexture(this.renderTarget),e.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&e.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&e.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&e.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},D.prototype.onResize=function(){var e=this.gl,t=this,n=[e.RENDERBUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0];c(e,n,function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.framebuffer),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.texImage2D(e.TEXTURE_2D,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,t.bufferWidth,t.bufferHeight,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.renderTarget,0),t.ctxAttribs.depth&&t.ctxAttribs.stencil?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthStencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t.depthStencilBuffer)):t.ctxAttribs.depth?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t.depthBuffer)):t.ctxAttribs.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,t.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.STENCIL_INDEX8,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,t.stencilBuffer)),!e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),t.realClearColor.apply(e,t.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},D.prototype.patch=function(){if(!this.isPatched){var r=this,t=this.gl.canvas,o=this.gl;y()||(t.width=l()*this.bufferScale,t.height=u()*this.bufferScale,Object.defineProperty(t,"width",{configurable:!0,enumerable:!0,get:function(){return r.bufferWidth},set:function(e){r.bufferWidth=e,r.realCanvasWidth.set.call(t,e),r.onResize()}}),Object.defineProperty(t,"height",{configurable:!0,enumerable:!0,get:function(){return r.bufferHeight},set:function(e){r.bufferHeight=e,r.realCanvasHeight.set.call(t,e),r.onResize()}})),this.lastBoundFramebuffer=o.getParameter(o.FRAMEBUFFER_BINDING),null==this.lastBoundFramebuffer&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(o.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(e,t){r.lastBoundFramebuffer=t||r.framebuffer,r.realBindFramebuffer.call(o,e,r.lastBoundFramebuffer)},this.cullFace=o.getParameter(o.CULL_FACE),this.depthTest=o.getParameter(o.DEPTH_TEST),this.blend=o.getParameter(o.BLEND),this.scissorTest=o.getParameter(o.SCISSOR_TEST),this.stencilTest=o.getParameter(o.STENCIL_TEST),o.enable=function(e){switch(e){case o.CULL_FACE:r.cullFace=!0;break;case o.DEPTH_TEST:r.depthTest=!0;break;case o.BLEND:r.blend=!0;break;case o.SCISSOR_TEST:r.scissorTest=!0;break;case o.STENCIL_TEST:r.stencilTest=!0}r.realEnable.call(o,e)},o.disable=function(e){switch(e){case o.CULL_FACE:r.cullFace=!1;break;case o.DEPTH_TEST:r.depthTest=!1;break;case o.BLEND:r.blend=!1;break;case o.SCISSOR_TEST:r.scissorTest=!1;break;case o.STENCIL_TEST:r.stencilTest=!1}r.realDisable.call(o,e)},this.colorMask=o.getParameter(o.COLOR_WRITEMASK),o.colorMask=function(e,t,n,i){r.colorMask[0]=e,r.colorMask[1]=t,r.colorMask[2]=n,r.colorMask[3]=i,r.realColorMask.call(o,e,t,n,i)},this.clearColor=o.getParameter(o.COLOR_CLEAR_VALUE),o.clearColor=function(e,t,n,i){r.clearColor[0]=e,r.clearColor[1]=t,r.clearColor[2]=n,r.clearColor[3]=i,r.realClearColor.call(o,e,t,n,i)},this.viewport=o.getParameter(o.VIEWPORT),o.viewport=function(e,t,n,i){r.viewport[0]=e,r.viewport[1]=t,r.viewport[2]=n,r.viewport[3]=i,r.realViewport.call(o,e,t,n,i)},this.isPatched=!0,i(t)}},D.prototype.unpatch=function(){if(this.isPatched){var e=this.gl,t=this.gl.canvas;y()||(Object.defineProperty(t,"width",this.realCanvasWidth),Object.defineProperty(t,"height",this.realCanvasHeight)),t.width=this.bufferWidth,t.height=this.bufferHeight,e.bindFramebuffer=this.realBindFramebuffer,e.enable=this.realEnable,e.disable=this.realDisable,e.colorMask=this.realColorMask,e.clearColor=this.realClearColor,e.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&e.bindFramebuffer(e.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){i(t)},1)}},D.prototype.setTextureBounds=function(e,t){e=e||[0,0,.5,1],t=t||[.5,0,.5,1],this.viewportOffsetScale[0]=e[0],this.viewportOffsetScale[1]=e[1],this.viewportOffsetScale[2]=e[2],this.viewportOffsetScale[3]=e[3],this.viewportOffsetScale[4]=t[0],this.viewportOffsetScale[5]=t[1],this.viewportOffsetScale[6]=t[2],this.viewportOffsetScale[7]=t[3]},D.prototype.submitFrame=function(){var e=this.gl,t=this,n=[];if(this.dirtySubmitFrameBindings||n.push(e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING,e.ELEMENT_ARRAY_BUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0),c(e,n,function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),t.cullFace&&t.realDisable.call(e,e.CULL_FACE),t.depthTest&&t.realDisable.call(e,e.DEPTH_TEST),t.blend&&t.realDisable.call(e,e.BLEND),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realDisable.call(e,e.STENCIL_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),(t.ctxAttribs.alpha||y())&&(t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)),e.useProgram(t.program),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indexBuffer),e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.enableVertexAttribArray(t.attribs.position),e.enableVertexAttribArray(t.attribs.texCoord),e.vertexAttribPointer(t.attribs.position,2,e.FLOAT,!1,20,0),e.vertexAttribPointer(t.attribs.texCoord,3,e.FLOAT,!1,20,8),e.activeTexture(e.TEXTURE0),e.uniform1i(t.uniforms.diffuse,0),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.uniform4fv(t.uniforms.viewportOffsetScale,t.viewportOffsetScale),e.drawElements(e.TRIANGLES,t.indexCount,e.UNSIGNED_SHORT,0),t.cardboardUI&&t.cardboardUI.renderNoState(),t.realBindFramebuffer.call(t.gl,e.FRAMEBUFFER,t.framebuffer),t.ctxAttribs.preserveDrawingBuffer||(t.realClearColor.call(e,0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)),t.dirtySubmitFrameBindings||t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.cullFace&&t.realEnable.call(e,e.CULL_FACE),t.depthTest&&t.realEnable.call(e,e.DEPTH_TEST),t.blend&&t.realEnable.call(e,e.BLEND),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realEnable.call(e,e.STENCIL_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),!t.ctxAttribs.alpha&&t.ctxAttribs.preserveDrawingBuffer||t.realClearColor.apply(e,t.clearColor)}),y()){var i=e.canvas;i.width==t.bufferWidth&&i.height==t.bufferHeight||(t.bufferWidth=i.width,t.bufferHeight=i.height,t.onResize())}},D.prototype.updateDeviceInfo=function(i){var e=this.gl,r=this,t=[e.ARRAY_BUFFER_BINDING,e.ELEMENT_ARRAY_BUFFER_BINDING];c(e,t,function(e){var t=r.computeMeshVertices_(r.meshWidth,r.meshHeight,i);if(e.bindBuffer(e.ARRAY_BUFFER,r.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),!r.indexCount){var n=r.computeMeshIndices_(r.meshWidth,r.meshHeight);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW),r.indexCount=n.length}})},D.prototype.computeMeshVertices_=function(e,t,n){for(var i=new Float32Array(2*e*t*5),r=n.getLeftEyeVisibleTanAngles(),o=n.getLeftEyeNoLensTanAngles(),a=n.getLeftEyeVisibleScreenRect(o),s=0,c=0;c<2;c++){for(var l=0;l<t;l++)for(var u=0;u<e;u++,s++){var h=u/(e-1),d=l/(t-1),p=h,f=d,m=w(r[0],r[2],h),v=w(r[3],r[1],d),g=Math.sqrt(m*m+v*v),y=n.distortion.distortInverse(g),A=v*y/g;h=(m*y/g-o[0])/(o[2]-o[0]),d=(A-o[3])/(o[1]-o[3]),h=2*(a.x+h*a.width-.5),d=2*(a.y+d*a.height-.5),i[5*s+0]=h,i[5*s+1]=d,i[5*s+2]=p,i[5*s+3]=f,i[5*s+4]=c}var b=r[2]-r[0];r[0]=-(b+r[0]),r[2]=b-r[2],b=o[2]-o[0],o[0]=-(b+o[0]),o[2]=b-o[2],a.x=1-(a.x+a.width)}return i},D.prototype.computeMeshIndices_=function(e,t){for(var n=new Uint16Array(2*(e-1)*(t-1)*6),i=e/2,r=t/2,o=0,a=0,s=0;s<2;s++)for(var c=0;c<t;c++)for(var l=0;l<e;l++,o++)0!=l&&0!=c&&(l<=i==c<=r?(n[a++]=o,n[a++]=o-e-1,n[a++]=o-e,n[a++]=o-e-1,n[a++]=o,n[a++]=o-1):(n[a++]=o-1,n[a++]=o-e,n[a++]=o,n[a++]=o-e,n[a++]=o-1,n[a++]=o-e-1));return n},D.prototype.getOwnPropertyDescriptor_=function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return void 0!==n.get&&void 0!==n.set||(n.configurable=!0,n.enumerable=!0,n.get=function(){return this.getAttribute(t)},n.set=function(e){this.setAttribute(t,e)}),n};var I=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join("\n"),O=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join("\n"),k=Math.PI/180;function j(e){this.gl=e,this.attribs={position:0},this.program=r(e,I,O,this.attribs),this.uniforms=a(e,this.program),this.vertexBuffer=e.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}function H(e){this.coefficients=e}j.prototype.destroy=function(){var e=this.gl;this.listener&&e.canvas.removeEventListener("click",this.listener,!1),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer)},j.prototype.listen=function(n,i){var r=this.gl.canvas;this.listener=function(e){var t=r.clientWidth/2;e.clientX>t-42&&e.clientX<42+t&&e.clientY>r.clientHeight-42?n(e):e.clientX<42&&e.clientY<42&&i(e)},r.addEventListener("click",this.listener,!1)},j.prototype.onResize=function(){var e=this.gl,f=this,t=[e.ARRAY_BUFFER_BINDING];c(e,t,function(n){var o=[],a=n.drawingBufferWidth/2,e=Math.max(screen.width,screen.height)*window.devicePixelRatio,t=n.drawingBufferWidth/e*window.devicePixelRatio,i=4*t/2,r=42*t,s=28*t/2,c=14*t;function l(e,t){var n=(90-e)*k,i=Math.cos(n),r=Math.sin(n);o.push(.3125*i*s+a,.3125*r*s+s),o.push(t*i*s+a,t*r*s+s)}o.push(a-i,r),o.push(a-i,n.drawingBufferHeight),o.push(a+i,r),o.push(a+i,n.drawingBufferHeight),f.gearOffset=o.length/2;for(var u=0;u<=6;u++){var h=60*u;l(h,1),l(12+h,1),l(20+h,.75),l(40+h,.75),l(48+h,1)}function d(e,t){o.push(c+e,n.drawingBufferHeight-c-t)}f.gearVertexCount=o.length/2-f.gearOffset,f.arrowOffset=o.length/2;var p=i/Math.sin(45*k);d(0,s),d(s,0),d(s+p,p),d(p,s+p),d(p,s-p),d(0,s),d(s,2*s),d(s+p,2*s-p),d(p,s-p),d(0,s),d(p,s-i),d(28*t,s-i),d(p,s+i),d(28*t,s+i),f.arrowVertexCount=o.length/2-f.arrowOffset,n.bindBuffer(n.ARRAY_BUFFER,f.vertexBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(o),n.STATIC_DRAW)})},j.prototype.render=function(){var e=this.gl,t=this,n=[e.CULL_FACE,e.DEPTH_TEST,e.BLEND,e.SCISSOR_TEST,e.STENCIL_TEST,e.COLOR_WRITEMASK,e.VIEWPORT,e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING];c(e,n,function(e){e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.BLEND),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.colorMask(!0,!0,!0,!0),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.renderNoState()})},j.prototype.renderNoState=function(){var e,t,n,i,r,o,a=this.gl;a.useProgram(this.program),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.enableVertexAttribArray(this.attribs.position),a.vertexAttribPointer(this.attribs.position,2,a.FLOAT,!1,8,0),a.uniform4f(this.uniforms.color,1,1,1,1),e=this.projMat,i=1/(0-(t=a.drawingBufferWidth)),r=1/(0-(n=a.drawingBufferHeight)),o=1/(.1-1024),e[0]=-2*i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*o,e[11]=0,e[12]=(0+t)*i,e[13]=(n+0)*r,e[14]=1024.1*o,e[15]=1,a.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),a.drawArrays(a.TRIANGLE_STRIP,0,4),a.drawArrays(a.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),a.drawArrays(a.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)},H.prototype.distortInverse=function(e){for(var t=0,n=1,i=e-this.distort(t);1e-4<Math.abs(n-t);){var r=e-this.distort(n),o=n-(n-t)/(r-i)*r;t=n,n=o,i=r}return n},H.prototype.distort=function(e){for(var t=e*e,n=0,i=0;i<this.coefficients.length;i++)n=t*(n+this.coefficients[i]);return(n+1)*e};var F=Math.PI/180,N=180/Math.PI,z=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0};z.prototype={constructor:z,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=this.length();if(0!==e){var t=1/e;this.multiplyScalar(t)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(e){this.x*=e,this.y*=e,this.z*=e},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,a=e.z,s=e.w,c=s*t+o*i-a*n,l=s*n+a*t-r*i,u=s*i+r*n-o*t,h=-r*t-o*n-a*i;return this.x=c*s+h*-r+l*-a-u*-o,this.y=l*s+h*-o+u*-r-c*-a,this.z=u*s+h*-a+c*-o-l*-r,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},crossVectors:function(e,t){var n=e.x,i=e.y,r=e.z,o=t.x,a=t.y,s=t.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this}};var U,G,V=function(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==i?i:1};function W(e){this.width=e.width||l(),this.height=e.height||u(),this.widthMeters=e.widthMeters,this.heightMeters=e.heightMeters,this.bevelMeters=e.bevelMeters}V.prototype={constructor:V,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEulerXYZ:function(e,t,n){var i=Math.cos(e/2),r=Math.cos(t/2),o=Math.cos(n/2),a=Math.sin(e/2),s=Math.sin(t/2),c=Math.sin(n/2);return this.x=a*r*o+i*s*c,this.y=i*s*o-a*r*c,this.z=i*r*c+a*s*o,this.w=i*r*o-a*s*c,this},setFromEulerYXZ:function(e,t,n){var i=Math.cos(e/2),r=Math.cos(t/2),o=Math.cos(n/2),a=Math.sin(e/2),s=Math.sin(t/2),c=Math.sin(n/2);return this.x=a*r*o+i*s*c,this.y=i*s*o-a*r*c,this.z=i*r*c-a*s*o,this.w=i*r*o+a*s*c,this},setFromAxisAngle:function(e,t){var n=t/2,i=Math.sin(n);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(n),this},multiply:function(e){return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var n=e.x,i=e.y,r=e.z,o=e.w,a=t.x,s=t.y,c=t.z,l=t.w;return this.x=n*l+o*a+i*c-r*s,this.y=i*l+o*s+r*a-n*c,this.z=r*l+o*c+n*s-i*a,this.w=o*l-n*a-i*s-r*c,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this.x,i=this.y,r=this.z,o=this.w,a=o*e.w+n*e.x+i*e.y+r*e.z;if(a<0?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,a=-a):this.copy(e),1<=a)return this.w=o,this.x=n,this.y=i,this.z=r,this;var s=Math.acos(a),c=Math.sqrt(1-a*a);if(Math.abs(c)<.001)return this.w=.5*(o+this.w),this.x=.5*(n+this.x),this.y=.5*(i+this.y),this.z=.5*(r+this.z),this;var l=Math.sin((1-t)*s)/c,u=Math.sin(t*s)/c;return this.w=o*l+this.w*u,this.x=n*l+this.x*u,this.y=i*l+this.y*u,this.z=r*l+this.z*u,this},setFromUnitVectors:function(e,t){return void 0===U&&(U=new z),(G=e.dot(t)+1)<1e-6?(G=0,Math.abs(e.x)>Math.abs(e.z)?U.set(-e.y,e.x,0):U.set(0,-e.z,e.y)):U.crossVectors(e,t),this.x=U.x,this.y=U.y,this.z=U.z,this.w=G,this.normalize(),this}};var q=new W({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),X=new W({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),Q={CardboardV1:new Z({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new Z({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function Y(e,t){this.viewer=Q.CardboardV2,this.updateDeviceParams(e),this.distortion=new H(this.viewer.distortionCoefficients);for(var n=0;n<t.length;n++){var i=t[n];Q[i.id]=new Z(i)}}function Z(e){this.id=e.id,this.label=e.label,this.fov=e.fov,this.interLensDistance=e.interLensDistance,this.baselineLensDistance=e.baselineLensDistance,this.screenLensDistance=e.screenLensDistance,this.distortionCoefficients=e.distortionCoefficients,this.inverseCoefficients=e.inverseCoefficients}Y.prototype.updateDeviceParams=function(e){this.device=this.determineDevice_(e)||this.device},Y.prototype.getDevice=function(){return this.device},Y.prototype.setViewer=function(e){this.viewer=e,this.distortion=new H(this.viewer.distortionCoefficients)},Y.prototype.determineDevice_=function(e){if(!e)return y()?(console.warn("Using fallback iOS device measurements."),X):(console.warn("Using fallback Android device measurements."),q);var t=.0254/e.xdpi,n=.0254/e.ydpi;return new W({widthMeters:t*l(),heightMeters:n*u(),bevelMeters:.001*e.bevelMm})},Y.prototype.getDistortedFieldOfViewLeftEye=function(){var e=this.viewer,t=this.device,n=this.distortion,i=e.screenLensDistance,r=(t.widthMeters-e.interLensDistance)/2,o=e.interLensDistance/2,a=e.baselineLensDistance-t.bevelMeters,s=t.heightMeters-a,c=N*Math.atan(n.distort(r/i)),l=N*Math.atan(n.distort(o/i)),u=N*Math.atan(n.distort(a/i)),h=N*Math.atan(n.distort(s/i));return{leftDegrees:Math.min(c,e.fov),rightDegrees:Math.min(l,e.fov),downDegrees:Math.min(u,e.fov),upDegrees:Math.min(h,e.fov)}},Y.prototype.getLeftEyeVisibleTanAngles=function(){var e=this.viewer,t=this.device,n=this.distortion,i=Math.tan(-F*e.fov),r=Math.tan(F*e.fov),o=Math.tan(F*e.fov),a=Math.tan(-F*e.fov),s=t.widthMeters/4,c=t.heightMeters/2,l=e.baselineLensDistance-t.bevelMeters-c,u=e.interLensDistance/2-s,h=-l,d=e.screenLensDistance,p=n.distort((u-s)/d),f=n.distort((h+c)/d),m=n.distort((u+s)/d),v=n.distort((h-c)/d),g=new Float32Array(4);return g[0]=Math.max(i,p),g[1]=Math.min(r,f),g[2]=Math.min(o,m),g[3]=Math.max(a,v),g},Y.prototype.getLeftEyeNoLensTanAngles=function(){var e=this.viewer,t=this.device,n=this.distortion,i=new Float32Array(4),r=n.distortInverse(Math.tan(-F*e.fov)),o=n.distortInverse(Math.tan(F*e.fov)),a=n.distortInverse(Math.tan(F*e.fov)),s=n.distortInverse(Math.tan(-F*e.fov)),c=t.widthMeters/4,l=t.heightMeters/2,u=e.baselineLensDistance-t.bevelMeters-l,h=e.interLensDistance/2-c,d=-u,p=e.screenLensDistance,f=(h-c)/p,m=(d+l)/p,v=(h+c)/p,g=(d-l)/p;return i[0]=Math.max(r,f),i[1]=Math.min(o,m),i[2]=Math.min(a,v),i[3]=Math.max(s,g),i},Y.prototype.getLeftEyeVisibleScreenRect=function(e){var t=this.viewer,n=this.device,i=t.screenLensDistance,r=(n.widthMeters-t.interLensDistance)/2,o=t.baselineLensDistance-n.bevelMeters,a=(e[0]*i+r)/n.widthMeters,s=(e[1]*i+o)/n.heightMeters,c=(e[2]*i+r)/n.widthMeters,l=(e[3]*i+o)/n.heightMeters;return{x:a,y:l,width:c-a,height:s-l}},Y.prototype.getFieldOfViewLeftEye=function(e){return e?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},Y.prototype.getFieldOfViewRightEye=function(e){var t=this.getFieldOfViewLeftEye(e);return{leftDegrees:t.rightDegrees,rightDegrees:t.leftDegrees,upDegrees:t.upDegrees,downDegrees:t.downDegrees}},Y.prototype.getUndistortedFieldOfViewLeftEye=function(){var e=this.getUndistortedParams_();return{leftDegrees:N*Math.atan(e.outerDist),rightDegrees:N*Math.atan(e.innerDist),downDegrees:N*Math.atan(e.bottomDist),upDegrees:N*Math.atan(e.topDist)}},Y.prototype.getUndistortedViewportLeftEye=function(){var e=this.getUndistortedParams_(),t=this.viewer,n=this.device,i=t.screenLensDistance,r=n.widthMeters/i,o=n.heightMeters/i,a=n.width/r,s=n.height/o,c=Math.round((e.eyePosX-e.outerDist)*a),l=Math.round((e.eyePosY-e.bottomDist)*s);return{x:c,y:l,width:Math.round((e.eyePosX+e.innerDist)*a)-c,height:Math.round((e.eyePosY+e.topDist)*s)-l}},Y.prototype.getUndistortedParams_=function(){var e=this.viewer,t=this.device,n=this.distortion,i=e.screenLensDistance,r=e.interLensDistance/2/i,o=t.widthMeters/i,a=t.heightMeters/i,s=o/2-r,c=(e.baselineLensDistance-t.bevelMeters)/i,l=e.fov,u=n.distortInverse(Math.tan(F*l)),h=Math.min(s,u),d=Math.min(r,u),p=Math.min(c,u);return{outerDist:h,innerDist:d,topDist:Math.min(a-c,u),bottomDist:p,eyePosX:s,eyePosY:c}},Y.Viewers=Q;var K={format:1,last_updated:"2018-12-10T17:01:42Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3}]};function ne(e,t){if(this.dpdb=K,this.recalculateDeviceParams_(),e){this.onDeviceParamsUpdated=t;var n=new XMLHttpRequest,i=this;n.open("GET",e,!0),n.addEventListener("load",function(){i.loading=!1,200<=n.status&&n.status<=299?(i.dpdb=JSON.parse(n.response),i.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),n.send()}}function ie(e){this.xdpi=e.xdpi,this.ydpi=e.ydpi,this.bevelMm=e.bevelMm}function re(e,t){this.set(e,t)}function oe(e,t){this.kFilter=e,this.isDebug=t,this.currentAccelMeasurement=new re,this.currentGyroMeasurement=new re,this.previousGyroMeasurement=new re,y()?this.filterQ=new V(-1,0,0,1):this.filterQ=new V(1,0,0,1),this.previousFilterQ=new V,this.previousFilterQ.copy(this.filterQ),this.accelQ=new V,this.isOrientationInitialized=!1,this.estimatedGravity=new z,this.measuredGravity=new z,this.gyroIntegralQ=new V}function ae(e,t){this.predictionTimeS=e,this.isDebug=t,this.previousQ=new V,this.previousTimestampS=null,this.deltaQ=new V,this.outQ=new V}function se(e,t,n,i){this.yawOnly=n,this.accelerometer=new z,this.gyroscope=new z,this.filter=new oe(e,i),this.posePredictor=new ae(t,i),this.isFirefoxAndroid=b(),this.isIOS=y();var r=x();this.isDeviceMotionInRadians=!this.isIOS&&r&&r<66,this.isWithoutDeviceMotion=E(),this.filterToWorldQ=new V,y()?this.filterToWorldQ.setFromAxisAngle(new z(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new z(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new V,this.worldToScreenQ=new V,this.originalPoseAdjustQ=new V,this.originalPoseAdjustQ.setFromAxisAngle(new z(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),o()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new V,this.orientationOut_=new Float32Array(4),this.start()}ne.prototype.getDeviceParams=function(){return this.deviceParams},ne.prototype.recalculateDeviceParams_=function(){var e=this.calcDeviceParams_();e?(this.deviceParams=e,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},ne.prototype.calcDeviceParams_=function(){var e=this.dpdb;if(!e)return console.error("DPDB not available."),null;if(1!=e.format)return console.error("DPDB has unexpected format version."),null;if(!e.devices||!e.devices.length)return console.error("DPDB does not have a devices section."),null;var t=navigator.userAgent||navigator.vendor||window.opera,n=l(),i=u();if(!e.devices)return console.error("DPDB has no devices section."),null;for(var r=0;r<e.devices.length;r++){var o=e.devices[r];if(o.rules)if("ios"==o.type||"android"==o.type){if(y()==("ios"==o.type)){for(var a=!1,s=0;s<o.rules.length;s++){var c=o.rules[s];if(this.ruleMatches_(c,t,n,i)){a=!0;break}}if(a)return new ie({xdpi:o.dpi[0]||o.dpi,ydpi:o.dpi[1]||o.dpi,bevelMm:o.bw})}}else console.warn("Device["+r+"] has invalid type.");else console.warn("Device["+r+"] has no rules section.")}return console.warn("No DPDB device match."),null},ne.prototype.ruleMatches_=function(e,t,n,i){if(!e.ua&&!e.res)return!1;if(e.ua&&"SM"===e.ua.substring(0,2)&&(e.ua=e.ua.substring(0,7)),e.ua&&t.indexOf(e.ua)<0)return!1;if(e.res){if(!e.res[0]||!e.res[1])return!1;var r=e.res[0],o=e.res[1];if(Math.min(n,i)!=Math.min(r,o)||Math.max(n,i)!=Math.max(r,o))return!1}return!0},re.prototype.set=function(e,t){this.sample=e,this.timestampS=t},re.prototype.copy=function(e){this.set(e.sample,e.timestampS)},oe.prototype.addAccelMeasurement=function(e,t){this.currentAccelMeasurement.set(e,t)},oe.prototype.addGyroMeasurement=function(e,t){var n;this.currentGyroMeasurement.set(e,t),n=t-this.previousGyroMeasurement.timestampS,isNaN(n)||n<=.001||1<n||this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},oe.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,t=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(t),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(t);var n=new V;n.copy(this.filterQ),n.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(n),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var i,r=new V;r.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),r.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",N*(1<(i=r).w?(console.warn("getQuaternionAngle: w > 1"),0):2*Math.acos(i.w)),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var o=new V;o.copy(this.filterQ),o.multiply(r),this.filterQ.slerp(o,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},oe.prototype.getOrientation=function(){return this.filterQ},oe.prototype.accelToQuaternion_=function(e){var t=new z;t.copy(e),t.normalize();var n=new V;return n.setFromUnitVectors(new z(0,0,-1),t),n.inverse(),n},oe.prototype.gyroToQuaternionDelta_=function(e,t){var n=new V,i=new z;return i.copy(e),i.normalize(),n.setFromAxisAngle(i,e.length()*t),n},ae.prototype.getPrediction=function(e,t,n){if(!this.previousTimestampS)return this.previousQ.copy(e),this.previousTimestampS=n,e;var i=new z;i.copy(t),i.normalize();var r=t.length();if(r<20*F)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(N*r).toFixed(1)),this.outQ.copy(e),this.previousQ.copy(e),this.outQ;var o=r*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(i,o),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(e),this.previousTimestampS=n,this.outQ},se.prototype.getPosition=function(){return null},se.prototype.getOrientation=function(){var e=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ)return this.deviceOrientationFixQ=this.deviceOrientationFixQ||(n=(new V).setFromAxisAngle(new z(0,0,-1),0),i=new V,-90===window.orientation?i.setFromAxisAngle(new z(0,1,0),Math.PI/-2):i.setFromAxisAngle(new z(0,1,0),Math.PI/2),n.multiply(i)),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||((t=new V).setFromAxisAngle(new z(1,0,0),-Math.PI/2),t),e=this._deviceOrientationQ,(r=new V).copy(e),r.multiply(this.deviceOrientationFilterToWorldQ),r.multiply(this.resetQ),r.multiply(this.worldToScreenQ),r.multiplyQuaternions(this.deviceOrientationFixQ,r),this.yawOnly&&(r.x=0,r.z=0,r.normalize()),this.orientationOut_[0]=r.x,this.orientationOut_[1]=r.y,this.orientationOut_[2]=r.z,this.orientationOut_[3]=r.w,this.orientationOut_;var t,n,i,r,o=this.filter.getOrientation();return e=this.posePredictor.getPrediction(o,this.gyroscope,this.previousTimestampS),(r=new V).copy(this.filterToWorldQ),r.multiply(this.resetQ),r.multiply(e),r.multiply(this.worldToScreenQ),this.yawOnly&&(r.x=0,r.z=0,r.normalize()),this.orientationOut_[0]=r.x,this.orientationOut_[1]=r.y,this.orientationOut_[2]=r.z,this.orientationOut_[3]=r.w,this.orientationOut_},se.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),o()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},se.prototype.onDeviceOrientation_=function(e){this._deviceOrientationQ=this._deviceOrientationQ||new V;var t=e.alpha,n=e.beta,i=e.gamma;t=(t||0)*Math.PI/180,n=(n||0)*Math.PI/180,i=(i||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(n,t,-i)},se.prototype.onDeviceMotion_=function(e){this.updateDeviceMotion_(e)},se.prototype.updateDeviceMotion_=function(e){var t=e.accelerationIncludingGravity,n=e.rotationRate,i=e.timeStamp/1e3,r=i-this.previousTimestampS;return r<0?C("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"):r<=.001||1<r?C("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."):(this.accelerometer.set(-t.x,-t.y,-t.z),M()?this.gyroscope.set(-n.beta,n.alpha,n.gamma):this.gyroscope.set(n.alpha,n.beta,n.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addAccelMeasurement(this.accelerometer,i),this.filter.addGyroMeasurement(this.gyroscope,i)),void(this.previousTimestampS=i)},se.prototype.onOrientationChange_=function(e){this.setScreenTransform_()},se.prototype.onMessage_=function(e){var t=e.data;t&&t.type&&"devicemotion"===t.type.toLowerCase()&&this.updateDeviceMotion_(t.deviceMotionEvent)},se.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new z(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new z(0,0,1),Math.PI/2)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},se.prototype.start=function(){var e,t,n;this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),y()&&(e=window.self!==window.top,t=s(document.referrer),n=s(window.location.href),e&&t!==n)&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},se.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var ce=new z(1,0,0),le=new z(0,0,1),ue=new V;ue.setFromAxisAngle(ce,-Math.PI/2),ue.multiply((new V).setFromAxisAngle(le,Math.PI/2));var he=(g(de,[{key:"init",value:function(){var e=null;try{(e=new RelativeOrientationSensor({frequency:60,referenceFrame:"screen"})).addEventListener("error",this._onSensorError)}catch(e){this.errors.push(e),"SecurityError"===e.name?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):"ReferenceError"===e.name?this.useDeviceMotion():console.error(e)}e&&(this.api="sensor",this.sensor=e,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new se(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var e=this.sensor.quaternion;this._sensorQ.set(e[0],e[1],e[2],e[3]);var t=this._outQ;return t.copy(ue),t.multiply(this._sensorQ),this.config.YAW_ONLY&&(t.x=t.z=0,t.normalize()),this._out[0]=t.x,this._out[1]=t.y,this._out[2]=t.z,this._out[3]=t.w,this._out}},{key:"_onSensorError",value:function(e){this.errors.push(e.error),"NotAllowedError"===e.error.name?console.error("Permission to access sensor was denied"):"NotReadableError"===e.error.name?console.error("Sensor could not be read"):console.error(e.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),de);function de(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,de),this.config=e,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new V,this._outQ=new V,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}function pe(){this.loadIcon_();var e=document.createElement("div");(o=e.style).position="fixed",o.top=0,o.right=0,o.bottom=0,o.left=0,o.backgroundColor="gray",o.fontFamily="sans-serif",o.zIndex=1e6;var t=document.createElement("img");t.src=this.icon,(o=t.style).marginLeft="25%",o.marginTop="25%",o.width="50%",e.appendChild(t);var n=document.createElement("div");(o=n.style).textAlign="center",o.fontSize="16px",o.lineHeight="24px",o.margin="24px 25%",o.width="50%",n.innerHTML="Place your phone into your Cardboard viewer.",e.appendChild(n);var i=document.createElement("div");(o=i.style).backgroundColor="#CFD8DC",o.position="fixed",o.bottom=0,o.width="100%",o.height="48px",o.padding="14px 24px",o.boxSizing="border-box",o.color="#656A6B",e.appendChild(i);var r=document.createElement("div");r.style.float="left",r.innerHTML="No Cardboard viewer?";var o,a=document.createElement("a");a.href="https://www.google.com/get/cardboard/get-cardboard/",a.innerHTML="get one",a.target="_blank",(o=a.style).float="right",o.fontWeight=600,o.textTransform="uppercase",o.borderLeft="1px solid gray",o.paddingLeft="24px",o.textDecoration="none",o.color="#656A6B",i.appendChild(r),i.appendChild(a),this.overlay=e,this.text=n,this.hide()}pe.prototype.show=function(e){e||this.overlay.parentElement?e&&(this.overlay.parentElement&&this.overlay.parentElement!=e&&this.overlay.parentElement.removeChild(this.overlay),e.appendChild(this.overlay)):document.body.appendChild(this.overlay),this.overlay.style.display="block";var t=this.overlay.querySelector("img").style;o()?(t.width="20%",t.marginLeft="40%",t.marginTop="3%"):(t.width="50%",t.marginLeft="25%",t.marginTop="25%")},pe.prototype.hide=function(){this.overlay.style.display="none"},pe.prototype.showTemporarily=function(e,t){this.show(t),this.timer=setTimeout(this.hide.bind(this),e)},pe.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},pe.prototype.update=function(){this.disableShowTemporarily(),!o()&&T()?this.show():this.hide()},pe.prototype.loadIcon_=function(){this.icon="data:image/svg+xml,"+encodeURIComponent("<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>")};var fe="CardboardV1",me="WEBVR_CARDBOARD_VIEWER";function ve(e){try{this.selectedKey=localStorage.getItem(me)}catch(e){console.error("Failed to load viewer profile: %s",e)}this.selectedKey||(this.selectedKey=e||fe),this.dialog=this.createDialog_(Y.Viewers),this.root=null,this.onChangeCallbacks_=[]}ve.prototype.show=function(e){(this.root=e).appendChild(this.dialog),this.dialog.querySelector("#"+this.selectedKey).checked=!0,this.dialog.style.display="block"},ve.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},ve.prototype.getCurrentViewer=function(){return Y.Viewers[this.selectedKey]},ve.prototype.getSelectedKey_=function(){var e=this.dialog.querySelector("input[name=field]:checked");return e?e.id:null},ve.prototype.onChange=function(e){this.onChangeCallbacks_.push(e)},ve.prototype.fireOnChange_=function(e){for(var t=0;t<this.onChangeCallbacks_.length;t++)this.onChangeCallbacks_[t](e)},ve.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),this.selectedKey&&Y.Viewers[this.selectedKey]){this.fireOnChange_(Y.Viewers[this.selectedKey]);try{localStorage.setItem(me,this.selectedKey)}catch(e){console.error("Failed to save viewer profile: %s",e)}this.hide()}else console.error("ViewerSelector.onSave_: this should never happen!")},ve.prototype.createDialog_=function(e){var t=document.createElement("div");t.classList.add("webvr-polyfill-viewer-selector"),t.style.display="none";var n=document.createElement("div");(r=n.style).position="fixed",r.left=0,r.top=0,r.width="100%",r.height="100%",r.background="rgba(0, 0, 0, 0.3)",n.addEventListener("click",this.hide.bind(this));var i=document.createElement("div"),r=i.style;for(var o in r.boxSizing="border-box",r.position="fixed",r.top="24px",r.left="50%",r.marginLeft="-140px",r.width="280px",r.padding="24px",r.overflow="hidden",r.background="#fafafa",r.fontFamily="'Roboto', sans-serif",r.boxShadow="0px 5px 20px #666",i.appendChild(this.createH1_("Select your viewer")),e)i.appendChild(this.createChoice_(o,e[o].label));return i.appendChild(this.createButton_("Save",this.onSave_.bind(this))),t.appendChild(n),t.appendChild(i),t},ve.prototype.createH1_=function(e){var t=document.createElement("h1"),n=t.style;return n.color="black",n.fontSize="20px",n.fontWeight="bold",n.marginTop=0,n.marginBottom="24px",t.innerHTML=e,t},ve.prototype.createChoice_=function(e,t){var n=document.createElement("div");n.style.marginTop="8px",n.style.color="black";var i=document.createElement("input");i.style.fontSize="30px",i.setAttribute("id",e),i.setAttribute("type","radio"),i.setAttribute("value",e),i.setAttribute("name","field");var r=document.createElement("label");return r.style.marginLeft="4px",r.setAttribute("for",e),r.innerHTML=t,n.appendChild(i),n.appendChild(r),n},ve.prototype.createButton_=function(e,t){var n=document.createElement("button");n.innerHTML=e;var i=n.style;return i.float="right",i.textTransform="uppercase",i.color="#1094f7",i.fontSize="14px",i.letterSpacing=0,i.border=0,i.background="none",i.marginTop="16px",n.addEventListener("click",t),n};var ge,ye,Ae=((ye={exports:{}}).exports=function(){return r={},i.m=n=[function(e,t,n){var i=function(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e},r=n(1),o="undefined"!=typeof navigator&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,a=(i(s,[{key:"enable",value:function(){o?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){o?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),s);function s(){!function(e){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this),o?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",r),this.noSleepVideo.addEventListener("timeupdate",function(e){.5<this.noSleepVideo.currentTime&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=a},function(e,t,n){e.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}],i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0);function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var n,r}(),(ge=ye.exports)&&ge.__esModule&&Object.prototype.hasOwnProperty.call(ge,"default")?ge.default:ge),be=1e3,we=[0,0,.5,1],xe=[.5,0,.5,1],Ee=window.requestAnimationFrame,Me=window.cancelAnimationFrame;function Te(e){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:e.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:e.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:e.canPresent},maxLayers:{writable:!1,enumerable:!0,value:e.maxLayers},hasOrientation:{enumerable:!0,get:function(){return L("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),e.hasOrientation}}})}function Se(e){var t=!("wakelock"in(e=e||{}))||e.wakelock;this.isPolyfilled=!0,this.displayId=be++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return L("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new Te({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,t&&T()&&(this.wakelock_=new Ae)}Se.prototype.getFrameData=function(e){return S(e,this._getPose(),this)},Se.prototype.getPose=function(){return L("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Se.prototype.resetPose=function(){return L("VRDisplay.prototype.resetPose"),this._resetPose()},Se.prototype.getImmediatePose=function(){return L("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Se.prototype.requestAnimationFrame=function(e){return Ee(e)},Se.prototype.cancelAnimationFrame=function(e){return Me(e)},Se.prototype.wrapForFullscreen=function(e){if(y())return e;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var t=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",t.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==e)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=e,this.originalParent_=e.parentElement,this.originalParent_||document.body.appendChild(e),!this.fullscreenWrapper_.parentElement){var n=this.fullscreenElement_.parentElement;n.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),n.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var i=this;return function(){if(i.fullscreenElement_){var e=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];i.fullscreenElement_.setAttribute("style",e.join("; ")+";")}}(),this.fullscreenWrapper_},Se.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var e=this.fullscreenElement_;this.fullscreenElementCachedStyle_?e.setAttribute("style",this.fullscreenElementCachedStyle_):e.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var t=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(e),this.originalParent_===t?t.insertBefore(e,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(e),t.removeChild(this.fullscreenWrapper_),e}},Se.prototype.requestPresent=function(c){var l=this.isPresenting,u=this;return c instanceof Array||(L("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),c=[c]),new Promise(function(t,e){if(u.capabilities.canPresent)if(0==c.length||c.length>u.capabilities.maxLayers)e(new Error("Invalid number of layers."));else{var n=c[0];if(n.source){var i=n.leftBounds||we,r=n.rightBounds||xe;if(l){var o=u.layer_;o.source!==n.source&&(o.source=n.source);for(var a=0;a<4;a++)o.leftBounds[a]=i[a],o.rightBounds[a]=r[a];return u.wrapForFullscreen(u.layer_.source),u.updatePresent_(),void t()}if(u.layer_={predistorted:n.predistorted,source:n.source,leftBounds:i.slice(0),rightBounds:r.slice(0)},u.waitingForPresent_=!1,u.layer_&&u.layer_.source){var s=u.wrapForFullscreen(u.layer_.source);u.addFullscreenListeners_(s,function(){var e=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;u.isPresenting=s===e,u.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(e){console.error("screen.orientation.lock() failed due to",e.message)}),u.waitingForPresent_=!1,u.beginPresent_(),t()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),u.removeFullscreenWrapper(),u.disableWakeLock(),u.endPresent_(),u.removeFullscreenListeners_()),u.fireVRDisplayPresentChange_()},function(){u.waitingForPresent_&&(u.removeFullscreenWrapper(),u.removeFullscreenListeners_(),u.disableWakeLock(),u.waitingForPresent_=!1,u.isPresenting=!1,e(new Error("Unable to present.")))}),function(e){if(A())return 0;if(e.requestFullscreen)e.requestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else{if(!e.msRequestFullscreen)return 0;e.msRequestFullscreen()}return 1}(s)?(u.enableWakeLock(),u.waitingForPresent_=!0):(y()||A())&&(u.enableWakeLock(),u.isPresenting=!0,u.beginPresent_(),u.fireVRDisplayPresentChange_(),t())}u.waitingForPresent_||y()||(h(),e(new Error("Unable to present.")))}else t()}else e(new Error("VRDisplay is not capable of presenting."))})},Se.prototype.exitPresent=function(){var n=this.isPresenting,i=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(e,t){n?(!h()&&y()&&(i.endPresent_(),i.fireVRDisplayPresentChange_()),A()&&(i.removeFullscreenWrapper(),i.removeFullscreenListeners_(),i.endPresent_(),i.fireVRDisplayPresentChange_()),e()):t(new Error("Was not presenting to VRDisplay."))})},Se.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Se.prototype.fireVRDisplayPresentChange_=function(){var e=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(e)},Se.prototype.fireVRDisplayConnect_=function(){var e=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(e)},Se.prototype.addFullscreenListeners_=function(e,t,n){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=e,this.fullscreenChangeHandler_=t,this.fullscreenErrorHandler_=n,t&&(document.fullscreenEnabled?e.addEventListener("fullscreenchange",t,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenchange",t,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",t,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenchange",t,!1)),n&&(document.fullscreenEnabled?e.addEventListener("fullscreenerror",n,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenerror",n,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",n,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenerror",n,!1))},Se.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var e=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var t=this.fullscreenChangeHandler_;e.removeEventListener("fullscreenchange",t,!1),e.removeEventListener("webkitfullscreenchange",t,!1),document.removeEventListener("mozfullscreenchange",t,!1),e.removeEventListener("msfullscreenchange",t,!1)}if(this.fullscreenErrorHandler_){var n=this.fullscreenErrorHandler_;e.removeEventListener("fullscreenerror",n,!1),e.removeEventListener("webkitfullscreenerror",n,!1),document.removeEventListener("mozfullscreenerror",n,!1),e.removeEventListener("msfullscreenerror",n,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Se.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Se.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Se.prototype.beginPresent_=function(){},Se.prototype.endPresent_=function(){},Se.prototype.submitFrame=function(e){};var Ce={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!(Se.prototype.getEyeParameters=function(e){return null}),DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},Le="left",_e="right";function Be(e){var t=n({},Ce);e=n(t,e||{}),Se.call(this,{wakelock:e.MOBILE_WAKE_LOCK}),this.config=e,this.displayName="Cardboard VRDisplay",this.capabilities=new Te({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new he(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new ne(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new Y(this.dpdb_.getDeviceParams(),e.ADDITIONAL_VIEWERS),this.viewerSelector_=new ve(e.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new pe),y()&&window.addEventListener("resize",this.onResize_.bind(this))}return(Be.prototype=Object.create(Se.prototype))._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},Be.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},Be.prototype._getFieldOfView=function(e){var t;if(e==Le)t=this.deviceInfo_.getFieldOfViewLeftEye();else{if(e!=_e)return console.error("Invalid eye provided: %s",e),null;t=this.deviceInfo_.getFieldOfViewRightEye()}return t},Be.prototype._getEyeOffset=function(e){var t;if(e==Le)t=[.5*-this.deviceInfo_.viewer.interLensDistance,0,0];else{if(e!=_e)return console.error("Invalid eye provided: %s",e),null;t=[.5*this.deviceInfo_.viewer.interLensDistance,0,0]}return t},Be.prototype.getEyeParameters=function(e){var t=this._getEyeOffset(e),n=this._getFieldOfView(e),i={offset:t,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(i,"fieldOfView",{enumerable:!0,get:function(){return L("VRFieldOfView","VRFrameData's projection matrices"),n}}),i},Be.prototype.onDeviceParamsUpdated_=function(e){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},Be.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},Be.prototype.beginPresent_=function(){var e=this.layer_.source.getContext("webgl");(e=(e=e||this.layer_.source.getContext("experimental-webgl"))||this.layer_.source.getContext("webgl2"))&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(e.canvas.width=l()*this.bufferScale_,e.canvas.height=u()*this.bufferScale_,this.cardboardUI_=new j(e)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new j(e)),this.distorter_=new D(e,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(e){this.viewerSelector_.show(this.layer_.source.parentElement),e.stopPropagation(),e.preventDefault()}.bind(this),function(e){this.exitPresent(),e.stopPropagation(),e.preventDefault()}.bind(this)),this.rotateInstructions_&&(o()&&T()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},Be.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},Be.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},Be.prototype.submitFrame=function(e){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var t=this.layer_.source.getContext("webgl").canvas;t.width==this.lastWidth&&t.height==this.lastHeight||this.cardboardUI_.onResize(),this.lastWidth=t.width,this.lastHeight=t.height,this.cardboardUI_.render()}},Be.prototype.onOrientationChange_=function(e){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},Be.prototype.onResize_=function(e){if(this.layer_){var t=this.layer_.source.getContext("webgl");t.canvas.setAttribute("style",["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"].join("; ")+";"),i(t.canvas)}},Be.prototype.onViewerChanged_=function(e){this.deviceInfo_.setViewer(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},Be.prototype.fireVRDisplayDeviceParamsChange_=function(){var e=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(e)},Be.VRFrameData=function(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null},Be.VRDisplay=Se,Be}(),e.exports))&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,s={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function c(e){this.config=n(n({},s),e),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&t())&&(this.enable(),this.getVRDisplays().then(function(e){e&&e[0]&&e[0].fireVRDisplayConnect_&&e[0].fireVRDisplayConnect_()}))}c.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(t()){var e=new a({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(e)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},c.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var t=this.native.VRFrameData,n=new this.native.VRFrameData,i=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(e){e instanceof t?i.call(this,e):(i.call(this,n),e.pose=n.pose,r(n.leftProjectionMatrix,e.leftProjectionMatrix),r(n.rightProjectionMatrix,e.rightProjectionMatrix),r(n.leftViewMatrix,e.leftViewMatrix),r(n.rightViewMatrix,e.rightViewMatrix))}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=a.VRDisplay,window.VRFrameData=a.VRFrameData},c.prototype.getVRDisplays=function(){var t=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(e){return 0<e.length?e:t.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},c.version="0.10.10",c.VRFrameData=a.VRFrameData,c.VRDisplay=a.VRDisplay;var l=Object.freeze({default:c}),u=l&&c||l;return void 0!==o&&o.window&&(o.document||(o.document=o.window.document),o.navigator||(o.navigator=o.window.navigator)),u},"object"==typeof i&&void 0!==n?n.exports=t():e.WebVRPolyfill=t()}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],47:[function(e,n,t){var h=/\n/,i=/\s/;function g(e){return i.test(e)}function r(e,t,n,i){return{start:t,end:t+Math.min(i,n-t)}}n.exports=function(t,e){return n.exports.lines(t,e).map(function(e){return t.substring(e.start,e.end)}).join("\n")},n.exports.lines=function(e,t){if(0===(t=t||{}).width&&"nowrap"!==t.mode)return[];e=e||"";var m="number"==typeof t.width?t.width:Number.MAX_VALUE,u=Math.max(0,t.start||0),n="number"==typeof t.end?t.end:e.length,v=t.mode,i=t.measure||r;return"pre"===v?function(e,t,n,i){for(var r=[],o=u,a=u;a<n&&a<t.length;a++){var s=t.charAt(a),c=h.test(s);if(c||a===n-1){var l=e(t,o,c?a:a+1,i);r.push(l),o=a+1}}return r}(i,e,n,m):function(e,t,n,i){var r,o,a,s,c=[],l=m;for("nowrap"===v&&(l=Number.MAX_VALUE);n<i&&n<t.length;){for(var u=(r="\n",o=n,a=i,-1===(s=t.indexOf(r,o))||a<s?a:s);n<u&&g(t.charAt(n));)n++;var h=e(t,n,u,l),d=n+(h.end-h.start),p=d+"\n".length;if(d<u){for(;n<d&&!g(t.charAt(d));)d--;if(d===n)n+"\n".length<p&&p--,d=p;else for(p=d;n<d&&g(t.charAt(d-"\n".length));)d--}if(n<=d){var f=e(t,n,d,l);c.push(f)}n=p}return c}(i,e,u,n)}},{}],48:[function(e,t,n){"use strict";var i=e("global/window"),r=e("is-function"),v=e("parse-headers"),o=e("xtend");function a(e,t,n){var i=e;return r(t)?(n=t,"string"==typeof e&&(i={uri:e})):i=o(t,{uri:e}),i.callback=n,i}function g(e,t,n){return s(t=a(e,t,n))}function s(i){if(void 0===i.callback)throw new Error("callback argument missing");function r(e,t,n){o||(o=!0,i.callback(e,t,n))}var o=!1;function t(e){return clearTimeout(s),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,r(e,m)}function e(){if(!a){var e;clearTimeout(s),e=i.useXDR&&void 0===c.status?200:1223===c.status?204:c.status;var t=m,n=null;return 0!==e?(t={body:function(){var e=void 0;if(e=c.response?c.response:c.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}(c),f)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:e,method:u,headers:{},url:l,rawRequest:c},c.getAllResponseHeaders&&(t.headers=v(c.getAllResponseHeaders()))):n=new Error("Internal XMLHttpRequest Error"),r(n,t,t.body)}}var n,a,s,c=i.xhr||null,l=(c=c||(i.cors||i.useXDR?new g.XDomainRequest:new g.XMLHttpRequest)).url=i.uri||i.url,u=c.method=i.method||"GET",h=i.body||i.data,d=c.headers=i.headers||{},p=!!i.sync,f=!1,m={body:void 0,headers:{},statusCode:0,method:u,url:l,rawRequest:c};if("json"in i&&!1!==i.json&&(f=!0,d.accept||d.Accept||(d.Accept="application/json"),"GET"!==u&&"HEAD"!==u&&(d["content-type"]||d["Content-Type"]||(d["Content-Type"]="application/json"),h=JSON.stringify(!0===i.json?h:i.json))),c.onreadystatechange=function(){4===c.readyState&&setTimeout(e,0)},c.onload=e,c.onerror=t,c.onprogress=function(){},c.onabort=function(){a=!0},c.ontimeout=t,c.open(u,l,!p,i.username,i.password),p||(c.withCredentials=!!i.withCredentials),!p&&0<i.timeout&&(s=setTimeout(function(){if(!a){a=!0,c.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",t(e)}},i.timeout)),c.setRequestHeader)for(n in d)d.hasOwnProperty(n)&&c.setRequestHeader(n,d[n]);else if(i.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return 0;return 1}(i.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in i&&(c.responseType=i.responseType),"beforeSend"in i&&"function"==typeof i.beforeSend&&i.beforeSend(c),c.send(h||null),c}(t.exports=g).XMLHttpRequest=i.XMLHttpRequest||function(){},g.XDomainRequest="withCredentials"in new g.XMLHttpRequest?g.XMLHttpRequest:i.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],function(i){g["delete"===i?"del":i]=function(e,t,n){return(t=a(e,t,n)).method=i.toUpperCase(),s(t)}})},{"global/window":16,"is-function":20,"parse-headers":31,xtend:50}],49:[function(e,t,n){t.exports=void 0!==self.DOMParser?function(e){return(new self.DOMParser).parseFromString(e,"application/xml")}:void 0!==self.ActiveXObject&&new self.ActiveXObject("Microsoft.XMLDOM")?function(e){var t=new self.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}:function(e){var t=document.createElement("div");return t.innerHTML=e,t}},{}],50:[function(e,t,n){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var i in n)r.call(n,i)&&(e[i]=n[i])}return e};var r=Object.prototype.hasOwnProperty},{}],51:[function(e,t,n){t.exports={name:"aframe",version:"0.9.0",description:"A web framework for building virtual reality experiences.",homepage:"https://aframe.io/",main:"dist/aframe-master.js",scripts:{browserify:"browserify src/index.js -s 'AFRAME' -p browserify-derequire",build:"shx mkdir -p build/ && npm run browserify -- --debug -t [envify --INSPECTOR_VERSION dev] -o build/aframe.js",codecov:"codecov",dev:"npm run build && cross-env INSPECTOR_VERSION=dev node ./scripts/budo -t envify",dist:"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"npm run browserify -s -- --debug | exorcist dist/aframe-master.js.map > dist/aframe-master.js","dist:min":"npm run browserify -s -- --debug -p [minifyify --map aframe-master.min.js.map --output dist/aframe-master.min.js.map] -o dist/aframe-master.min.js",docs:"markserv --dir docs --port 9001",preghpages:"node ./scripts/preghpages.js",ghpages:"ghpages -p gh-pages/",lint:"semistandard -v | snazzy","lint:fix":"semistandard --fix",precommit:"npm run lint",prepush:"node scripts/testOnlyCheck.js",prerelease:"node scripts/release.js 0.8.2 0.9.0",start:"npm run dev","start:https":"cross-env SSL=true npm run dev",test:"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"mocha --ui tdd tests/node"},repository:"aframevr/aframe",license:"MIT",files:["dist/*","docs/**/*","src/**/*","vendor/**/*"],dependencies:{animejs:"^2.2.0","browserify-css":"^0.8.4","custom-event-polyfill":"^1.0.6",debug:"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","document-register-element":"dmarcos/document-register-element#8ccc532b7f3744be954574caf3072a5fd260ca90",envify:"^3.4.1","load-bmfont":"^1.2.3","object-assign":"^4.0.1",present:"0.0.6","promise-polyfill":"^3.1.0","style-attr":"^1.0.2","super-three":"^0.101.0","three-bmfont-text":"^2.1.0","webvr-polyfill":"^0.10.10"},devDependencies:{browserify:"^13.1.0","browserify-derequire":"^0.9.4","browserify-istanbul":"^2.0.0",budo:"^9.2.0",chai:"^3.5.0","chai-shallow-deep-equal":"^1.4.0",chalk:"^1.1.3",codecov:"^1.0.1","cross-env":"^5.0.1",exorcist:"^0.4.0",ghpages:"0.0.8","git-rev":"^0.2.1",glob:"^7.1.1",husky:"^0.11.7",istanbul:"^0.4.5",jsdom:"^9.11.0",karma:"1.4.1","karma-browserify":"^5.1.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^1.0.0","karma-mocha":"^1.1.1","karma-mocha-reporter":"^2.1.0","karma-sinon-chai":"1.2.4",lolex:"^1.5.1",markserv:"github:sukima/markserv#feature/fix-broken-websoketio-link",minifyify:"^7.3.3",mocha:"^3.0.2","mozilla-download":"^1.1.1","replace-in-file":"^2.5.3",semistandard:"^9.0.0",shelljs:"^0.7.7",shx:"^0.2.2",sinon:"^1.17.5","sinon-chai":"2.8.0",snazzy:"^5.0.0","too-wordy":"ngokevin/too-wordy",uglifyjs:"^2.4.10","write-good":"^0.9.1"},link:!0,browserify:{transform:["browserify-css","envify"]},semistandard:{ignore:["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},keywords:["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","web-components","webvr"],"browserify-css":{minify:!0},engines:{node:">= 4.6.0",npm:"^2.15.9"}}},{}],52:[function(e,t,n){var a=e("animejs"),s=e("../core/component").components,i=e("../core/component").registerComponent,c=e("../lib/three"),l=e("../utils"),r=new c.Color,o=new c.Color,u=l.entity.getComponentProperty,h=l.entity.setComponentProperty,d={},p="components";function f(e){e.x=c.Math.degToRad(e.x),e.y=c.Math.degToRad(e.y),e.z=c.Math.degToRad(e.z)}function m(e,t,n){var i;for(i=0;i<t.length;i++)e.addEventListener(t[i],n)}function v(e,t,n){var i;for(i=0;i<t.length;i++)e.removeEventListener(t[i],n)}function g(e,t){var n,i,r;for(i=A(t),r=e,n=0;n<i.length;n++)r=r[i[n]];return r}function y(e,t,n,i){var r,o,a,s;for(t.startsWith("object3D.rotation")&&(n=c.Math.degToRad(n)),o=A(t),s=e,r=0;r<o.length-1;r++)s=s[o[r]];a=o[o.length-1],"color"!==i?s[a]=n:"r"in s[a]?(s[a].r=n.r,s[a].g=n.g,s[a].b=n.b):(s[a].x=n.r,s[a].y=n.g,s[a].z=n.b)}function A(e){return e in d||(d[e]=e.split(".")),d[e]}function b(e){return e.isRawProperty||e.property.startsWith(p)||e.property.startsWith("object3D")}t.exports.Component=i("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(e){return!0===e||"true"===e||!1!==e&&"false"!==e&&parseInt(e,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var e=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){e.animationIsPlaying=!1,e.el.emit("animationcomplete",e.eventDetail,!1),e.id&&e.el.emit("animationcomplete__"+e.id,e.eventDetail,!1)}}},update:function(e){var t=this.config,n=this.data;this.animationIsPlaying=!1,this.data.enabled&&n.property&&(t.autoplay=!1,t.direction=n.dir,t.duration=n.dur,t.easing=n.easing,t.elasticity=n.elasticity,t.loop=n.loop,t.round=n.round,this.createAndStartAnimation())},tick:function(e,t){this.animationIsPlaying&&(this.time+=t,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var e=this.data;this.updateConfig(),this.animationIsPlaying=!1,this.animation=a(this.config),this.removeEventListeners(),this.addEventListeners(),!e.autoplay||e.startEvents&&e.startEvents.length||(e.delay?setTimeout(this.beginAnimation,e.delay):this.beginAnimation())},beginAnimation:function(){this.updateConfig(),this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){this.data.enabled&&(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=a(this.config),this.data.delay?setTimeout(this.beginAnimation,this.data.delay):this.beginAnimation())},updateConfigForRawColor:function(){var e,t,n,i=this.config,r=this.data,o=this.el;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){for(t in e=""===r.from?g(o,r.property):r.from,n=r.to,this.setColorConfig(e,n),e=this.fromColor,n=this.toColor,this.targetsArray.length=0,this.targetsArray.push(e),i.targets=this.targetsArray,n)i[t]=n[t];var a;i.update=(a={},function(e){var t;(t=e.animatables[0].target).r===a.r&&t.g===a.g&&t.b===a.b||y(o,r.property,t,r.type)})}},updateConfigForDefault:function(){var e,n,t,i,r=this.config,o=this.data,a=this.el;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(e=""===o.from?b(o)?g(a,o.property):u(a,o.property):o.from,t=o.to,t=isNaN(e||t)?(e=e?e.toString():e,t?t.toString():t):(e=parseFloat(e),parseFloat(t)),(n="true"===o.to||"false"===o.to||!0===o.to||!1===o.to)&&(e="true"===o.from||!0===o.from?1:0,t="true"===o.to||!0===o.to?1:0),this.targets.aframeProperty=e,r.targets=this.targets,r.aframeProperty=t,r.update=function(e){var t;(t=e.animatables[0].target.aframeProperty)!==i&&(i=t,n&&(t=1<=t),b(o)?y(a,o.property,t,o.type):h(a,o.property,t))})},updateConfigForVector:function(){var e,t,n,i,r,o=this.config,a=this.data,s=this.el;for(e in t=""!==a.from?l.coordinates.parse(a.from):u(s,a.property),n=l.coordinates.parse(a.to),"rotation"===a.property&&(f(t),f(n)),this.targetsArray.length=0,this.targetsArray.push(t),o.targets=this.targetsArray,n)o[e]=n[e];"position"!==a.property&&"rotation"!==a.property&&"scale"!==a.property?o.update=(r={},function(e){var t=e.animations[0].target;t.x===r.x&&t.y===r.y&&t.z===r.z||(r.x=t.x,r.y=t.y,r.z=t.z,h(s,a.property,t))}):o.update=(i={},function(e){var t=e.animatables[0].target;"scale"===a.property&&(t.x=Math.max(1e-4,t.x),t.y=Math.max(1e-4,t.y),t.z=Math.max(1e-4,t.z)),t.x===i.x&&t.y===i.y&&t.z===i.z||(i.x=t.x,i.y=t.y,i.z=t.z,s.object3D[a.property].set(t.x,t.y,t.z))})},updateConfig:function(){var e,t,n,i,r,o;t=this.el,i=(r=this.data.property.split("."))[0],o=r[1],e=(n=t.components[i]||s[i])?o&&!n.schema[o]?null:o?n.schema[o].type:n.schema.type:null,b(this.data)&&"color"===this.data.type?this.updateConfigForRawColor():"vec2"===e||"vec3"===e||"vec4"===e?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(n){var i,e=this.data,r=this.el,o=this;return""===e.from&&!!e.property.startsWith(p)&&(i=A(e.property)[1],!r.components[i]&&(r.addEventListener("componentinitialized",function e(t){t.detail.name===i&&(n(),o.animation=a(o.config),r.removeEventListener("componentinitialized",e))}),!0))},stopRelatedAnimations:function(){var e,t;for(t in this.el.components)e=this.el.components[t],t!==this.attrName&&"animation"===e.name&&e.animationIsPlaying&&e.data.property===this.data.property&&(e.animationIsPlaying=!1)},addEventListeners:function(){var e=this.data,t=this.el;m(t,e.startEvents,this.onStartEvent),m(t,e.pauseEvents,this.pauseAnimation),m(t,e.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var e=this.data,t=this.el;v(t,e.startEvents,this.onStartEvent),v(t,e.pauseEvents,this.pauseAnimation),v(t,e.resumeEvents,this.resumeAnimation)},setColorConfig:function(e,t){r.set(e),o.set(t),e=this.fromColor,t=this.toColor,e.r=r.r,e.g=r.g,e.b=r.b,t.r=o.r,t.g=o.g,t.b=o.b}})},{"../core/component":103,"../lib/three":151,"../utils":176,animejs:2}],53:[function(e,t,n){var i=e("../core/component").registerComponent,r=e("../lib/three");t.exports.Component=i("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var e,t=this.el;e=this.camera=new r.PerspectiveCamera,t.setObject3D("camera",e)},update:function(e){var t=this.data,n=this.camera;n.aspect=t.aspect||window.innerWidth/window.innerHeight,n.far=t.far,n.fov=t.fov,n.near=t.near,n.zoom=t.zoom,n.updateProjectionMatrix(),this.updateActiveCamera(e),this.updateSpectatorCamera(e)},updateActiveCamera:function(e){var t=this.data,n=this.el,i=this.system;e&&e.active===t.active||t.spectator||(t.active&&i.activeCameraEl!==n?i.setActiveCamera(n):t.active||i.activeCameraEl!==n||i.disableActiveCamera())},updateSpectatorCamera:function(e){var t=this.data,n=this.el,i=this.system;e&&e.spectator===t.spectator||(t.spectator&&i.spectatorCameraEl!==n?i.setSpectatorCamera(n):t.spectator||i.spectatorCameraEl!==n||i.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},{"../core/component":103,"../lib/three":151}],54:[function(e,t,n){var a,s,c,l,i=e("../core/component").registerComponent,r=e("../utils/"),o=r.bind,u="click",h="fusing",d="mouseenter",p="mousedown",f="mouseleave",m="mouseup",v="cursor-fusing",g="cursor-hovering",y="cursor-hovered",A={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]};t.exports.Component=i("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:r.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity"]}},init:function(){var e=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.updateCanvasBounds=r.debounce(function(){e.canvasBounds=e.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=o(this.onCursorDown,this),this.onCursorUp=o(this.onCursorUp,this),this.onIntersection=o(this.onIntersection,this),this.onIntersectionCleared=o(this.onIntersectionCleared,this),this.onMouseMove=o(this.onMouseMove,this)},update:function(e){this.data.rayOrigin!==e.rayOrigin&&this.updateMouseEventListeners()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var e=this.el;e.removeState(g),e.removeState(v),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(y),this.removeEventListeners()},addEventListeners:function(){var t,e=this.data,n=this.el,i=this;function r(){t=n.sceneEl.canvas,e.downEvents.length||e.upEvents.length||(A.DOWN.forEach(function(e){t.addEventListener(e,i.onCursorDown)}),A.UP.forEach(function(e){t.addEventListener(e,i.onCursorUp)}))}(t=n.sceneEl.canvas)?r():n.sceneEl.addEventListener("render-target-loaded",r),e.downEvents.forEach(function(e){n.addEventListener(e,i.onCursorDown)}),e.upEvents.forEach(function(e){n.addEventListener(e,i.onCursorUp)}),n.addEventListener("raycaster-intersection",this.onIntersection),n.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),n.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var t,e=this.data,n=this.el,i=this;!(t=n.sceneEl.canvas)||e.downEvents.length||e.upEvents.length||(A.DOWN.forEach(function(e){t.removeEventListener(e,i.onCursorDown)}),A.UP.forEach(function(e){t.removeEventListener(e,i.onCursorUp)})),e.downEvents.forEach(function(e){n.removeEventListener(e,i.onCursorDown)}),e.upEvents.forEach(function(e){n.removeEventListener(e,i.onCursorUp)}),n.removeEventListener("raycaster-intersection",this.onIntersection),n.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("touchstart",this.onMouseMove),t.removeEventListener("touchmove",this.onMouseMove),n.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var e,t=this.el;(e=t.sceneEl.canvas).removeEventListener("mousemove",this.onMouseMove),e.removeEventListener("touchmove",this.onMouseMove),t.setAttribute("raycaster","useWorldCoordinates",!1),"mouse"===this.data.rayOrigin&&(e.addEventListener("mousemove",this.onMouseMove,!1),e.addEventListener("touchmove",this.onMouseMove,!1),t.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:(a=new THREE.Vector3,s=new THREE.Vector2,c=new THREE.Vector3,l={origin:c,direction:a},function(e){var t,n,i,r=this.canvasBounds,o=this.el.sceneEl.camera;o.parent.updateMatrixWorld(),t=(n="touchmove"===e.type||"touchstart"===e.type?e.touches.item(0):e).clientX-r.left,i=n.clientY-r.top,s.x=t/r.width*2-1,s.y=-i/r.height*2+1,c.setFromMatrixPosition(o.matrixWorld),a.set(s.x,s.y,.5).unproject(o).sub(c).normalize(),this.el.setAttribute("raycaster",l),"touchmove"===e.type&&e.preventDefault()}),onCursorDown:function(e){"mouse"===this.data.rayOrigin&&"touchstart"===e.type&&(this.onMouseMove(e),this.el.components.raycaster.checkIntersections(),e.preventDefault()),this.twoWayEmit(p),this.cursorDownEl=this.intersectedEl},onCursorUp:function(e){var t=this.data;this.twoWayEmit(m),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(m,this.intersectedEventDetail)),t.fuse&&"mouse"!==t.rayOrigin||!this.intersectedEl||this.cursorDownEl!==this.intersectedEl||this.twoWayEmit(u),this.cursorDownEl=null,"touchend"===e.type&&e.preventDefault()},onIntersection:function(e){var t,n,i,r,o=this.el;n=e.detail.els[0]===o?1:0,r=e.detail.intersections[n],(i=e.detail.els[n])&&this.intersectedEl!==i&&(this.intersectedEl&&(t=this.el.components.raycaster.getIntersection(this.intersectedEl))&&t.distance<=r.distance||(this.clearCurrentIntersection(!0),this.setIntersection(i,r)))},onIntersectionCleared:function(e){-1!==e.detail.clearedEls.indexOf(this.intersectedEl)&&this.clearCurrentIntersection()},setIntersection:function(e,t){var n=this.el,i=this.data,r=this;this.intersectedEl!==e&&(this.intersectedEl=e,n.addState(g),e.addState(y),this.twoWayEmit(d),this.data.mouseCursorStylesEnabled&&"mouse"===this.data.rayOrigin&&this.el.sceneEl.canvas.classList.add("a-mouse-cursor-hover"),0!==i.fuseTimeout&&i.fuse&&(n.addState(v),this.twoWayEmit(h),this.fuseTimeout=setTimeout(function(){n.removeState(v),r.twoWayEmit(u)},i.fuseTimeout)))},clearCurrentIntersection:function(e){var t,n,i=this.el;this.intersectedEl&&(this.intersectedEl.removeState(y),i.removeState(g),i.removeState(v),this.twoWayEmit(f),this.data.mouseCursorStylesEnabled&&"mouse"===this.data.rayOrigin&&this.el.sceneEl.canvas.classList.remove("a-mouse-cursor-hover"),this.intersectedEl=null,clearTimeout(this.fuseTimeout),!0===e||0===(n=this.el.components.raycaster.intersections).length||(t=n[n[0].object.el===i?1:0])&&this.setIntersection(t.object.el,t))},twoWayEmit:function(e){var t,n=this.el,i=this.intersectedEl;t=this.el.components.raycaster.getIntersection(i),this.eventDetail.intersectedEl=i,this.eventDetail.intersection=t,n.emit(e,this.eventDetail),i&&(this.intersectedEventDetail.intersection=t,i.emit(e,this.intersectedEventDetail))}})},{"../core/component":103,"../utils/":176}],55:[function(e,t,n){var i=e("../core/component").registerComponent,r=e("../utils/bind"),o=e("../utils/tracked-controls").checkControllerPresentAndSetup,a=e("../utils/tracked-controls"),s=a.emitIfAxesChanged,c=a.onButtonEvent;t.exports.Component=i("daydream-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","menu","system"]},bindMethods:function(){this.onModelLoaded=r(this.onModelLoaded,this),this.onControllersUpdate=r(this.onControllersUpdate,this),this.checkIfControllerPresent=r(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=r(this.removeControllersUpdateListener,this),this.onAxisMoved=r(this.onAxisMoved,this)},init:function(){var t=this;this.animationActive="pointing",this.onButtonChanged=r(this.onButtonChanged,this),this.onButtonDown=function(e){c(e.detail.id,"down",t)},this.onButtonUp=function(e){c(e.detail.id,"up",t)},this.onButtonTouchStart=function(e){c(e.detail.id,"touchstart",t)},this.onButtonTouchEnd=function(e){c(e.detail.id,"touchend",t)},this.onAxisMoved=r(this.onAxisMoved,this),this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods(),this.checkControllerPresentAndSetup=o,this.emitIfAxesChanged=s},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("model-loaded",this.onModelLoaded),e.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("model-loaded",this.onModelLoaded),e.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,"Daydream Controller",{hand:this.data.hand})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var e=this.el,t=this.data;e.setAttribute("tracked-controls",{armModel:t.armModel,hand:t.hand,idPrefix:"Daydream Controller",orientationOffset:t.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:"https://cdn.aframe.io/controllers/google/vr_controller_daydream.obj",mtl:"https://cdn.aframe.io/controllers/google/vr_controller_daydream.mtl"})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(e){var t,n=e.detail.model;this.data.model&&((t=this.buttonMeshes={}).menu=n.getObjectByName("AppButton_AppButton_Cylinder.004"),t.system=n.getObjectByName("HomeButton_HomeButton_Cylinder.005"),t.trackpad=n.getObjectByName("TouchPad_TouchPad_Cylinder.003"),n.position.set(0,0,-.04))},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping.axes,e)},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];t&&this.el.emit(t+"changed",e.detail.state)},updateModel:function(e,t){this.data.model&&this.updateButtonModel(e,t)},updateButtonModel:function(e,t){var n=this.buttonMeshes;if(n&&n[e]){var i;switch(t){case"down":i=this.data.buttonHighlightColor;break;case"touchstart":i=this.data.buttonTouchedColor;break;default:i=this.data.buttonColor}n[e].material.color.set(i)}}})},{"../core/component":103,"../utils/bind":170,"../utils/tracked-controls":184}],56:[function(e,t,n){var i=e("../core/component").registerComponent,r=e("../utils/bind"),o=e("../utils/tracked-controls"),a=o.checkControllerPresentAndSetup,s=o.emitIfAxesChanged,c=o.onButtonEvent;t.exports.Component=i("gearvr-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=r(this.onModelLoaded,this),this.onControllersUpdate=r(this.onControllersUpdate,this),this.checkIfControllerPresent=r(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=r(this.removeControllersUpdateListener,this),this.onAxisMoved=r(this.onAxisMoved,this)},init:function(){var t=this;this.animationActive="pointing",this.onButtonChanged=r(this.onButtonChanged,this),this.onButtonDown=function(e){c(e.detail.id,"down",t)},this.onButtonUp=function(e){c(e.detail.id,"up",t)},this.onButtonTouchStart=function(e){c(e.detail.id,"touchstart",t)},this.onButtonTouchEnd=function(e){c(e.detail.id,"touchend",t)},this.onAxisMoved=r(this.onAxisMoved,this),this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods(),this.checkControllerPresentAndSetup=a,this.emitIfAxesChanged=s},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("model-loaded",this.onModelLoaded),e.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("model-loaded",this.onModelLoaded),e.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,"Gear VR",this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var e=this.el,t=this.data;e.setAttribute("tracked-controls",{armModel:t.armModel,idPrefix:"Gear VR",orientationOffset:t.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:"https://cdn.aframe.io/controllers/samsung/gear_vr_controller.obj",mtl:"https://cdn.aframe.io/controllers/samsung/gear_vr_controller.mtl"})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(e){var t,n=e.detail.model;this.data.model&&((t=this.buttonMeshes={}).trigger=n.children[2],t.trackpad=n.children[1])},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];t&&this.el.emit(t+"changed",e.detail.state)},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping.axes,e)},updateModel:function(e,t){this.data.model&&this.updateButtonModel(e,t)},updateButtonModel:function(e,t){var n=this.buttonMeshes;if(n&&n[e]){var i;switch(t){case"down":i=this.data.buttonHighlightColor;break;case"touchstart":i=this.data.buttonTouchedColor;break;default:i=this.data.buttonColor}n[e].material.color.set(i)}}})},{"../core/component":103,"../utils/bind":170,"../utils/tracked-controls":184}],57:[function(e,t,n){var r=e("../core/geometry").geometries,i=e("../core/geometry").geometryNames,o=e("../core/component").registerComponent,a=e("../lib/three"),s=new a.Geometry;t.exports.Component=o("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:i,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(e){var t,n=this.data,i=this.el,r=this.system;this.geometry&&(r.unuseGeometry(e),this.geometry=null),this.geometry=r.getOrCreateGeometry(n),(t=i.getObject3D("mesh"))?t.geometry=this.geometry:((t=new a.Mesh).geometry=this.geometry,i.setObject3D("mesh",t))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=s,this.geometry=null},updateSchema:function(e){var t=this.oldData&&this.oldData.primitive,n=e.primitive,i=r[n]&&r[n].schema;if(!i)throw new Error("Unknown geometry schema `"+n+"`");t&&t===n||this.extendSchema(i)}})},{"../core/component":103,"../core/geometry":104,"../lib/three":151}],58:[function(e,t,n){var i=e("../core/component").registerComponent,r=e("../lib/three"),o=e("../utils/").debug("components:gltf-model:warn");t.exports.Component=i("gltf-model",{schema:{type:"model"},init:function(){var e=this.system.getDRACOLoader();this.model=null,this.loader=new r.GLTFLoader,e&&this.loader.setDRACOLoader(e)},update:function(){var t=this,n=this.el,i=this.data;i&&(this.remove(),this.loader.load(i,function(e){t.model=e.scene||e.scenes[0],t.model.animations=e.animations,n.setObject3D("mesh",t.model),n.emit("model-loaded",{format:"gltf",model:t.model})},void 0,function(e){var t=e&&e.message?e.message:"Failed to load glTF model";o(t),n.emit("model-error",{format:"gltf",src:i})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../core/component":103,"../lib/three":151,"../utils/":176}],59:[function(e,t,n){var i=e("../core/component").registerComponent,r={left:"https://cdn.aframe.io/controllers/oculus-hands/v2/leftHand.json",right:"https://cdn.aframe.io/controllers/oculus-hands/v2/rightHand.json"},l={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},o={};function a(e,t){var n;if(e)return"grip"===(n=o[e])?n+(t?"close":"open"):"point"===n||"thumb"===n?n+(t?"up":"down"):"pointing"===n||"pistol"===n?n+(t?"start":"end"):void 0}o[l.fist]="grip",o[l.thumbUp]="pistol",o[l.point]="pointing",o[l.thumb]="thumb",t.exports.Component=i("hand-controls",{schema:{default:"left"},init:function(){var e=this,t=this.el;this.gesture=l.open,this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.ObjectLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){e.handleButton("grip","down")},this.onGripUp=function(){e.handleButton("grip","up")},this.onTrackpadDown=function(){e.handleButton("trackpad","down")},this.onTrackpadUp=function(){e.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){e.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){e.handleButton("trackpad","touchend")},this.onTriggerDown=function(){e.handleButton("trigger","down")},this.onTriggerUp=function(){e.handleButton("trigger","up")},this.onTriggerTouchStart=function(){e.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){e.handleButton("trigger","touchend")},this.onGripTouchStart=function(){e.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){e.handleButton("grip","touchend")},this.onThumbstickDown=function(){e.handleButton("thumbstick","down")},this.onThumbstickUp=function(){e.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){e.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){e.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){e.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){e.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){e.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){e.handleButton("surface","touchend")},t.addEventListener("controllerconnected",this.onControllerConnected),t.addEventListener("controllerdisconnected",this.onControllerDisconnected),t.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(e,t){var n=this.el.getObject3D("mesh");n&&n.mixer&&n.mixer.update(t/1e3)},addEventListeners:function(){var e=this.el;e.addEventListener("gripdown",this.onGripDown),e.addEventListener("gripup",this.onGripUp),e.addEventListener("trackpaddown",this.onTrackpadDown),e.addEventListener("trackpadup",this.onTrackpadUp),e.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),e.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),e.addEventListener("triggerdown",this.onTriggerDown),e.addEventListener("triggerup",this.onTriggerUp),e.addEventListener("triggertouchstart",this.onTriggerTouchStart),e.addEventListener("triggertouchend",this.onTriggerTouchEnd),e.addEventListener("griptouchstart",this.onGripTouchStart),e.addEventListener("griptouchend",this.onGripTouchEnd),e.addEventListener("thumbstickdown",this.onThumbstickDown),e.addEventListener("thumbstickup",this.onThumbstickUp),e.addEventListener("abuttontouchstart",this.onAorXTouchStart),e.addEventListener("abuttontouchend",this.onAorXTouchEnd),e.addEventListener("bbuttontouchstart",this.onBorYTouchStart),e.addEventListener("bbuttontouchend",this.onBorYTouchEnd),e.addEventListener("xbuttontouchstart",this.onAorXTouchStart),e.addEventListener("xbuttontouchend",this.onAorXTouchEnd),e.addEventListener("ybuttontouchstart",this.onBorYTouchStart),e.addEventListener("ybuttontouchend",this.onBorYTouchEnd),e.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),e.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var e=this.el;e.removeEventListener("gripdown",this.onGripDown),e.removeEventListener("gripup",this.onGripUp),e.removeEventListener("trackpaddown",this.onTrackpadDown),e.removeEventListener("trackpadup",this.onTrackpadUp),e.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),e.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),e.removeEventListener("triggerdown",this.onTriggerDown),e.removeEventListener("triggerup",this.onTriggerUp),e.removeEventListener("triggertouchstart",this.onTriggerTouchStart),e.removeEventListener("triggertouchend",this.onTriggerTouchEnd),e.removeEventListener("griptouchstart",this.onGripTouchStart),e.removeEventListener("griptouchend",this.onGripTouchEnd),e.removeEventListener("thumbstickdown",this.onThumbstickDown),e.removeEventListener("thumbstickup",this.onThumbstickUp),e.removeEventListener("abuttontouchstart",this.onAorXTouchStart),e.removeEventListener("abuttontouchend",this.onAorXTouchEnd),e.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),e.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),e.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),e.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),e.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),e.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),e.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),e.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(e){var n,i=this.el,t=this.data;n={hand:t,model:!1,orientationOffset:{x:0,y:0,z:"left"===t?90:-90}},t!==e&&this.loader.load(r[t],function(e){var t=e.getObjectByName("Hand");t.material.skinning=!0,t.mixer=new THREE.AnimationMixer(t),i.setObject3D("mesh",t),t.position.set(0,0,0),t.rotation.set(0,0,0),i.setAttribute("vive-controls",n),i.setAttribute("oculus-touch-controls",n),i.setAttribute("windows-motion-controls",n)})},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(e,t){var n,i="down"===t,r="touchstart"===t;if(0===t.indexOf("touch")){if(r===this.touchedButtons[e])return;this.touchedButtons[e]=r}else{if(i===this.pressedButtons[e])return;this.pressedButtons[e]=i}n=this.gesture,this.gesture=this.determineGesture(),this.gesture!==n&&(this.animateGesture(this.gesture,n),this.emitGestureEvents(this.gesture,n))},determineGesture:function(){var e,t,n,i=this.pressedButtons.grip,r=this.pressedButtons.surface||this.touchedButtons.surface,o=this.pressedButtons.trackpad||this.touchedButtons.trackpad,a=this.pressedButtons.trigger||this.touchedButtons.trigger,s=this.touchedButtons.AorX||this.touchedButtons.BorY,c=(n=(t=this.el.components["tracked-controls"])&&t.controller&&t.controller.id)&&0===n.indexOf("OpenVR ");return i?e=c?l.fist:r||s||o?a?l.fist:l.point:a?l.thumbUp:l.pointThumb:a?e=c?l.fist:l.hold:c&&o&&(e=l.point),e},animateGesture:function(e,t){e?this.playAnimation(e||l.open,t,!1):this.playAnimation(t,t,!0)},emitGestureEvents:function(e,t){var n,i=this.el;t!==e&&((n=a(t,!1))&&i.emit(n),(n=a(e,!0))&&i.emit(n))},playAnimation:function(e,t,n){var i,r,o=this.el.getObject3D("mesh");if(o){if((r=o.mixer.clipAction(e)).clampWhenFinished=!0,r.loop=THREE.LoopRepeat,r.repetitions=0,r.timeScale=n?-1:1,r.weight=1,!t||e===t)return o.mixer.stopAllAction(),void r.play();i=o.mixer.clipAction(t),o.mixer.stopAllAction(),i.weight=.15,i.play(),r.play(),i.crossFadeTo(r,.15,!0)}}})},{"../core/component":103}],60:[function(e,t,n){e("./animation"),e("./camera"),e("./cursor"),e("./daydream-controls"),e("./gearvr-controls"),e("./geometry"),e("./gltf-model"),e("./hand-controls"),e("./laser-controls"),e("./light"),e("./line"),e("./link"),e("./look-controls"),e("./material"),e("./obj-model"),e("./oculus-go-controls"),e("./oculus-touch-controls"),e("./position"),e("./raycaster"),e("./rotation"),e("./scale"),e("./shadow"),e("./sound"),e("./text"),e("./tracked-controls"),e("./tracked-controls-webvr"),e("./tracked-controls-webxr"),e("./visible"),e("./vive-controls"),e("./vive-focus-controls"),e("./wasd-controls"),e("./windows-motion-controls"),e("./scene/background"),e("./scene/debug"),e("./scene/embedded"),e("./scene/inspector"),e("./scene/fog"),e("./scene/keyboard-shortcuts"),e("./scene/pool"),e("./scene/screenshot"),e("./scene/stats"),e("./scene/vr-mode-ui")},{"./animation":52,"./camera":53,"./cursor":54,"./daydream-controls":55,"./gearvr-controls":56,"./geometry":57,"./gltf-model":58,"./hand-controls":59,"./laser-controls":61,"./light":62,"./line":63,"./link":64,"./look-controls":65,"./material":66,"./obj-model":67,"./oculus-go-controls":68,"./oculus-touch-controls":69,"./position":70,"./raycaster":71,"./rotation":72,"./scale":73,"./scene/background":74,"./scene/debug":75,"./scene/embedded":76,"./scene/fog":77,"./scene/inspector":78,"./scene/keyboard-shortcuts":79,"./scene/pool":80,"./scene/screenshot":81,"./scene/stats":82,"./scene/vr-mode-ui":83,"./shadow":84,"./sound":85,"./text":86,"./tracked-controls":89,"./tracked-controls-webvr":87,"./tracked-controls-webxr":88,"./visible":90,"./vive-controls":91,"./vive-focus-controls":92,"./wasd-controls":93,"./windows-motion-controls":94}],61:[function(e,t,n){var i=e("../core/component").registerComponent,s=e("../utils/");i("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var i=this.config,e=this.data,r=this.el,o=this,t=this.data.model&&!this.el.sceneEl.hasWebXR,n={hand:e.hand,model:t};function a(e){var t=i[e.detail.name];if(t){var n=s.extend({showLine:!0},t.raycaster||{});e.detail.rayOrigin&&(n.origin=e.detail.rayOrigin.origin,n.direction=e.detail.rayOrigin.direction,n.showLine=!0),e.detail.rayOrigin||!o.modelReady?r.setAttribute("raycaster",n):r.setAttribute("raycaster","showLine",!0),r.setAttribute("cursor",s.extend({fuse:!1},t.cursor))}}r.setAttribute("daydream-controls",n),r.setAttribute("gearvr-controls",n),r.setAttribute("oculus-go-controls",n),r.setAttribute("oculus-touch-controls",n),r.setAttribute("vive-controls",n),r.setAttribute("vive-focus-controls",n),r.setAttribute("windows-motion-controls",n),this.data.model&&this.el.sceneEl.hasWebXR&&this.initDefaultModel(),r.addEventListener("controllerconnected",a),r.addEventListener("controllerdisconnected",function(){r.setAttribute("raycaster","showLine",!1)}),r.addEventListener("controllermodelready",function(e){a(e),o.modelReady=!0})},config:{"daydream-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"gearvr-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}},initDefaultModel:function(){var e=this.modelEl=document.createElement("a-entity");e.setAttribute("geometry",{primitive:"sphere",radius:.03}),e.setAttribute("material",{color:this.data.color}),this.el.appendChild(e)}})},{"../core/component":103,"../utils/":176}],62:[function(e,t,n){var u=e("../utils/bind"),s=e("../utils").diff,i=e("../utils/debug"),r=e("../core/component").registerComponent,h=e("../lib/three"),d=h.Math.degToRad,p=i("components:light:warn");t.exports.Component=r("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color"},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var e=this.el;this.light=null,this.defaultTarget=null,this.rendererSystem=this.el.sceneEl.systems.renderer,this.system.registerLight(e)},update:function(e){var n=this.data,t=s(n,e),i=this.light,r=this.rendererSystem,o=this;if(!i||"type"in t)this.setLight(this.data),this.updateShadow();else{var a=!1;Object.keys(t).forEach(function(e){var t=n[e];switch(e){case"color":i.color.set(t),r.applyColorCorrection(i.color);break;case"groundColor":i.groundColor.set(t),r.applyColorCorrection(i.groundColor);break;case"angle":i.angle=d(t);break;case"target":null===t?"spot"!==n.type&&"directional"!==n.type||(i.target=o.defaultTarget):t.hasLoaded?o.onSetTarget(t,i):t.addEventListener("loaded",u(o.onSetTarget,o,t,i));break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":a||(o.updateShadow(),a=!0);break;default:i[e]=t}})}},setLight:function(e){var t=this.el,n=this.getLight(e);n&&(this.light&&t.removeObject3D("light"),this.light=n,(this.light.el=t).setObject3D("light",this.light),"spot"!==e.type&&"directional"!==e.type&&"hemisphere"!==e.type||t.getObject3D("light").translateY(-1),"spot"===e.type&&(t.setObject3D("light-target",this.defaultTarget),t.getObject3D("light-target").position.set(0,0,-1)))},updateShadow:function(){var e=this.el,t=this.data,n=this.light;n.castShadow=t.castShadow;var i=e.getObject3D("cameraHelper");if(t.shadowCameraVisible&&!i?e.setObject3D("cameraHelper",new h.CameraHelper(n.shadow.camera)):!t.shadowCameraVisible&&i&&e.removeObject3D("cameraHelper"),!t.castShadow)return n;n.shadow.bias=t.shadowBias,n.shadow.radius=t.shadowRadius,n.shadow.mapSize.height=t.shadowMapHeight,n.shadow.mapSize.width=t.shadowMapWidth,n.shadow.camera.near=t.shadowCameraNear,n.shadow.camera.far=t.shadowCameraFar,n.shadow.camera instanceof h.OrthographicCamera?(n.shadow.camera.top=t.shadowCameraTop,n.shadow.camera.right=t.shadowCameraRight,n.shadow.camera.bottom=t.shadowCameraBottom,n.shadow.camera.left=t.shadowCameraLeft):n.shadow.camera.fov=t.shadowCameraFov,n.shadow.camera.updateProjectionMatrix(),i&&i.update()},getLight:function(e){var t=e.angle,n=new h.Color(e.color);this.rendererSystem.applyColorCorrection(n),n=n.getHex();var i=e.decay,r=e.distance,o=new h.Color(e.groundColor);this.rendererSystem.applyColorCorrection(o),o=o.getHex();var a=e.intensity,s=e.type,c=e.target,l=null;switch(s.toLowerCase()){case"ambient":return new h.AmbientLight(n,a);case"directional":return l=new h.DirectionalLight(n,a),this.defaultTarget=l.target,c&&(c.hasLoaded?this.onSetTarget(c,l):c.addEventListener("loaded",u(this.onSetTarget,this,c,l))),l;case"hemisphere":return new h.HemisphereLight(n,o,a);case"point":return new h.PointLight(n,a,r,i);case"spot":return l=new h.SpotLight(n,a,r,d(t),e.penumbra,i),this.defaultTarget=l.target,c&&(c.hasLoaded?this.onSetTarget(c,l):c.addEventListener("loaded",u(this.onSetTarget,this,c,l))),l;default:p("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",s)}},onSetTarget:function(e,t){t.target=e.object3D},remove:function(){var e=this.el;e.removeObject3D("light"),e.getObject3D("cameraHelper")&&e.removeObject3D("cameraHelper")}})},{"../core/component":103,"../lib/three":151,"../utils":176,"../utils/bind":170,"../utils/debug":172}],63:[function(e,t,n){var i=e("../core/component").registerComponent;function a(e,t){return!(!e||!t)&&e.x===t.x&&e.y===t.y&&e.z===t.z}t.exports.Component=i("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var e,t,n=this.data;this.rendererSystem=this.el.sceneEl.systems.renderer,t=this.material=new THREE.LineBasicMaterial({color:n.color,opacity:n.opacity,transparent:n.opacity<1,visible:n.visible}),(e=this.geometry=new THREE.BufferGeometry).addAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.rendererSystem.applyColorCorrection(t.color),this.line=new THREE.Line(e,t),this.el.setObject3D(this.attrName,this.line)},update:function(e){var t=this.data,n=this.geometry,i=!1,r=this.material,o=n.attributes.position.array;a(t.start,e.start)||(o[0]=t.start.x,o[1]=t.start.y,o[2]=t.start.z,i=!0),a(t.end,e.end)||(o[3]=t.end.x,o[4]=t.end.y,o[5]=t.end.z,i=!0),i&&(n.attributes.position.needsUpdate=!0,n.computeBoundingSphere()),r.color.setStyle(t.color),this.rendererSystem.applyColorCorrection(r.color),r.opacity=t.opacity,r.transparent=t.opacity<1,r.visible=t.visible},remove:function(){this.el.removeObject3D("line",this.line)}})},{"../core/component":103}],64:[function(e,t,n){var i,r,o,a,s,c,l,u,h=e("../core/component").registerComponent,d=e("../core/shader").registerShader,p=e("../lib/three");t.exports.Component=h("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new p.Quaternion,this.hiddenEls=[]},update:function(e){var t,n,i=this.data,r=this.el;i.visualAspectEnabled&&(this.initVisualAspect(),t=i.highlighted?i.highlightedColor:i.backgroundColor,n=i.highlighted?i.highlightedColor:i.borderColor,r.setAttribute("material","backgroundColor",t),r.setAttribute("material","strokeColor",n),i.on!==e.on&&this.updateEventListener(),void 0!==e.peekMode&&i.peekMode!==e.peekMode&&this.updatePeekMode(),i.image&&e.image!==i.image&&r.setAttribute("material","pano","string"==typeof i.image?i.image:i.image.src))},updatePeekMode:function(){var e=this.el,t=this.sphereEl;this.data.peekMode?(this.hideAll(),e.getObject3D("mesh").visible=!1,t.setAttribute("visible",!0)):(this.showAll(),e.getObject3D("mesh").visible=!0,t.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var e=this.el;e.isPlaying&&(this.removeEventListener(),e.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var e=this.data.on;e&&this.el.removeEventListener(e,this.navigate)},initVisualAspect:function(){var e,t,n,i=this.el;this.data.visualAspectEnabled&&!this.visualAspectInitialized&&(n=this.textEl=this.textEl||document.createElement("a-entity"),t=this.sphereEl=this.sphereEl||document.createElement("a-entity"),e=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),i.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),i.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),n.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),n.setAttribute("position","0 1.5 0"),i.appendChild(n),e.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),e.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),e.setAttribute("rotation","0 180 0"),e.setAttribute("position","0 0 0"),e.setAttribute("visible",!1),i.appendChild(e),t.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),t.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),t.setAttribute("visible",!1),i.appendChild(t),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:(s=new p.Vector3,c=new p.Vector3,l=new p.Quaternion,u=new p.Vector3,function(){var e,t,n=this.el,i=n.object3D,r=n.sceneEl.camera,o=this.textEl;if(this.data.visualAspectEnabled)if(i.updateMatrixWorld(),r.parent.updateMatrixWorld(),r.updateMatrixWorld(),i.matrix.decompose(c,l,u),c.setFromMatrixPosition(i.matrixWorld),s.setFromMatrixPosition(r.matrixWorld),20<(t=c.distanceTo(s)))this.previousQuaternion||(this.quaternionClone.copy(l),this.previousQuaternion=this.quaternionClone),i.lookAt(s);else{if(e=this.calculateCameraPortalOrientation(),t<.5){if(!0===this.semiSphereEl.getAttribute("visible"))return;o.setAttribute("text","width",1.5),e<=0?(o.setAttribute("position","0 0 0.75"),o.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(o.setAttribute("position","0 0 -0.75"),o.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),n.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=e}else e<=0?o.setAttribute("rotation","0 180 0"):o.setAttribute("rotation","0 0 0"),o.setAttribute("text","width",5),o.setAttribute("position","0 1.5 0"),n.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(i.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}),hideAll:function(){var t=this.el,n=this.hiddenEls,i=this;0<n.length||t.sceneEl.object3D.traverse(function(e){e&&e.el&&e.el.hasAttribute("link-controls")||e.el&&e!==t.sceneEl.object3D&&e.el!==t&&e.el!==i.sphereEl&&e.el!==t.sceneEl.cameraEl&&!1!==e.el.getAttribute("visible")&&e.el!==i.textEl&&e.el!==i.semiSphereEl&&(e.el.setAttribute("visible",!1),n.push(e.el))})},showAll:function(){this.hiddenEls.forEach(function(e){e.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:(i=new p.Matrix4,r=new p.Vector3,o=new p.Vector3(0,0,1),a=new p.Vector3(0,0,0),function(){var e=this.el,t=e.sceneEl.camera;return r.set(0,0,0),o.set(0,0,1),a.set(0,0,0),e.object3D.matrixWorld.extractRotation(i),o.applyMatrix4(i),e.object3D.updateMatrixWorld(),e.object3D.localToWorld(a),t.parent.parent.updateMatrixWorld(),t.parent.updateMatrixWorld(),t.updateMatrixWorld(),t.localToWorld(r),r.sub(a).normalize(),o.normalize(),Math.sign(o.dot(r))}),remove:function(){this.removeEventListener()}}),d("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = saturate(direction.y * 0.5  + 0.5);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join("\n")})},{"../core/component":103,"../core/shader":113,"../lib/three":151}],65:[function(e,t,n){var a,i=e("../core/component").registerComponent,r=e("../lib/three"),o=e("../utils/").bind,s=e("../utils").device.PolyfillControls,c=Math.PI/2;t.exports.Component=i("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},hmdEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0}},init:function(){this.previousHMDPosition=new r.Vector3,this.hmdQuaternion=new r.Quaternion,this.hmdEuler=new r.Euler,this.position=new r.Vector3,this.savedRotation=new r.Vector3,this.savedPosition=new r.Vector3,this.polyfillObject=new r.Object3D,this.polyfillControls=new s(this.polyfillObject),this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.el.object3D.matrixAutoUpdate=!1,this.savedPose={position:new r.Vector3,rotation:new r.Euler},this.el.sceneEl.is("vr-mode")&&this.onEnterVR()},update:function(e){var t=this.data;t.enabled!==e.enabled&&this.updateGrabCursor(t.enabled),!e||t.hmdEnabled||e.hmdEnabled||(this.pitchObject.rotation.set(0,0,0),this.yawObject.rotation.set(0,0,0)),e&&!t.pointerLockEnabled!==e.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(e){this.data.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=o(this.onMouseDown,this),this.onMouseMove=o(this.onMouseMove,this),this.onMouseUp=o(this.onMouseUp,this),this.onTouchStart=o(this.onTouchStart,this),this.onTouchMove=o(this.onTouchMove,this),this.onTouchEnd=o(this.onTouchEnd,this),this.onEnterVR=o(this.onEnterVR,this),this.onExitVR=o(this.onExitVR,this),this.onPointerLockChange=o(this.onPointerLockChange,this),this.onPointerLockError=o(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new r.Object3D,this.yawObject=new r.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var e=this.el.sceneEl,t=e.canvas;t?(t.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),t.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd),e.addEventListener("enter-vr",this.onEnterVR),e.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))):e.addEventListener("render-target-loaded",o(this.addEventListeners,this))},removeEventListeners:function(){var e=this.el.sceneEl,t=e&&e.canvas;t&&(t.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),e.removeEventListener("enter-vr",this.onEnterVR),e.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:(a=new r.Matrix4,function(){var e,t=this.hmdEuler,n=this.el.object3D,i=this.pitchObject,r=this.yawObject,o=this.el.sceneEl;o.is("vr-mode")&&o.hasWebXR?(e=o.renderer.vr.getCameraPose())&&(a.elements=e.poseModelMatrix,a.decompose(n.position,n.rotation,n.scale)):n.updateMatrix(),o.is("vr-mode")&&o.checkHeadsetConnected()||(this.polyfillControls.update(),t.setFromQuaternion(this.polyfillObject.quaternion,"YXZ"),n.rotation.x=t.x+i.rotation.x,n.rotation.y=t.y+r.rotation.y)}),onMouseMove:function(e){var t,n,i,r=this.pitchObject,o=this.previousMouseEvent,a=this.yawObject;this.data.enabled&&(this.mouseDown||this.pointerLocked)&&(i=this.pointerLocked?(n=e.movementX||e.mozMovementX||0,e.movementY||e.mozMovementY||0):(n=e.screenX-o.screenX,e.screenY-o.screenY),this.previousMouseEvent=e,t=this.data.reverseMouseDrag?1:-1,a.rotation.y+=.002*n*t,r.rotation.x+=.002*i*t,r.rotation.x=Math.max(-c,Math.min(c,r.rotation.x)))},onMouseDown:function(e){if(this.data.enabled&&0===e.button){var t=this.el.sceneEl,n=t&&t.canvas;this.mouseDown=!0,this.previousMouseEvent=e,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(n.requestPointerLock?n.requestPointerLock():n.mozRequestPointerLock&&n.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(e){1===e.touches.length&&this.data.touchEnabled&&(this.touchStart={x:e.touches[0].pageX,y:e.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(e){var t,n,i=this.el.sceneEl.canvas,r=this.yawObject;this.touchStarted&&this.data.touchEnabled&&(n=2*Math.PI*(e.touches[0].pageX-this.touchStart.x)/i.clientWidth,t=this.data.reverseTouchDrag?1:-1,r.rotation.y-=.5*n*t,this.touchStart={x:e.touches[0].pageX,y:e.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.updateMatrix())},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0))},onPointerLockChange:function(){this.pointerLocked=!(!document.pointerLockElement&&!document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(e){var t=this.el.sceneEl;function n(){t.canvas.classList.add("a-grab-cursor")}function i(){t.canvas.classList.remove("a-grab-cursor")}t.canvas?e?n():i():e?t.addEventListener("render-target-loaded",n):t.addEventListener("render-target-loaded",i)},saveCameraPose:function(){var e=this.el;this.savedPose.position.copy(e.object3D.position),this.savedPose.rotation.copy(e.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var e=this.el,t=this.savedPose;this.hasSavedPose&&(e.object3D.position.copy(t.position),e.object3D.rotation.copy(t.rotation),this.hasSavedPose=!1)}})},{"../core/component":103,"../lib/three":151,"../utils":176,"../utils/":176}],66:[function(e,t,n){var i=e("../utils/"),r=e("../core/component"),o=e("../lib/three"),a=e("../core/shader"),s=i.debug("components:material:error"),c=r.registerComponent,l=a.shaders,u=a.shaderNames;function h(e,t){e.dispose(),t.unregisterMaterial(e)}t.exports.Component=c("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:u,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColors:{type:"string",default:"none",oneOf:["face","vertex"]},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]}},init:function(){this.material=null},update:function(e){var t=this.data;this.shader&&t.shader===e.shader||this.updateShader(t.shader),this.shader.update(this.data),this.updateMaterial(e)},updateSchema:function(e){var t,n,i,r;n=e&&e.shader,t=this.oldData&&this.oldData.shader,(i=l[r=n||t]&&l[r].schema)||s("Unknown shader schema "+r),t&&n===t||(this.extendSchema(i),this.updateBehavior())},updateBehavior:function(){var e,i,t=this.el.sceneEl,n=this.schema,r=this;function o(e,t){var n;for(n in i)i[n]=e;r.shader.update(i)}for(e in this.tick=void 0,i={},n)"time"===n[e].type&&(this.tick=o,i[e]=!0);t&&(this.tick?t.addBehavior(this):t.removeBehavior(this))},updateShader:function(e){var t,n=this.data,i=l[e]&&l[e].Shader;if(!i)throw new Error("Unknown shader "+e);(t=this.shader=new i).el=this.el,t.init(n),this.setMaterial(t.material),this.updateSchema(n)},updateMaterial:function(e){var t,n=this.data,i=this.material;for(t in i.alphaTest=n.alphaTest,i.depthTest=!1!==n.depthTest,i.depthWrite=!1!==n.depthWrite,i.opacity=n.opacity,i.flatShading=n.flatShading,i.side=function(){switch(n.side){case"back":return o.BackSide;case"double":return o.DoubleSide;default:return o.FrontSide}}(),i.transparent=!1!==n.transparent||n.opacity<1,i.vertexColors=function(){switch(n.vertexColors){case"face":return o.FaceColors;case"vertex":return o.VertexColors;default:return o.NoColors}}(),i.visible=n.visible,i.blending=function(){switch(n.blending){case"none":return o.NoBlending;case"additive":return o.AdditiveBlending;case"subtractive":return o.SubtractiveBlending;case"multiply":return o.MultiplyBlending;default:return o.NormalBlending}}(),e)break;!t||e.alphaTest===n.alphaTest&&e.side===n.side&&e.vertexColors===n.vertexColors||(i.needsUpdate=!0)},remove:function(){var e=new o.MeshBasicMaterial,t=this.material,n=this.el.getObject3D("mesh");n&&(n.material=e),h(t,this.system)},setMaterial:function(n){var e,i=this.el,t=this.system;this.material&&h(this.material,t),this.material=n,t.registerMaterial(n),(e=i.getObject3D("mesh"))?e.material=n:i.addEventListener("object3dset",function e(t){"mesh"===t.detail.type&&t.target===i&&(i.getObject3D("mesh").material=n,i.removeEventListener("object3dset",e))})}})},{"../core/component":103,"../core/shader":113,"../lib/three":151,"../utils/":176}],67:[function(e,t,n){var i=e("../utils/debug"),r=e("../core/component").registerComponent,s=e("../lib/three"),c=i("components:obj-model:warn");t.exports.Component=r("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){this.model=null,this.objLoader=new s.OBJLoader,this.mtlLoader=new s.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin=""},update:function(){var e=this.data;e.obj&&(this.resetMesh(),this.loadObj(e.obj,e.mtl))},remove:function(){this.model&&this.resetMesh()},resetMesh:function(){this.el.removeObject3D("mesh")},loadObj:function(t,e){var n=this,i=this.el,r=this.mtlLoader,o=this.objLoader,a=this.el.sceneEl.systems.renderer;if(e)return i.hasAttribute("material")&&c("Material component properties are ignored when a .MTL is provided"),r.setTexturePath(e.substr(0,e.lastIndexOf("/")+1)),void r.load(e,function(e){e.preload(),o.setMaterials(e),o.load(t,function(e){n.model=e,n.model.traverse(function(e){if(e.isMesh){var t=e.material;t.color&&a.applyColorCorrection(t.color),t.map&&a.applyColorCorrection(t.map),t.emissive&&a.applyColorCorrection(t.emissive),t.emissiveMap&&a.applyColorCorrection(t.emissiveMap)}}),i.setObject3D("mesh",e),i.emit("model-loaded",{format:"obj",model:e})})});o.load(t,function(e){var t=i.components.material;t&&e.traverse(function(e){e instanceof s.Mesh&&(e.material=t.material)}),n.model=e,i.setObject3D("mesh",e),i.emit("model-loaded",{format:"obj",model:e})})}})},{"../core/component":103,"../lib/three":151,"../utils/debug":172}],68:[function(e,t,n){var i=e("../core/component").registerComponent,r=e("../utils/bind"),o=e("../utils/tracked-controls"),a=o.checkControllerPresentAndSetup,s=o.emitIfAxesChanged,c=o.onButtonEvent;t.exports.Component=i("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},rotationOffset:{default:0},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=r(this.onModelLoaded,this),this.onControllersUpdate=r(this.onControllersUpdate,this),this.checkIfControllerPresent=r(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=r(this.removeControllersUpdateListener,this),this.onAxisMoved=r(this.onAxisMoved,this)},init:function(){var t=this;this.animationActive="pointing",this.onButtonChanged=r(this.onButtonChanged,this),this.onButtonDown=function(e){c(e.detail.id,"down",t)},this.onButtonUp=function(e){c(e.detail.id,"up",t)},this.onButtonTouchStart=function(e){c(e.detail.id,"touchstart",t)},this.onButtonTouchEnd=function(e){c(e.detail.id,"touchend",t)},this.onAxisMoved=r(this.onAxisMoved,this),this.controllerPresent=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods(),this.checkControllerPresentAndSetup=a,this.emitIfAxesChanged=s},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("model-loaded",this.onModelLoaded),e.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("model-loaded",this.onModelLoaded),e.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,"Oculus Go",this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var e=this.el,t=this.data;e.setAttribute("tracked-controls",{armModel:t.armModel,idPrefix:"Oculus Go",rotationOffset:t.rotationOffset}),this.data.model&&this.el.setAttribute("gltf-model","https://cdn.aframe.io/controllers/oculus/go/oculus-go-controller.gltf")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(e){var t,n=e.detail.model;this.data.model&&((t=this.buttonMeshes={}).trigger=n.getObjectByName("oculus_go_button_trigger"),t.trackpad=n.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];t&&this.el.emit(t+"changed",e.detail.state)},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping.axes,e)},updateModel:function(e,t){this.data.model&&this.updateButtonModel(e,t)},updateButtonModel:function(e,t){var n=this.buttonMeshes;if(n&&n[e]){var i,r;switch(t){case"down":i=this.data.buttonHighlightColor;break;case"touchstart":i=this.data.buttonTouchedColor;break;default:i=this.data.buttonColor}(r=n[e]).material.color.set(i),this.rendererSystem.applyColorCorrection(r.material.color)}}})},{"../core/component":103,"../utils/bind":170,"../utils/tracked-controls":184}],69:[function(e,t,n){var i=e("../utils/bind"),r=e("../core/component").registerComponent,o=e("../utils/tracked-controls"),a=e("../lib/three"),s=o.onButtonEvent,c={left:"https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-left.gltf",right:"https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-right.gltf"},l=new a.Vector3(0,0,-.053),u={left:{origin:{x:.008,y:-.004,z:0},direction:{x:0,y:-.8,z:-1}},right:{origin:{x:-.008,y:-.004,z:0},direction:{x:0,y:-.8,z:-1}}};t.exports.Component=r("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},mapping:{left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},bindMethods:function(){this.onModelLoaded=i(this.onModelLoaded,this),this.onControllersUpdate=i(this.onControllersUpdate,this),this.checkIfControllerPresent=i(this.checkIfControllerPresent,this),this.onAxisMoved=i(this.onAxisMoved,this)},init:function(){var t=this;this.onButtonChanged=i(this.onButtonChanged,this),this.onButtonDown=function(e){s(e.detail.id,"down",t,t.data.hand)},this.onButtonUp=function(e){s(e.detail.id,"up",t,t.data.hand)},this.onButtonTouchStart=function(e){s(e.detail.id,"touchstart",t,t.data.hand)},this.onButtonTouchEnd=function(e){s(e.detail.id,"touchend",t,t.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods(),this.emitIfAxesChanged=o.emitIfAxesChanged,this.checkControllerPresentAndSetup=o.checkControllerPresentAndSetup},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("axismove",this.onAxisMoved),e.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("axismove",this.onAxisMoved),e.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,"Oculus Touch",{hand:this.data.hand})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(){var e=this.data;e.model&&this.el.setAttribute("gltf-model","url("+c[e.hand]+")")},injectTrackedControls:function(){var e=this.data;this.el.setAttribute("tracked-controls",{id:"right"===e.hand?"Oculus Touch (Right)":"Oculus Touch (Left)",controller:0,hand:e.hand,orientationOffset:e.orientationOffset}),this.loadModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var t,n=this.mapping[this.data.hand].buttons[e.detail.id],i=this.buttonMeshes;n&&("trigger"!==n&&"grip"!==n||(t=e.detail.state.value),i&&("trigger"===n&&i.trigger&&(i.trigger.rotation.x=this.originalXRotationTrigger-t*(Math.PI/26)),"grip"===n&&i.grip&&(i.grip.position.x=this.originalXPositionGrip+("left"===this.data.hand?-1:1)*t*.004)),this.el.emit(n+"changed",e.detail.state))},onModelLoaded:function(e){var t,n=e.detail.model;this.data.model&&((t=this.buttonMeshes={}).grip=n.getObjectByName("buttonHand"),this.originalXPositionGrip=t.grip.position.x,t.thumbstick=n.getObjectByName("stick"),t.trigger=n.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=t.trigger.rotation.x,t.xbutton=n.getObjectByName("buttonX"),t.abutton=n.getObjectByName("buttonA"),t.ybutton=n.getObjectByName("buttonY"),t.bbutton=n.getObjectByName("buttonB"),n.position.copy(l),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:u[this.data.hand]}))},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping[this.data.hand].axes,e)},updateModel:function(e,t){this.data.model&&this.updateButtonModel(e,t)},updateButtonModel:function(e,t){var n,i="up"===t||"touchend"===t?this.data.buttonColor:"touchstart"===t?this.data.buttonTouchColor:this.data.buttonHighlightColor,r=this.buttonMeshes;this.data.model&&r&&r[e]&&((n=r[e]).material.color.set(i),this.rendererSystem.applyColorCorrection(n.material.color))}})},{"../core/component":103,"../lib/three":151,"../utils/bind":170,"../utils/tracked-controls":184}],70:[function(e,t,n){var i=e("../core/component").registerComponent;t.exports.Component=i("position",{schema:{type:"vec3"},update:function(){var e=this.el.object3D,t=this.data;e.position.set(t.x,t.y,t.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},{"../core/component":103}],71:[function(e,t,n){var i,r,o=e("../core/component").registerComponent,a=e("../lib/three"),s=e("../utils/").debug("components:raycaster:warn"),c=/^[\w\s-.,[\]#]*$/,l={childList:!0,attributes:!0,subtree:!0},h="raycaster-intersected",d="raycaster-intersection",p="raycaster-intersected-cleared",f="raycaster-intersection-cleared";function m(e,t){var n;for(e.length=t.length,n=0;n<t.length;n++)e[n]=t[n]}t.exports.Component=o("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new a.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new a.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new a.Vector3,this.otherLineEndVec3=new a.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(e){var t=this.data,n=this.el,i=this.raycaster;i.far=t.far,i.near=t.near,!t.showLine||t.far===e.far&&t.origin===e.origin&&t.direction===e.direction&&e.showLine||(this.unitLineEndVec3.copy(t.origin).add(t.direction).normalize(),this.drawLine()),!t.showLine&&e.showLine&&n.removeAttribute("line"),t.objects===e.objects||c.test(t.objects)||s('[raycaster] Selector "'+t.objects+'" may not update automatically with DOM changes.'),t.objects||s('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),t.autoRefresh!==e.autoRefresh&&n.isPlaying&&(t.autoRefresh?this.addEventListeners():this.removeEventListeners()),e.enabled&&!t.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,l),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var e,t=this.data;e=t.objects?this.el.sceneEl.querySelectorAll(t.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(e),this.dirty=!1},tick:function(e){var t=this.data,n=this.prevCheckTime;t.enabled&&(n&&e-n<t.interval||(this.prevCheckTime=e,this.checkIntersections()))},checkIntersections:function(){var e,t,n=this.clearedIntersectedEls,i=this.el,r=this.data,o=this.intersectedEls,a=this.intersections,s=this.newIntersectedEls,c=this.newIntersections,l=this.prevIntersectedEls,u=this.rawIntersections;for(this.dirty&&this.refreshObjects(),m(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),u.length=0,this.raycaster.intersectObjects(this.objects,!0,u),a.length=0,e=o.length=0;e<u.length;e++)t=u[e],r.showLine&&t.object===i.getObject3D("line")||t.object.el&&(a.push(t),o.push(t.object.el));for(c.length=0,e=s.length=0;e<a.length;e++)-1===l.indexOf(a[e].object.el)&&(c.push(a[e]),s.push(a[e].object.el));for(e=n.length=0;e<l.length;e++)-1===o.indexOf(l[e])&&(l[e].emit(p,this.intersectedClearedDetail),n.push(l[e]));for(n.length&&i.emit(f,this.intersectionClearedDetail),e=0;e<s.length;e++)s[e].emit(h,this.intersectedDetail);c.length&&(this.intersectionDetail.els=s,this.intersectionDetail.intersections=c,i.emit(d,this.intersectionDetail)),setTimeout(this.updateLine)},updateLine:function(){var e,t=this.el,n=this.intersections;this.data.showLine&&(n.length&&(e=n[0].object.el===t&&n[1]?n[1].distance:n[0].distance),this.drawLine(e))},getIntersection:function(e){var t,n;for(t=0;t<this.intersections.length;t++)if((n=this.intersections[t]).object.el===e)return n;return null},updateOriginDirection:(i=new a.Vector3,r=new a.Vector3,function(){var e=this.el,t=this.data;t.useWorldCoordinates?this.raycaster.set(t.origin,t.direction):(e.object3D.getWorldPosition(r),0===t.origin.x&&0===t.origin.y&&0===t.origin.z||(r=e.object3D.localToWorld(r.copy(t.origin))),i.copy(t.direction).transformDirection(e.object3D.matrixWorld).normalize(),this.raycaster.set(r,i))}),drawLine:function(e){var t,n=this.data,i=this.el;t=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,void 0===e&&(e=n.far===1/0?1e3:n.far),this.lineData.start=n.origin,this.lineData.end=t.copy(this.unitLineEndVec3).multiplyScalar(e),i.setAttribute("line",this.lineData)},flattenObject3DMaps:function(e){var t,n,i=this.objects;for(n=i.length=0;n<e.length;n++)if(e[n].isEntity&&e[n].object3D)for(t in e[n].object3DMap)i.push(e[n].getObject3D(t));return i},clearAllIntersections:function(){var e;for(e=0;e<this.intersectedEls.length;e++)this.intersectedEls[e].emit(p,this.intersectedClearedDetail);m(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(f,this.intersectionClearedDetail)}})},{"../core/component":103,"../lib/three":151,"../utils/":176}],72:[function(e,t,n){var i=e("../lib/three").Math.degToRad,r=e("../core/component").registerComponent;t.exports.Component=r("rotation",{schema:{type:"vec3"},update:function(){var e=this.data,t=this.el.object3D;t.rotation.set(i(e.x),i(e.y),i(e.z)),t.rotation.order="YXZ"},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},{"../core/component":103,"../lib/three":151}],73:[function(e,t,n){var i=e("../core/component").registerComponent;t.exports.Component=i("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var e=this.data,t=this.el.object3D,n=0===e.x?1e-5:e.x,i=0===e.y?1e-5:e.y,r=0===e.z?1e-5:e.z;t.scale.set(n,i,r)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},{"../core/component":103}],74:[function(e,t,n){var i=e("../../core/component").registerComponent;t.exports.Component=i("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},update:function(){var e=this.data,t=this.el.object3D;e.transparent?t.background=null:t.background=new THREE.Color(e.color)}})},{"../../core/component":103}],75:[function(e,t,n){var i=e("../../core/component").registerComponent;t.exports.Component=i("debug",{schema:{default:!0}})},{"../../core/component":103}],76:[function(e,t,n){var i=e("../../core/component").registerComponent;t.exports.Component=i("embedded",{dependencies:["vr-mode-ui"],schema:{default:!0},update:function(){var e=this.el,t=e.querySelector(".a-enter-vr");!0===this.data?(t&&t.classList.add("embedded"),e.removeFullScreenStyles()):(t&&t.classList.remove("embedded"),e.addFullScreenStyles())}})},{"../../core/component":103}],77:[function(e,t,n){var i=e("../../core/component").registerComponent,o=e("../../lib/three"),a=e("../../utils/debug")("components:fog:warn");t.exports.Component=i("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var e,t,n=this.data,i=this.el,r=this.el.object3D.fog;if(i.isScene)return r&&n.type===r.name?void Object.keys(this.schema).forEach(function(e){var t=n[e];"color"===e&&(t=new o.Color(t)),r[e]=t}):(i.object3D.fog=((t="exponential"===(e=n).type?new o.FogExp2(e.color,e.density):new o.Fog(e.color,e.near,e.far)).name=e.type,t),void i.systems.material.updateMaterials());a("Fog component can only be applied to <a-scene>")},remove:function(){var e=this.el.object3D.fog;e&&(e.far=0,e.near=.1)}})},{"../../core/component":103,"../../lib/three":151,"../../utils/debug":172}],78:[function(c,l,e){(function(e){var t,i=c("../../constants").AFRAME_INJECTED,n=c("../../../package"),r=c("../../core/component").registerComponent,o=c("../../utils/"),a="https://unpkg.com/aframe-inspector@"+((t=n.version.split("."))[2]="x",t.join("."))+"/dist/aframe-inspector.min.js",s="dev"===e.env.INSPECTOR_VERSION?"https://aframe.io/aframe-inspector/dist/aframe-inspector.js":a;l.exports.Component=r("inspector",{schema:{url:{default:s}},init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var e;this.firstPlay&&"false"!==(e=o.getUrlParameter("inspector"))&&e&&(this.openInspector(),this.firstPlay=!1)},initOverlay:function(){this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML='Loading Inspector<span class="dots"><span>.</span><span>.</span><span>.</span></span>'},remove:function(){this.removeEventListeners()},onKeydown:function(e){73===e.keyCode&&e.ctrlKey&&e.altKey&&this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(e){"INJECT_AFRAME_INSPECTOR"===e.data&&this.openInspector()},openInspector:function(e){var t,n=this;AFRAME.INSPECTOR||AFRAME.inspectorInjected?AFRAME.INSPECTOR.open(e):(this.showLoader(),(t=document.createElement("script")).src=this.data.url,t.setAttribute("data-name","aframe-inspector"),t.setAttribute(i,""),t.onload=function(){AFRAME.INSPECTOR.open(e),n.hideLoader(),n.removeEventListeners()},t.onerror=function(){n.loadingMessageEl.innerHTML="Error loading Inspector"},document.head.appendChild(t),AFRAME.inspectorInjected=!0)},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})}).call(this,c("_process"))},{"../../../package":51,"../../constants":95,"../../core/component":103,"../../utils/":176,_process:33}],79:[function(e,t,n){var i=e("../../core/component").registerComponent,r=e("../../utils/").shouldCaptureKeyEvent;t.exports.Component=i("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(e){var t=this.data;this.enterVREnabled=t.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(e){var t=this.el;r(e)&&(this.enterVREnabled&&70===e.keyCode&&t.enterVR(),this.enterVREnabled&&27===e.keyCode&&t.exitVR())}})},{"../../core/component":103,"../../utils/":176}],80:[function(e,t,n){var i=e("../../utils/debug"),r=e("../../core/component").registerComponent,o=i("components:pool:warn");t.exports.Component=r("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var e;for(this.availableEls=[],this.usedEls=[],this.data.mixin||o("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||o("Container "+this.data.container+" not found.")),this.container=this.container||this.el,e=0;e<this.data.size;++e)this.createEntity()},update:function(e){var t=this.data;e.mixin===t.mixin&&e.size===t.size||this.initPool()},createEntity:function(){var e;(e=document.createElement("a-entity")).play=this.wrapPlay(e.play),e.setAttribute("mixin",this.data.mixin),e.object3D.visible=!1,e.pause(),this.container.appendChild(e),this.availableEls.push(e)},wrapPlay:function(e){var t=this.usedEls;return function(){-1!==t.indexOf(this)&&e.call(this)}},requestEntity:function(){var e;if(0===this.availableEls.length){if(!1===this.data.dynamic)return void o("Requested entity from empty pool: "+this.attrName);o("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName),this.createEntity()}return e=this.availableEls.shift(),this.usedEls.push(e),e.object3D.visible=!0,e},returnEntity:function(e){var t=this.usedEls.indexOf(e);if(-1!==t)return this.usedEls.splice(t,1),this.availableEls.push(e),e.object3D.visible=!1,e.pause(),e;o("The returned entity was not previously pooled from "+this.attrName)}})},{"../../core/component":103,"../../utils/debug":172}],81:[function(e,t,n){var i=e("../../core/component").registerComponent,o=e("../../lib/three"),r=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),a=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join("\n");t.exports.Component=i("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){var t=this.el,n=this;function e(){var e=t.renderer.getContext();e&&(n.cubeMapSize=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),n.material=new o.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:r,fragmentShader:a,side:o.DoubleSide}),n.quad=new o.Mesh(new o.PlaneBufferGeometry(1,1),n.material),n.quad.visible=!1,n.camera=new o.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),n.canvas=document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),t.object3D.add(n.quad),n.onKeyDown=n.onKeyDown.bind(n))}t.renderer?e():t.addEventListener("render-target-loaded",e)},getRenderTarget:function(e,t){return new o.WebGLRenderTarget(e,t,{minFilter:o.LinearFilter,magFilter:o.LinearFilter,wrapS:o.ClampToEdgeWrapping,wrapT:o.ClampToEdgeWrapping,format:o.RGBAFormat,type:o.UnsignedByteType})},resize:function(e,t){this.quad.scale.set(e,t,1),this.camera.left=-1*e/2,this.camera.right=e/2,this.camera.top=t/2,this.camera.bottom=-1*t/2,this.camera.updateProjectionMatrix(),this.canvas.width=e,this.canvas.height=t},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(e){var t=83===e.keyCode&&e.ctrlKey&&e.altKey;if(this.data&&t){var n=e.shiftKey?"equirectangular":"perspective";this.capture(n)}},setCapture:function(e){var t,n,i,r=this.el;return"perspective"===e?(this.quad.visible=!1,n=this.data.camera&&this.data.camera.components.camera.camera||r.camera,t={width:this.data.width,height:this.data.height}):(n=this.camera,i=new o.CubeCamera(r.camera.near,r.camera.far,Math.min(this.cubeMapSize,2048)),r.camera.getWorldPosition(i.position),r.camera.getWorldQuaternion(i.quaternion),i.update(r.renderer,r.object3D),this.quad.material.uniforms.map.value=i.renderTarget.texture,t={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:n,size:t,projection:e}},capture:function(e){var t,n=this.el.renderer.vr.enabled,i=this.el.renderer;i.vr.enabled=!1,t=this.setCapture(e),this.renderCapture(t.camera,t.size,t.projection),this.saveCapture(),i.vr.enabled=n},getCanvas:function(e){var t=this.setCapture(e);return this.renderCapture(t.camera,t.size,t.projection),this.canvas},renderCapture:function(e,t,n){var i,r,o,a=this.el.renderer.autoClear,s=this.el,c=s.renderer;r=this.getRenderTarget(t.width,t.height),o=new Uint8Array(4*t.width*t.height),this.resize(t.width,t.height),c.autoClear=!0,c.render(s.object3D,e,r,!0),c.autoClear=a,c.readRenderTargetPixels(r,0,0,t.width,t.height,o),"perspective"===n&&(o=this.flipPixelsVertically(o,t.width,t.height)),i=new ImageData(new Uint8ClampedArray(o),t.width,t.height),this.quad.visible=!1,this.ctx.putImageData(i,0,0)},flipPixelsVertically:function(e,t,n){for(var i=e.slice(0),r=0;r<t;++r)for(var o=0;o<n;++o)i[4*r+o*t*4]=e[4*r+(n-o)*t*4],i[4*r+1+o*t*4]=e[4*r+1+(n-o)*t*4],i[4*r+2+o*t*4]=e[4*r+2+(n-o)*t*4],i[4*r+3+o*t*4]=e[4*r+3+(n-o)*t*4];return i},saveCapture:function(){this.canvas.toBlob(function(e){var t="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",n=document.createElement("a"),i=URL.createObjectURL(e);n.href=i,n.setAttribute("download",t),n.innerHTML="downloading...",n.style.display="none",document.body.appendChild(n),setTimeout(function(){n.click(),document.body.removeChild(n)},1)},"image/png")}})},{"../../core/component":103,"../../lib/three":151}],82:[function(e,t,n){var i=e("../../core/component").registerComponent,o=e("../../../vendor/rStats"),a=e("../../utils");e("../../../vendor/rStats.extras"),e("../../lib/rStatsAframe");var s=window.aframeStats,c=a.bind,l=window.threeStats;t.exports.Component=i("stats",{schema:{default:!0},init:function(){var e,t,n,i,r=this.el;"false"!==a.getUrlParameter("stats")&&(this.stats=(t=new l((e=r).renderer),n=new s(e),i=e.isMobile?[]:[t,n],new o({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:i})),this.statsEl=document.querySelector(".rs-base"),this.hideBound=c(this.hide,this),this.showBound=c(this.show,this),r.addEventListener("enter-vr",this.hideBound),r.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var e=this.stats;e&&(e("rAF").tick(),e("FPS").frame(),e().update())},hide:function(){this.statsEl.classList.add("a-hidden")},show:function(){this.statsEl.classList.remove("a-hidden")}})},{"../../../vendor/rStats":186,"../../../vendor/rStats.extras":185,"../../core/component":103,"../../lib/rStatsAframe":150,"../../utils":176}],83:[function(e,t,n){var i=e("../../core/component").registerComponent,o=e("../../constants/"),a=e("../../utils/"),r=a.bind,s="a-hidden";t.exports.Component=i("vr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},enterVRButton:{default:""}},init:function(){var t=this,e=this.el;"false"!==a.getUrlParameter("ui")&&(this.insideLoader=!1,this.enterVREl=null,this.orientationModalEl=null,this.bindMethods(),e.addEventListener("enter-vr",this.updateEnterVRInterface),e.addEventListener("exit-vr",this.updateEnterVRInterface),window.addEventListener("message",function(e){"loaderReady"===e.data.type&&(t.insideLoader=!0,t.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=r(this.onEnterVRButtonClick,this),this.onModalClick=r(this.onModalClick,this),this.toggleOrientationModalIfNeeded=r(this.toggleOrientationModalIfNeeded,this),this.updateEnterVRInterface=r(this.updateEnterVRInterface,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},update:function(){var t,e,n,i=this.data,r=this.el;if(!i.enabled||this.insideLoader||"false"===a.getUrlParameter("ui"))return this.remove();this.enterVREl||this.orientationModalEl||(i.enterVRButton?(this.enterVREl=document.querySelector(i.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=(t=this.onEnterVRButtonClick,(n=document.createElement("div")).classList.add("a-enter-vr"),n.setAttribute(o.AFRAME_INJECTED,""),(e=document.createElement("button")).className="a-enter-vr-button",e.setAttribute("title","Enter VR mode with a headset or fullscreen mode on a desktop. Visit https://webvr.rocks or https://webvr.info for more information."),e.setAttribute(o.AFRAME_INJECTED,""),n.appendChild(e),e.addEventListener("click",function(e){t(),e.stopPropagation()}),n),r.appendChild(this.enterVREl)),this.orientationModalEl=function(e){var t=document.createElement("div");t.className="a-orientation-modal",t.classList.add(s),t.setAttribute(o.AFRAME_INJECTED,"");var n=document.createElement("button");return n.setAttribute(o.AFRAME_INJECTED,""),n.innerHTML="Exit VR",n.addEventListener("click",e),t.appendChild(n),t}(this.onModalClick),r.appendChild(this.orientationModalEl),this.updateEnterVRInterface())},remove:function(){[this.enterVREl,this.orientationModalEl].forEach(function(e){e&&e.parentNode&&e.parentNode.removeChild(e)})},updateEnterVRInterface:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var e=this.el;this.enterVREl&&(e.is("vr-mode")?this.enterVREl.classList.add(s):this.enterVREl.classList.remove(s))},toggleOrientationModalIfNeeded:function(){var e=this.el,t=this.orientationModalEl;t&&e.isMobile&&(!a.device.isLandscape()&&e.is("vr-mode")?t.classList.remove(s):t.classList.add(s))}})},{"../../constants/":95,"../../core/component":103,"../../utils/":176}],84:[function(e,t,n){var i=e("../core/component"),a=e("../lib/three"),r=e("../utils/bind"),o=i.registerComponent;t.exports.Component=o("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=r(this.update,this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var e=this.data;this.updateDescendants(e.cast,e.receive)},remove:function(){this.el.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(i,r){var o=this.el.sceneEl;this.el.object3D.traverse(function(e){if(e instanceof a.Mesh&&(e.castShadow=i,e.receiveShadow=r,o.hasLoaded&&e.material))for(var t=Array.isArray(e.material)?e.material:[e.material],n=0;n<t.length;n++)t[n].needsUpdate=!0})}})},{"../core/component":103,"../lib/three":151,"../utils/bind":170}],85:[function(e,t,n){var i=e("../core/component").registerComponent,r=e("../utils/debug"),a=e("../lib/three"),o=r("components:sound:warn");t.exports.Component=i("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var e=this;this.listener=null,this.audioLoader=new a.AudioLoader,this.pool=new a.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){e.playSound()}},update:function(e){var t,n,i=this.data,r=i.src!==e.src;if(r){if(!i.src)return;this.setupSound()}for(t=0;t<this.pool.children.length;t++)n=this.pool.children[t],i.positional&&(n.setDistanceModel(i.distanceModel),n.setMaxDistance(i.maxDistance),n.setRefDistance(i.refDistance),n.setRolloffFactor(i.rolloffFactor)),n.setLoop(i.loop),n.setVolume(i.volume),n.isPaused=!1;if(i.on!==e.on&&this.updateEventListener(e.on),r){var o=this;this.loaded=!1,this.audioLoader.load(i.src,function(e){for(t=0;t<o.pool.children.length;t++)(n=o.pool.children[t]).setBuffer(e);o.loaded=!0,a.Cache.remove(i.src),(o.data.autoplay||o.mustPlay)&&o.playSound(),o.el.emit("sound-loaded",o.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var e;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(e=0;e<this.pool.children.length;e++)this.pool.children[e].disconnect()}catch(e){o("Audio source not properly disconnected")}},updateEventListener:function(e){var t=this.el;e&&t.removeEventListener(e,this.playSoundBound),t.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var e,t,n=this,i=this.el,r=i.sceneEl;0<this.pool.children.length&&(this.stopSound(),i.removeObject3D("sound"));var o=this.listener=r.audioListener||new a.AudioListener;for(r.audioListener=o,r.camera&&r.camera.add(o),r.addEventListener("camera-set-active",function(e){e.detail.cameraEl.getObject3D("camera").add(o)}),this.pool=new a.Group,e=0;e<this.data.poolSize;e++)t=this.data.positional?new a.PositionalAudio(o):new a.Audio(o),this.pool.add(t);for(i.setObject3D(this.attrName,this.pool),e=0;e<this.pool.children.length;e++)(t=this.pool.children[e]).onEnded=function(){this.isPlaying=!1,i.emit("sound-ended",n.evtDetail,!1)}},pauseSound:function(){var e,t;for(this.isPlaying=!1,e=0;e<this.pool.children.length;e++)(t=this.pool.children[e]).source&&t.source.buffer&&t.isPlaying&&!t.isPaused&&(t.isPaused=!0,t.pause())},playSound:function(e){var t,n,i;if(!this.loaded)return o("Sound not loaded yet. It will be played once it finished loading"),void(this.mustPlay=!0);for(t=!1,this.isPlaying=!0,n=0;n<this.pool.children.length;n++)(i=this.pool.children[n]).isPlaying||!i.buffer||t||(e&&e(i),i.play(),t=!(i.isPaused=!1));t?this.mustPlay=!1:o("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el)},stopSound:function(){var e,t;for(this.isPlaying=!1,e=0;e<this.pool.children.length;e++){if(!(t=this.pool.children[e]).source||!t.source.buffer)return;t.stop()}}})},{"../core/component":103,"../lib/three":151,"../utils/debug":172}],86:[function(e,t,n){var i=e("three-bmfont-text"),h=e("load-bmfont"),r=e("../core/component").registerComponent,o=e("../core/shader"),d=e("../lib/three"),a=e("../utils/"),p=a.debug("components:text:error"),u=o.shaders,f=a.debug("components:text:warn"),s="https://cdn.aframe.io/fonts/",m={aileronsemibold:s+"Aileron-Semibold.fnt",dejavu:s+"DejaVu-sdf.fnt",exo2bold:s+"Exo2Bold.fnt",exo2semibold:s+"Exo2SemiBold.fnt",kelsonsans:s+"KelsonSans.fnt",monoid:s+"Monoid.fnt",mozillavr:s+"mozillavr.fnt",roboto:s+"Roboto-msdf.json",sourcecodepro:s+"SourceCodePro.fnt"},v=["roboto"];t.exports.FONTS=m;var c,l,g,y,A=new function(){var n=this.cache={};this.get=function(e,t){return e in n||(n[e]=t()),n[e]}},b={},w={},x=/^\w+:/;function E(e,t,n){return e||(.5+t)*n}t.exports.Component=r("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:"roboto"},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:u},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=i(),this.createOrUpdateMaterial(),this.mesh=new d.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh)},update:function(e){var t=this.data,n=this.currentFont;w[t.font]?this.texture=w[t.font]:(this.texture=w[t.font]=new d.Texture,this.texture.anisotropy=16),this.createOrUpdateMaterial(),e.font===t.font?n&&(this.updateGeometry(this.geometry,n),this.updateLayout()):this.updateFont()},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var e,t,n,i,r,o,a,s=this.data,c=this.material,l=this.shaderData;if(n=s.shader,-1!==v.indexOf(s.font)||0<=s.font.indexOf("-msdf.")?n="msdf":s.font in m&&-1===v.indexOf(s.font)&&(n="sdf"),e=(this.shaderObject&&this.shaderObject.name)!==n,l.alphaTest=s.alphaTest,l.color=s.color,l.map=this.texture,l.opacity=s.opacity,l.side=function(){switch(s.side){case"back":return d.FrontSide;case"double":return d.DoubleSide;default:return d.BackSide}}(),l.transparent=s.transparent,l.negate=s.negate,!e)return this.shaderObject.update(l),c.transparent=l.transparent,void(c.side=l.side);i=this.el,r=l,(a=new u[n].Shader).el=i,a.init(r),a.update(r),(o=a.material).transparent=r.transparent,t={material:o,shader:a},this.material=t.material,this.shaderObject=t.shader,this.material.side=l.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var a,s=this.data,c=this.el,l=this.geometry,u=this;s.font||f("No font specified. Using the default font."),this.mesh.visible=!1,a=this.lookupFont(s.font||"roboto")||s.font,A.get(a,function(){return r=a,o=s.yOffset,new Promise(function(n,i){h(r,function(e,t){if(e)return p("Error loading font",r),void i(e);0<=r.indexOf("/Roboto-msdf.json")&&(o=30),o&&t.chars.map(function(e){e.yoffset+=o}),n(t)})});var r,o}).then(function(n){var e,t,i,r,o;if(1!==n.pages.length)throw new Error("Currently only single-page bitmap fonts are supported.");b[a]||(n.widthFactor=b[n]=(o=r=i=0,(t=n).chars.map(function(e){i+=e.xadvance,48<=e.id&&e.id<=57&&(o++,r+=e.xadvance)}),o?r/o:i/t.chars.length)),u.updateGeometry(l,n),u.currentFont=n,u.updateLayout(),e=u.getFontImageSrc(),A.get(e,function(){return n=e,new Promise(function(t,e){(new d.ImageLoader).load(n,function(e){t(e)},void 0,function(){p("Error loading font image",n),e(null)})});var n}).then(function(e){var t=u.texture;t.image=e,t.needsUpdate=!0,w[s.font]=t,u.texture=t,u.mesh.visible=!0,c.emit("textfontset",{font:s.font,fontObj:n})}).catch(function(e){p(e.message),p(e.stack)})}).catch(function(e){p(e.message),p(e.stack)})},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var e=this.lookupFont(this.data.font||"roboto")||this.data.font,t=this.currentFont.pages[0];return t.match(x)&&0!==t.indexOf("http")?e.replace(/(\.fnt)|(\.json)/,".png"):d.LoaderUtils.extractUrlBase(e)+t},updateLayout:function(){var e,t,n,i,r,o,a,s,c,l=this.el,u=this.data,h=this.geometry,d=this.mesh;if(h.layout){if(n=l.getAttribute("geometry"),i=(o=(a=u.width||n&&n.width||1)/E(u.wrapPixels,u.wrapCount,this.currentFont.widthFactor))*((r=h.layout).height+r.descender),n&&"plane"===n.primitive&&(n.width||l.setAttribute("geometry","width",a),n.height||l.setAttribute("geometry","height",i)),"left"===(e="align"===u.anchor?u.align:u.anchor))s=0;else if("right"===e)s=-1*r.width;else{if("center"!==e)throw new TypeError("Invalid text.anchor property value",e);s=-1*r.width/2}if("bottom"===(t=u.baseline))c=0;else if("top"===t)c=-1*r.height+r.ascender;else{if("center"!==t)throw new TypeError("Invalid text.baseline property value",t);c=-1*r.height/2}d.position.x=s*o+u.xOffset,d.position.y=c*o,d.position.z=u.zOffset,d.scale.set(o,-1*o,o)}},lookupFont:function(e){return m[e]},updateGeometry:(c={},l={},g=/\\n/g,y=/\\t/g,function(e,t){var n=this.data;l.font=t,l.lineHeight=n.lineHeight&&isFinite(n.lineHeight)?n.lineHeight:t.common.lineHeight,l.text=n.value.toString().replace(g,"\n").replace(y,"\t"),l.width=E(n.wrapPixels,n.wrapCount,t.widthFactor),e.update(a.extend(c,n,l))})})},{"../core/component":103,"../core/shader":113,"../lib/three":151,"../utils/":176,"load-bmfont":24,"three-bmfont-text":41}],87:[function(e,t,n){var i=e("../core/component").registerComponent,r=e("../utils/tracked-controls"),o=e("../constants").DEFAULT_CAMERA_HEIGHT,a=e("../lib/three"),l=e("../constants").DEFAULT_HANDEDNESS,u=.175,h=-.3,d=-.03,p=0,f=0,m=-.175,s={touches:[]},c="axismove",v="buttonchanged",g="buttondown",y="buttonup",A="touchstart",b="touchend";t.exports.Component=i("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!0},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new a.Vector3,this.controllerQuaternion=new a.Quaternion,this.controllerEuler=new a.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(e,t){var n=this.el.getObject3D("mesh");n&&n.update&&n.update(t/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return o},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var e=this.data,t=r.findMatchingControllerWebVR(this.system.controllers,e.id,e.idPrefix,e.hand,e.controller);this.controller=t,this.el.components["tracked-controls"].controller=t,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(e){var t,n,i,r,o=this.controller,a=this.controllerEuler,s=this.controllerQuaternion,c=this.deltaControllerPosition;n=this.getHeadElement().object3D,r=this.defaultUserHeight(),i=o.pose,t=(o?o.hand:void 0)||l,e.copy(n.position),c.set(u*("left"===t?-1:"right"===t?1:0),h,d),c.multiplyScalar(r),c.applyAxisAngle(n.up,n.rotation.y),e.add(c),c.set(p,f,m),c.multiplyScalar(r),i.orientation?s.fromArray(i.orientation):s.copy(n.quaternion),a.setFromQuaternion(s),a.set(a.x,a.y,0),c.applyEuler(a),e.add(c)},updatePose:function(){var e,t,n=this.controller,i=this.data,r=this.el.object3D,o=this.system.vrDisplay;n&&((e=n.pose).position?r.position.fromArray(e.position):i.armModel&&this.applyArmModel(r.position),e.orientation&&r.quaternion.fromArray(e.orientation),o&&e.position&&(t=this.el.sceneEl.renderer.vr.getStandingMatrix(),r.matrix.compose(r.position,r.quaternion,r.scale),r.matrix.multiplyMatrices(t,r.matrix),r.matrix.decompose(r.position,r.quaternion,r.scale)),r.rotateX(this.data.orientationOffset.x*a.Math.DEG2RAD),r.rotateY(this.data.orientationOffset.y*a.Math.DEG2RAD),r.rotateZ(this.data.orientationOffset.z*a.Math.DEG2RAD))},updateButtons:function(){var e,t,n=this.controller;if(n){for(t=0;t<n.buttons.length;++t)this.buttonStates[t]||(this.buttonStates[t]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[t]||(this.buttonEventDetails[t]={id:t,state:this.buttonStates[t]}),e=n.buttons[t],this.handleButton(t,e);this.handleAxes()}},handleButton:function(e,t){return!!(this.handlePress(e,t)|this.handleTouch(e,t)|this.handleValue(e,t))&&(this.el.emit(v,this.buttonEventDetails[e],!1),!0)},handleAxes:function(){var e,t=!1,n=this.controller.axes,i=this.axis,r=this.changedAxes;for(e=this.changedAxes.length=0;e<n.length;++e)r.push(i[e]!==n[e]),r[e]&&(t=!0);if(!t)return!1;for(e=this.axis.length=0;e<n.length;e++)this.axis.push(n[e]);return this.el.emit(c,this.axisMoveEventDetail,!1),!0},handlePress:function(e,t){var n,i=this.buttonStates[e];return t.pressed!==i.pressed&&(n=t.pressed?g:y,this.el.emit(n,this.buttonEventDetails[e],!1),i.pressed=t.pressed,!0)},handleTouch:function(e,t){var n,i=this.buttonStates[e];return t.touched!==i.touched&&(n=t.touched?A:b,this.el.emit(n,this.buttonEventDetails[e],!1,s),i.touched=t.touched,!0)},handleValue:function(e,t){var n=this.buttonStates[e];return t.value!==n.value&&(n.value=t.value,!0)}})},{"../constants":95,"../core/component":103,"../lib/three":151,"../utils/tracked-controls":184}],88:[function(e,t,n){var i=e("../utils/tracked-controls"),r=e("../core/component").registerComponent;t.exports.Component=r("tracked-controls-webxr",{schema:{hand:{type:"string",default:""}},init:function(){this.addSessionEventListeners=this.addSessionEventListeners.bind(this),this.updateController=this.updateController.bind(this),this.emitButtonUpEvent=this.emitButtonUpEvent.bind(this),this.emitButtonDownEvent=this.emitButtonDownEvent.bind(this),this.buttonEventDetails={id:"trigger",state:{pressed:!1}}},play:function(){var e=this.el.sceneEl;this.updateController(),this.addSessionEventListeners(),e.addEventListener("enter-vr",this.addSessionEventListeners),e.addEventListener("controllersupdated",this.updateController)},pause:function(){var e=this.el.sceneEl;this.removeSessionEventListeners(),e.removeEventListener("enter-vr",this.addSessionEventListeners),e.removeEventListener("controllersupdated",this.updateController)},addSessionEventListeners:function(){var e=this.el.sceneEl;e.xrSession&&(e.xrSession.addEventListener("selectstart",this.emitButtonDownEvent),e.xrSession.addEventListener("selectend",this.emitButtonUpEvent))},removeSessionEventListeners:function(){var e=this.el.sceneEl;e.xrSession&&(e.xrSession.addEventListener("selectstart",this.emitButtonDownEvent),e.xrSession.addEventListener("selectend",this.emitButtonUpEvent))},emitButtonDownEvent:function(e){this.controller&&e.inputSource.handedness===this.data.hand&&(this.buttonEventDetails.state.pressed=!0,this.el.emit("buttondown",this.buttonEventDetails),this.el.emit("buttonchanged",this.buttonEventDetails),this.el.emit("triggerdown"))},emitButtonUpEvent:function(e){this.controller&&e.inputSource.handedness===this.data.hand&&(this.buttonEventDetails.state.pressed=!1,this.el.emit("buttonup",this.buttonEventDetails),this.el.emit("buttonchanged",this.buttonEventDetails),this.el.emit("triggerup"))},updateController:function(){this.controller=i.findMatchingControllerWebXR(this.system.controllers,this.data.hand),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var e,t=this.el.sceneEl,n=this.el.object3D;this.controller&&t.frame&&(e=t.frame.getInputPose(this.controller,t.frameOfReference))&&(n.matrix.elements=e.targetRay.transformMatrix,n.matrix.decompose(n.position,n.rotation,n.scale))}})},{"../core/component":103,"../utils/tracked-controls":184}],89:[function(e,t,n){var i=e("../core/component").registerComponent;t.exports.Component=i("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!0},headElement:{type:"selector"}},update:function(){var e=this.data,t=this.el;t.sceneEl.hasWebXR?t.setAttribute("tracked-controls-webxr",e):t.setAttribute("tracked-controls-webvr",e)}})},{"../core/component":103}],90:[function(e,t,n){var i=e("../core/component").registerComponent;t.exports.Component=i("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},{"../core/component":103}],91:[function(e,t,n){var i=e("../core/component").registerComponent,r=e("../utils/").bind,o=e("../utils/tracked-controls"),a=o.checkControllerPresentAndSetup,s=o.emitIfAxesChanged,c=o.onButtonEvent;t.exports.Component=i("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},init:function(){var t=this;this.animationActive="pointing",this.checkControllerPresentAndSetup=a,this.controllerPresent=!1,this.emitIfAxesChanged=s,this.lastControllerCheck=0,this.onButtonChanged=r(this.onButtonChanged,this),this.onButtonDown=function(e){c(e.detail.id,"down",t)},this.onButtonUp=function(e){c(e.detail.id,"up",t)},this.onButtonTouchEnd=function(e){c(e.detail.id,"touchend",t)},this.onButtonTouchStart=function(e){c(e.detail.id,"touchstart",t)},this.onAxisMoved=r(this.onAxisMoved,this),this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=r(this.onModelLoaded,this),this.onControllersUpdate=r(this.onControllersUpdate,this),this.checkIfControllerPresent=r(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=r(this.removeControllersUpdateListener,this),this.onAxisMoved=r(this.onAxisMoved,this)},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("model-loaded",this.onModelLoaded),e.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("model-loaded",this.onModelLoaded),e.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var e=this.data,t="right"===e.hand?0:"left"===e.hand?1:2;this.checkControllerPresentAndSetup(this,"OpenVR ",{index:t})},injectTrackedControls:function(){var e=this.el,t=this.data;e.setAttribute("tracked-controls",{idPrefix:"OpenVR ",controller:"right"===t.hand?0:"left"===t.hand?1:2,hand:t.hand,orientationOffset:t.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:"https://cdn.aframe.io/controllers/vive/vr_controller_vive.obj",mtl:"https://cdn.aframe.io/controllers/vive/vr_controller_vive.mtl"})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var t,n=this.mapping.buttons[e.detail.id],i=this.buttonMeshes;n&&("trigger"===n&&(t=e.detail.state.value,i&&i.trigger&&(i.trigger.rotation.x=-t*(Math.PI/12))),this.el.emit(n+"changed",e.detail.state))},onModelLoaded:function(e){var t,n=e.detail.model,i=this;this.data.model&&((t=this.buttonMeshes={}).grip={left:n.getObjectByName("leftgrip"),right:n.getObjectByName("rightgrip")},t.menu=n.getObjectByName("menubutton"),t.system=n.getObjectByName("systembutton"),t.trackpad=n.getObjectByName("touchpad"),t.trigger=n.getObjectByName("trigger"),Object.keys(t).forEach(function(e){i.setButtonColor(e,i.data.buttonColor)}),n.position.set(0,-.015,.04))},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping.axes,e)},updateModel:function(e,t){var n;this.data.model&&(-1!==t.indexOf("touch")||(n="up"===t?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(e,n)))},setButtonColor:function(e,t){var n=this.buttonMeshes,i=this.rendererSystem;if(n){if("grip"===e)return n.grip.left.material.color.set(t),n.grip.right.material.color.set(t),i.applyColorCorrection(n.grip.left.material.color),void i.applyColorCorrection(n.grip.right.material.color);n[e].material.color.set(t),i.applyColorCorrection(n[e].material.color)}}})},{"../core/component":103,"../utils/":176,"../utils/tracked-controls":184}],92:[function(e,t,n){var i=e("../core/component").registerComponent,r=e("../utils/bind"),o=e("../utils/tracked-controls"),a=o.checkControllerPresentAndSetup,s=o.emitIfAxesChanged,c=o.onButtonEvent;t.exports.Component=i("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},rotationOffset:{default:0},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trigger","trackpad"]},bindMethods:function(){this.onModelLoaded=r(this.onModelLoaded,this),this.onControllersUpdate=r(this.onControllersUpdate,this),this.checkIfControllerPresent=r(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=r(this.removeControllersUpdateListener,this),this.onAxisMoved=r(this.onAxisMoved,this)},init:function(){var t=this;this.animationActive="pointing",this.onButtonChanged=r(this.onButtonChanged,this),this.onButtonDown=function(e){c(e.detail.id,"down",t)},this.onButtonUp=function(e){c(e.detail.id,"up",t)},this.onButtonTouchStart=function(e){c(e.detail.id,"touchstart",t)},this.onButtonTouchEnd=function(e){c(e.detail.id,"touchend",t)},this.onAxisMoved=r(this.onAxisMoved,this),this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods(),this.checkControllerPresentAndSetup=a,this.emitIfAxesChanged=s},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("model-loaded",this.onModelLoaded),e.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("model-loaded",this.onModelLoaded),e.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,"HTC Vive Focus",this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var e=this.el,t=this.data;e.setAttribute("tracked-controls",{armModel:t.armModel,idPrefix:"HTC Vive Focus",rotationOffset:t.rotationOffset}),this.data.model&&this.el.setAttribute("gltf-model","https://cdn.aframe.io/controllers/vive/focus-controller/focus-controller.gltf")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(e){var t,n=e.detail.model;this.data.model&&((t=this.buttonMeshes={}).trigger=n.getObjectByName("BumperKey"),t.triggerPressed=n.getObjectByName("BumperKey_Press"),t.triggerPressed&&(t.triggerPressed.visible=!1),t.trackpad=n.getObjectByName("TouchPad"),t.trackpadPressed=n.getObjectByName("TouchPad_Press"),t.trackpadPressed&&(t.trackpadPressed.visible=!1))},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];t&&this.el.emit(t+"changed",e.detail.state)},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping.axes,e)},updateModel:function(e,t){this.data.model&&this.updateButtonModel(e,t)},updateButtonModel:function(e,t){var n=this.buttonMeshes,i=e+"Pressed";if(n&&n[e]&&n[i]){var r;switch(t){case"down":r=this.data.buttonHighlightColor;break;case"touchstart":r=this.data.buttonTouchedColor}r&&n[i].material.color.set(r),n[i].visible=!!r,n[e].visible=!r}}})},{"../core/component":103,"../utils/bind":170,"../utils/tracked-controls":184}],93:[function(e,t,n){var r,o,i=e("../constants").keyboardevent.KEYCODE_TO_CODE,a=e("../core/component").registerComponent,s=e("../lib/three"),c=e("../utils/"),l=c.bind,u=c.shouldCaptureKeyEvent,h=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];t.exports.Component=a("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={},this.easing=1.1,this.velocity=new s.Vector3,this.onBlur=l(this.onBlur,this),this.onFocus=l(this.onFocus,this),this.onKeyDown=l(this.onKeyDown,this),this.onKeyUp=l(this.onKeyUp,this),this.onVisibilityChange=l(this.onVisibilityChange,this),this.attachVisibilityEventListeners()},tick:function(e,t){var n=this.data,i=this.el,r=this.velocity;!r[n.adAxis]&&!r[n.wsAxis]&&function(e){var t;for(t in e)return 0;return 1}(this.keys)||(t/=1e3,this.updateVelocity(t),(r[n.adAxis]||r[n.wsAxis])&&i.object3D.position.add(this.getMovementVector(t)))},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(e){var t,n,i,r,o,a=this.data,s=this.keys,c=this.velocity;if(n=a.adAxis,r=a.wsAxis,.2<e)return c[n]=0,void(c[r]=0);var l=Math.pow(1/this.easing,60*e);0!==c[n]&&(c[n]-=c[n]*l),0!==c[r]&&(c[r]-=c[r]*l),Math.abs(c[n])<1e-5&&(c[n]=0),Math.abs(c[r])<1e-5&&(c[r]=0),a.enabled&&(t=a.acceleration,a.adEnabled&&(i=a.adInverted?-1:1,(s.KeyA||s.ArrowLeft)&&(c[n]-=i*t*e),(s.KeyD||s.ArrowRight)&&(c[n]+=i*t*e)),a.wsEnabled&&(o=a.wsInverted?-1:1,(s.KeyW||s.ArrowUp)&&(c[r]-=o*t*e),(s.KeyS||s.ArrowDown)&&(c[r]+=o*t*e)))},getMovementVector:(r=new s.Vector3(0,0,0),o=new s.Euler(0,0,0,"YXZ"),function(e){var t,n=this.el.getAttribute("rotation"),i=this.velocity;return r.copy(i),r.multiplyScalar(e),n&&(t=this.data.fly?n.x:0,o.set(s.Math.degToRad(t),s.Math.degToRad(n.y),0),r.applyEuler(o)),r}),attachVisibilityEventListeners:function(){window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(e){var t;u(e)&&(t=e.code||i[e.keyCode],-1!==h.indexOf(t)&&(this.keys[t]=!0))},onKeyUp:function(e){var t;t=e.code||i[e.keyCode],delete this.keys[t]}})},{"../constants":95,"../core/component":103,"../lib/three":151,"../utils/":176}],94:[function(e,t,n){var i,a,s,r=e("../utils/bind"),o=e("../core/component").registerComponent,c=e("../utils/tracked-controls"),l=c.onButtonEvent,u=e("../utils/"),h=u.debug("components:windows-motion-controls:debug"),d=u.debug("components:windows-motion-controls:warn"),p=e("../constants").DEFAULT_HANDEDNESS,f={left:"left.glb",right:"right.glb",default:"universal.glb"},m=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/;t.exports.Component=o("windows-motion-controls",{schema:{hand:{default:p},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},mapping:{axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},bindMethods:function(){this.onModelError=r(this.onModelError,this),this.onModelLoaded=r(this.onModelLoaded,this),this.onControllersUpdate=r(this.onControllersUpdate,this),this.checkIfControllerPresent=r(this.checkIfControllerPresent,this),this.onAxisMoved=r(this.onAxisMoved,this)},init:function(){var t=this,e=this.el;this.onButtonChanged=r(this.onButtonChanged,this),this.onButtonDown=function(e){l(e.detail.id,"down",t)},this.onButtonUp=function(e){l(e.detail.id,"up",t)},this.onButtonTouchStart=function(e){l(e.detail.id,"touchstart",t)},this.onButtonTouchEnd=function(e){l(e.detail.id,"touchend",t)},this.onControllerConnected=function(){t.setModelVisibility(!0)},this.onControllerDisconnected=function(){t.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},this.emitIfAxesChanged=c.emitIfAxesChanged,this.checkControllerPresentAndSetup=c.checkControllerPresentAndSetup,e.addEventListener("controllerconnected",this.onControllerConnected),e.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged),e.addEventListener("buttondown",this.onButtonDown),e.addEventListener("buttonup",this.onButtonUp),e.addEventListener("touchstart",this.onButtonTouchStart),e.addEventListener("touchend",this.onButtonTouchEnd),e.addEventListener("axismove",this.onAxisMoved),e.addEventListener("model-error",this.onModelError),e.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged),e.removeEventListener("buttondown",this.onButtonDown),e.removeEventListener("buttonup",this.onButtonUp),e.removeEventListener("touchstart",this.onButtonTouchStart),e.removeEventListener("touchend",this.onButtonTouchEnd),e.removeEventListener("axismove",this.onAxisMoved),e.removeEventListener("model-error",this.onModelError),e.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,"Spatial Controller (Spatial Interaction Source) ",{hand:this.data.hand,index:this.data.pair})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(this.data.model&&!this.rayOrigin.createdFromMesh){var e=this.createControllerModelUrl();this.loadModel(e)}else this.modelReady()},createControllerModelUrl:function(e){var t=this.el.components["tracked-controls"],n=t?t.controller:null,i="default",r=this.data.hand;if(n&&(r=n.hand,!e)){var o=n.id.match(m);i=o&&o[0]||i}return"https://cdn.aframe.io/controllers/microsoft/"+i+"/"+(f[r]||f.default)},injectTrackedControls:function(){var e=this.data;this.el.setAttribute("tracked-controls",{idPrefix:"Spatial Controller (Spatial Interaction Source) ",controller:e.pair,hand:e.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(e){var t=this.createControllerModelUrl(!0);e.detail.src!==t?(d("Failed to load controller model for device, attempting to load default."),this.loadModel(t)):d("Failed to load default controller model.")},loadModel:function(e){this.el.setAttribute("gltf-model","url("+e+")")},onModelLoaded:function(e){var t,n,i,r,o=this.controllerModel=e.detail.model,a=this.loadedMeshInfo;if(h("Processing model"),a.buttonMeshes={},a.axisMeshes={},o){for(t=0;t<this.mapping.buttons.length;t++)(n=this.mapping.buttonMeshNames[this.mapping.buttons[t]])?(i=o.getObjectByName(n))?(r={index:t,value:s(i,"VALUE"),pressed:s(i,"PRESSED"),unpressed:s(i,"UNPRESSED")}).value&&r.pressed&&r.unpressed?a.buttonMeshes[this.mapping.buttons[t]]=r:d("Missing button submesh under mesh with name: "+n+"(VALUE: "+!!r.value+", PRESSED: "+!!r.pressed+", UNPRESSED:"+!!r.unpressed+")"):d("Missing button mesh with name: "+n):h("Skipping unknown button at index: "+t+" with mapped name: "+this.mapping.buttons[t]);for(t=0;t<this.mapping.axisMeshNames.length;t++)(n=this.mapping.axisMeshNames[t])?(i=o.getObjectByName(n))?(r={index:t,value:s(i,"VALUE"),min:s(i,"MIN"),max:s(i,"MAX")}).value&&r.min&&r.max?a.axisMeshes[t]=r:d("Missing axis submesh under mesh with name: "+n+"(VALUE: "+!!r.value+", MIN: "+!!r.min+", MAX:"+!!r.max+")"):d("Missing axis mesh with name: "+n):h("Skipping unknown axis at index: "+t);this.calculateRayOriginFromMesh(o),this.setModelVisibility()}function s(e,t){for(var n=0,i=e.children.length;n<i;n++){var r=e.children[n];if(r&&r.name===t)return r}}h("Model load complete.")},calculateRayOriginFromMesh:(i=new THREE.Quaternion,function(e){var t;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,t=e.getObjectByName(this.mapping.pointingPoseMeshName)){var n=e.parent;n&&(e.parent=null,e.updateMatrixWorld(!0),e.parent=n),t.getWorldPosition(this.rayOrigin.origin),t.getWorldQuaternion(i),this.rayOrigin.direction.applyQuaternion(i),n&&e.updateMatrixWorld(!0)}else h("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}),lerpAxisTransform:(s=new THREE.Quaternion,function(e,t){var n=this.loadedMeshInfo.axisMeshes[e];if(n){var i=n.min,r=n.max,o=n.value,a=.5*t+.5;o.setRotationFromQuaternion(s.copy(i.quaternion).slerp(r.quaternion,a)),o.position.lerpVectors(i.position,r.position,a)}}),lerpButtonTransform:(a=new THREE.Quaternion,function(e,t){var n=this.loadedMeshInfo.buttonMeshes[e];if(n){var i=n.unpressed,r=n.pressed,o=n.value;o.setRotationFromQuaternion(a.copy(i.quaternion).slerp(r.quaternion,t)),o.position.lerpVectors(i.position,r.position,t)}}),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];t&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(t,e.detail.state.value),this.el.emit(t+"changed",e.detail.state))},onAxisMoved:function(e){var t=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var n=0;n<t;n++)this.lerpAxisTransform(n,e.detail.axis[n]||0);this.emitIfAxesChanged(this,this.mapping.axes,e)},setModelVisibility:function(e){var t=this.el.getObject3D("mesh");e=void 0!==e?e:this.modelVisible,this.modelVisible=e,t&&(t.visible=e)}})},{"../constants":95,"../core/component":103,"../utils/":176,"../utils/bind":170,"../utils/tracked-controls":184}],95:[function(e,t,n){t.exports={AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:e("./keyboardevent")}},{"./keyboardevent":96}],96:[function(e,t,n){t.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},{}],97:[function(e,t,n){var i=e("./a-node"),c=e("../utils/bind"),r=e("../utils/debug"),o=e("./a-register-element").registerElement,l=e("../lib/three"),a=new l.FileLoader,u=r("core:a-assets:warn");function h(i){if(i.hasAttribute("autoplay")||"auto"===i.getAttribute("preload"))return new Promise(function(n,e){if(4===i.readyState)return n();if(i.error)return e();function t(){for(var e=0,t=0;t<i.buffered.length;t++)e+=i.buffered.end(t)-i.buffered.start(t);e>=i.duration&&("VIDEO"===i.tagName&&(l.Cache.files[i.getAttribute("src")]=i),n())}i.addEventListener("loadeddata",t,!1),i.addEventListener("progress",t,!1),i.addEventListener("error",e,!1)})}function d(e){var t=function(e){var t,n,i;if(e.hasAttribute("crossorigin"))return e;if(null!==(t=e.getAttribute("src"))){if(-1===t.indexOf("://"))return e;if((i=-1<(n=t).indexOf("://")?n.split("/")[2]:n.split("/")[0]).substring(0,i.indexOf(":"))===window.location.host)return e}return u('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',t),e.crossOrigin="anonymous",e.cloneNode(!0)}(e);return t.tagName&&"video"===t.tagName.toLowerCase()&&(t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline","")),t!==e&&(e.parentNode.appendChild(t),e.parentNode.removeChild(e)),t}function s(e){var t=e.lastIndexOf(".");if(0<=t){var n=e.slice(t,e.length);if(".gltf"===n||".glb"===n)return"arraybuffer"}return"text"}t.exports=o("a-assets",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.isAssets=!0,this.fileLoader=a,this.timeout=null}},attachedCallback:{value:function(){var n,e,t,i,r,o,a=this,s=[];if(!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(r=this.querySelectorAll("img"),n=0;n<r.length;n++)i=d(r[n]),s.push(new Promise(function(e,t){(l.Cache.files[r[n].getAttribute("src")]=i).onload=e,i.onerror=t}));for(t=this.querySelectorAll("audio, video"),n=0;n<t.length;n++)(e=d(t[n])).src||e.srcObject||u("Audio/video asset has neither `src` nor `srcObject` attributes."),s.push(h(e));Promise.all(s).then(c(this.load,this)),o=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){a.hasLoaded||(u("Asset loading timed out in ",o,"ms"),a.emit("timeout"),a.load())},o)}},detachedCallback:{value:function(){this.timeout&&clearTimeout(this.timeout)}},load:{value:function(){i.prototype.load.call(this,null,function(e){return e.isAssetItem&&e.hasAttribute("src")})}}})}),o("a-asset-item",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.data=null,this.isAssetItem=!0}},attachedCallback:{value:function(){var t=this,e=this.getAttribute("src");a.setResponseType(this.getAttribute("response-type")||s(e)),a.load(e,function(e){t.data=e,setTimeout(function(){i.prototype.load.call(t)})},function(e){t.emit("progress",{loadedBytes:e.loaded,totalBytes:e.total,xhr:e})},function(e){t.emit("error",{xhr:e})})}}})}),t.exports.inferResponseType=s},{"../lib/three":151,"../utils/bind":170,"../utils/debug":172,"./a-node":101,"./a-register-element":102}],98:[function(e,t,n){var i=e("../utils/debug"),r=e("./a-register-element").registerElement,o=i("core:cubemap:warn");t.exports=r("a-cubemap",{prototype:Object.create(window.HTMLElement.prototype,{attachedCallback:{value:function(){this.srcs=this.validate()},writable:window.debug},validate:{value:function(){var e,t=this.querySelectorAll("[src]"),n=[];if(6===t.length){for(e=0;e<t.length;e++)n.push(t[e].getAttribute("src"));return n}o("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")},writable:window.debug}})})},{"../utils/debug":172,"./a-register-element":102}],99:[function(e,t,n){var r,c,s,l=e("./a-node"),u=e("./component").components,i=e("./a-register-element").registerElement,o=e("../lib/three"),h=e("../utils/"),d=h.debug("core:a-entity:debug"),a=h.debug("core:a-entity:warn"),p="__",f=["position","rotation","scale","visible"],m={once:!0},v=Object.create(l.prototype,{createdCallback:{value:function(){this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new o.Group,(this.object3D.el=this).object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}},attributeChangedCallback:{value:function(e,t,n){var i=this.components[e];i&&i.justInitialized&&""===n?delete i.justInitialized:!i&&null===n||this.setEntityAttribute(e,t,n)}},attachedCallback:{value:function(){var e,t=this.sceneEl,n=this;this.addToParent(),this.isScene||(t?!(e=t.querySelector("a-assets"))||e.hasLoaded?this.load():e.addEventListener("loaded",function(){n.load()}):this.load())}},detachedCallback:{value:function(){var e;if(this.parentEl){for(e in this.components)this.removeComponent(e);this.isScene||(this.removeFromParent(),l.prototype.detachedCallback.call(this),this.object3D.el=null)}}},getObject3D:{value:function(e){return this.object3DMap[e]}},setObject3D:{value:function(e,t){var n,i=this;if(!(t instanceof o.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");(n=this.getObject3D(e))&&this.object3D.remove(n),t.el=this,t.children.length&&t.traverse(function(e){e.el=i}),this.object3D.add(t),this.object3DMap[e]=t,this.emit("object3dset",{object:t,type:e})}},removeObject3D:{value:function(e){var t=this.getObject3D(e);t?(this.object3D.remove(t),delete this.object3DMap[e],this.emit("object3dremove",{type:e})):a("Tried to remove `Object3D` of type:",e,"which was not defined.")}},getOrCreateObject3D:{value:function(e,t){var n=this.getObject3D(e);return!n&&t&&(n=new t,this.setObject3D(e,n)),a("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),n}},add:{value:function(e){if(!e.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(e.object3D),this.emit("child-attached",{el:e})}},addToParent:{value:function(){var e=this.parentEl=this.parentNode;e&&e.add&&!this.attachedToParent&&(e.add(this),this.attachedToParent=!0)}},removeFromParent:{value:function(){var e=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,e.emit("child-detached",{el:this})}},load:{value:function(){var e=this;!this.hasLoaded&&this.parentEl&&l.prototype.load.call(this,function(){e.parentEl&&(e.updateComponents(),(e.isScene||e.parentEl.isPlaying)&&e.play())})},writable:window.debug},remove:{value:function(e){this.object3D.remove(e.object3D)}},getChildEntities:{value:function(){for(var e=this.children,t=[],n=0;n<e.length;n++){var i=e[n];i instanceof r&&t.push(i)}return t}},initComponent:{value:function(e,t,n){var i,r,o,a;if(a=(o=h.split(e,p))[0],r=2<o.length?o.slice(1).join("__"):o[1],u[a]&&(g(this,e)||void 0!==t||n)&&!(e in this.components)){if(this.initComponentDependencies(a),r&&!u[a].multiple)throw new Error("Trying to initialize multiple components of type `"+a+"`. There can only be one component of this type per entity.");i=new u[a].Component(this,t,r),this.isPlaying&&i.play(),this.hasAttribute(e)||(i.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,e,"")),d("Component initialized: %s",e)}},writable:window.debug},initComponentDependencies:{value:function(e){var t,n;if(u[e]&&(t=u[e].dependencies))for(n=0;n<t.length;n++)this.initComponent(t[n],window.HTMLElement.prototype.getAttribute.call(this,t[n])||void 0,!0)}},removeComponent:{value:function(n){var e;(e=this.components[n])&&(e.initialized?(e.pause(),e.remove(),delete this.components[n],this.emit("componentremoved",e.evtDetail)):this.addEventListener("componentinitialized",function e(t){t.detail.name===n&&(this.removeComponent(n),this.removeEventListener("componentinitialized",e))}))},writable:window.debug},updateComponents:{value:function(){var e,t,n,i,r,o,a=this.componentsToUpdate;if(this.hasLoaded){for(n=0;n<this.mixinEls.length;n++)for(i in this.mixinEls[n].componentCache)y(i)&&(a[i]=!0);if(this.getExtraComponents)for(i in t=this.getExtraComponents())y(i)&&(a[i]=!0);for(n=0;n<this.attributes.length;++n)i=this.attributes[n].name,-1===f.indexOf(i)&&y(i)&&(a[i]=!0);for(n=0;n<f.length;n++)i=f[n],this.hasAttribute(i)&&this.updateComponent(i,this.getDOMAttribute(i));for(i in a)r=this.getDOMAttribute(i),e=(o=t&&t[i])?o.constructor===Object?h.extend(o,h.styleParser.parse(r||{})):r||o:r,this.updateComponent(i,e),delete a[i]}},writable:window.debug},updateComponent:{value:function(e,t,n){var i=this.components[e];if(i)return null!==t||g(this,e)?void i.updateProperties(t,n):void this.removeComponent(e);this.initComponent(e,t,!1)}},removeAttribute:{value:function(e,t){var n=this.components[e];n&&void 0===t&&this.removeComponent(e),n&&void 0!==t?n.resetProperty(t):("mixin"===e&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,e))}},play:{value:function(){var e,t,n;if(!this.isPlaying&&this.hasLoaded){for(n in this.isPlaying=!0,this.components)this.components[n].play();for(e=this.getChildEntities(),t=0;t<e.length;t++)e[t].play();this.emit("play")}},writable:!0},pause:{value:function(){var e,t,n;if(this.isPlaying){for(n in this.isPlaying=!1,this.components)this.components[n].pause();for(e=this.getChildEntities(),t=0;t<e.length;t++)e[t].pause();this.emit("pause")}},writable:!0},setEntityAttribute:{value:function(e,t,n){if(u[e]||this.components[e])this.updateComponent(e,n);else if("mixin"===e){if(n===this.computedMixinStr)return;this.mixinUpdate(n,t)}}},mixinUpdate:{value:(s=[],function(e,t){var n,i,r,o,a=this;if(this.hasLoaded){for(t=t||this.getAttribute("mixin"),r=this.updateMixins(e,t),o=s.length=0;o<this.mixinEls.length;o++)for(n in this.mixinEls[o].componentCache)-1===s.indexOf(n)&&(this.components[n]?this.components[n].handleMixinUpdate():this.initComponent(n,null),s.push(n));for(o=0;o<r.oldMixinIds.length;o++)if(i=document.getElementById(r.oldMixinIds[o]))for(n in i.componentCache)-1===s.indexOf(n)&&this.components[n]&&(this.getDOMAttribute(n)?this.components[n].handleMixinUpdate():this.removeComponent(n))}else this.addEventListener("loaded",function(){a.mixinUpdate(e,t)},m)})},setAttribute:{value:(c={},function(e,t,n){var i,r,o,a,s;if(o=0<(a=e.indexOf(p))?e.substring(0,a):e,!u[o])return"mixin"===e&&this.mixinUpdate(t),void l.prototype.setAttribute.call(this,e,t);if(!this.components[e]&&this.hasAttribute(e)&&this.updateComponent(e,window.HTMLElement.prototype.getAttribute.call(this,e)),void 0!==n&&"string"==typeof t&&0<t.length&&"string"==typeof h.styleParser.parse(t)){for(s in c)delete c[s];(i=c)[t]=n,r=!1}else i=t,r=!0===n;this.updateComponent(e,i,r),this.sceneEl&&this.sceneEl.getAttribute("debug")&&this.components[e].flushToDOM()}),writable:window.debug},flushToDOM:{value:function(e){var t,n,i,r=this.components,o=this.children;for(i in r)r[i].flushToDOM();if(e)for(n=0;n<o.length;++n)(t=o[n]).flushToDOM&&t.flushToDOM(e)}},getAttribute:{value:function(e){var t,n,i,r;return"position"===e?this.object3D.position:"rotation"===e?(n=o.Math.radToDeg,i=this.object3D.rotation,(r=this.rotationObj).x=n(i.x),r.y=n(i.y),r.z=n(i.z),r):"scale"===e?this.object3D.scale:"visible"===e?this.object3D.visible:(t=this.components[e])?t.data:window.HTMLElement.prototype.getAttribute.call(this,e)},writable:window.debug},getDOMAttribute:{value:function(e){var t=this.components[e];return t?t.attrValue:window.HTMLElement.prototype.getAttribute.call(this,e)},writable:window.debug},addState:{value:function(e){this.is(e)||(this.states.push(e),this.emit("stateadded",e))}},removeState:{value:function(e){var t=this.states.indexOf(e);-1!==t&&(this.states.splice(t,1),this.emit("stateremoved",e))}},is:{value:function(e){return-1!==this.states.indexOf(e)}},inspect:{value:function(){this.sceneEl.components.inspector.openInspector(this)}}});function g(e,t){return!(!e.components[t]||!e.components[t].attrValue)||function(e,t){var n,i=!1;for(n=0;n<t.length&&!(i=t[n].hasAttribute(e));++n);return i}(t,e.mixinEls)}function y(e){return-1!==e.indexOf(p)&&(e=h.split(e,p)[0]),!!u[e]}r=i("a-entity",{prototype:v}),t.exports=r},{"../lib/three":151,"../utils/":176,"./a-node":101,"./a-register-element":102,"./component":103}],100:[function(e,t,n){var i=e("./a-node"),r=e("./a-register-element").registerElement,o=e("./component").components,a=e("../utils");t.exports=r("a-mixin",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.componentCache={},this.id=this.getAttribute("id"),this.isMixin=!0}},attributeChangedCallback:{value:function(e,t,n){this.cacheAttribute(e,n),this.updateEntities()}},attachedCallback:{value:function(){this.sceneEl=this.closestScene(),this.cacheAttributes(),this.updateEntities(),this.load()}},setAttribute:{value:function(e,t){window.HTMLElement.prototype.setAttribute.call(this,e,t),this.cacheAttribute(e,t)}},cacheAttribute:{value:function(e,t){var n,i;i=a.split(e,"__")[0],(n=o[i])&&(void 0===t&&(t=window.HTMLElement.prototype.getAttribute.call(this,e)),this.componentCache[e]=n.parseAttrValueForCache(t))}},getAttribute:{value:function(e){return this.componentCache[e]||window.HTMLElement.prototype.getAttribute.call(this,e)}},cacheAttributes:{value:function(){var e,t,n=this.attributes;for(t=0;t<n.length;t++)e=n[t].name,this.cacheAttribute(e)}},updateEntities:{value:function(){var e,t,n;if(this.sceneEl)for(t=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),n=0;n<t.length;n++)(e=t[n]).hasLoaded&&!e.isMixin&&e.mixinUpdate(this.id)}}})})},{"../utils":176,"./a-node":101,"./a-register-element":102,"./component":103}],101:[function(e,t,n){var r,o,a,s,i=e("./a-register-element").registerElement,c=e("./a-register-element").isNode,l=e("../utils/"),u=l.debug("core:a-node:warn"),h=l.debug("core:a-node:error");t.exports=i("a-node",{prototype:Object.create(window.HTMLElement.prototype,{createdCallback:{value:function(){this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]},writable:window.debug},attachedCallback:{value:function(){var e;this.sceneEl=this.closestScene(),this.sceneEl||u("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(e=this.getAttribute("mixin"))&&this.updateMixins(e)},writable:window.debug},attributeChangedCallback:{value:function(e,t,n){n!==this.computedMixinStr&&("mixin"!==e||this.isMixin||this.updateMixins(n,t))}},closestScene:{value:function(){for(var e=this;e&&!e.isScene;)e=e.parentElement;return e}},closest:{value:function(e){for(var t=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,n=this;n&&!t.call(n,e);)n=n.parentElement;return n}},detachedCallback:{value:function(){this.hasLoaded=!1}},load:{value:function(e,t){var n,i=this;this.hasLoaded||(t=t||c,n=this.getChildren().filter(t).map(function(t){return new Promise(function(e){if(t.hasLoaded)return e();t.addEventListener("loaded",e)})}),Promise.all(n).then(function(){i.hasLoaded=!0,e&&e(),i.emit("loaded",void 0,!1)}).catch(function(e){h("Failure loading node: ",e)}))},writable:!0},getChildren:{value:function(){return Array.prototype.slice.call(this.children,0)}},updateMixins:{value:(o=[],a=[],s={},function(e,t){var n,i,r;for(o.length=0,a.length=0,i=e?l.split(e.trim(),/\s+/):o,r=t?l.split(t.trim(),/\s+/):a,s.newMixinIds=i,s.oldMixinIds=r,n=0;n<r.length;n++)-1===i.indexOf(r[n])&&this.unregisterMixin(r[n]);for(this.computedMixinStr="",n=this.mixinEls.length=0;n<i.length;n++)this.registerMixin(document.getElementById(i[n]));return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),s})},registerMixin:{value:function(e){var t,n,i;if(e){if(i=e.getAttribute("mixin"))for(t=l.split(i.trim(),/\s+/),n=0;n<t.length;n++)this.registerMixin(document.getElementById(t[n]));this.computedMixinStr=this.computedMixinStr+" "+e.id,this.mixinEls.push(e)}}},setAttribute:{value:function(e,t){"mixin"===e&&this.updateMixins(t),window.HTMLElement.prototype.setAttribute.call(this,e,t)}},unregisterMixin:{value:function(e){var t,n=this.mixinEls;for(t=0;t<n.length;++t)if(e===n[t].id){n.splice(t,1);break}}},emit:{value:(r={},function(e,t,n,i){void 0===n&&(n=!0),r.bubbles=!!n,r.detail=t,i&&(r=l.extend({},i,r)),this.dispatchEvent(new CustomEvent(e,r))}),writable:window.debug}})})},{"../utils/":176,"./a-register-element":102}],102:[function(e,t,n){var u,h;e("document-register-element");var d=t.exports.knownTags={};function p(o,e,a,s){e.forEach(function(e){var t,n,i,r;t=o,n=s,i=a[e],r=n[e],i&&r&&i!==r&&(t[e]={value:function(){return r.apply(this,arguments),i.apply(this,arguments)},writable:window.debug})})}function f(n,i){Object.getOwnPropertyNames(n).forEach(function(e){var t;i[e]||(t=Object.getOwnPropertyDescriptor(n,e),i[e]={value:n[e],writable:t.writable})})}t.exports.isNode=function(e){return e.tagName.toLowerCase()in d||e.isNode},t.exports.registerElement=function(e,t){var n,i,r,o,a=Object.getPrototypeOf(t.prototype),s=t,c=u&&a===u.prototype,l=h&&a===h.prototype;return(c||l)&&(d[e.toLowerCase()]=!0),c&&(r=t.prototype,p(o={},["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],r,u.prototype),f(r,o),s=o,s={prototype:Object.create(a,s)}),l&&(n=t.prototype,p(i={},["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],n,u.prototype),p(i,["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],n,h.prototype),f(n,i),s=i,s={prototype:Object.create(a,s)}),Object.getOwnPropertyNames(s.prototype).forEach(function(e){var t=s.prototype[e];"function"==typeof t&&(t.displayName=e)}),document.registerElement(e,s)},t.exports.wrapMethods=p,u=e("./a-node"),h=e("./a-entity")},{"./a-entity":99,"./a-node":101,"document-register-element":12}],103:[function(e,t,n){var i=e("./schema"),u=e("./scene/scenes"),h=e("./system"),p=e("../utils/"),d=t.exports.components={},f=i.parseProperties,m=i.parseProperty,v=i.process,g=i.isSingleProperty,r=i.stringifyProperties,o=i.stringifyProperty,a=p.styleParser,y=p.debug("core:component:warn"),A=document.currentScript,b=new RegExp("[A-Z]+"),w={},x=t.exports.Component=function(e,t,n){var i=this;this.el=e,this.id=n,this.attrName=this.name+(n?"__"+n:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.isSingleProperty=g(this.schema),this.isSinglePropertyObject=this.isSingleProperty&&C(m(void 0,this.schema))&&!(this.schema.default instanceof window.HTMLElement),this.isObjectBased=!this.isSingleProperty||this.isSinglePropertyObject,(this.el.components[this.attrName]=this).objectPool=w[this.name],this.attrValue=void 0,this.nextData=this.isObjectBased?this.objectPool.use():void 0,this.oldData=this.isObjectBased?this.objectPool.use():void 0,this.previousOldData=this.isObjectBased?this.objectPool.use():void 0,this.parsingAttrValue=this.isObjectBased?this.objectPool.use():void 0,this.throttledEmitComponentChanged=p.throttle(function(){e.emit("componentchanged",i.evtDetail,!1)},200),this.updateProperties(t)};if(x.prototype={schema:{},init:function(){},update:function(e){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(e,t){var n=this.schema;return this.isSingleProperty?m(e,n):f(a.parse(e),n,!0,this.name,t)},stringify:function(e){var t=this.schema;return"string"==typeof e?e:this.isSingleProperty?o(e,t):(e=r(e,t),a.stringify(e))},updateCachedAttrValue:function(e,t){var n,i,r;if(void 0!==e){if(null===e)return this.isObjectBased&&this.attrValue&&this.objectPool.recycle(this.attrValue),void(this.attrValue=void 0);if(n=e instanceof Object&&!(e instanceof window.HTMLElement)?(i=this.objectPool.use(),p.extend(i,e)):this.parseAttrValueForCache(e),this.isObjectBased&&!t&&this.attrValue)for(r in this.attrValue)void 0===n[r]&&(n[r]=this.attrValue[r]);this.isObjectBased&&!this.attrValue&&(this.attrValue=this.objectPool.use()),p.objectPool.clearObject(this.attrValue),this.attrValue=T(this.attrValue,n,this.isObjectBased),p.objectPool.clearObject(i)}},parseAttrValueForCache:function(e){var t;return"string"!=typeof e?e:(this.isSingleProperty?"string"==typeof(t=this.schema.parse(e))&&(t=e):(p.objectPool.clearObject(this.parsingAttrValue),t=a.parse(e,this.parsingAttrValue)),t)},flushToDOM:function(e){var t=e?this.data:this.attrValue;t&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(t))},updateProperties:function(e,t){this.el.hasLoaded?(null!==e&&(e=this.parseAttrValueForCache(e)),this.updateCachedAttrValue(e,t),this.initialized?(this.updateComponent(e,t),this.callUpdateHandler()):this.initComponent()):this.updateCachedAttrValue(e)},initComponent:function(){var e,t=this.el;this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!1,!0)),this.data=this.buildData(this.attrValue),t.initializingComponents[this.name]||(t.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete t.initializingComponents[this.name],this.oldData=T(this.oldData,this.data,this.isObjectBased),e=this.isObjectBased?this.objectPool.use():void 0,this.update(e),this.isObjectBased&&this.objectPool.recycle(e),t.isPlaying&&this.play(),t.emit("componentinitialized",this.evtDetail,!1))},updateComponent:function(e,t){var n,i;if(t)return this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),void(this.data=this.buildData(this.attrValue,!0,!1));if(this.isSingleProperty)return this.isObjectBased&&m(e,this.schema),void(this.data=e);if(f(e,this.schema,!0,this.name),this.schemaChangeKeys.length)for(n in e)if(this.schema[n].schemaChange){i=!0;break}if(i)return this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),void(this.data=this.buildData(this.attrValue,!0,!1));for(n in e)void 0!==e[n]&&(this.data[n]=e[n])},callUpdateHandler:function(){var e;this.previousOldData instanceof Object&&p.objectPool.clearObject(this.previousOldData),this.isObjectBased?M(this.previousOldData,this.oldData):this.previousOldData=this.oldData,e=!p.deepEqual(this.oldData,this.data),(this.isPositionRotationScale||e)&&(this.oldData instanceof Object&&p.objectPool.clearObject(this.oldData),this.oldData=T(this.oldData,this.data,this.isObjectBased),this.update(this.previousOldData),this.throttledEmitComponentChanged())},handleMixinUpdate:function(){this.data=this.buildData(this.attrValue),this.callUpdateHandler()},resetProperty:function(e){if(this.isObjectBased){if(!(e in this.attrValue))return;delete this.attrValue[e],this.data[e]=this.schema[e].default}else this.attrValue=this.schema.default,this.data=this.schema.default;this.updateProperties(this.attrValue)},extendSchema:function(e){var t;t=p.extend({},d[this.name].schema),p.extend(t,e),this.schema=v(t),this.el.emit("schemachanged",this.evtDetail)},buildData:function(e,t,n){var i,r,o,a,s,c,l,u=this.nextData,h=this.schema,d=this.el.mixinEls;if(i=e&&e.constructor===Array?e.length:null!=e,this.isObjectBased&&p.objectPool.clearObject(u),this.isSingleProperty)r=this.isObjectBased?M(u,h.default):L(h.default)?p.clone(h.default):h.default;else for(a in r=(l=!t&&this.attrValue)instanceof Object?M(u,l):u,h)o=h[a].default,void 0===r[a]&&(r[a]=L(o)?p.clone(o):o);for(c=0;c<d.length;c++)(s=d[c].getAttribute(this.attrName))&&(r=T(r,s,this.isObjectBased));if(i){if(this.isSingleProperty)return C(e)?(M(this.parsingAttrValue,e),m(this.parsingAttrValue,h)):m(e,h);r=T(r,e,this.isObjectBased)}else if(this.isSingleProperty)return m(r,h);return f(r,h,void 0,this.name,n)}},window.debug)var E=t.exports.registrationOrderWarnings={};function M(e,t){var n,i;for(i in t)void 0!==t[i]&&(n=t[i],e[i]=L(n)?p.clone(n):n);return e}function T(e,t,n){var i;if(n&&t.constructor===Object){for(i in t)void 0!==t[i]&&(t[i]&&t[i].constructor===Object?e[i]=p.clone(t[i]):e[i]=t[i]);return e}return t}function S(e){return e.tick||e.tock}function C(e){return e&&e.constructor===Object&&!(e instanceof window.HTMLElement)}function L(e){return e&&(e.constructor===Object||e.constructor===Array)&&!(e instanceof window.HTMLElement)}t.exports.registerComponent=function(t,n){var e,i,r,o,a,s,c,l={};if(document.currentScript&&document.currentScript!==A&&u.forEach(function(e){e.hasLoaded||document.currentScript.compareDocumentPosition(e)!==Node.DOCUMENT_POSITION_FOLLOWING&&(y("The component `"+t+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(E[t]=!0))}),!0===b.test(t)&&y("The component name `"+t+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+t.toLowerCase()+"`"),-1!==t.indexOf("__"))throw new Error("The component name `"+t+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(n).forEach(function(e){l[e]={value:n[e],writable:!0}}),d[t])throw new Error("The component `"+t+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");if(((e=function(e,t,n){x.call(this,e,t,n)}).prototype=Object.create(x.prototype,l)).name=t,e.prototype.isPositionRotationScale="position"===t||"rotation"===t||"scale"===t,(e.prototype.constructor=e).prototype.system=h&&h.systems[t],e.prototype.play=(a=e.prototype.play,function(){var e=this.el.sceneEl,t=this.el.isPlaying&&!this.isPlaying;this.initialized&&t&&(a.call(this),this.isPlaying=!0,S(this)&&e.addBehavior(this))}),e.prototype.pause=(s=e.prototype.pause,function(){var e=this.el.sceneEl;this.isPlaying&&(s.call(this),this.isPlaying=!1,S(this)&&e.removeBehavior(this))}),e.prototype.remove=(c=e.prototype.remove,function(){c.call(this),this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.oldData),this.objectPool.recycle(this.parsingAttrValue),this.attrValue=this.oldData=this.parsingAttrValue=void 0}),r=p.extend(v(e.prototype.schema,e.prototype.name)),!(o=g(e.prototype.schema)))for(i in e.prototype.schemaChangeKeys=[],r)r[i].schemaChange&&e.prototype.schemaChangeKeys.push(i);return w[t]=p.objectPool.createPool(),d[t]={Component:e,dependencies:e.prototype.dependencies,isSingleProp:o,multiple:e.prototype.multiple,name:t,parse:e.prototype.parse,parseAttrValueForCache:e.prototype.parseAttrValueForCache,schema:r,stringify:e.prototype.stringify,type:e.prototype.type},e}},{"../utils/":176,"./scene/scenes":110,"./schema":112,"./system":114}],104:[function(e,t,n){var r=e("./schema").process,o=t.exports.geometries={},a=t.exports.geometryNames=[],i=e("../lib/three"),s=t.exports.Geometry=function(){};s.prototype={schema:{},init:function(e){return this.geometry=new i.Geometry,this.geometry},update:function(e){}},t.exports.registerGeometry=function(e,t){var n,i={};if(Object.keys(t).forEach(function(e){i[e]={value:t[e],writable:!0}}),o[e])throw new Error("The geometry `"+e+"` has been already registered");return((n=function(){s.call(this)}).prototype=Object.create(s.prototype,i)).name=e,n.prototype.constructor=n,o[e]={Geometry:n,schema:r(n.prototype.schema)},a.push(e),n}},{"../lib/three":151,"./schema":112}],105:[function(e,t,n){var i=e("../utils/coordinates"),r=e("debug"),o=r("core:propertyTypes:warn"),a=r("core:propertyTypes:warn"),s=t.exports.propertyTypes={},c=/[,> .[\]:]/,l=/\url\((.+)\)/;function u(e,t,n,i){"type"in s?o("Property type "+e+" is already registered."):s[e]={default:t,parse:n||d,stringify:i||p}}function h(e){var t,n;return"string"!=typeof e?e:(n=e.match(l))?n[1]:"#"===e.charAt(0)?(t=document.getElementById(e.substring(1)))?"CANVAS"===t.tagName||"VIDEO"===t.tagName||"IMG"===t.tagName?t:t.getAttribute("src"):void a('"'+e+'" asset not found.'):e}function d(e){return e}function p(e){return null===e?"null":e.toString()}function f(e){return parseInt(e,10)}function m(e){return i.parse(e,this.default)}function v(e,t){if(null===e)return!0;if("object"!=typeof e)return!1;if(Object.keys(e).length!==t)return!1;var n=e.x,i=e.y,r=e.z,o=e.w;return!("number"!=typeof n||"number"!=typeof i||2<t&&"number"!=typeof r||3<t&&"number"!=typeof o)}u("audio","",h),u("array",[],function(e){return Array.isArray(e)?e:e&&"string"==typeof e?e.split(",").map(function(e){return e.trim()}):[]},function(e){return e.join(", ")}),u("asset","",h),u("boolean",!1,function(e){return"false"!==e&&!1!==e}),u("color","#FFF",d,p),u("int",0,f),u("number",0,function(e){return parseFloat(e,10)}),u("map","",h),u("model","",h),u("selector",null,function(e){return e?"string"!=typeof e?e:"#"!==e[0]||c.test(e)?document.querySelector(e):document.getElementById(e.substring(1)):null},function(e){return e.getAttribute?"#"+e.getAttribute("id"):p(e)}),u("selectorAll",null,function(e){return e?"string"!=typeof e?e:Array.prototype.slice.call(document.querySelectorAll(e),0):null},function(e){return e instanceof Array?e.map(function(e){return"#"+e.getAttribute("id")}).join(", "):p(e)}),u("src","",function(e){return a("`src` property type is deprecated. Use `asset` instead."),h(e)}),u("string","",d,p),u("time",0,f),u("vec2",{x:0,y:0},m,i.stringify),u("vec3",{x:0,y:0,z:0},m,i.stringify),u("vec4",{x:0,y:0,z:0,w:1},m,i.stringify),t.exports.registerPropertyType=u,t.exports.isValidDefaultValue=function(e,t){return("audio"!==e||"string"==typeof t)&&!("array"===e&&!Array.isArray(t))&&("asset"!==e||"string"==typeof t)&&("boolean"!==e||"boolean"==typeof t)&&("color"!==e||"string"==typeof t)&&("int"!==e||"number"==typeof t)&&("number"!==e||"number"==typeof t)&&("map"!==e||"string"==typeof t)&&("model"!==e||"string"==typeof t)&&("selector"!==e||"string"==typeof t||null===t)&&("selectorAll"!==e||"string"==typeof t||null===t)&&("src"!==e||"string"==typeof t)&&("string"!==e||"string"==typeof t)&&("time"!==e||"number"==typeof t)&&("vec2"===e?v(t,2):"vec3"===e?v(t,3):"vec4"!==e||v(t,4))},t.exports.isValidDefaultCoordinate=v},{"../utils/coordinates":171,debug:9}],106:[function(e,t,n){var i=e("./metaTags").inject,r=e("./wakelock"),o=e("./loadingScreen"),a=e("../a-register-element"),s=e("./scenes"),c=e("../system").systems,l=e("../../lib/three"),u=e("../../utils/"),h=e("../a-entity"),d=e("../a-node"),p=e("./postMessage"),f=u.bind,m=u.device.isIOS(),v=u.device.isMobile(),g=u.device.isWebXRAvailable,y=a.registerElement,A=u.debug("core:a-scene:warn");function b(e,t,n,i){return t?{height:e.parentElement.offsetHeight,width:e.parentElement.offsetWidth}:(r=n,o=i,c=window.devicePixelRatio,s={height:document.body.offsetHeight,width:document.body.offsetWidth},!r||o||-1===r.width&&-1===r.height||s.width*c<r.width&&s.height*c<r.height||(a=s.width/s.height,s.width*c>r.width&&-1!==r.width&&(s.width=Math.round(r.width/c),s.height=Math.round(r.width/a/c)),s.height*c>r.height&&-1!==r.height&&(s.height=Math.round(r.height/c),s.width=Math.round(r.height*a/c))),s);var r,o,a,s,c}function w(e){var t;function n(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||e.exitVR(),document.activeElement.blur(),document.body.focus()}(t=document.createElement("canvas")).classList.add("a-canvas"),t.dataset.aframeCanvas=!0,e.appendChild(t),document.addEventListener("fullscreenchange",n),document.addEventListener("mozfullscreenchange",n),document.addEventListener("webkitfullscreenchange",n),t.addEventListener("touchmove",function(e){e.preventDefault()}),e.canvas=t,e.emit("render-target-loaded",{target:t}),setTimeout(f(e.resize,e),0)}t.exports.AScene=y("a-scene",{prototype:Object.create(h.prototype,{createdCallback:{value:function(){this.isIOS=m,this.isMobile=v,this.hasWebXR=g,this.highRefreshRate=!1,this.isScene=!0,this.object3D=new l.Scene;var i=this;this.object3D.onAfterRender=function(e,t,n){i.isPlaying&&i.tock(i.time,i.delta,n)},this.render=f(this.render,this),this.systems={},this.systemNames=[],this.time=this.delta=0,this.behaviors={tick:[],tock:[]},this.hasLoaded=!1,this.isPlaying=!1,this.originalHTML=this.innerHTML,this.renderTarget=null,this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("vr-mode-ui","")}},addFullScreenStyles:{value:function(){document.documentElement.classList.add("a-fullscreen")}},removeFullScreenStyles:{value:function(){document.documentElement.classList.remove("a-fullscreen")}},attachedCallback:{value:function(){var e=this;w(this),this.setupRenderer(),this.resize(),this.addFullScreenStyles(),p(this),i(this),r(this),this.addEventListener("cameraready",function(){e.attachedCallbackPostCamera()}),this.initSystems()}},attachedCallbackPostCamera:{value:function(){var e,t=this;e=f(this.resize,this),window.addEventListener("load",e),window.addEventListener("resize",function(){t.isIOS?setTimeout(e,100):e()}),this.play(),s.push(this),this.onVRPresentChangeBound=f(this.onVRPresentChange,this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){t.enterVR()},this.exitVRBound=function(){t.exitVR()},this.exitVRTrueBound=function(){t.exitVR(!0)},this.pointerRestrictedBound=function(){t.pointerRestricted()},this.pointerUnrestrictedBound=function(){t.pointerUnrestricted()},window.addEventListener("vrdisplayactivate",this.enterVRBound),window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)},writable:window.debug},initSystems:{value:function(){var e;for(e in this.initSystem("camera"),c)"camera"!==e&&this.initSystem(e)}},initSystem:{value:function(e){this.systems[e]||(this.systems[e]=new c[e](this),this.systemNames.push(e))}},detachedCallback:{value:function(){var e=s.indexOf(this);s.splice(e,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)}},addBehavior:{value:function(e){var t,n,i=this.behaviors;for(n in i)e[n]&&-1===(t=this.behaviors[n]).indexOf(e)&&t.push(e)}},getPointerLockElement:{value:function(){return document.pointerLockElement},writable:window.debug},checkHeadsetConnected:{value:u.device.checkHeadsetConnected,writable:window.debug},enterVR:{value:function(){var e,t=this,n=t.renderer.vr;return this.is("vr-mode")?Promise.resolve("Already in VR."):this.checkHeadsetConnected()||this.isMobile?(e=u.device.getVRDisplay(),n.setDevice(e),n.enabled=!0,this.hasWebXR?(this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound),e.requestSession({immersive:!0,exclusive:!0}).then(function(e){t.xrSession=e,n.setSession(e),e.addEventListener("end",t.exitVRBound),e.requestFrameOfReference("stage").then(function(e){t.frameOfReference=e}),i()}),Promise.resolve()):e.isPresenting?(i(),Promise.resolve()):e.requestPresent([{source:this.canvas,attributes:{highRefreshRate:this.highRefreshRate}}]).then(i,function(e){throw e&&e.message?new Error("Failed to enter VR mode (`requestPresent`): "+e.message):new Error("Failed to enter VR mode (`requestPresent`).")})):(i(),Promise.resolve());function i(){var e;t.addState("vr-mode"),t.emit("enter-vr",{target:t}),t.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),t.addFullScreenStyles(),t.isMobile||t.checkHeadsetConnected()||((e=t.canvas).requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen).apply(e),t.resize()}},writable:!0},exitVR:{value:function(){var e,t=this,n=this.renderer.vr;if(!this.is("vr-mode"))return Promise.resolve("Not in VR.");if(this.checkHeadsetConnected()||this.isMobile){if(n.enabled=!1,e=u.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end(),n.setSession(null);else if(e.isPresenting)return e.exitPresent().then(i,function(e){throw e&&e.message?new Error("Failed to exit VR mode (`exitPresent`): "+e.message):new Error("Failed to exit VR mode (`exitPresent`).")})}else document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();return i(),Promise.resolve();function i(){t.removeState("vr-mode"),t.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),t.hasAttribute("embedded")&&t.removeFullScreenStyles(),t.resize(),t.isIOS&&u.forceCanvasResizeSafariMobile(t.canvas),t.emit("exit-vr",{target:t})}},writable:!0},pointerRestricted:{value:function(){if(this.canvas){var e=this.getPointerLockElement();e&&e!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}},pointerUnrestricted:{value:function(){var e=this.getPointerLockElement();e&&e===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}},onVRPresentChange:{value:function(e){(e.display||e.detail.display).isPresenting?this.enterVR():this.exitVR()}},getAttribute:{value:function(e){var t=this.systems[e];return t?t.data:h.prototype.getAttribute.call(this,e)}},getComputedAttribute:{value:function(e){A("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute(e)}},getDOMAttribute:{value:function(e){var t=this.systems[e];return t?t.data:h.prototype.getDOMAttribute.call(this,e)}},setAttribute:{value:function(e,t,n){var i=this.systems[e];if(i)return d.prototype.setAttribute.call(this,e,t),void i.updateProperties(t);h.prototype.setAttribute.call(this,e,t,n)}},removeBehavior:{value:function(e){var t,n,i,r=this.behaviors;for(n in r)e[n]&&(-1!==(i=(t=this.behaviors[n]).indexOf(e))&&t.splice(i,1))}},resize:{value:function(){var e,t,n,i=this.camera,r=this.canvas;n=this.renderer.vr.getDevice(),e=this.renderer.vr.enabled&&n&&n.isPresenting,!i||!r||this.is("vr-mode")&&(this.isMobile||e)||(t=b(r,this.getAttribute("embedded")&&!this.is("vr-mode"),this.maxCanvasSize,this.is("vr-mode")),i.aspect=t.width/t.height,i.updateProjectionMatrix(),this.renderer.setSize(t.width,t.height,!1),this.emit("rendererresize",null,!1))},writable:!0},setupRenderer:{value:function(){var e,t,n,i,r=this;i={alpha:!0,antialias:!v,canvas:this.canvas,logarithmicDepthBuffer:!1},this.maxCanvasSize={height:1920,width:1920},this.hasAttribute("renderer")&&(n=this.getAttribute("renderer"),(t=u.styleParser.parse(n)).precision&&(i.precision=t.precision+"p"),t.antialias&&"auto"!==t.antialias&&(i.antialias="true"===t.antialias),t.logarithmicDepthBuffer&&"auto"!==t.logarithmicDepthBuffer&&(i.logarithmicDepthBuffer="true"===t.logarithmicDepthBuffer),this.maxCanvasSize={width:t.maxCanvasWidth?parseInt(t.maxCanvasWidth):this.maxCanvasSize.width,height:t.maxCanvasHeight?parseInt(t.maxCanvasHeight):this.maxCanvasSize.height}),(e=this.renderer=new l.WebGLRenderer(i)).setPixelRatio(window.devicePixelRatio),e.sortObjects=!1,this.camera&&e.vr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){e.vr.setPoseTarget(r.camera.el.object3D)}),o.setup(this,b)},writable:window.debug},play:{value:function(){var e=this,t=this;this.renderStarted?h.prototype.play.call(this):(this.addEventListener("loaded",function(){h.prototype.play.call(this),t.renderStarted||(t.resize(),t.renderer&&(window.performance&&window.performance.mark("render-started"),t.clock=new l.Clock,o.remove(),t.renderer.setAnimationLoop(this.render),t.render(),t.renderStarted=!0,t.emit("renderstart")))}),setTimeout(function(){h.prototype.load.call(e)}))}},updateComponent:{value:function(e){e in c||h.prototype.updateComponent.apply(this,arguments)}},tick:{value:function(e,t){var n,i=this.systems;for(n=0;n<this.behaviors.tick.length;n++)this.behaviors.tick[n].el.isPlaying&&this.behaviors.tick[n].tick(e,t);for(n=0;n<this.systemNames.length;n++)i[this.systemNames[n]].tick&&i[this.systemNames[n]].tick(e,t)}},tock:{value:function(e,t,n){var i,r=this.systems;for(i=0;i<this.behaviors.tock.length;i++)this.behaviors.tock[i].el.isPlaying&&this.behaviors.tock[i].tock(e,t,n);for(i=0;i<this.systemNames.length;i++)r[this.systemNames[i]].tock&&r[this.systemNames[i]].tock(e,t,n)}},render:{value:function(e,t){var n=this.renderer;this.frame=t,this.delta=1e3*this.clock.getDelta(),this.time=1e3*this.clock.elapsedTime,this.isPlaying&&this.tick(this.time,this.delta),n.render(this.object3D,this.camera,this.renderTarget)},writable:!0}})}),t.exports.setupCanvas=w},{"../../lib/three":151,"../../utils/":176,"../a-entity":99,"../a-node":101,"../a-register-element":102,"../system":114,"./loadingScreen":107,"./metaTags":108,"./postMessage":109,"./scenes":110,"./wakelock":111}],107:[function(e,t,n){var m,v,g,i=e("../../utils/"),y=i.styleParser;function A(e){var t=g(m.canvas,!1,m.maxCanvasSize,m.is("vr-mode"));e.aspect=t.width/t.height,e.updateProjectionMatrix(),m.renderer.setSize(t.width,t.height,!1)}window.addEventListener("vrdisplayactivate",function(){var e=m.renderer.vr,t=i.device.getVRDisplay();if(e.setDevice(t),e.enabled=!0,!t.isPresenting)return t.requestPresent([{source:m.canvas}]).then(function(){},function(){})}),t.exports.setup=function(e,t){g=t;var n,i,r,o,a,s,c,l,u,h,d=(m=e).hasAttribute("loading-screen")?y.parse(m.getAttribute("loading-screen")):void 0,p=d&&d.dotsColor||"white",f=d&&d.backgroundColor||"#24CAFF";void 0!==d&&!0!==d.enabled&&void 0!==d.enabled||(n=new THREE.Scene,i=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),r=new THREE.MeshBasicMaterial({color:p}),o=new THREE.Mesh(i,r),a=o.clone(),s=o.clone(),c=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),l=new THREE.Clock,u=0,h=function(){m.renderer.render(n,c),u=l.getElapsedTime()%4,o.visible=1<=u,a.visible=2<=u,s.visible=3<=u},n.background=new THREE.Color(f),n.add(c),o.position.set(-1,0,-15),a.position.set(0,0,-15),s.position.set(1,0,-15),c.add(o),c.add(a),c.add(s),(v=document.createElement("div")).className="a-loader-title",v.innerHTML=document.title,v.style.display="none",m.appendChild(v),setTimeout(function(){m.hasLoaded||(A(c),v.style.display="block",window.addEventListener("resize",function(){A(c)}),m.renderer.setAnimationLoop(h))},200))},t.exports.remove=function(){window.removeEventListener("resize",A),v&&(v.style.display="none")}},{"../../utils/":176}],108:[function(e,t,n){var i,a=e("../../constants/"),s=e("../../utils").extend,c=t.exports.MOBILE_HEAD_TAGS=[r({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui"}),r({name:"mobile-web-app-capable",content:"yes"}),r({name:"theme-color",content:"black"})],l=[r({name:"apple-mobile-web-app-capable",content:"yes"}),r({name:"apple-mobile-web-app-status-bar-style",content:"black"}),{tagName:"link",attributes:i={rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"},exists:function(){return document.querySelector('link[rel="'+i.rel+'"]')}}];function r(e){return{tagName:"meta",attributes:e,exists:function(){return document.querySelector('meta[name="'+e.name+'"]')}}}t.exports.inject=function(e){var t,n=document.head,i=n.querySelector("script"),r=[];return c.forEach(o),e.isIOS&&l.forEach(o),r;function o(e){e&&!e.exists()&&(t=function(e){if(e&&e.tagName){var t=document.createElement(e.tagName);return t.setAttribute(a.AFRAME_INJECTED,""),s(t,e.attributes)}}(e))&&(i?i.parentNode.insertBefore(t,i):n.appendChild(t),r.push(t))}}},{"../../constants/":95,"../../utils":176}],109:[function(e,t,n){var i=e("../../utils/bind"),r=e("../../utils/").isIframed;function o(e){if(e.data)switch(e.data.type){case"vr":switch(e.data.data){case"enter":this.enterVR();break;case"exit":this.exitVR()}}}t.exports=function(e){r()&&window.addEventListener("message",i(o,e))}},{"../../utils/":176,"../../utils/bind":170}],110:[function(e,t,n){t.exports=[]},{}],111:[function(e,t,n){var i=e("../../../vendor/wakelock/wakelock");t.exports=function(e){if(e.isMobile){var t=e.wakelock=new i;e.addEventListener("enter-vr",function(){t.request()}),e.addEventListener("exit-vr",function(){t.release()})}}},{"../../../vendor/wakelock/wakelock":189}],112:[function(e,t,n){var l,i=e("../utils/"),r=e("./propertyTypes"),o=i.debug,a=r.isValidDefaultValue,s=r.propertyTypes,u=o("core:schema:warn");function c(e){return"type"in e?"string"==typeof e.type:"default"in e}function h(e,t){var n,i,r=e.default,o=e.type;return e.type?"bool"===e.type?o="boolean":"float"===e.type&&(o="number"):o=void 0===r||"boolean"!=typeof r&&"number"!=typeof r?Array.isArray(r)?"array":"string":typeof r,(i=s[o])||u("Unknown property type for component `"+t+"`: "+o),n=!!e.parse,e.parse=e.parse||i.parse,e.stringify=e.stringify||i.stringify,e.type=o,"default"in e?n||a(o,r)||u("Default value `"+r+"` does not match type `"+o+"` in component `"+t+"`"):e.default=i.default,e}function d(e,t){return null!=e&&""!==e||(e=t.default,Array.isArray(e)&&(e=e.slice())),t.parse(e,t.default)}function p(e,t){return"object"!=typeof e?e:t&&null!==e?t.stringify(e):JSON.stringify(e)}t.exports.isSingleProperty=c,t.exports.process=function(e,t){var n;if(c(e))return h(e,t);for(n in e)e[n]=h(e[n],t);return e},t.exports.processPropertyDefinition=h,t.exports.parseProperties=(l=[],function(e,t,n,i,r){var o,a,s,c;for(a in l.length=0,n?e:t)n&&void 0===e[a]||l.push(a);if(null===e||"object"!=typeof e)return e;for(a in e)void 0===e[a]||t[a]||r||u("Unknown property `"+a+"` for component/system `"+i+"`.");for(o=0;o<l.length;o++){if(s=t[a=l[o]],c=e[a],!t[a])return;e[a]=d(c,s)}return e}),t.exports.parseProperty=d,t.exports.stringifyProperties=function(e,t){var n,i,r,o,a={};for(n in e)i=t[n],"object"==typeof(o=r=e[n])&&(o=p(r,i),i||u("Unknown component property: "+n)),a[n]=o;return a},t.exports.stringifyProperty=p},{"../utils/":176,"./propertyTypes":105}],113:[function(e,t,n){var r=e("./schema").process,o=t.exports.shaders={},a=t.exports.shaderNames=[],i=e("../lib/three"),s=e("../utils"),c={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},l=t.exports.Shader=function(){};l.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(e){return this.attributes=this.initVariables(e,"attribute"),this.uniforms=this.initVariables(e,"uniform"),this.material=new(this.raw?i.RawShaderMaterial:i.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initVariables:function(e,t){var n,i,r=this.schema,o={};for(n in r)r[n].is===t&&(i=c[r[n].type],o[n]={type:i,value:void 0});return o},update:function(e){this.updateVariables(e,"attribute"),this.updateVariables(e,"uniform")},updateVariables:function(e,t){var n,i,r,o=this.schema;for(n in r="uniform"===t?this.uniforms:this.attributes,e)if(o[n]&&o[n].is===t)if("map"!==o[n].type)r[n].value=this.parseValue(o[n].type,e[n]),r[n].needsUpdate=!0;else{if(!r[n]||r[n].value===e[n])continue;i="_texture_"+n,this.setMapOnTextureLoad(r,n,i),s.material.updateMapMaterialFromData(i,n,this,e)}},parseValue:function(e,t){var n;switch(e){case"vec2":return new i.Vector2(t.x,t.y);case"vec3":return new i.Vector3(t.x,t.y,t.z);case"vec4":return new i.Vector4(t.x,t.y,t.z,t.w);case"color":return n=new i.Color(t),new i.Vector3(n.r,n.g,n.b);case"map":return i.ImageUtils.loadTexture(t);default:return t}},setMapOnTextureLoad:function(e,t,n){var i=this;this.el.addEventListener("materialtextureloaded",function(){e[t].value=i.material[n],e[t].needsUpdate=!0})}},t.exports.registerShader=function(e,t){var n,i={};if(Object.keys(t).forEach(function(e){i[e]={value:t[e],writable:!0}}),o[e])throw new Error("The shader "+e+" has been already registered");return((n=function(){l.call(this)}).prototype=Object.create(l.prototype,i)).name=e,n.prototype.constructor=n,o[e]={Shader:n,schema:r(n.prototype.schema)},a.push(e),n}},{"../lib/three":151,"../utils":176,"./schema":112}],114:[function(e,t,n){var i=e("./component"),r=e("./schema"),a=e("../utils/"),o=r.parseProperties,s=r.parseProperty,c=r.process,l=r.isSingleProperty,u=a.styleParser,h=t.exports.systems={},d=t.exports.System=function(e){var t=i&&i.components[this.name];this.el=e,this.sceneEl=e,t&&(t.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};d.prototype={schema:{},init:function(){},update:function(e){},updateProperties:function(e){var t=this.data;Object.keys(r).length&&(this.buildData(e),this.update(t))},buildData:function(e){var t=this.schema;Object.keys(t).length&&(e=e||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),l(t)?this.data=s(e,t):this.data=o(u.parse(e)||{},t))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},t.exports.registerSystem=function(e,t){var n,i,r={},o=a.findAllScenes(document);if(Object.keys(t).forEach(function(e){r[e]={value:t[e],writable:!0}}),h[e])throw new Error("The system `"+e+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");for(((i=function(e){d.call(this,e)}).prototype=Object.create(d.prototype,r)).name=e,(i.prototype.constructor=i).prototype.schema=a.extend(c(i.prototype.schema)),h[e]=i,n=0;n<o.length;n++)o[n].initSystem(e)}},{"../utils/":176,"./component":103,"./schema":112}],115:[function(e,t,n){e("./pivot")},{"./pivot":116}],116:[function(e,t,n){var i=e("../../core/component").registerComponent,o=e("../../lib/three"),a=new o.Vector3,s=new o.Vector3;i("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var e=this.data,t=this.el,n=t.object3D.parent,i=t.object3D,r=new o.Group;a.copy(i.position),s.copy(i.rotation),n.remove(i),r.add(i),n.add(r),t.object3D=r,i.position.set(-1*e.x,-1*e.y,-1*e.z),r.position.set(e.x+a.x,e.y+a.y,e.z+a.z),r.rotation.copy(i.rotation),i.rotation.set(0,0,0)}})},{"../../core/component":103,"../../lib/three":151}],117:[function(e,t,n){var i=e("../../core/component").components,r=e("../../core/shader").shaders,o=e("../../utils/"),a={};function s(e){var t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();"fog"===e&&(t="material-fog"),"visible"===e&&(t="material-visible"),a[t]="material."+e}Object.keys(i.material.schema).forEach(s),Object.keys(r.standard.schema).forEach(s),t.exports=function(){return{defaultComponents:{material:{}},mappings:o.extend({},a)}}},{"../../core/component":103,"../../core/shader":113,"../../utils/":176}],118:[function(e,t,n){e("./primitives/a-camera"),e("./primitives/a-cursor"),e("./primitives/a-curvedimage"),e("./primitives/a-gltf-model"),e("./primitives/a-image"),e("./primitives/a-light"),e("./primitives/a-link"),e("./primitives/a-obj-model"),e("./primitives/a-sky"),e("./primitives/a-sound"),e("./primitives/a-text"),e("./primitives/a-video"),e("./primitives/a-videosphere"),e("./primitives/meshPrimitives")},{"./primitives/a-camera":120,"./primitives/a-cursor":121,"./primitives/a-curvedimage":122,"./primitives/a-gltf-model":123,"./primitives/a-image":124,"./primitives/a-light":125,"./primitives/a-link":126,"./primitives/a-obj-model":127,"./primitives/a-sky":128,"./primitives/a-sound":129,"./primitives/a-text":130,"./primitives/a-video":131,"./primitives/a-videosphere":132,"./primitives/meshPrimitives":133}],119:[function(e,n,t){var i=e("../../core/a-entity"),o=e("../../core/component").components,r=e("../../core/a-register-element").registerElement,u=e("../../utils/"),a=u.debug,s=u.entity.setComponentProperty,c=a("extras:primitives:debug"),l=a("extras:primitives:warn"),h=n.exports.primitives={};n.exports.registerPrimitive=function(e,t){e=e.toLowerCase(),c("Registering <%s>",e),t.defaultAttributes&&l("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var n=r(e,{prototype:Object.create(i.prototype,{defaultComponentsFromPrimitive:{value:t.defaultComponents||t.defaultAttributes||{}},deprecated:{value:t.deprecated||null},deprecatedMappings:{value:t.deprecatedMappings||{}},mappings:{value:t.mappings||{}},createdCallback:{value:function(){t.deprecated&&console.warn(t.deprecated),this.resolveMappingCollisions()}},resolveMappingCollisions:{value:function(){var n=this.mappings,i=this;Object.keys(n).forEach(function(e){var t;e!==e.toLowerCase()&&l("Mapping keys should be specified in lower case. The mapping key "+e+" may not be recognized"),o[e]&&(t=n[e].replace(".","-"),n[t]=n[e],delete n[e],console.warn("The primitive "+i.tagName.toLowerCase()+" has a mapping collision. The attribute "+e+" has the same name as a registered component and has been renamed to "+t))})}},getExtraComponents:{value:function(){var e,r,t,n,i,o,a=this;for(r=u.clone(this.defaultComponentsFromPrimitive),(i=this.getAttribute("mixin"))&&(i=i.trim().split(" ")).forEach(function(e){var i=a.sceneEl.querySelector("#"+e).componentCache;Object.keys(i).forEach(function(e){var t,n;r[e]=(t=r[e],n=i[e],s(t)?c(n):s(n)?c(t):l(t)&&l(n)?u.extendDeep(t,n):c(n))})}),t=0;t<this.attributes.length;t++)e=this.attributes[t],(n=this.mappings[e.name])&&((o=u.entity.getComponentPropertyPath(n)).constructor===Array?(r[o[0]]=r[o[0]]||{},r[o[0]][o[1]]=e.value.trim()):r[o]=e.value.trim());return r;function s(e){return void 0===e}function c(e){return l(e)?u.extendDeep({},e):e}function l(e){return null!==e&&e.constructor===Object}}},attributeChangedCallback:{value:function(e,t,n){var i=this.mappings[e];e in this.deprecatedMappings&&console.warn(this.deprecatedMappings[e]),e&&i&&s(this,i,n)}}})});return h[e]=n},n.exports.definePrimitive=function(e,t,r){r=r||{},Object.keys(t).map(function(e){var n,i,t;i=r,t=o[n=e].schema,Object.keys(t).map(function(e){var t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();void 0!==i[t]&&(t=n+"-"+e),i[t]=n+"."+e})}),n.exports.registerPrimitive(e,u.extendDeep({},null,{defaultComponents:t,mappings:r}))}},{"../../core/a-entity":99,"../../core/a-register-element":102,"../../core/component":103,"../../utils/":176}],120:[function(e,t,n){(0,e("../primitives").registerPrimitive)("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},{"../primitives":119}],121:[function(e,t,n){var i=e("../getMeshMixin");(0,e("../primitives").registerPrimitive)("a-cursor",e("../../../utils/").extendDeep({},i(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},{"../../../utils/":176,"../getMeshMixin":117,"../primitives":119}],122:[function(e,t,n){var i=e("../getMeshMixin");(0,e("../primitives").registerPrimitive)("a-curvedimage",e("../../../utils/").extendDeep({},i(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},{"../../../utils/":176,"../getMeshMixin":117,"../primitives":119}],123:[function(e,t,n){(0,e("../primitives").registerPrimitive)("a-gltf-model",{mappings:{src:"gltf-model"}})},{"../primitives":119}],124:[function(e,t,n){var i=e("../getMeshMixin");(0,e("../primitives").registerPrimitive)("a-image",e("../../../utils/").extendDeep({},i(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":176,"../getMeshMixin":117,"../primitives":119}],125:[function(e,t,n){(0,e("../primitives").registerPrimitive)("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target"}})},{"../primitives":119}],126:[function(e,t,n){(0,e("../primitives").registerPrimitive)("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},{"../primitives":119}],127:[function(e,t,n){var i=e("../getMeshMixin")();(0,e("../primitives").registerPrimitive)("a-obj-model",e("../../../utils/").extendDeep({},i,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},{"../../../utils/":176,"../getMeshMixin":117,"../primitives":119}],128:[function(e,t,n){var i=e("../getMeshMixin"),r=e("../primitives").registerPrimitive,o=e("../../../utils/"),a=e("./meshPrimitives");r("a-sky",o.extendDeep({},i(),{defaultComponents:{geometry:{primitive:"sphere",radius:5e3,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:o.extendDeep({},a["a-sphere"].prototype.mappings)}))},{"../../../utils/":176,"../getMeshMixin":117,"../primitives":119,"./meshPrimitives":133}],129:[function(e,t,n){(0,e("../primitives").registerPrimitive)("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},{"../primitives":119}],130:[function(e,t,n){(0,e("../primitives").definePrimitive)("a-text",{text:{anchor:"align",width:5}})},{"../primitives":119}],131:[function(e,t,n){var i=e("../getMeshMixin");(0,e("../primitives").registerPrimitive)("a-video",e("../../../utils/").extendDeep({},i(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":176,"../getMeshMixin":117,"../primitives":119}],132:[function(e,t,n){var i=e("../getMeshMixin");(0,e("../primitives").registerPrimitive)("a-videosphere",e("../../../utils/").extendDeep({},i(),{defaultComponents:{geometry:{primitive:"sphere",radius:5e3,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},{"../../../utils/":176,"../getMeshMixin":117,"../primitives":119}],133:[function(e,t,n){var a=e("../getMeshMixin"),s=e("../../../core/geometry").geometries,i=e("../../../core/geometry").geometryNames,c=e("../primitives").registerPrimitive,l=e("../../../utils/"),u=t.exports={};function h(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}i.forEach(function(e){var t=s[e],n=h(e),i={};Object.keys(t.schema).forEach(function(e){i[h(e)]="geometry."+e});var r="a-"+n,o=c(r,l.extendDeep({},a(),{defaultComponents:{geometry:{primitive:e}},mappings:i}));u[r]=o})},{"../../../core/geometry":104,"../../../utils/":176,"../getMeshMixin":117,"../primitives":119}],134:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three");i("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(e){this.geometry=new r.BoxGeometry(e.width,e.height,e.depth,e.segmentsWidth,e.segmentsHeight,e.segmentsDepth)}})},{"../core/geometry":104,"../lib/three":151}],135:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three"),o=r.Math.degToRad;i("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new r.CircleGeometry(e.radius,e.segments,o(e.thetaStart),o(e.thetaLength))}})},{"../core/geometry":104,"../lib/three":151}],136:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three"),o=r.Math.degToRad;i("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new r.CylinderGeometry(e.radiusTop,e.radiusBottom,e.height,e.segmentsRadial,e.segmentsHeight,e.openEnded,o(e.thetaStart),o(e.thetaLength))}})},{"../core/geometry":104,"../lib/three":151}],137:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three"),o=r.Math.degToRad;i("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new r.CylinderGeometry(e.radius,e.radius,e.height,e.segmentsRadial,e.segmentsHeight,e.openEnded,o(e.thetaStart),o(e.thetaLength))}})},{"../core/geometry":104,"../lib/three":151}],138:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three");i("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new r.DodecahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":104,"../lib/three":151}],139:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three");i("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new r.IcosahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":104,"../lib/three":151}],140:[function(e,t,n){e("./box.js"),e("./circle.js"),e("./cone.js"),e("./cylinder.js"),e("./dodecahedron.js"),e("./icosahedron.js"),e("./octahedron.js"),e("./plane.js"),e("./ring.js"),e("./sphere.js"),e("./tetrahedron.js"),e("./torus.js"),e("./torusKnot.js"),e("./triangle.js")},{"./box.js":134,"./circle.js":135,"./cone.js":136,"./cylinder.js":137,"./dodecahedron.js":138,"./icosahedron.js":139,"./octahedron.js":141,"./plane.js":142,"./ring.js":143,"./sphere.js":144,"./tetrahedron.js":145,"./torus.js":146,"./torusKnot.js":147,"./triangle.js":148}],141:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three");i("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new r.OctahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":104,"../lib/three":151}],142:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three");i("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(e){this.geometry=new r.PlaneGeometry(e.width,e.height,e.segmentsWidth,e.segmentsHeight)}})},{"../core/geometry":104,"../lib/three":151}],143:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three"),o=r.Math.degToRad;i("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new r.RingGeometry(e.radiusInner,e.radiusOuter,e.segmentsTheta,e.segmentsPhi,o(e.thetaStart),o(e.thetaLength))}})},{"../core/geometry":104,"../lib/three":151}],144:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three"),o=r.Math.degToRad;i("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(e){this.geometry=new r.SphereGeometry(e.radius,e.segmentsWidth,e.segmentsHeight,o(e.phiStart),o(e.phiLength),o(e.thetaStart),o(e.thetaLength))}})},{"../core/geometry":104,"../lib/three":151}],145:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three");i("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new r.TetrahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":104,"../lib/three":151}],146:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three"),o=r.Math.degToRad;i("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(e){this.geometry=new r.TorusGeometry(e.radius,2*e.radiusTubular,e.segmentsRadial,e.segmentsTubular,o(e.arc))}})},{"../core/geometry":104,"../lib/three":151}],147:[function(e,t,n){var i=e("../core/geometry").registerGeometry,r=e("../lib/three");i("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(e){this.geometry=new r.TorusKnotGeometry(e.radius,2*e.radiusTubular,e.segmentsTubular,e.segmentsRadial,e.p,e.q)}})},{"../core/geometry":104,"../lib/three":151}],148:[function(e,t,n){var i=e("../core/geometry").registerGeometry,s=e("../lib/three"),c=new s.Quaternion,l=new s.Vector3(0,0,1),u=new s.Vector2,h=new s.Vector2,d=new s.Vector2;i("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(e){var t,n,i,r,o,a;(i=new s.Triangle).a.set(e.vertexA.x,e.vertexA.y,e.vertexA.z),i.b.set(e.vertexB.x,e.vertexB.y,e.vertexB.z),i.c.set(e.vertexC.x,e.vertexC.y,e.vertexC.z),n=i.getNormal(new s.Vector3),c.setFromUnitVectors(n,l),r=i.a.clone().applyQuaternion(c),o=i.b.clone().applyQuaternion(c),a=i.c.clone().applyQuaternion(c),u.set(Math.min(r.x,o.x,a.x),Math.min(r.y,o.y,a.y)),h.set(Math.max(r.x,o.x,a.x),Math.max(r.y,o.y,a.y)),d.set(0,0).subVectors(h,u),r=(new s.Vector2).subVectors(r,u).divide(d),o=(new s.Vector2).subVectors(o,u).divide(d),a=(new s.Vector2).subVectors(a,u).divide(d),(t=this.geometry=new s.Geometry).vertices.push(i.a),t.vertices.push(i.b),t.vertices.push(i.c),t.faces.push(new s.Face3(0,1,2,n)),t.faceVertexUvs[0]=[[r,o,a]]}})},{"../core/geometry":104,"../lib/three":151}],149:[function(e,t,n){if(window.Promise=window.Promise||e("promise-polyfill"),window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=void 0!==navigator.xr,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var i=e("./utils/isIOSOlderThan10")(window.navigator.userAgent)?1/window.devicePixelRatio:1,r=e("webvr-polyfill"),o={BUFFER_SCALE:i,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0};window.webvrpolyfill=new r(o)}var a=e("./utils/"),s=a.debug;a.isIE11&&(e("custom-event-polyfill"),e("../vendor/starts-with-polyfill"));var c=s("A-Frame:error"),l=s("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&l("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),"file:"===window.location.protocol&&c("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server."),e("present"),a.device.isBrowserEnvironment&&(e("./style/aframe.css"),e("./style/rStats.css"));var u=e("./core/scene/a-scene").AScene,h=e("./core/component").components,d=e("./core/component").registerComponent,p=e("./core/geometry").registerGeometry,f=e("./extras/primitives/primitives").registerPrimitive,m=e("./core/shader").registerShader,v=e("./core/system").registerSystem,g=e("./core/shader").shaders,y=e("./core/system").systems,A=window.THREE=e("./lib/three"),b=e("../package");e("./components/index"),e("./geometries/index"),e("./shaders/index"),e("./systems/index");var w=e("./core/a-node"),x=e("./core/a-entity");e("./core/a-assets"),e("./core/a-cubemap"),e("./core/a-mixin"),e("./extras/components/"),e("./extras/primitives/"),console.log("A-Frame Version: 0.9.0 (Date 2019-02-07, Commit #faaca2b)"),console.log("three Version (https://github.com/supermedium/three.js):",b.dependencies["super-three"]),console.log("WebVR Polyfill Version:",b.dependencies["webvr-polyfill"]),t.exports=window.AFRAME={AComponent:e("./core/component").Component,AEntity:x,ANode:w,ANIME:e("animejs"),AScene:u,components:h,geometries:e("./core/geometry").geometries,registerComponent:d,registerElement:e("./core/a-register-element").registerElement,registerGeometry:p,registerPrimitive:f,registerShader:m,registerSystem:v,primitives:{getMeshMixin:e("./extras/primitives/getMeshMixin"),primitives:e("./extras/primitives/primitives").primitives},scenes:e("./core/scene/scenes"),schema:e("./core/schema"),shaders:g,systems:y,THREE:A,utils:a,version:b.version}},{"../package":51,"../vendor/starts-with-polyfill":187,"./components/index":60,"./core/a-assets":97,"./core/a-cubemap":98,"./core/a-entity":99,"./core/a-mixin":100,"./core/a-node":101,"./core/a-register-element":102,"./core/component":103,"./core/geometry":104,"./core/scene/a-scene":106,"./core/scene/scenes":110,"./core/schema":112,"./core/shader":113,"./core/system":114,"./extras/components/":115,"./extras/primitives/":118,"./extras/primitives/getMeshMixin":117,"./extras/primitives/primitives":119,"./geometries/index":140,"./lib/three":151,"./shaders/index":153,"./style/aframe.css":158,"./style/rStats.css":159,"./systems/index":163,"./utils/":176,"./utils/isIOSOlderThan10":178,animejs:2,"custom-event-polyfill":8,present:32,"promise-polyfill":34,"webvr-polyfill":46}],150:[function(e,t,n){window.aframeStats=function(e){var t=null,n=e;return{update:function(){var e;t("te").set((e=n.querySelectorAll("*"),Array.prototype.slice.call(e).filter(function(e){return e.isEntity}),e.length)),window.performance.getEntriesByName&&t("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))},start:function(){},end:function(){},attach:function(e){t=e},values:{te:{caption:"Entities"},lt:{caption:"Load Time"}},groups:[{caption:"A-Frame",values:["te","lt"]}],fractions:[]}},"object"==typeof t&&(t.exports={aframeStats:window.aframeStats})},{}],151:[function(n,i,e){(function(e){var t=e.THREE=n("super-three");t.TextureLoader&&(t.TextureLoader.prototype.crossOrigin="anonymous"),t.ImageLoader&&(t.ImageLoader.prototype.crossOrigin="anonymous"),t.Cache&&(t.Cache.enabled=!0),n("super-three/examples/js/loaders/DRACOLoader"),n("super-three/examples/js/loaders/GLTFLoader"),n("super-three/examples/js/loaders/OBJLoader"),n("super-three/examples/js/loaders/MTLLoader"),t.DRACOLoader.prototype.crossOrigin="anonymous",t.GLTFLoader.prototype.crossOrigin="anonymous",t.MTLLoader.prototype.crossOrigin="anonymous",t.OBJLoader.prototype.crossOrigin="anonymous",i.exports=t}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"super-three":36,"super-three/examples/js/loaders/DRACOLoader":37,"super-three/examples/js/loaders/GLTFLoader":38,"super-three/examples/js/loaders/MTLLoader":39,"super-three/examples/js/loaders/OBJLoader":40}],152:[function(e,t,n){var i=e("../core/shader").registerShader,r=e("../lib/three"),o=e("../utils/");function a(e,t){return t.color.set(e.color),t.fog=e.fog,t.wireframe=e.wireframe,t.wireframeLinewidth=e.wireframeLinewidth,t}t.exports.Shader=i("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(e){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new r.Color},this.textureSrc=null,a(e,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.material=new r.MeshBasicMaterial(this.materialData),o.material.updateMap(this,e)},update:function(e){this.updateMaterial(e),o.material.updateMap(this,e)},updateMaterial:function(e){var t;for(t in a(e,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.materialData)this.material[t]=this.materialData[t]}})},{"../core/shader":113,"../lib/three":151,"../utils/":176}],153:[function(e,t,n){e("./flat"),e("./standard"),e("./sdf"),e("./msdf"),e("./ios10hls")},{"./flat":152,"./ios10hls":154,"./msdf":155,"./sdf":156,"./standard":157}],154:[function(e,t,n){var i=e("../core/shader").registerShader;t.exports.Shader=i("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:["varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["uniform sampler2D src;","uniform float opacity;","varying vec2 vUV;","void main() {","  vec2 offset = vec2(0, 0);","  vec2 repeat = vec2(1, 1);","  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;","  gl_FragColor = vec4(color.rgb, opacity);","}"].join("\n")})},{"../core/shader":113}],155:[function(e,t,n){var i=e("../core/shader").registerShader;t.exports.Shader=i("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sample = texture2D(map, vUV).rgb;","  if (negate) { sample = 1.0 - sample; }","  float sigDist = median(sample.r, sample.g, sample.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","}"].join("\n")})},{"../core/shader":113}],156:[function(e,t,n){var i=e("../core/shader").registerShader;t.exports.Shader=i("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","#ifdef GL_OES_standard_derivatives","  float contour(float width, float value) {","    return smoothstep(0.5 - value, 0.5 + value, width);","  }","#else","  float aastep(float value, float afwidth) {","    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","  }","#endif","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","void main() {","  #ifdef GL_OES_standard_derivatives","    vec2 uv = vUV;","    vec4 texColor = texture2D(map, uv);","    float dist = texColor.a;","    float width = fwidth(dist);","    float alpha = contour(dist, width);","    float dscale = 0.353505;","    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","    float isBigEnough = max(abs(duv.x), abs(duv.y));","    if (isBigEnough <= BIG_ENOUGH) {","      vec4 box = vec4 (uv - duv, uv + duv);","      alpha = (alpha + 0.5 * (","        contour(texture2D(map, box.xy).a, width)","        + contour(texture2D(map, box.zw).a, width)","        + contour(texture2D(map, box.xw).a, width)","        + contour(texture2D(map, box.zy).a, width)","      )) / 3.0;","    }","    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  #else","    vec4 texColor = texture2D(map, vUV);","    float value = texColor.a;","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","    float alpha = aastep(value, afwidth);","    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","    alpha = alpha * ratio + (1.0 - ratio) * value;","    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }","  #endif","  gl_FragColor = vec4(color, opacity * alpha);","}"].join("\n")})},{"../core/shader":113}],157:[function(e,t,n){var i=e("../core/shader").registerShader,o=e("../lib/three"),a=e("../utils/"),s=new o.CubeTextureLoader,c={};function r(e,t){return t.color.set(e.color),t.emissive.set(e.emissive),t.emissiveIntensity=e.emissiveIntensity,t.fog=e.fog,t.metalness=e.metalness,t.roughness=e.roughness,t.wireframe=e.wireframe,t.wireframeLinewidth=e.wireframeLinewidth,e.normalMap&&(t.normalScale=e.normalScale),e.ambientOcclusionMap&&(t.aoMapIntensity=e.ambientOcclusionMapIntensity),e.displacementMap&&(t.displacementScale=e.displacementScale,t.displacementBias=e.displacementBias),t}t.exports.Shader=i("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(e){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new o.Color,emissive:new o.Color},r(e,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.material=new o.MeshStandardMaterial(this.materialData),a.material.updateMap(this,e),e.normalMap&&a.material.updateDistortionMap("normal",this,e),e.displacementMap&&a.material.updateDistortionMap("displacement",this,e),e.ambientOcclusionMap&&a.material.updateDistortionMap("ambientOcclusion",this,e),e.metalnessMap&&a.material.updateDistortionMap("metalness",this,e),e.roughnessMap&&a.material.updateDistortionMap("roughness",this,e),this.updateEnvMap(e)},update:function(e){this.updateMaterial(e),a.material.updateMap(this,e),e.normalMap&&a.material.updateDistortionMap("normal",this,e),e.displacementMap&&a.material.updateDistortionMap("displacement",this,e),e.ambientOcclusionMap&&a.material.updateDistortionMap("ambientOcclusion",this,e),e.metalnessMap&&a.material.updateDistortionMap("metalness",this,e),e.roughnessMap&&a.material.updateDistortionMap("roughness",this,e),this.updateEnvMap(e)},updateMaterial:function(e){var t,n=this.material;for(t in r(e,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.materialData)n[t]=this.materialData[t]},updateEnvMap:function(e){var n=this,i=this.material,r=e.envMap,t=e.sphericalEnvMap;if(!r&&!t||this.isLoadingEnvMap)return i.envMap=null,void(i.needsUpdate=!0);this.isLoadingEnvMap=!0,t?this.el.sceneEl.systems.material.loadTexture(t,{src:t},function(e){n.isLoadingEnvMap=!1,e.mapping=o.SphericalReflectionMapping,i.envMap=e,a.material.handleTextureEvents(n.el,e),i.needsUpdate=!0}):c[r]?c[r].then(function(e){n.isLoadingEnvMap=!1,i.envMap=e,a.material.handleTextureEvents(n.el,e),i.needsUpdate=!0}):c[r]=new Promise(function(t){a.srcLoader.validateCubemapSrc(r,function(e){s.load(e,function(e){n.isLoadingEnvMap=!1,i.envMap=e,a.material.handleTextureEvents(n.el,e),t(e)})})})}})},{"../core/shader":113,"../lib/three":151,"../utils/":176}],158:[function(e,t,n){var i="html.a-fullscreen{bottom:0;left:0;position:fixed;right:0;top:0}html.a-fullscreen body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}html.a-fullscreen .a-canvas{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;position:fixed!important}html:not(.a-fullscreen) .a-enter-vr{right:5px;bottom:5px}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}canvas.a-canvas.a-mouse-cursor-hover:hover{cursor:pointer}.a-inspector-loader{background-color:#ed3160;position:fixed;left:3px;top:3px;padding:6px 10px;color:#fff;text-decoration:none;font-size:12px;font-family:Roboto,sans-serif;text-align:center;z-index:99999;width:204px}@keyframes dots-1{from{opacity:0}25%{opacity:1}}@keyframes dots-2{from{opacity:0}50%{opacity:1}}@keyframes dots-3{from{opacity:0}75%{opacity:1}}@-webkit-keyframes dots-1{from{opacity:0}25%{opacity:1}}@-webkit-keyframes dots-2{from{opacity:0}50%{opacity:1}}@-webkit-keyframes dots-3{from{opacity:0}75%{opacity:1}}.a-inspector-loader .dots span{animation:dots-1 2s infinite steps(1);-webkit-animation:dots-1 2s infinite steps(1)}.a-inspector-loader .dots span:first-child+span{animation-name:dots-2;-webkit-animation-name:dots-2}.a-inspector-loader .dots span:first-child+span+span{animation-name:dots-3;-webkit-animation-name:dots-3}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;position:absolute;right:20px;bottom:20px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff}.a-enter-vr-button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20245.82%20141.73%22%3E%3Cdefs%3E%3Cstyle%3E.a%7Bfill%3A%23fff%3Bfill-rule%3Aevenodd%3B%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Ctitle%3Emask%3C%2Ftitle%3E%3Cpath%20class%3D%22a%22%20d%3D%22M175.56%2C111.37c-22.52%2C0-40.77-18.84-40.77-42.07S153%2C27.24%2C175.56%2C27.24s40.77%2C18.84%2C40.77%2C42.07S198.08%2C111.37%2C175.56%2C111.37ZM26.84%2C69.31c0-23.23%2C18.25-42.07%2C40.77-42.07s40.77%2C18.84%2C40.77%2C42.07-18.26%2C42.07-40.77%2C42.07S26.84%2C92.54%2C26.84%2C69.31ZM27.27%2C0C11.54%2C0%2C0%2C12.34%2C0%2C28.58V110.9c0%2C16.24%2C11.54%2C30.83%2C27.27%2C30.83H99.57c2.17%2C0%2C4.19-1.83%2C5.4-3.7L116.47%2C118a8%2C8%2C0%2C0%2C1%2C12.52-.18l11.51%2C20.34c1.2%2C1.86%2C3.22%2C3.61%2C5.39%2C3.61h72.29c15.74%2C0%2C27.63-14.6%2C27.63-30.83V28.58C245.82%2C12.34%2C233.93%2C0%2C218.19%2C0H27.27Z%22%2F%3E%3C%2Fsvg%3E) 50% 50%/70% 70% no-repeat rgba(0,0,0,.35);border:0;bottom:0;cursor:pointer;min-width:50px;min-height:30px;padding-right:5%;padding-top:4%;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999}.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#666}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:\"Insert phone into Cardboard holder.\";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}.a-loader-title{background-color:rgba(0,0,0,.6);font-family:sans-serif,monospace;text-align:center;font-size:20px;height:50px;font-weight:300;line-height:50px;position:absolute;right:0;left:0;top:0;color:#fff}";e("browserify-css").createStyle(i,{href:"src/style/aframe.css"}),t.exports=i},{"browserify-css":5}],159:[function(e,t,n){var i=".rs-base{background-color:#333;color:#fafafa;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}";e("browserify-css").createStyle(i,{href:"src/style/rStats.css"}),t.exports=i},{"browserify-css":5}],160:[function(e,t,n){var i=e("../constants/"),r=e("../core/system").registerSystem,u="data-aframe-default-camera";t.exports.System=r("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var e,t,n=this.sceneEl,i=this;if(!n.camera||n.camera.el.getAttribute("camera").spectator)if((e=n.querySelectorAll("a-camera, [camera]")).length)for(this.numUserCameras=e.length,t=0;t<e.length;t++)e[t].addEventListener("object3dset",function(e){"camera"===e.detail.type&&i.checkUserCamera(this)}),e[t].isNode?e[t].load():e[t].addEventListener("nodeready",function(){this.load()});else this.createDefaultCamera();else n.emit("cameraready",{cameraEl:n.camera.el})},checkUserCamera:function(e){var t,n=this.el.sceneEl;this.numUserCamerasChecked++,this.initialCameraFound||((t=e.getAttribute("camera")).active&&!t.spectator?(this.initialCameraFound=!0,n.camera=e.getObject3D("camera"),n.emit("cameraready",{cameraEl:e})):this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera())},createDefaultCamera:function(){var t,n=this.sceneEl;(t=document.createElement("a-entity")).setAttribute("camera",{active:!0}),t.setAttribute("position",{x:0,y:i.DEFAULT_CAMERA_HEIGHT,z:0}),t.setAttribute("wasd-controls",""),t.setAttribute("look-controls",""),t.setAttribute(i.AFRAME_INJECTED,""),t.addEventListener("object3dset",function(e){"camera"===e.detail.type&&(n.camera=e.detail.object,n.emit("cameraready",{cameraEl:t}))}),n.appendChild(t)},disableActiveCamera:function(){var e;(e=this.sceneEl.querySelectorAll("[camera]"))[e.length-1].setAttribute("camera","active",!0)},setActiveCamera:function(e){var t,n,i,r,o,a,s=this.activeCameraEl,c=this.sceneEl;if((r=e.getObject3D("camera"))&&e!==this.activeCameraEl){var l=c.querySelector("["+u+"]");for(e!==(l&&l.querySelector("[camera]"))&&(a=void 0,(o=c).camera&&(a=o.querySelector("["+u+"]"))&&o.removeChild(a)),this.activeCameraEl=e,this.activeCameraEl.play(),c.camera=r,s&&s.setAttribute("camera","active",!1),n=c.querySelectorAll("[camera]"),i=0;i<n.length;i++)(t=n[i]).isEntity&&e!==t&&(t.setAttribute("camera","active",!1),t.pause());c.emit("camera-set-active",{cameraEl:e})}},setSpectatorCamera:function(e){var t,n=this.spectatorCameraEl,i=this.sceneEl;e.getObject3D("camera")&&e!==this.spectatorCameraEl&&(n&&n.setAttribute("camera","spectator",!1),t=this.spectatorCameraEl=e,i.addEventListener("enter-vr",this.wrapRender),i.addEventListener("exit-vr",this.unwrapRender),t.setAttribute("camera","active",!1),t.play(),i.emit("camera-set-spectator",{cameraEl:e}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){this.spectatorCameraEl&&(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(e,t,n){var i,r,o=this.sceneEl;i=o.renderer.vr.enabled,this.originalRender.call(o.renderer,e,t,n),this.spectatorCameraEl&&!o.isMobile&&i&&(r=this.spectatorCameraEl.components.camera.camera,o.renderer.vr.enabled=!1,this.originalRender.call(o.renderer,e,r),o.renderer.vr.enabled=i)}})},{"../constants/":95,"../core/system":114}],161:[function(e,t,n){var a=e("../core/geometry").geometries,i=e("../core/system").registerSystem,s=e("../lib/three");function o(e){var t,n,i=e.primitive,r=a[i]&&a[i].Geometry,o=new r;if(!r)throw new Error("Unknown geometry `"+i+"`");return o.init(e),t=o.geometry,e.buffer?((n=(new s.BufferGeometry).fromGeometry(t)).metadata={type:t.type,parameters:t.parameters||{}},t.dispose(),n):t}t.exports.System=i("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(e){var t,n,i,r=this.cache;return e.skipCache?o(e):(t=r[n=this.hash(e)],(i=this.cacheCount)[n]=void 0===i[n]?1:i[n]+1,t||(t=o(e),r[n]=t))},unuseGeometry:function(e){var t,n=this.cache,i=this.cacheCount;e.skipCache||n[t=this.hash(e)]&&(i[t]--,0<i[t]||(n[t].dispose(),delete n[t],delete i[t]))},hash:function(e){return JSON.stringify(e)}})},{"../core/geometry":104,"../core/system":114,"../lib/three":151}],162:[function(e,t,n){var i=e("../core/system").registerSystem,r=e("../lib/three");t.exports.System=i("gltf-model",{schema:{dracoDecoderPath:{default:""}},init:function(){var e=this.data.dracoDecoderPath;r.DRACOLoader.setDecoderPath(e),this.dracoLoader=e?new r.DRACOLoader:null},getDRACOLoader:function(){return this.dracoLoader}})},{"../core/system":114,"../lib/three":151}],163:[function(e,t,n){e("./camera"),e("./geometry"),e("./gltf-model"),e("./light"),e("./material"),e("./renderer"),e("./shadow"),e("./tracked-controls-webvr"),e("./tracked-controls-webxr")},{"./camera":160,"./geometry":161,"./gltf-model":162,"./light":164,"./material":165,"./renderer":166,"./shadow":167,"./tracked-controls-webvr":168,"./tracked-controls-webxr":169}],164:[function(e,t,n){var i=e("../core/system").registerSystem,r=e("../utils/bind"),o=e("../constants/");t.exports.System=i("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",r(this.setupDefaultLights,this))},registerLight:function(e){e.hasAttribute("data-aframe-default-light")||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var e,t=this.sceneEl;if(this.defaultLights){e=document.querySelectorAll("[data-aframe-default-light]");for(var n=0;n<e.length;n++)t.removeChild(e[n]);this.defaultLights=!1}},setupDefaultLights:function(){var e,t,n=this.sceneEl;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||((e=document.createElement("a-entity")).setAttribute("light",{color:"#BBB",type:"ambient"}),e.setAttribute("data-aframe-default-light",""),e.setAttribute(o.AFRAME_INJECTED,""),n.appendChild(e),(t=document.createElement("a-entity")).setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),t.setAttribute("position",{x:-.5,y:1,z:1}),t.setAttribute("data-aframe-default-light",""),t.setAttribute(o.AFRAME_INJECTED,""),n.appendChild(t),this.defaultLights=!0)}})},{"../constants/":95,"../core/system":114,"../utils/bind":170}],165:[function(e,t,n){var i=e("../core/system").registerSystem,f=e("../lib/three"),r=e("../utils/"),m=e("../utils/material").isHLS,o=r.bind,a=r.debug,s=a("components:texture:error"),c=new f.TextureLoader,v=a("components:texture:warn");function g(e,t){var n=t.offset||{x:0,y:0},i=t.repeat||{x:1,y:1};!t.npot&&1||(e.wrapS=f.ClampToEdgeWrapping,e.wrapT=f.ClampToEdgeWrapping,e.magFilter=f.LinearFilter,e.minFilter=f.LinearFilter),1===i.x&&1===i.y||(e.wrapS=f.RepeatWrapping,e.wrapT=f.RepeatWrapping,e.repeat.set(i.x,i.y)),0===n.x&&0===n.y||e.offset.set(n.x,n.y)}c.setCrossOrigin("anonymous"),t.exports.System=i("material",{init:function(){this.materials={},this.textureCounts={},this.textureCache={},this.sceneEl.addEventListener("materialtextureloaded",o(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(e,t,n){var i=this;if("CANVAS"!==e.tagName){if("VIDEO"===e.tagName)return e.src||e.srcObject||e.childElementCount||v("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes."),void this.loadVideo(e,t,n);r.srcLoader.validateSrc(e,function(e){i.loadImage(e,t,n)},function(e){i.loadVideo(e,t,n)})}else this.loadCanvas(e,t,n)},loadImage:function(e,t,n){var i,r,o=this.hash(t),a=this.textureCache;a[o]||(a[o]=(i=e,r=t,new Promise(function(t,e){function n(e){g(e,r),e.needsUpdate=!0,t(e)}"string"==typeof i?c.load(i,n,function(){},function(e){s("`$s` could not be fetched (Error code: %s; Response: %s)",e.status,e.statusText)}):n(new f.Texture(i))}))),a[o].then(n)},loadCanvas:function(e,t,n){var i;g(i=new f.CanvasTexture(e),t),n(i)},loadVideo:function(e,t,n){var i,r,o,a,s,c,l,u,h,d=this.textureCache;function p(e){e.texture.needsUpdate=!0,n(e.texture,e.videoEl)}if("string"!=typeof e){if(o=e,d[i=this.hashVideo(t,o)])return void d[i].then(p);(s=o).autoplay=s.hasAttribute("autoplay")&&"false"!==s.getAttribute("autoplay"),s.controls=s.hasAttribute("controls")&&"false"!==s.getAttribute("controls"),"false"===s.getAttribute("loop")&&s.removeAttribute("loop"),"false"===s.getAttribute("preload")&&(s.preload="none"),s.crossOrigin=s.crossOrigin||"anonymous",s.setAttribute("playsinline",""),s.setAttribute("webkit-playsinline","")}o=o||(c=e,l=t.width,u=t.height,(h=document.createElement("video")).width=l,h.height=u,h.setAttribute("playsinline",""),h.setAttribute("webkit-playsinline",""),h.autoplay=!0,h.loop=!0,h.crossOrigin="anonymous",h.addEventListener("error",function(){v("`$s` is not a valid video",c)},!0),h.src=c,h),d[i=this.hashVideo(t,o)]?d[i].then(p):((r=new f.VideoTexture(o)).minFilter=f.LinearFilter,g(r,t),this.sceneEl.isIOS&&m(o.src||o.getAttribute("src"),o.type||o.getAttribute("type"))&&(r.format=f.RGBAFormat,r.needsCorrectionBGRA=!0,r.flipY=!1,r.needsCorrectionFlipY=!0),a={texture:r,videoEl:o},d[i]=Promise.resolve(a),p(a))},hash:function(e){return e.src.tagName&&((e=r.extendDeep({},e)).src=e.src.src),JSON.stringify(e)},hashVideo:function(e,t){return function(e,t){var n,i,r,o=t.getAttribute("id");if(o)return o;for(i="",r=e||{},n=0;n<t.attributes.length;n++)r[t.attributes[n].name]=t.attributes[n].value;return Object.keys(r).sort().forEach(function(e){i+=e+":"+r[e]+";"}),i}(e,t)},registerMaterial:function(e){this.materials[e.uuid]=e},unregisterMaterial:function(t){delete this.materials[t.uuid];var n=this.textureCounts;Object.keys(t).filter(function(e){return t[e]&&t[e].isTexture}).forEach(function(e){n[t[e].uuid]--,n[t[e].uuid]<=0&&t[e].dispose()})},updateMaterials:function(e){var t=this.materials;Object.keys(t).forEach(function(e){t[e].needsUpdate=!0})},onMaterialTextureLoaded:function(e){this.textureCounts[e.detail.texture.uuid]||(this.textureCounts[e.detail.texture.uuid]=0),this.textureCounts[e.detail.texture.uuid]++}})},{"../core/system":114,"../lib/three":151,"../utils/":176,"../utils/material":179}],166:[function(e,t,n){var i=e("../core/system").registerSystem,r=e("../utils/"),o=e("../lib/three"),a=(0,r.debug)("components:renderer:warn");t.exports.System=i("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:!1},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:1920},maxCanvasHeight:{default:1920},physicallyCorrectLights:{default:!1},precision:{default:"high",oneOf:["high","medium","low"]},sortObjects:{default:!1},colorManagement:{default:!1},gammaOutput:{default:!1}},init:function(){var e=this.data,t=this.el,n=t.renderer;n.sortObjects=e.sortObjects,n.physicallyCorrectLights=e.physicallyCorrectLights,t.highRefreshRate=e.highRefreshRate,(e.colorManagement||e.gammaOutput)&&(n.gammaOutput=!0,n.gammaFactor=2.2,e.gammaOutput&&a('Property `gammaOutput` is deprecated. Use `renderer="colorManagement: true;"` instead.')),t.hasAttribute("antialias")&&a('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),t.hasAttribute("logarithmicDepthBuffer")&&a('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.')},applyColorCorrection:function(e){this.data.colorManagement&&e&&(e.isColor?e.convertSRGBToLinear():e.isTexture&&(e.encoding=o.sRGBEncoding))}})},{"../core/system":114,"../lib/three":151,"../utils/":176}],167:[function(e,t,n){var i=e("../core/system").registerSystem,r=e("../lib/three"),o={basic:r.BasicShadowMap,pcf:r.PCFShadowMap,pcfsoft:r.PCFSoftShadowMap};t.exports.System=i("shadow",{schema:{autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var e=this.sceneEl,t=this.data;this.shadowMapEnabled=!1,e.renderer&&(e.renderer.shadowMap.type=o[t.type],e.renderer.shadowMap.autoUpdate=t.autoUpdate,this.setShadowMapEnabled(this.shadowMapEnabled))},setShadowMapEnabled:function(e){var t=this.sceneEl.renderer;this.shadowMapEnabled=e,t&&(t.shadowMap.enabled=e)}})},{"../core/system":114,"../lib/three":151}],168:[function(e,t,n){var i=e("../core/system").registerSystem,r=e("../utils");t.exports.System=i("tracked-controls-webvr",{init:function(){var t=this;this.controllers=[],this.updateControllerList(),this.throttledUpdateControllerList=r.throttle(this.updateControllerList,500,this),navigator.getVRDisplays&&this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(e){e.length&&(t.vrDisplay=e[0])})})},tick:function(){-1!==navigator.userAgent.indexOf("Chrome")&&navigator.getGamepads&&navigator.getGamepads(),this.throttledUpdateControllerList()},updateControllerList:function(){var e,t,n,i,r=this.controllers;if(t=navigator.getGamepads&&navigator.getGamepads()){for(i=r.length,n=r.length=0;n<t.length;++n)(e=t[n])&&e.pose&&r.push(e);r.length!==i&&this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":114,"../utils":176}],169:[function(e,t,n){var i=e("../core/system").registerSystem,r=e("../utils");t.exports.System=i("tracked-controls-webxr",{init:function(){this.controllers=[],this.throttledUpdateControllerList=r.throttle(this.updateControllerList,500,this)},tick:function(){this.throttledUpdateControllerList()},updateControllerList:function(){var e=this.controllers.length;this.el.xrSession&&(this.controllers=this.el.xrSession.getInputSources(),e!==this.controllers.length&&this.el.emit("controllersupdated",void 0,!1))}})},{"../core/system":114,"../utils":176}],170:[function(e,t,n){t.exports=function(t,n){return i=Array.prototype.slice.call(arguments,2),function(){var e=i.concat(Array.prototype.slice.call(arguments,0));return t.apply(n,e)};var i}},{}],171:[function(e,t,n){var i=e("./debug"),h=e("object-assign"),r=i("utils:coordinates:warn"),d=["x","y","z","w"],o=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;t.exports.regex=o;var p=/\s+/g;function a(e){return o.test(e)}function f(e){return null!=e&&e.constructor===String?parseFloat(e,10):e}t.exports.parse=function(e,t){var n,i,r,o,a,s,c,l,u;if(e&&e instanceof Object)return s=void 0===e.x?t&&t.x:e.x,c=void 0===e.y?t&&t.y:e.y,l=void 0===e.z?t&&t.z:e.z,u=void 0===e.w?t&&t.w:e.w,null!=s&&(e.x=f(s)),null!=c&&(e.y=f(c)),null!=l&&(e.z=f(l)),null!=u&&(e.w=f(u)),e;if(null==e)return"object"==typeof t?h({},t):t;for(n=e.trim().split(p),a={},o=0;o<d.length;o++)if(r=d[o],n[o])a[r]=parseFloat(n[o],10);else{if(void 0===(i=t&&t[r]))continue;a[r]=f(i)}return a},t.exports.stringify=function(e){var t;return"object"!=typeof e?e:(t=e.x+" "+e.y,e.z&&(t+=" "+e.z),e.w&&(t+=" "+e.w),t)},t.exports.isCoordinates=a,t.exports.isCoordinate=function(e){return r("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),a(e)},t.exports.toVector3=function(e){return new THREE.Vector3(e.x,e.y,e.z)}},{"./debug":172,"object-assign":26}],172:[function(a,s,e){(function(e){function t(e){var t,n,i=r(e);return i.color=(n=(t=e.split(":"))[t.length-1],o.colors&&o.colors[n]||null),i}var r=a("debug"),n=a("object-assign"),o={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}};n(t,r);var i=function(){try{return window.localStorage}catch(e){}}();i&&(parseInt(i.logs,10)||"true"===i.logs)?t.enable("*"):t.enable("*:error,*:info,*:warn"),e.browser&&(window.logs=t),s.exports=t}).call(this,a("_process"))},{_process:33,debug:9,"object-assign":26}],173:[function(e,h,t){(function(e){var n;function t(){return n}navigator.getVRDisplays&&navigator.getVRDisplays().then(function(e){var t=document.querySelector("a-scene");n=e.length&&e[0],t&&t.emit("displayconnected",{vrDisplay:n})}),h.exports.isWebXRAvailable=void 0!==navigator.xr,h.exports.getVRDisplay=t,h.exports.checkHeadsetConnected=function(){return!!t()},h.exports.checkHasPositionalTracking=function(){var e=t();return!(o()||c()||l())&&e&&e.capabilities.hasPosition};var i,r,o=(r=!1,i=window.navigator.userAgent||window.navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4)))&&(r=!0),(s()||a()||u())&&(r=!0),l()&&(r=!1),function(){return r});function a(e){var t=e||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(t)}function s(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}function c(){return/SamsungBrowser.+Mobile VR/i.test(window.navigator.userAgent)}function l(){return/Pacific Build.+OculusBrowser.+SamsungBrowser.+Mobile VR/i.test(window.navigator.userAgent)}function u(){return/R7 Build/.test(window.navigator.userAgent)}h.exports.isMobile=o,h.exports.isTablet=a,h.exports.isIOS=s,h.exports.isGearVR=c,h.exports.isOculusGo=l,h.exports.isR7=u,h.exports.isLandscape=function(){var e=window.orientation;return u()&&(e+=90),90===e||-90===e},h.exports.isBrowserEnvironment=!(e&&!e.browser),h.exports.isNodeEnvironment=!h.exports.isBrowserEnvironment,h.exports.PolyfillControls=function(t){var n,i=window.webvrpolyfill&&window.webvrpolyfill.getPolyfillDisplays()[0];window.VRFrameData&&(n=new window.VRFrameData),this.update=function(){var e;i&&(i.getFrameData(n),null!==(e=n.pose).orientation&&t.quaternion.fromArray(e.orientation),null!==e.position?t.position.fromArray(e.position):t.position.set(0,0,0))}}}).call(this,e("_process"))},{_process:33}],174:[function(e,t,n){var i={};function o(e,t){return i[t=t||"."]||(i[t]={}),-1!==e.indexOf(t)?i[t][e]=e.split(t):i[t][e]=e,i[t][e]}t.exports.getComponentPropertyPath=o,t.exports.propertyPathCache=i,t.exports.getComponentProperty=function(e,t,n){var i;return n=n||".",-1!==t.indexOf(n)?(i=o(t,n)).constructor===String?e.getAttribute(i):e.getAttribute(i[0])[i[1]]:e.getAttribute(t)},t.exports.setComponentProperty=function(e,t,n,i){var r;i=i||".",-1===t.indexOf(i)?e.setAttribute(t,n):(r=o(t,i)).constructor===String?e.setAttribute(r,n):e.setAttribute(r[0],r[1],n)}},{}],175:[function(e,t,n){t.exports=function(e){var t=e.style.width,n=e.style.height;e.style.width=parseInt(t,10)+1+"px",e.style.height=parseInt(n,10)+1+"px",setTimeout(function(){e.style.width=t,e.style.height=n},200)}},{}],176:[function(e,a,t){var n=e("./debug"),i=e("deep-assign"),r=e("./device"),o=e("object-assign"),s=e("./object-pool"),c=n("utils:warn");a.exports.bind=e("./bind"),a.exports.coordinates=e("./coordinates"),a.exports.debug=n,a.exports.device=r,a.exports.entity=e("./entity"),a.exports.forceCanvasResizeSafariMobile=e("./forceCanvasResizeSafariMobile"),a.exports.isIE11=e("./is-ie11"),a.exports.material=e("./material"),a.exports.objectPool=s,a.exports.split=e("./split").split,a.exports.styleParser=e("./styleParser"),a.exports.trackedControls=e("./tracked-controls"),a.exports.checkHeadsetConnected=function(){return c("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),r.checkHeadsetConnected(arguments)},a.exports.isGearVR=function(){return c("`utils.isGearVR` has moved to `utils.device.isGearVR`"),r.isGearVR(arguments)},a.exports.isIOS=function(){return c("`utils.isIOS` has moved to `utils.device.isIOS`"),r.isIOS(arguments)},a.exports.isMobile=function(){return c("`utils.isMobile has moved to `utils.device.isMobile`"),r.isMobile(arguments)},a.exports.throttle=function(t,n,e){var i;return e&&(t=a.exports.bind(t,e)),function(){var e=Date.now();(void 0===i||n<=(void 0===i?n:e-i))&&(i=e,t.apply(null,arguments))}},a.exports.throttleTick=function(i,r,e){var o;return e&&(i=a.exports.bind(i,e)),function(e,t){var n=void 0===o?t:e-o;(void 0===o||r<=n)&&i(o=e,n)}},a.exports.debounce=function(i,r,o){var a;return function(){var e=this,t=arguments,n=o&&!a;clearTimeout(a),a=setTimeout(function(){a=null,o||i.apply(e,t)},r),n&&i.apply(e,t)}},a.exports.extend=o,a.exports.extendDeep=i,a.exports.clone=function(e){return JSON.parse(JSON.stringify(e))};var l,u,h=(l=s.createPool(function(){return[]}),function(e,t){var n,i,r,o,a,s;if(void 0===e||void 0===t||null===e||null===t||!(e&&t&&e.constructor===Object&&t.constructor===Object||e.constructor===Array&&t.constructor===Array))return e===t;for(n in i=l.use(),r=l.use(),i.length=0,r.length=0,e)i.push(n);for(n in t)r.push(n);if(i.length!==r.length)return l.recycle(i),l.recycle(r),!1;for(o=0;o<i.length;++o)if(a=e[i[o]],s=t[i[o]],"object"==typeof a||"object"==typeof s||Array.isArray(a)&&Array.isArray(s)){if(a===s)continue;if(!h(a,s))return l.recycle(i),l.recycle(r),!1}else if(a!==s)return l.recycle(i),l.recycle(r),!1;return l.recycle(i),l.recycle(r),!0});a.exports.deepEqual=h,a.exports.diff=(u=[],function(e,t,n){var i,r,o,a,s,c,l;for(s in a=n||{},u.length=0,e)u.push(s);if(!t)return a;for(o in t)-1===u.indexOf(o)&&u.push(o);for(c=0;c<u.length;c++)i=e[s=u[c]],r=t[s],((l=i&&r&&i.constructor===Object&&r.constructor===Object)&&!h(i,r)||!l&&i!==r)&&(a[s]=r);return a}),a.exports.shouldCaptureKeyEvent=function(e){return!e.metaKey&&document.activeElement===document.body},a.exports.splitString=function(e,t){void 0===t&&(t=" ");var n=new RegExp(t,"g");return(e=(e||"").replace(n,t)).split(t)},a.exports.getElData=function(t,e){e=e||{};var n={};return Object.keys(e).forEach(function(e){t.hasAttribute(e)&&(n[e]=t.getAttribute(e))}),n},a.exports.getUrlParameter=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},a.exports.isIframed=function(){return window.top!==window.self},a.exports.findAllScenes=function(e){for(var t=[],n=e.getElementsByTagName("*"),i=0,r=n.length;i<r;i++)n[i].isScene&&t.push(n[i]);return t},a.exports.srcLoader=e("./src-loader")},{"./bind":170,"./coordinates":171,"./debug":172,"./device":173,"./entity":174,"./forceCanvasResizeSafariMobile":175,"./is-ie11":177,"./material":179,"./object-pool":180,"./split":181,"./src-loader":182,"./styleParser":183,"./tracked-controls":184,"deep-assign":11,"object-assign":26}],177:[function(e,t,n){var i,r;t.exports=11===(i=-1,r=navigator.userAgent,"Microsoft Internet Explorer"===navigator.appName?null!=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})").exec(r)&&(i=parseFloat(RegExp.$1)):"Netscape"===navigator.appName&&null!=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})").exec(r)&&(i=parseFloat(RegExp.$1)),i)},{}],178:[function(e,t,n){t.exports=function(e){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(e)}},{}],179:[function(e,n,t){var l=e("../lib/three"),i=["application/x-mpegurl","application/vnd.apple.mpegurl"],u=new Set(["emissiveMap","envMap","map","specularMap"]);function h(e,t){t&&(e.emit("materialtextureloaded",{src:t.image,texture:t}),t.image&&"VIDEO"===t.image.tagName&&(t.image.addEventListener("loadeddata",function(){e.components&&e.components.material&&(t.needsCorrectionBGRA&&t.needsCorrectionFlipY&&-1!==["standard","flat"].indexOf(e.components.material.data.shader)&&e.setAttribute("material","shader","ios10hls"),e.emit("materialvideoloadeddata",{src:t.image,texture:t}))}),t.image.addEventListener("ended",function(){e.emit("materialvideoended",{src:t.image,texture:t})})))}n.exports.updateMapMaterialFromData=function(t,e,n,i){var r=n.el,o=n.material,a=r.sceneEl.systems.renderer,s=i[e];if(n.materialSrcs||(n.materialSrcs={}),!s)return delete n.materialSrcs[t],void c(null);function c(e){(o[t]=e)&&u.has(t)&&a.applyColorCorrection(e),o.needsUpdate=!0,h(r,e)}s!==n.materialSrcs[t]&&((n.materialSrcs[t]=s)instanceof l.Texture?c(s):r.sceneEl.systems.material.loadTexture(s,{src:s,repeat:i.repeat,offset:i.offset,npot:i.npot},function(e){n.materialSrcs[t]===s&&c(e)}))},n.exports.updateMap=function(e,t){return n.exports.updateMapMaterialFromData("map","src",e,t)},n.exports.updateDistortionMap=function(e,t,n){var i=e;"ambientOcclusion"===e&&(i="ao");var r=t.el,o=t.material,a=r.sceneEl.systems.renderer,s=n[e+"Map"],c={};if(c.src=s,c.offset=n[e+"TextureOffset"],c.repeat=n[e+"TextureRepeat"],c.wrap=n[e+"TextureWrap"],s){if(s===t[e+"TextureSrc"])return;return t[e+"TextureSrc"]=s,void r.sceneEl.systems.material.loadTexture(s,c,l)}function l(e){var t=i+"Map";(o[t]=e)&&u.has(t)&&a.applyColorCorrection(e),o.needsUpdate=!0,h(r,e)}o.map&&l(null)},n.exports.handleTextureEvents=h,n.exports.isHLS=function(e,t){return!(!t||!i.includes(t.toLowerCase()))||!!(e&&0<e.toLowerCase().indexOf(".m3u8"))}},{"../lib/three":151}],180:[function(e,t,n){var a=Object.freeze(Object.create(null));function s(){return{}}function c(e){var t;if(e&&e.constructor===Object)for(t in e)e[t]=void 0}t.exports.createPool=function(i){var r=[],o=null;function t(e){var t,n;if(0<(e=void 0===e?r.length:e)&&null==o&&(o=0),0<e)for(t=r.length,r.length+=Number(e),n=t;n<r.length;n++)r[n]=i();return r.length}return i=i||s,{grow:t,pool:r,recycle:function(e){e instanceof Object&&(null!==o&&-1!==o?r[--o]=e:r[r.length]=e)},size:function(){return r.length},use:function(){var e;return null!==o&&o!==r.length||t(r.length||5),e=r[o],r[o++]=a,c(e),e}}},t.exports.clearObject=c},{}],181:[function(e,t,n){var i;t.exports.split=(i={},function(e,t){return t in i||(i[t]={}),e in i[t]||(i[t][e]=e.split(t)),i[t][e]})},{}],182:[function(e,t,n){var c=e("./debug")("utils:src-loader:warn");function l(t,n,i){var r,o,a;o=function(e){e?n(t):i(t)},(r=t).tagName?o("IMG"===r.tagName):((a=new XMLHttpRequest).open("HEAD",r),a.addEventListener("load",function(e){var t;200<=a.status&&a.status<300?null==(t=a.getResponseHeader("Content-Type"))?s(r,o):t.startsWith("image")?o(!0):o(!1):s(r,o),a.abort()}),a.send())}function u(e){var t=e.match(/\url\((.+)\)/);if(t)return t[1]}function s(e,t){var n=new Image;n.addEventListener("load",function(){t(!0)}),n.addEventListener("error",function(){t(!1)}),n.src=e}t.exports={parseUrl:u,validateSrc:l,validateCubemapSrc:function(e,t){var n,i,r,o="",a=[];for(i=0;i<5;i++)o+="(url\\((?:[^\\)]+)\\),\\s*)";function s(e){a.push(e),6===a.length&&t(a)}if(o+="(url\\((?:[^\\)]+)\\)\\s*)",r=e.match(new RegExp(o)))for(i=1;i<7;i++)l(u(r[i]),s);else if(n=function(e){try{var t=document.querySelector(e);return t||c('No element was found matching the selector: "%s"',e),t}catch(t){return void c('"%s" is not a valid selector',e)}}(e))return"A-CUBEMAP"===n.tagName&&n.srcs?t(n.srcs):void c('Selector "%s" does not point to <a-cubemap>',e)}}},{"./debug":172}],183:[function(e,t,n){var i=/-([a-z])/g;function r(e){return e.replace(i,l)}function o(e){var t,n;for(n in e)n!==(t=r(n))&&(e[t]=e[n],delete e[n]);return e}t.exports.parse=function(s,e){var t;return"string"!=typeof s?s:(t=function(e){var t,n,i,r,o,a;for(e=e||{},t=c(s),n=0;n<t.length;n++)(i=t[n])&&(r=i.indexOf(":"),o=i.substr(0,r).trim(),a=i.substr(r+1).trim(),e[o]=a);return e}(e))[""]?s:o(t)},t.exports.stringify=function(e){return"string"==typeof e?e:function(e){var t,n=0,i=0,r="";for(t in e)n++;for(t in e)r+=t+": "+e[t],i<n-1&&(r+="; "),i++;return r}(e)},t.exports.toCamelCase=r,t.exports.transformKeysToCamelCase=o;var a,s,c=(a=[],s=/url\([^)]+$/,function(e){var t,n="",i=0;for(a.length=0;i<e.length;)-1===(t=e.indexOf(";",i))&&(t=e.length),n+=e.substring(i,t),i=(s.test(n)?n+=";":(a.push(n.trim()),n=""),t+1);return a});function l(e){return e[1].toUpperCase()}},{}],184:[function(e,t,n){var l=e("../constants").DEFAULT_HANDEDNESS,c=["x","y","z","w"],u=2;function a(e,t,n){var i,r,o=e.el.sceneEl,a=n.index||0;return!!(t&&(r=o&&o.systems["tracked-controls-webvr"])&&(i=r.controllers).length&&h(i,null,t,n.hand,a))}function s(e,t,n){var i,r=e.el.sceneEl,o=r&&r.systems["tracked-controls-webxr"];return!!o&&!(!(i=o.controllers)||!i.length)&&d(i,n.hand)}function h(e,t,n,i,r){var o,a,s=0,c=r||0;for(a=0;a<e.length;a++)if(o=e[a],(!n||o.id.startsWith(n))&&(n||o.id===t)&&(!i||!o.hand||i===o.hand)){if(i&&!o.hand&&(c=u*r+(i===l?0:1)),s===c)return o;++s}}function d(e,t){var n,i;for(n=0;n<e.length;n++)if(i=e[n].handedness,!t||""===i&&"right"===t||e[n].handedness===t)return e[n]}t.exports.checkControllerPresentAndSetup=function(e,t,n){var i,r=e.el,o=r.sceneEl.hasWebXR;if(i=!!(o?s:a)(e,t,n),!e.controllerPresent||e.controllerEventsActive||o||e.addEventListeners(),i===e.controllerPresent)return i;(e.controllerPresent=i)?(e.injectTrackedControls(),o||e.addEventListeners(),r.emit("controllerconnected",{name:e.name,component:e})):(e.removeEventListeners(),r.emit("controllerdisconnected",{name:e.name,component:e}))},t.exports.isControllerPresentWebVR=a,t.exports.isControllerPresentWebXR=s,t.exports.findMatchingControllerWebVR=h,t.exports.findMatchingControllerWebXR=d,t.exports.emitIfAxesChanged=function(e,t,n){var i,r,o,a,s;for(r in t){for(i=t[r],o=!1,s=0;s<i.length;s++)n.detail.changed[i[s]]&&(o=!0);if(o){for(a={},s=0;s<i.length;s++)a[c[s]]=n.detail.axis[i[s]];e.el.emit(r+"moved",a)}}},t.exports.onButtonEvent=function(e,t,n,i){var r=(i?n.mapping[i]:n.mapping).buttons[e];n.el.emit(r+t),n.updateModel&&n.updateModel(r,t)}},{"../constants":95}],185:[function(e,t,n){window.glStats=function(){var t=null,e=0,n=0,i=0,r=0,o=0,a=0,s=0;function c(e,t){return function(){t.apply(this,arguments),e.apply(this,arguments)}}return WebGLRenderingContext.prototype.drawArrays=c(WebGLRenderingContext.prototype.drawArrays,function(){e++,arguments[0]==this.POINTS?a+=arguments[2]:o+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=c(WebGLRenderingContext.prototype.drawElements,function(){n++,r+=arguments[1]/3,o+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=c(WebGLRenderingContext.prototype.useProgram,function(){i++}),WebGLRenderingContext.prototype.bindTexture=c(WebGLRenderingContext.prototype.bindTexture,function(){s++}),{update:function(){t("allcalls").set(e+n),t("drawElements").set(n),t("drawArrays").set(e),t("bindTexture").set(s),t("useProgram").set(i),t("glfaces").set(r),t("glvertices").set(o),t("glpoints").set(a)},start:function(){s=a=o=r=i=n=e=0},end:function(){},attach:function(e){t=e},values:{allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},groups:[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],fractions:[{base:"allcalls",steps:["drawelements","drawarrays"]}]}},window.threeStats=function(e){var t=null;return{update:function(){t("renderer.info.memory.geometries").set(e.info.memory.geometries),t("renderer.info.programs").set(e.info.programs.length),t("renderer.info.memory.textures").set(e.info.memory.textures),t("renderer.info.render.calls").set(e.info.render.calls),t("renderer.info.render.triangles").set(e.info.render.triangles),t("renderer.info.render.points").set(e.info.render.points)},start:function(){},end:function(){},attach:function(e){t=e},values:{"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},groups:[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],fractions:[]}},window.BrowserStats=function(){var t=null,e=0,n=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),0===performance.memory.totalJSHeapSize&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var i=Math.log(1024);function r(e){var t=Math.floor(Math.log(e)/i);return Math.round(100*e/Math.pow(1024,t))/100}return{update:function(){e=r(performance.memory.usedJSHeapSize),n=r(performance.memory.totalJSHeapSize),t("memory").set(e),t("total").set(n)},start:function(){e=0},end:function(){},attach:function(e){t=e},values:{memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},groups:[{caption:"Browser",values:["memory","total"]}],fractions:[{base:"total",steps:["memory"]}]}},"object"==typeof t&&(t.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats})},{}],186:[function(e,t,n){"use strict";!function(){"performance"in window==0&&(window.performance={});var e=window.performance;if("now"in e==0){var t=Date.now();e.timing&&e.timing.navigationStart&&(t=e.timing.navigationStart),e.now=function(){return Date.now()-t}}e.mark||(e.mark=function(){}),e.measure||(e.measure=function(){})}(),window.rStats=function(e){function a(e,t){for(var n=Object.keys(e),i=0,r=n.length;i<r;i++)t(n[i])}var b=e||{},s=b.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],t=(b.CSSPath?b.CSSPath:"")+"rStats.css";(b.css||["https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",t]).forEach(function(e){var t,n;t=e,(n=document.createElement("link")).href=t,n.rel="stylesheet",n.type="text/css",document.getElementsByTagName("head")[0].appendChild(n)}),b.values||(b.values={});var n,w,p=10,f=200,c={};function x(e,t,n){var i=n||{},r=document.createElement("canvas"),o=r.getContext("2d"),a=0,s=0,c=i.color?i.color:"#666666",l=document.createElement("canvas"),u=l.getContext("2d");l.width=1,l.height=2*p,u.fillStyle="#444444",u.fillRect(0,0,1,2*p),u.fillStyle=c,u.fillRect(0,p,1,p),u.fillStyle="#ffffff",u.globalAlpha=.5,u.fillRect(0,p,1,1),u.globalAlpha=1;var h=document.createElement("canvas"),d=h.getContext("2d");return h.width=1,h.height=2*p,d.fillStyle="#444444",d.fillRect(0,0,1,2*p),d.fillStyle="#b70000",d.fillRect(0,p,1,p),d.globalAlpha=.5,d.fillStyle="#ffffff",d.fillRect(0,p,1,1),d.globalAlpha=1,r.width=f,r.height=p,r.style.width=r.width+"px",r.style.height=r.height+"px",r.className="rs-canvas",e.appendChild(r),o.fillStyle="#444444",o.fillRect(0,0,r.width,r.height),{draw:function(e,t){(s+=.1*(e-s))>(a*=.99)&&(a=s),o.drawImage(r,1,0,r.width-1,r.height,0,0,r.width-1,r.height),t?o.drawImage(h,r.width-1,r.height-s*r.height/a-p):o.drawImage(l,r.width-1,r.height-s*r.height/a-p)}}}function l(e,t){var r=document.createElement("canvas"),o=r.getContext("2d");return r.width=f,r.height=p*t,r.style.width=r.width+"px",r.style.height=r.height+"px",r.className="rs-canvas",e.appendChild(r),o.fillStyle="#444444",o.fillRect(0,0,r.width,r.height),{draw:function(n){o.drawImage(r,1,0,r.width-1,r.height,0,0,r.width-1,r.height);var i=0;a(n,function(e){var t=n[e]*r.height;o.fillStyle=s[e],o.fillRect(r.width-1,i,1,t),i+=t})}}}function r(e,t){var n,i=e,r=0,o=0,a=0,s=0,c=performance.now(),l=0,u=document.createElement("div"),h=document.createElement("span"),d=document.createElement("div"),p=document.createTextNode(""),f=b?b.values[i.toLowerCase()]:null,m=new x(u,i,f),v=!1;function g(e){if(f&&f.average){s+=e,l++;var t=performance.now();t-c>=(f.avgMs||1e3)&&(a=s/l,c=t,l=s=0)}}function y(){n=performance.now(),b.userTimingAPI&&performance.mark(i+"-start"),v=!0}function A(){r=performance.now()-n,b.userTimingAPI&&(performance.mark(i+"-end"),v&&performance.measure(i,i+"-start",i+"-end")),g(r)}return h.className="rs-counter-id",h.textContent=f&&f.caption?f.caption:i,d.className="rs-counter-value",d.appendChild(p),u.appendChild(h),u.appendChild(d),t?t.div.appendChild(u):w.appendChild(u),n=performance.now(),{set:function(e){g(r=e)},start:y,tick:function(){A(),y()},end:A,frame:function(){var e=performance.now(),t=e-n;o++,1e3<t&&(r=f&&!1===f.interpolate?o:1e3*o/t,o=0,n=e,g(r))},value:function(){return r},draw:function(){var e=f&&f.average?a:r;p.nodeValue=Math.round(100*e)/100;var t=f&&(f.below&&r<f.below||f.over&&r>f.over);m.draw(r,t),u.className=t?"rs-counter-base alarm":"rs-counter-base"}}}function i(e){var n=e.toLowerCase();if(void 0===n&&(n="default"),c[n])return c[n];var i=null;b&&b.groups&&a(b.groups,function(e){var t=b.groups[parseInt(e,10)];i||-1===t.values.indexOf(n.toLowerCase())||(i=t)});var t=new r(n,i);return c[n]=t}function o(){a(b.plugins,function(e){b.plugins[e].update()}),a(c,function(e){c[e].draw()}),b&&b.fractions&&a(b.fractions,function(i){var e=b.fractions[parseInt(i,10)],r=[],o=c[e.base.toLowerCase()];o&&(o=o.value(),a(b.fractions[i].steps,function(e){var t=b.fractions[i].steps[parseInt(e,10)].toLowerCase(),n=c[t];n&&r.push(n.value()/o)})),e.graph.draw(r)})}return function(){if(b.plugins){b.values||(b.values={}),b.groups||(b.groups=[]),b.fractions||(b.fractions=[]);for(var t=0;t<b.plugins.length;t++)b.plugins[t].attach(i),a(b.plugins[t].values,function(e){b.values[e]=b.plugins[t].values[e]}),b.groups=b.groups.concat(b.plugins[t].groups),b.fractions=b.fractions.concat(b.plugins[t].fractions)}else b.plugins={};(n=document.createElement("div")).className="rs-base",(w=document.createElement("div")).className="rs-container",w.style.height="auto",n.appendChild(w),document.body.appendChild(n),b&&(b.groups&&a(b.groups,function(e){var t=b.groups[parseInt(e,10)],n=document.createElement("div");n.className="rs-group",t.div=n;var i=document.createElement("h1");i.textContent=t.caption,i.addEventListener("click",function(e){this.classList.toggle("hidden"),e.preventDefault()}.bind(n)),w.appendChild(i),w.appendChild(n)}),b.fractions&&a(b.fractions,function(n){var e=b.fractions[parseInt(n,10)],t=document.createElement("div");t.className="rs-fraction";var i=document.createElement("div");i.className="rs-legend";var r=0;a(b.fractions[n].steps,function(e){var t=document.createElement("p");t.textContent=b.fractions[n].steps[e],t.style.color=s[r],i.appendChild(t),r++}),t.appendChild(i),t.style.height=r*p+"px";var o=new l(e.div=t,r);e.graph=o,w.appendChild(t)}))}(),function(e){return e?i(e):{element:n,update:o}}},"object"==typeof t&&(t.exports=window.rStats)},{}],187:[function(e,t,n){String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e})},{}],188:[function(e,t,n){var i={base64:function(e,t){return"data:"+e+";base64,"+t},isMobile:function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},isIOS:function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},isIFrame:function(){try{return window.self!==window.top}catch(e){return!0}},appendQueryParameter:function(e,t,n){var i=e.indexOf("?")<0?"?":"&";return e+i+t+"="+n},getQueryParameter:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},isLandscapeMode:function(){return 90==window.orientation||-90==window.orientation}};t.exports=i},{}],189:[function(e,t,n){var i,r=e("./util.js");t.exports=(i=navigator.userAgent||navigator.vendor||window.opera).match(/iPhone/i)||i.match(/iPod/i)?function(){var e=null;this.request=function(){e=e||setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3)},this.release=function(){e&&(clearInterval(e),e=null)}}:function(){var e=document.createElement("video");e.addEventListener("ended",function(){e.play()}),this.request=function(){e.paused&&(e.src=r.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),e.play())},this.release=function(){e.pause(),e.src=""}}},{"./util.js":188}]},{},[149])(149)}).call(this,i(51),i(124).setImmediate)},function(e,r,o){(function(e){var t=void 0!==e&&e||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}r.setTimeout=function(){return new i(n.call(setTimeout,t,arguments),clearTimeout)},r.setInterval=function(){return new i(n.call(setInterval,t,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(t,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},o(125),r.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,r.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,o(51))},function(e,t,n){(function(e,f){!function(n,i){"use strict";if(!n.setImmediate){var r,o,t,a,e,s=1,c={},l=!1,u=n.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(n);h=h&&h.setTimeout?h:n,r="[object process]"==={}.toString.call(n.process)?function(e){f.nextTick(function(){p(e)})}:function(){if(n.postMessage&&!n.importScripts){var e=!0,t=n.onmessage;return n.onmessage=function(){e=!1},n.postMessage("","*"),n.onmessage=t,e}}()?(a="setImmediate$"+Math.random()+"$",e=function(e){e.source===n&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},n.addEventListener?n.addEventListener("message",e,!1):n.attachEvent("onmessage",e),function(e){n.postMessage(a+e,"*")}):n.MessageChannel?((t=new MessageChannel).port1.onmessage=function(e){p(e.data)},function(e){t.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(o=u.documentElement,function(e){var t=u.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):function(e){setTimeout(p,0,e)},h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return c[s]=i,r(s),s++},h.clearImmediate=d}function d(e){delete c[e]}function p(e){if(l)setTimeout(p,0,e);else{var n=c[e];if(n){l=!0;try{!function(){var e=n.callback,t=n.args;switch(t.length){case 0:e();break;case 1:e(t[0]);break;case 2:e(t[0],t[1]);break;case 3:e(t[0],t[1],t[2]);break;default:e.apply(i,t)}}()}finally{d(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(51),n(126))},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var c,l=[],u=!1,h=-1;function d(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&p())}function p(){if(!u){var e=s(d);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||u||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){function l(e){var t,n={};for(t in e)"function"==typeof e[t]?n[t]=e[t]:"object"==typeof e[t]?n[t]=AFRAME.utils.clone(e[t]):n[t]=e[t];return n}document.registerElement("a-timeline"),document.registerElement("a-timeline-group"),document.registerElement("a-timeline-animation"),AFRAME.registerComponent("animation-timeline",{schema:{direction:{type:"string",default:"normal"},loop:{default:0,parse:function(e){return"true"===e||"false"!==e&&parseInt(e,10)}},pauseEvents:{type:"array"},startEvents:{type:"array"},timeline:{type:"string"}},multiple:!0,init:function(){var e,t=this.data;for(this.animationIsPlaying=!1,this.beginAnimation=this.beginAnimation.bind(this),this.eventDetail={name:this.id},this.time=0,this.timeline=null,e=0;e<t.startEvents.length;e++)this.el.addEventListener(t.startEvents[e],this.beginAnimation);for(e=0;e<t.pauseEvents.length;e++)this.el.addEventListener(t.pauseEvents[e],this.pauseAnimation)},play:function(){this.data.startEvents.length||this.beginAnimation()},tick:function(e,t){this.animationIsPlaying&&this.timeline&&(this.time+=t,this.timeline.tick(this.time))},beginAnimation:function(){var e,t,n,i,r,o,a,s=this;if("A-TIMELINE"!==(o=document.querySelector(this.data.timeline)).tagName)throw new Error("[animation-timeline] timeline must be a selector to <a-timeline> element.");for(this.animationIsPlaying=!0,this.time=0,this.timeline=(AFRAME.anime||AFRAME.ANIME).timeline({autoplay:!1,complete:function(){s.animationIsPlaying=!1,s.el.emit("animationtimelinecomplete",s.eventDetail)},direction:this.data.direction,loop:this.data.loop}),e=r=0;e<o.children.length;e++)if("A-TIMELINE-GROUP"!==o.children[e].tagName)"A-TIMELINE-ANIMATION"===o.children[e].tagName&&(r+=this.addAnimationToTimeline(o.children[e],r));else{for(a=o.children[e],t=i=0;t<a.children.length;t++)(n=this.addAnimationToTimeline(a.children[t],r))>i&&(i=n);r+=i}},addAnimationToTimeline:function(e,t){var n,i,r,o,a,s,c;if(i="animation__"+e.getAttribute("name"),c=e.getAttribute("select"),!(a=this.el.sceneEl.querySelectorAll(c)).length)return console.warn('[animation-timeline] No entities found for select="'+c+'"'),0;for(n=parseFloat(e.getAttribute("offset")||0,10),s=0;s<a.length;s++){if(!(r=a[s].components[i]))throw new Error("Could not find animation `"+i+"` for `"+e.getAttribute("select")+"`.");r.updateConfig(),r.stopRelatedAnimations(),(o=l(r.config)).offset=t+n,this.timeline.add(o)}return(o.duration||0)+(o.delay||0)+n},pauseAnimation:function(){this.animationIsPlaying=!1}})},function(e,t,n){var i=n(5);n(151),n(55),n(156),n(157),n(158),n(159),n(160),n(161),e.exports={registerAll:function(){console.warn("registerAll() is deprecated. Components are automatically registered.")}},window.CANNON=window.CANNON||i},function(e){e.exports={_from:"github:donmccurdy/cannon.js#v0.6.2-dev1",_id:"cannon@0.6.2",_inBundle:!1,_integrity:"",_location:"/cannon",_phantomChildren:{},_requested:{type:"git",raw:"cannon@github:donmccurdy/cannon.js#v0.6.2-dev1",name:"cannon",escapedName:"cannon",rawSpec:"github:donmccurdy/cannon.js#v0.6.2-dev1",saveSpec:"github:donmccurdy/cannon.js#v0.6.2-dev1",fetchSpec:null,gitCommittish:"v0.6.2-dev1"},_requiredBy:["/aframe-physics-system"],_resolved:"github:donmccurdy/cannon.js#022e8ba53fa83abf0ad8a0e4fd08623123838a17",_spec:"cannon@github:donmccurdy/cannon.js#v0.6.2-dev1",_where:"C:\\Users\\David Meyer\\Desktop\\Projects\\rsc_mm\\node_modules\\aframe-physics-system",author:{name:"Stefan Hedman",email:"schteppe@gmail.com",url:"http://steffe.se"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},bundleDependencies:!1,dependencies:{},deprecated:!1,description:"A lightweight 3D physics engine written in JavaScript.",devDependencies:{browserify:"*",grunt:"~0.4.0","grunt-browserify":"^2.1.4","grunt-contrib-concat":"~0.1.3","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"^0.5.1","grunt-contrib-yuidoc":"^0.5.2",jshint:"latest",nodeunit:"^0.9.0","uglify-js":"latest"},engines:{node:"*"},homepage:"https://github.com/schteppe/cannon.js",keywords:["cannon.js","cannon","physics","engine","3d"],licenses:[{type:"MIT"}],main:"./src/Cannon.js",name:"cannon",repository:{type:"git",url:"git+https://github.com/schteppe/cannon.js.git"},version:"0.6.2"}},function(e,t,n){e.exports=r;var i=n(0);function r(){this.spatial=new i,this.rotational=new i}r.prototype.multiplyElement=function(e){return e.spatial.dot(this.spatial)+e.rotational.dot(this.rotational)},r.prototype.multiplyVectors=function(e,t){return e.dot(this.spatial)+t.dot(this.rotational)}},function(e,t,n){e.exports=i,n(21);var c=n(38),l=n(132),u=n(39),h=(n(10),n(0));function i(e,t,n){var i=void 0!==(n=n||{}).maxForce?n.maxForce:1e6,r=n.pivotA?n.pivotA.clone():new h,o=n.pivotB?n.pivotB.clone():new h;this.axisA=n.axisA?n.axisA.clone():new h,this.axisB=n.axisB?n.axisB.clone():new h,c.call(this,e,r,t,o,i),this.collideConnected=!!n.collideConnected,this.angle=void 0!==n.angle?n.angle:0;var a=this.coneEquation=new l(e,t,n),s=this.twistEquation=new u(e,t,n);this.twistAngle=void 0!==n.twistAngle?n.twistAngle:0,a.maxForce=0,a.minForce=-i,s.maxForce=0,s.minForce=-i,this.equations.push(a,s)}i.prototype=new c,i.constructor=i,new h,new h,i.prototype.update=function(){var e=this.bodyA,t=this.bodyB,n=this.coneEquation,i=this.twistEquation;c.prototype.update.call(this),e.vectorToWorldFrame(this.axisA,n.axisA),t.vectorToWorldFrame(this.axisB,n.axisB),this.axisA.tangents(i.axisA,i.axisA),e.vectorToWorldFrame(i.axisA,i.axisA),this.axisB.tangents(i.axisB,i.axisB),t.vectorToWorldFrame(i.axisB,i.axisB),n.angle=this.angle,i.maxAngle=this.twistAngle}},function(e,t,n){e.exports=i;var r=n(0),o=(n(8),n(22));function i(e,t,n){var i=void 0!==(n=n||{}).maxForce?n.maxForce:1e6;o.call(this,e,t,-i,i),this.axisA=n.axisA?n.axisA.clone():new r(1,0,0),this.axisB=n.axisB?n.axisB.clone():new r(0,1,0),this.angle=void 0!==n.angle?n.angle:0}(i.prototype=new o).constructor=i;var l=new r,u=new r;i.prototype.computeB=function(e){var t=this.a,n=this.b,i=this.axisA,r=this.axisB,o=l,a=u,s=this.jacobianElementA,c=this.jacobianElementB;return i.cross(r,o),r.cross(i,a),s.rotational.copy(a),c.rotational.copy(o),-(Math.cos(this.angle)-i.dot(r))*t-this.computeGW()*n-e*this.computeGiMf()}},function(e,t,n){e.exports=i;var v=n(1),g=n(0),y=(n(3),n(19));function i(e,t,n,i){var r=i,o=[],a=[],s=[],c=[],l=[],u=Math.cos,h=Math.sin;o.push(new g(t*u(0),t*h(0),.5*-n)),c.push(0),o.push(new g(e*u(0),e*h(0),.5*n)),l.push(1);for(var d=0;d<r;d++){var p=2*Math.PI/r*(d+1),f=2*Math.PI/r*(d+.5);d<r-1?(o.push(new g(t*u(p),t*h(p),.5*-n)),c.push(2*d+2),o.push(new g(e*u(p),e*h(p),.5*n)),l.push(2*d+3),s.push([2*d+2,2*d+3,2*d+1,2*d])):s.push([0,1,2*d+1,2*d]),(r%2==1||d<r/2)&&a.push(new g(u(f),h(f),0))}s.push(l),a.push(new g(0,0,1));var m=[];for(d=0;d<c.length;d++)m.push(c[c.length-d-1]);s.push(m),this.type=v.types.CONVEXPOLYHEDRON,y.call(this,o,s,a)}i.prototype=new y},function(e,t,n){e.exports=i;var o=n(21),a=n(10);function i(e,t,n,i){o.call(this,e,t),void 0===n&&(n=e.position.distanceTo(t.position)),void 0===i&&(i=1e6),this.distance=n;var r=this.distanceEquation=new a(e,t);this.equations.push(r),r.minForce=-i,r.maxForce=i}(i.prototype=new o).update=function(){var e=this.bodyA,t=this.bodyB,n=this.distanceEquation,i=.5*this.distance,r=n.ni;t.position.vsub(e.position,r),r.normalize(),r.mult(i,n.ri),r.mult(-i,n.rj)}},function(e,t,n){e.exports=i;var s=n(35),c=n(0),ne=n(1);function i(e,t,n,i,r){s.apply(this),this.nx=n||10,this.ny=i||10,this.nz=r||10,this.aabbMin=e||new c(100,100,100),this.aabbMax=t||new c(-100,-100,-100);var o=this.nx*this.ny*this.nz;if(o<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=o,this.binLengths.length=o;for(var a=0;a<o;a++)this.bins[a]=[],this.binLengths[a]=0}(i.prototype=new s).constructor=i;var ie=new c;new c,i.prototype.collisionPairs=function(e,t,n){for(var i=e.numObjects(),r=e.bodies,o=this.aabbMax,a=this.aabbMin,g=this.nx,y=this.ny,A=this.nz,b=y*A,w=A,x=1,s=o.x,c=o.y,l=o.z,E=a.x,M=a.y,T=a.z,S=g/(s-E),C=y/(c-M),L=A/(l-T),u=(s-E)/g,h=(c-M)/y,d=(l-T)/A,p=.5*Math.sqrt(u*u+h*h+d*d),f=ne.types,m=f.SPHERE,v=f.PLANE,_=(f.BOX,f.COMPOUND,f.CONVEXPOLYHEDRON,this.bins),B=this.binLengths,R=this.bins.length,P=0;P!==R;P++)B[P]=0;var D=Math.ceil;function I(e,t,n,i,r,o,a){var s=(e-E)*S|0,c=(t-M)*C|0,l=(n-T)*L|0,u=D((i-E)*S),h=D((r-M)*C),d=D((o-T)*L);s<0?s=0:g<=s&&(s=g-1),c<0?c=0:y<=c&&(c=y-1),l<0?l=0:A<=l&&(l=A-1),u<0?u=0:g<=u&&(u=g-1),h<0?h=0:y<=h&&(h=y-1),d<0?d=0:A<=d&&(d=A-1),c*=w,l*=x,u*=b,h*=w,d*=x;for(var p=s*=b;p<=u;p+=b)for(var f=c;f<=h;f+=w)for(var m=l;m<=d;m+=x){var v=p+f+m;_[v][B[v]++]=a}}for(a=Math.min,o=Math.max,P=0;P!==i;P++){var O=(ee=r[P]).shape;switch(O.type){case m:var k=ee.position.x,j=ee.position.y,H=ee.position.z,F=O.radius;I(k-F,j-F,H-F,k+F,j+F,H+F,ee);break;case v:O.worldNormalNeedsUpdate&&O.computeWorldNormal(ee.quaternion);var N=O.worldNormal,z=E+.5*u-ee.position.x,U=M+.5*h-ee.position.y,G=T+.5*d-ee.position.z,V=ie;V.set(z,U,G);for(var W=0,q=0;W!==g;W++,q+=b,V.y=U,V.x+=u)for(var X=0,Q=0;X!==y;X++,Q+=w,V.z=G,V.y+=h)for(var Y=0,Z=0;Y!==A;Y++,Z+=x,V.z+=d)if(V.dot(N)<p){var K=q+Q+Z;_[K][B[K]++]=ee}break;default:ee.aabbNeedsUpdate&&ee.computeAABB(),I(ee.aabb.lowerBound.x,ee.aabb.lowerBound.y,ee.aabb.lowerBound.z,ee.aabb.upperBound.x,ee.aabb.upperBound.y,ee.aabb.upperBound.z,ee)}}for(P=0;P!==R;P++){var J=B[P];if(1<J){var $=_[P];for(W=0;W!==J;W++){var ee=$[W];for(X=0;X!==W;X++){var te=$[X];this.needBroadphaseCollision(ee,te)&&this.intersectionTest(ee,te,t,n)}}}}this.makePairsUnique(t,n)}},function(e,t,n){var i=n(1),h=n(19),d=n(0),r=n(27);function o(e,t){t=r.defaults(t,{maxValue:null,minValue:null,elementSize:1}),this.data=e,this.maxValue=t.maxValue,this.minValue=t.minValue,this.elementSize=t.elementSize,null===t.minValue&&this.updateMinValue(),null===t.maxValue&&this.updateMaxValue(),this.cacheEnabled=!0,i.call(this),this.pillarConvex=new h,this.pillarOffset=new d,this.type=i.types.HEIGHTFIELD,this.updateBoundingSphereRadius(),this._cachedPillars={}}((e.exports=o).prototype=new i).update=function(){this._cachedPillars={}},o.prototype.updateMinValue=function(){for(var e=this.data,t=e[0][0],n=0;n!==e.length;n++)for(var i=0;i!==e[n].length;i++){var r=e[n][i];r<t&&(t=r)}this.minValue=t},o.prototype.updateMaxValue=function(){for(var e=this.data,t=e[0][0],n=0;n!==e.length;n++)for(var i=0;i!==e[n].length;i++){var r=e[n][i];t<r&&(t=r)}this.maxValue=t},o.prototype.setHeightValueAtIndex=function(e,t,n){this.data[e][t]=n,this.clearCachedConvexTrianglePillar(e,t,!1),0<e&&(this.clearCachedConvexTrianglePillar(e-1,t,!0),this.clearCachedConvexTrianglePillar(e-1,t,!1)),0<t&&(this.clearCachedConvexTrianglePillar(e,t-1,!0),this.clearCachedConvexTrianglePillar(e,t-1,!1)),0<t&&0<e&&this.clearCachedConvexTrianglePillar(e-1,t-1,!0)},o.prototype.getRectMinMax=function(e,t,n,i,r){r=r||[];for(var o=this.data,a=this.minValue,s=e;s<=n;s++)for(var c=t;c<=i;c++){var l=o[s][c];a<l&&(a=l)}r[0]=this.minValue,r[1]=a},o.prototype.getIndexOfPosition=function(e,t,n,i){var r=this.elementSize,o=this.data,a=Math.floor(e/r),s=Math.floor(t/r);return n[0]=a,n[1]=s,i&&(a<0&&(a=0),s<0&&(s=0),a>=o.length-1&&(a=o.length-1),s>=o[0].length-1&&(s=o[0].length-1)),!(a<0||s<0||a>=o.length-1||s>=o[0].length-1)};var b=[],w=new d,x=new d,E=new d,M=new d;o.prototype.getTriangleAt=function(e,t,n,i,r,o){var a=b;this.getIndexOfPosition(e,t,a,n);var s=a[0],c=a[1],l=this.data;n&&(s=Math.min(l.length-2,Math.max(0,s)),c=Math.min(l[0].length-2,Math.max(0,c)));var u=this.elementSize,h=Math.pow(e/u-s,2)+Math.pow(t/u-c,2)>Math.pow(e/u-(s+1),2)+Math.pow(t/u-(c+1),2);return this.getTriangle(s,c,h,i,r,o),h};var l=new d,u=new d,p=new d,f=new d,m=new d;o.prototype.getNormalAt=function(e,t,n,i){var r=l,o=u,a=p,s=f,c=m;this.getTriangleAt(e,t,n,r,o,a),o.vsub(r,s),a.vsub(r,c),s.cross(c,i),i.normalize()},o.prototype.getAabbAtIndex=function(e,t,n){var i=this.data,r=this.elementSize;n.lowerBound.set(e*r,t*r,i[e][t]),n.upperBound.set((e+1)*r,(t+1)*r,i[e+1][t+1])},o.prototype.getHeightAt=function(e,t,n){var i=this.data,r=x,o=E,a=M,s=b;this.getIndexOfPosition(e,t,s,n);var c=s[0],l=s[1];n&&(c=Math.min(i.length-2,Math.max(0,c)),l=Math.min(i[0].length-2,Math.max(0,l)));var u,h,d,p,f,m,v,g,y,A=this.getTriangleAt(e,t,n,r,o,a);u=e,h=t,d=r.x,p=r.y,f=o.x,m=o.y,v=a.x,g=a.y,(y=w).x=((m-g)*(u-v)+(v-f)*(h-g))/((m-g)*(d-v)+(v-f)*(p-g)),y.y=((g-p)*(u-v)+(d-v)*(h-g))/((m-g)*(d-v)+(v-f)*(p-g)),y.z=1-y.x-y.y;return A?i[c+1][l+1]*w.x+i[c][l+1]*w.y+i[c+1][l]*w.z:i[c][l]*w.x+i[c+1][l]*w.y+i[c][l+1]*w.z},o.prototype.getCacheConvexTrianglePillarKey=function(e,t,n){return e+"_"+t+"_"+(n?1:0)},o.prototype.getCachedConvexTrianglePillar=function(e,t,n){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,n)]},o.prototype.setCachedConvexTrianglePillar=function(e,t,n,i,r){this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,n)]={convex:i,offset:r}},o.prototype.clearCachedConvexTrianglePillar=function(e,t,n){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,n)]},o.prototype.getTriangle=function(e,t,n,i,r,o){var a=this.data,s=this.elementSize;n?(i.set((e+1)*s,(t+1)*s,a[e+1][t+1]),r.set(e*s,(t+1)*s,a[e][t+1]),o.set((e+1)*s,t*s,a[e+1][t])):(i.set(e*s,t*s,a[e][t]),r.set((e+1)*s,t*s,a[e+1][t]),o.set(e*s,(t+1)*s,a[e][t+1]))},o.prototype.getConvexTrianglePillar=function(e,t,n){var i=this.pillarConvex,r=this.pillarOffset;if(this.cacheEnabled){if(o=this.getCachedConvexTrianglePillar(e,t,n))return this.pillarConvex=o.convex,void(this.pillarOffset=o.offset);i=new h,r=new d,this.pillarConvex=i,this.pillarOffset=r}var o=this.data,a=this.elementSize,s=i.faces;i.vertices.length=6;for(var c=0;c<6;c++)i.vertices[c]||(i.vertices[c]=new d);for(s.length=5,c=0;c<5;c++)s[c]||(s[c]=[]);var l=i.vertices,u=(Math.min(o[e][t],o[e+1][t],o[e][t+1],o[e+1][t+1])-this.minValue)/2+this.minValue;n?(r.set((e+.75)*a,(t+.75)*a,u),l[0].set(.25*a,.25*a,o[e+1][t+1]-u),l[1].set(-.75*a,.25*a,o[e][t+1]-u),l[2].set(.25*a,-.75*a,o[e+1][t]-u),l[3].set(.25*a,.25*a,-u-1),l[4].set(-.75*a,.25*a,-u-1),l[5].set(.25*a,-.75*a,-u-1),s[0][0]=0,s[0][1]=1,s[0][2]=2,s[1][0]=5,s[1][1]=4,s[1][2]=3,s[2][0]=2,s[2][1]=5,s[2][2]=3,s[2][3]=0,s[3][0]=3,s[3][1]=4,s[3][2]=1,s[3][3]=0,s[4][0]=1,s[4][1]=4,s[4][2]=5,s[4][3]=2):(r.set((e+.25)*a,(t+.25)*a,u),l[0].set(-.25*a,-.25*a,o[e][t]-u),l[1].set(.75*a,-.25*a,o[e+1][t]-u),l[2].set(-.25*a,.75*a,o[e][t+1]-u),l[3].set(-.25*a,-.25*a,-u-1),l[4].set(.75*a,-.25*a,-u-1),l[5].set(-.25*a,.75*a,-u-1),s[0][0]=0,s[0][1]=1,s[0][2]=2,s[1][0]=5,s[1][1]=4,s[1][2]=3,s[2][0]=0,s[2][1]=2,s[2][2]=5,s[2][3]=3,s[3][0]=1,s[3][1]=0,s[3][2]=3,s[3][3]=4,s[4][0]=4,s[4][1]=5,s[4][2]=2,s[4][3]=1),i.computeNormals(),i.computeEdges(),i.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(e,t,n,i,r)},o.prototype.calculateLocalInertia=function(e,t){return(t=t||new d).set(0,0,0),t},o.prototype.volume=function(){return Number.MAX_VALUE},o.prototype.calculateWorldAABB=function(e,t,n,i){n.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),i.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},o.prototype.updateBoundingSphereRadius=function(){var e=this.data,t=this.elementSize;this.boundingSphereRadius=new d(e.length*t,e[0].length*t,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()},o.prototype.setHeightsFromImage=function(e,t){var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var i=n.getContext("2d");i.drawImage(e,0,0);var r=i.getImageData(0,0,e.width,e.height),o=this.data;o.length=0,this.elementSize=Math.abs(t.x)/r.width;for(var a=0;a<r.height;a++){for(var s=[],c=0;c<r.width;c++){var l=(r.data[4*(a*r.height+c)]+r.data[4*(a*r.height+c)+1]+r.data[4*(a*r.height+c)+2])/4/255*t.z;t.x<0?s.push(l):s.unshift(l)}t.y<0?o.unshift(s):o.push(s)}this.updateMaxValue(),this.updateMinValue(),this.update()}},function(e,t,n){e.exports=i,n(21);var u=n(38),h=n(39),d=(n(54),n(10),n(0));function i(e,t,n){var i=void 0!==(n=n||{}).maxForce?n.maxForce:1e6,r=new d,o=new d,a=new d;e.position.vadd(t.position,a),a.scale(.5,a),t.pointToLocalFrame(a,o),e.pointToLocalFrame(a,r),u.call(this,e,r,t,o,i),this.xA=e.vectorToLocalFrame(d.UNIT_X),this.xB=t.vectorToLocalFrame(d.UNIT_X),this.yA=e.vectorToLocalFrame(d.UNIT_Y),this.yB=t.vectorToLocalFrame(d.UNIT_Y),this.zA=e.vectorToLocalFrame(d.UNIT_Z),this.zB=t.vectorToLocalFrame(d.UNIT_Z);var s=this.rotationalEquation1=new h(e,t,n),c=this.rotationalEquation2=new h(e,t,n),l=this.rotationalEquation3=new h(e,t,n);this.equations.push(s,c,l)}i.prototype=new u,i.constructor=i,new d,new d,i.prototype.update=function(){var e=this.bodyA,t=this.bodyB,n=(this.motorEquation,this.rotationalEquation1),i=this.rotationalEquation2,r=this.rotationalEquation3;u.prototype.update.call(this),e.vectorToWorldFrame(this.xA,n.axisA),t.vectorToWorldFrame(this.yB,n.axisB),e.vectorToWorldFrame(this.yA,i.axisA),t.vectorToWorldFrame(this.zB,i.axisB),e.vectorToWorldFrame(this.zA,r.axisA),t.vectorToWorldFrame(this.xB,r.axisB)}},function(e,t){function n(){this.matrix={}}(e.exports=n).prototype.get=function(e,t){if(e=e.id,(t=t.id)>e){var n=t;t=e,e=n}return e+"-"+t in this.matrix},n.prototype.set=function(e,t,n){if(e=e.id,(t=t.id)>e){var i=t;t=e,e=i}n?this.matrix[e+"-"+t]=!0:delete this.matrix[e+"-"+t]},n.prototype.reset=function(){this.matrix={}},n.prototype.setNumObjects=function(e){}},function(e,t,n){n(9);var T=n(0),u=n(3),i=(n(29),n(36)),r=n(140);function o(e){this.chassisBody=e.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=void 0!==e.indexRightAxis?e.indexRightAxis:1,this.indexForwardAxis=void 0!==e.indexForwardAxis?e.indexForwardAxis:0,this.indexUpAxis=void 0!==e.indexUpAxis?e.indexUpAxis:2}e.exports=o,new T,new T,new T;var h=new T,d=new T,p=new T;new i,o.prototype.addWheel=function(e){var t=new r(e=e||{}),n=this.wheelInfos.length;return this.wheelInfos.push(t),n},o.prototype.setSteeringValue=function(e,t){this.wheelInfos[t].steering=e},new T,o.prototype.applyEngineForce=function(e,t){this.wheelInfos[t].engineForce=e},o.prototype.setBrake=function(e,t){this.wheelInfos[t].brake=e},o.prototype.addToWorld=function(e){this.constraints,e.addBody(this.chassisBody);var t=this;this.preStepCallback=function(){t.updateVehicle(e.dt)},e.addEventListener("preStep",this.preStepCallback),this.world=e},o.prototype.getVehicleAxisWorld=function(e,t){t.set(0===e?1:0,1===e?1:0,2===e?1:0),this.chassisBody.vectorToWorldFrame(t,t)},o.prototype.updateVehicle=function(e){for(var t=this.wheelInfos,n=t.length,i=this.chassisBody,r=0;r<n;r++)this.updateWheelTransform(r);this.currentVehicleSpeedKmHour=3.6*i.velocity.norm();var o=new T;for(this.getVehicleAxisWorld(this.indexForwardAxis,o),o.dot(i.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1),r=0;r<n;r++)this.castRay(t[r]);this.updateSuspension(e);var a=new T,s=new T;for(r=0;r<n;r++){var c=(d=t[r]).suspensionForce;c>d.maxSuspensionForce&&(c=d.maxSuspensionForce),d.raycastResult.hitNormalWorld.scale(c*e,a),d.raycastResult.hitPointWorld.vsub(i.position,s),i.applyImpulse(a,s)}this.updateFriction(e);var l=new T,u=new T,h=new T;for(r=0;r<n;r++){var d=t[r];i.getVelocityAtWorldPoint(d.chassisConnectionPointWorld,h);var p=1;switch(this.indexUpAxis){case 1:p=-1}if(d.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,u);var f=u.dot(d.raycastResult.hitNormalWorld);d.raycastResult.hitNormalWorld.scale(f,l),u.vsub(l,u);var m=u.dot(h);d.deltaRotation=p*m*e/d.radius}!d.sliding&&d.isInContact||0===d.engineForce||!d.useCustomSlidingRotationalSpeed||(d.deltaRotation=(0<d.engineForce?1:-1)*d.customSlidingRotationalSpeed*e),Math.abs(d.brake)>Math.abs(d.engineForce)&&(d.deltaRotation=0),d.rotation+=d.deltaRotation,d.deltaRotation*=.99}},o.prototype.updateSuspension=function(e){for(var t=this.chassisBody.mass,n=this.wheelInfos,i=n.length,r=0;r<i;r++){var o=n[r];if(o.isInContact){var a,s=o.suspensionRestLength-o.suspensionLength;a=o.suspensionStiffness*s*o.clippedInvContactDotSuspension;var c=o.suspensionRelativeVelocity;a-=(c<0?o.dampingCompression:o.dampingRelaxation)*c,o.suspensionForce=a*t,o.suspensionForce<0&&(o.suspensionForce=0)}else o.suspensionForce=0}},o.prototype.removeFromWorld=function(e){this.constraints,e.remove(this.chassisBody),e.removeEventListener("preStep",this.preStepCallback),this.world=null};var g=new T,y=new T;o.prototype.castRay=function(e){var t=g,n=y;this.updateWheelTransformWorld(e);var i=this.chassisBody,r=-1,o=e.suspensionRestLength+e.radius;e.directionWorld.scale(o,t);var a=e.chassisConnectionPointWorld;a.vadd(t,n);var s=e.raycastResult;s.reset();var c=i.collisionResponse;i.collisionResponse=!1,this.world.rayTest(a,n,s),i.collisionResponse=c;var l=s.body;if(e.raycastResult.groundObject=0,l){r=s.distance,e.raycastResult.hitNormalWorld=s.hitNormalWorld,e.isInContact=!0;var u=s.distance;e.suspensionLength=u-e.radius;var h=e.suspensionRestLength-e.maxSuspensionTravel,d=e.suspensionRestLength+e.maxSuspensionTravel;e.suspensionLength<h&&(e.suspensionLength=h),e.suspensionLength>d&&(e.suspensionLength=d,e.raycastResult.reset());var p=e.raycastResult.hitNormalWorld.dot(e.directionWorld),f=new T;i.getVelocityAtWorldPoint(e.raycastResult.hitPointWorld,f);var m=e.raycastResult.hitNormalWorld.dot(f);if(-.1<=p)e.suspensionRelativeVelocity=0,e.clippedInvContactDotSuspension=10;else{var v=-1/p;e.suspensionRelativeVelocity=m*v,e.clippedInvContactDotSuspension=v}}else e.suspensionLength=e.suspensionRestLength+0*e.maxSuspensionTravel,e.suspensionRelativeVelocity=0,e.directionWorld.scale(-1,e.raycastResult.hitNormalWorld),e.clippedInvContactDotSuspension=1;return r},o.prototype.updateWheelTransformWorld=function(e){e.isInContact=!1;var t=this.chassisBody;t.pointToWorldFrame(e.chassisConnectionPointLocal,e.chassisConnectionPointWorld),t.vectorToWorldFrame(e.directionLocal,e.directionWorld),t.vectorToWorldFrame(e.axleLocal,e.axleWorld)},o.prototype.updateWheelTransform=function(e){var t=h,n=d,i=p,r=this.wheelInfos[e];this.updateWheelTransformWorld(r),r.directionLocal.scale(-1,t),n.copy(r.axleLocal),t.cross(n,i),i.normalize(),n.normalize();var o=r.steering,a=new u;a.setFromAxisAngle(t,o);var s=new u;s.setFromAxisAngle(n,r.rotation);var c=r.worldTransform.quaternion;this.chassisBody.quaternion.mult(a,c),c.mult(s,c),c.normalize();var l=r.worldTransform.position;l.copy(r.directionWorld),l.scale(r.suspensionLength,l),l.vadd(r.chassisConnectionPointWorld,l)};var S=[new T(1,0,0),new T(0,1,0),new T(0,0,1)];o.prototype.getWheelTransformWorld=function(e){return this.wheelInfos[e].worldTransform};var C=new T,L=[],_=[];o.prototype.updateFriction=function(e){for(var t=C,n=this.wheelInfos,i=n.length,r=this.chassisBody,o=_,a=L,s=0;s<i;s++)h=(b=n[s]).raycastResult.body,b.sideImpulse=0,b.forwardImpulse=0,o[s]||(o[s]=new T),a[s]||(a[s]=new T);for(s=0;s<i;s++)if(h=(b=n[s]).raycastResult.body){var c=a[s];this.getWheelTransformWorld(s).vectorToWorldFrame(S[this.indexRightAxis],c);var l=b.raycastResult.hitNormalWorld,u=c.dot(l);l.scale(u,t),c.vsub(t,c),c.normalize(),l.cross(c,o[s]),o[s].normalize(),b.sideImpulse=R(r,b.raycastResult.hitPointWorld,h,b.raycastResult.hitPointWorld,c),b.sideImpulse*=1}for(this.sliding=!1,s=0;s<i;s++){var h=(b=n[s]).raycastResult.body,d=0;if(b.slipInfo=1,h){var p=b.brake?b.brake:0;d=B(r,h,b.raycastResult.hitPointWorld,o[s],p);var f=p/(d+=b.engineForce*e);b.slipInfo*=f}if(b.forwardImpulse=0,b.skidInfo=1,h){b.skidInfo=1;var m=b.suspensionForce*e*b.frictionSlip,v=m*m;b.forwardImpulse=d;var g=.5*b.forwardImpulse,y=1*b.sideImpulse,A=g*g+y*y;b.sliding=!1,v<A&&(this.sliding=!0,b.sliding=!0,f=m/Math.sqrt(A),b.skidInfo*=f)}}if(this.sliding)for(s=0;s<i;s++)0!==(b=n[s]).sideImpulse&&b.skidInfo<1&&(b.forwardImpulse*=b.skidInfo,b.sideImpulse*=b.skidInfo);for(s=0;s<i;s++){var b=n[s],w=new T;if(b.raycastResult.hitPointWorld.vsub(r.position,w),0!==b.forwardImpulse){var x=new T;o[s].scale(b.forwardImpulse,x),r.applyImpulse(x,w)}if(0!==b.sideImpulse){h=b.raycastResult.body;var E=new T;b.raycastResult.hitPointWorld.vsub(h.position,E);var M=new T;a[s].scale(b.sideImpulse,M),r.vectorToLocalFrame(w,w),w["xyz"[this.indexUpAxis]]*=b.rollInfluence,r.vectorToWorldFrame(w,w),r.applyImpulse(M,w),M.scale(-1,M),h.applyImpulse(M,E)}}};var f=new T,m=new T,v=new T;function B(e,t,n,i,r){var o=0,a=n,s=f,c=m,l=v;return e.getVelocityAtWorldPoint(a,s),t.getVelocityAtWorldPoint(a,c),s.vsub(c,l),r<(o=-i.dot(l)*(1/(b(e,n,i)+b(t,n,i))))&&(o=r),o<-r&&(o=-r),o}var s=new T,c=new T,l=new T,A=new T;function b(e,t,n){var i=s,r=c,o=l,a=A;return t.vsub(e.position,i),i.cross(n,r),e.invInertiaWorld.vmult(r,a),a.cross(i,o),e.invMass+n.dot(o)}var w=new T,x=new T,E=new T;function R(e,t,n,i,r){if(1.1<r.norm2())return 0;var o=w,a=x,s=E;return e.getVelocityAtWorldPoint(t,o),n.getVelocityAtWorldPoint(i,a),o.vsub(a,s),-.2*r.dot(s)*(1/(e.invMass+n.invMass))}},function(e,t,n){var i=n(0),r=n(20),o=n(29),a=n(27);function s(e){e=a.defaults(e,{chassisConnectionPointLocal:new i,chassisConnectionPointWorld:new i,directionLocal:new i,directionWorld:new i,axleLocal:new i,axleWorld:new i,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=e.maxSuspensionTravel,this.customSlidingRotationalSpeed=e.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=e.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=e.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=e.chassisConnectionPointWorld.clone(),this.directionLocal=e.directionLocal.clone(),this.directionWorld=e.directionWorld.clone(),this.axleLocal=e.axleLocal.clone(),this.axleWorld=e.axleWorld.clone(),this.suspensionRestLength=e.suspensionRestLength,this.suspensionMaxLength=e.suspensionMaxLength,this.radius=e.radius,this.suspensionStiffness=e.suspensionStiffness,this.dampingCompression=e.dampingCompression,this.dampingRelaxation=e.dampingRelaxation,this.frictionSlip=e.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=e.rollInfluence,this.maxSuspensionForce=e.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=e.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new o,this.worldTransform=new r,this.isInContact=!1}e.exports=s;var c=new i,l=new i;c=new i,s.prototype.updateWheel=function(e){var t=this.raycastResult;if(this.isInContact){var n=t.hitNormalWorld.dot(t.directionWorld);t.hitPointWorld.vsub(e.position,l),e.getVelocityAtWorldPoint(l,c);var i=t.hitNormalWorld.dot(c);if(-.1<=n)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10;else{var r=-1/n;this.suspensionRelativeVelocity=i*r,this.clippedInvContactDotSuspension=r}}else t.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,t.directionWorld.scale(-1,t.hitNormalWorld),this.clippedInvContactDotSuspension=1}},function(e,t,n){var a=n(9),s=n(79),i=n(34),c=n(0),l=n(76);function r(e){if(this.wheelBodies=[],this.coordinateSystem=void 0===e.coordinateSystem?new c(1,2,3):e.coordinateSystem.clone(),this.chassisBody=e.chassisBody,!this.chassisBody){var t=new i(new c(5,2,.5));this.chassisBody=new a(1,t)}this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}(e.exports=r).prototype.addWheel=function(e){var t=(e=e||{}).body;t=t||new a(1,new s(1.2)),this.wheelBodies.push(t),this.wheelForces.push(0),new c;var n=void 0!==e.position?e.position.clone():new c,i=new c;this.chassisBody.pointToWorldFrame(n,i),t.position.set(i.x,i.y,i.z);var r=void 0!==e.axis?e.axis.clone():new c(0,1,0);this.wheelAxes.push(r);var o=new l(this.chassisBody,t,{pivotA:n,axisA:r,pivotB:c.ZERO,axisB:r,collideConnected:!1});return this.constraints.push(o),this.wheelBodies.length-1},r.prototype.setSteeringValue=function(e,t){var n=this.wheelAxes[t],i=Math.cos(e),r=Math.sin(e),o=n.x,a=n.y;this.constraints[t].axisA.set(i*o-r*a,r*o+i*a,0)},r.prototype.setMotorSpeed=function(e,t){var n=this.constraints[t];n.enableMotor(),n.motorTargetVelocity=e},r.prototype.disableMotor=function(e){this.constraints[e].disableMotor()};var o=new c;r.prototype.setWheelForce=function(e,t){this.wheelForces[t]=e},r.prototype.applyWheelForce=function(e,t){var n=this.wheelAxes[t],i=this.wheelBodies[t],r=i.torque;n.scale(e,o),i.vectorToWorldFrame(o,o),r.vadd(o,r)},r.prototype.addToWorld=function(e){for(var t=this.constraints,n=this.wheelBodies.concat([this.chassisBody]),i=0;i<n.length;i++)e.addBody(n[i]);for(i=0;i<t.length;i++)e.addConstraint(t[i]);e.addEventListener("preStep",this._update.bind(this))},r.prototype._update=function(){for(var e=this.wheelForces,t=0;t<e.length;t++)this.applyWheelForce(e[t],t)},r.prototype.removeFromWorld=function(e){for(var t=this.constraints,n=this.wheelBodies.concat([this.chassisBody]),i=0;i<n.length;i++)e.remove(n[i]);for(i=0;i<t.length;i++)e.removeConstraint(t[i])};var u=new c;r.prototype.getWheelSpeed=function(e){var t=this.wheelAxes[e],n=this.wheelBodies[e].angularVelocity;return this.chassisBody.vectorToWorldFrame(t,u),n.dot(u)}},function(e,t,n){n(1);var i=n(35);function u(e){i.apply(this),this.axisList=[],this.world=null,this.axisIndex=0;var n=this.axisList;this._addBodyHandler=function(e){n.push(e.body)},this._removeBodyHandler=function(e){var t=n.indexOf(e.body);-1!==t&&n.splice(t,1)},e&&this.setWorld(e)}((e.exports=u).prototype=new i).setWorld=function(e){for(var t=this.axisList.length=0;t<e.bodies.length;t++)this.axisList.push(e.bodies[t]);e.removeEventListener("addBody",this._addBodyHandler),e.removeEventListener("removeBody",this._removeBodyHandler),e.addEventListener("addBody",this._addBodyHandler),e.addEventListener("removeBody",this._removeBodyHandler),this.world=e,this.dirty=!0},u.insertionSortX=function(e){for(var t=1,n=e.length;t<n;t++){for(var i=e[t],r=t-1;0<=r&&!(e[r].aabb.lowerBound.x<=i.aabb.lowerBound.x);r--)e[r+1]=e[r];e[r+1]=i}return e},u.insertionSortY=function(e){for(var t=1,n=e.length;t<n;t++){for(var i=e[t],r=t-1;0<=r&&!(e[r].aabb.lowerBound.y<=i.aabb.lowerBound.y);r--)e[r+1]=e[r];e[r+1]=i}return e},u.insertionSortZ=function(e){for(var t=1,n=e.length;t<n;t++){for(var i=e[t],r=t-1;0<=r&&!(e[r].aabb.lowerBound.z<=i.aabb.lowerBound.z);r--)e[r+1]=e[r];e[r+1]=i}return e},u.prototype.collisionPairs=function(e,t,n){var i,r,o=this.axisList,a=o.length,s=this.axisIndex;for(this.dirty&&(this.sortList(),this.dirty=!1),i=0;i!==a;i++){var c=o[i];for(r=i+1;r<a;r++){var l=o[r];if(this.needBroadphaseCollision(c,l)){if(!u.checkBounds(c,l,s))break;this.intersectionTest(c,l,t,n)}}}},u.prototype.sortList=function(){for(var e=this.axisList,t=this.axisIndex,n=e.length,i=0;i!==n;i++){var r=e[i];r.aabbNeedsUpdate&&r.computeAABB()}0===t?u.insertionSortX(e):1===t?u.insertionSortY(e):2===t&&u.insertionSortZ(e)},u.checkBounds=function(e,t,n){var i,r;0===n?(i=e.position.x,r=t.position.x):1===n?(i=e.position.y,r=t.position.y):2===n&&(i=e.position.z,r=t.position.z);var o=e.boundingRadius;return r-t.boundingRadius<i+o},u.prototype.autoDetectAxis=function(){for(var e=0,t=0,n=0,i=0,r=0,o=0,a=this.axisList,s=a.length,c=1/s,l=0;l!==s;l++){var u=a[l],h=u.position.x;e+=h,t+=h*h;var d=u.position.y;n+=d,i+=d*d;var p=u.position.z;r+=p,o+=p*p}var f=t-e*e*c,m=i-n*n*c,v=o-r*r*c;this.axisIndex=m<f?v<f?0:2:v<m?1:2},u.prototype.aabbQuery=function(e,t,n){n=n||[],this.dirty&&(this.sortList(),this.dirty=!1);var i=this.axisIndex,r="x";1===i&&(r="y"),2===i&&(r="z");for(var o=this.axisList,a=(t.lowerBound[r],t.upperBound[r],0);a<o.length;a++){var s=o[a];s.aabbNeedsUpdate&&s.computeAABB(),s.aabb.overlaps(t)&&n.push(s)}return n}},function(e,t,n){e.exports=r,n(1);var i=n(0);function r(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}n(3),n(78),n(9),n(28),r.prototype.add=function(e){this.particles.push(e),this.neighbors.length<this.particles.length&&this.neighbors.push([])},r.prototype.remove=function(e){var t=this.particles.indexOf(e);-1!==t&&(this.particles.splice(t,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())};var c=new i;r.prototype.getNeighbors=function(e,t){for(var n=this.particles.length,i=e.id,r=this.smoothingRadius*this.smoothingRadius,o=c,a=0;a!==n;a++){var s=this.particles[a];s.position.vsub(e.position,o),i!==s.id&&o.norm2()<r&&t.push(s)}};var x=new i,E=new i,M=new i,T=new i,S=new i,C=new i;r.prototype.update=function(){for(var e=this.particles.length,t=x,n=this.speedOfSound,i=this.eps,r=0;r!==e;r++){var o=this.particles[r];(y=this.neighbors[r]).length=0,this.getNeighbors(o,y),y.push(this.particles[r]);for(var a=y.length,s=0,c=0;c!==a;c++){o.position.vsub(y[c].position,t);var l=t.norm(),u=this.w(l);s+=y[c].mass*u}this.densities[r]=s,this.pressures[r]=n*n*(this.densities[r]-this.density)}var h=E,d=M,p=T,f=S,m=C;for(r=0;r!==e;r++){var v,g,y,A=this.particles[r];for(h.set(0,0,0),d.set(0,0,0),a=(y=this.neighbors[r]).length,c=0;c!==a;c++){var b=y[c];A.position.vsub(b.position,f);var w=f.norm();v=-b.mass*(this.pressures[r]/(this.densities[r]*this.densities[r]+i)+this.pressures[c]/(this.densities[c]*this.densities[c]+i)),this.gradw(f,p),p.mult(v,p),h.vadd(p,h),b.velocity.vsub(A.velocity,m),m.mult(1/(1e-4+this.densities[r]*this.densities[c])*this.viscosity*b.mass,m),g=this.nablaw(w),m.mult(g,m),d.vadd(m,d)}d.mult(A.mass,d),h.mult(A.mass,h),A.force.vadd(d,A.force),A.force.vadd(h,A.force)}},r.prototype.w=function(e){var t=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(t,9))*Math.pow(t*t-e*e,3)},r.prototype.gradw=function(e,t){var n=e.norm(),i=this.smoothingRadius;e.mult(945/(32*Math.PI*Math.pow(i,9))*Math.pow(i*i-n*n,2),t)},r.prototype.nablaw=function(e){var t=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(t,9))*(t*t-e*e)*(7*e*e-3*t*t)}},function(e,t,n){e.exports=o,n(0),n(3);var i=n(37),r=n(9);function o(e){for(i.call(this),this.iterations=10,this.tolerance=1e-7,this.subsolver=e,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}o.prototype=new i;var w=[],x=[],E={bodies:[]},a=r.STATIC;function M(e){for(var t=e.length,n=0;n!==t;n++){var i=e[n];if(!(i.visited||i.body.type&a))return i}return!1}var s=[];function T(e,t,n,i){for(s.push(e),e.visited=!0,t(e,n,i);s.length;)for(var r,o=s.pop();r=M(o.children);)r.visited=!0,t(r,n,i),s.push(r)}function S(e,t,n){t.push(e.body);for(var i=e.eqs.length,r=0;r!==i;r++){var o=e.eqs[r];-1===n.indexOf(o)&&n.push(o)}}function C(e,t){return t.id-e.id}o.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}},o.prototype.solve=function(e,t){for(var n=w,i=this.nodePool,r=t.bodies,o=this.equations,a=o.length,s=r.length,c=this.subsolver;i.length<s;)i.push(this.createNode());n.length=s;for(var l=0;l<s;l++)n[l]=i[l];for(l=0;l!==s;l++){var u=n[l];u.body=r[l],u.children.length=0,u.eqs.length=0,u.visited=!1}for(var h=0;h!==a;h++){var d=o[h],p=(l=r.indexOf(d.bi),r.indexOf(d.bj)),f=n[l],m=n[p];f.children.push(m),f.eqs.push(d),m.children.push(f),m.eqs.push(d)}var v,g=0,y=x;c.tolerance=this.tolerance,c.iterations=this.iterations;for(var A=E;v=M(n);){y.length=0,A.bodies.length=0,T(v,S,A.bodies,y);var b=y.length;for(y=y.sort(C),l=0;l!==b;l++)c.addEquation(y[l]);c.solve(e,A),c.removeAllEquations(),g++}return g}},function(e,t,n){var i=n(0);function r(e,t,n){n=n||{},this.restLength="number"==typeof n.restLength?n.restLength:1,this.stiffness=n.stiffness||100,this.damping=n.damping||1,this.bodyA=e,this.bodyB=t,this.localAnchorA=new i,this.localAnchorB=new i,n.localAnchorA&&this.localAnchorA.copy(n.localAnchorA),n.localAnchorB&&this.localAnchorB.copy(n.localAnchorB),n.worldAnchorA&&this.setWorldAnchorA(n.worldAnchorA),n.worldAnchorB&&this.setWorldAnchorB(n.worldAnchorB)}(e.exports=r).prototype.setWorldAnchorA=function(e){this.bodyA.pointToLocalFrame(e,this.localAnchorA)},r.prototype.setWorldAnchorB=function(e){this.bodyB.pointToLocalFrame(e,this.localAnchorB)},r.prototype.getWorldAnchorA=function(e){this.bodyA.pointToWorldFrame(this.localAnchorA,e)},r.prototype.getWorldAnchorB=function(e){this.bodyB.pointToWorldFrame(this.localAnchorB,e)};var g=new i,y=new i,A=new i,b=new i,w=new i,x=new i,E=new i,M=new i,T=new i,S=new i,C=new i;r.prototype.applyForce=function(){var e=this.stiffness,t=this.damping,n=this.restLength,i=this.bodyA,r=this.bodyB,o=g,a=y,s=A,c=b,l=C,u=w,h=x,d=E,p=M,f=T,m=S;this.getWorldAnchorA(u),this.getWorldAnchorB(h),u.vsub(i.position,d),h.vsub(r.position,p),h.vsub(u,o);var v=o.norm();a.copy(o),a.normalize(),r.velocity.vsub(i.velocity,s),r.angularVelocity.cross(p,l),s.vadd(l,s),i.angularVelocity.cross(d,l),s.vsub(l,s),a.mult(-e*(v-n)-t*s.dot(a),c),i.force.vsub(c,i.force),r.force.vadd(c,r.force),d.cross(c,f),p.cross(c,m),i.torque.vsub(f,i.torque),r.torque.vadd(m,r.torque)}},function(e,t,n){e.exports=y;var i=n(1),l=n(0),r=(n(3),n(20)),u=n(7),o=n(147);function y(e,t){i.call(this),this.type=i.types.TRIMESH,this.vertices=new Float32Array(e),this.indices=new Int16Array(t),this.normals=new Float32Array(t.length),this.aabb=new u,this.edges=null,this.scale=new l(1,1,1),this.tree=new o,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}(y.prototype=new i).constructor=y;var s=new l;y.prototype.updateTree=function(){var e=this.tree;e.reset(),e.aabb.copy(this.aabb);var t=this.scale;e.aabb.lowerBound.x*=1/t.x,e.aabb.lowerBound.y*=1/t.y,e.aabb.lowerBound.z*=1/t.z,e.aabb.upperBound.x*=1/t.x,e.aabb.upperBound.y*=1/t.y,e.aabb.upperBound.z*=1/t.z;for(var n=new u,i=new l,r=new l,o=new l,a=[i,r,o],s=0;s<this.indices.length/3;s++){var c=3*s;this._getUnscaledVertex(this.indices[c],i),this._getUnscaledVertex(this.indices[1+c],r),this._getUnscaledVertex(this.indices[2+c],o),n.setFromPoints(a),e.insert(n,s)}e.removeEmptyNodes()};var c=new u;y.prototype.getTrianglesInAABB=function(e,t){c.copy(e);var n=this.scale,i=n.x,r=n.y,o=n.z,a=c.lowerBound,s=c.upperBound;return a.x/=i,a.y/=r,a.z/=o,s.x/=i,s.y/=r,s.z/=o,this.tree.aabbQuery(c,t)},y.prototype.setScale=function(e){var t=this.scale.x===this.scale.y===this.scale.z,n=e.x===e.y===e.z;t&&n||this.updateNormals(),this.scale.copy(e),this.updateAABB(),this.updateBoundingSphereRadius()},y.prototype.updateNormals=function(){for(var e=s,t=this.normals,n=0;n<this.indices.length/3;n++){var i=3*n,r=this.indices[i],o=this.indices[1+i],a=this.indices[2+i];this.getVertex(r,f),this.getVertex(o,m),this.getVertex(a,v),y.computeNormal(m,f,v,e),t[i]=e.x,t[1+i]=e.y,t[2+i]=e.z}},y.prototype.updateEdges=function(){function e(e,t){n[r<o?r+"_"+o:o+"_"+r]=!0}for(var n={},t=0;t<this.indices.length/3;t++){var i=3*t,r=this.indices[i],o=this.indices[1+i];this.indices[2+i],e(),e(),e()}var a=Object.keys(n);for(this.edges=new Int16Array(2*a.length),t=0;t<a.length;t++){var s=a[t].split("_");this.edges[2*t]=parseInt(s[0],10),this.edges[2*t+1]=parseInt(s[1],10)}},y.prototype.getEdgeVertex=function(e,t,n){var i=this.edges[2*e+(t?1:0)];this.getVertex(i,n)};var a=new l,h=new l;y.prototype.getEdgeVector=function(e,t){var n=a,i=h;this.getEdgeVertex(e,0,n),this.getEdgeVertex(e,1,i),i.vsub(n,t)};var d=new l,p=new l;y.computeNormal=function(e,t,n,i){t.vsub(e,p),n.vsub(t,d),d.cross(p,i),i.isZero()||i.normalize()};var f=new l,m=new l,v=new l;y.prototype.getVertex=function(e,t){var n=this.scale;return this._getUnscaledVertex(e,t),t.x*=n.x,t.y*=n.y,t.z*=n.z,t},y.prototype._getUnscaledVertex=function(e,t){var n=3*e,i=this.vertices;return t.set(i[n],i[1+n],i[2+n])},y.prototype.getWorldVertex=function(e,t,n,i){return this.getVertex(e,i),r.pointToWorldFrame(t,n,i,i),i},y.prototype.getTriangleVertices=function(e,t,n,i){var r=3*e;this.getVertex(this.indices[r],t),this.getVertex(this.indices[1+r],n),this.getVertex(this.indices[2+r],i)},y.prototype.getNormal=function(e,t){var n=3*e;return t.set(this.normals[n],this.normals[1+n],this.normals[2+n])};var g=new u;y.prototype.calculateLocalInertia=function(e,t){this.computeLocalAABB(g);var n=g.upperBound.x-g.lowerBound.x,i=g.upperBound.y-g.lowerBound.y,r=g.upperBound.z-g.lowerBound.z;return t.set(1/12*e*(2*i*2*i+2*r*2*r),1/12*e*(2*n*2*n+2*r*2*r),1/12*e*(2*i*2*i+2*n*2*n))};var A=new l;y.prototype.computeLocalAABB=function(e){var t=e.lowerBound,n=e.upperBound,i=this.vertices.length,r=(this.vertices,A);this.getVertex(0,r),t.copy(r),n.copy(r);for(var o=0;o!==i;o++)this.getVertex(o,r),r.x<t.x?t.x=r.x:r.x>n.x&&(n.x=r.x),r.y<t.y?t.y=r.y:r.y>n.y&&(n.y=r.y),r.z<t.z?t.z=r.z:r.z>n.z&&(n.z=r.z)},y.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)},y.prototype.updateBoundingSphereRadius=function(){for(var e=0,t=this.vertices,n=new l,i=0,r=t.length/3;i!==r;i++){this.getVertex(i,n);var o=n.norm2();e<o&&(e=o)}this.boundingSphereRadius=Math.sqrt(e)},new l;var b=new r,w=new u;y.prototype.calculateWorldAABB=function(e,t,n,i){var r=b,o=w;r.position=e,r.quaternion=t,this.aabb.toWorldFrame(r,o),n.copy(o.lowerBound),i.copy(o.upperBound)},y.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},y.createTorus=function(e,t,n,i,r){e=e||1,t=t||.5,n=n||8,i=i||6,r=r||2*Math.PI;for(var o=[],a=[],s=0;s<=n;s++)for(var c=0;c<=i;c++){var l=c/i*r,u=s/n*Math.PI*2,h=(e+t*Math.cos(u))*Math.cos(l),d=(e+t*Math.cos(u))*Math.sin(l),p=t*Math.sin(u);o.push(h,d,p)}for(s=1;s<=n;s++)for(c=1;c<=i;c++){var f=(i+1)*s+c-1,m=(i+1)*(s-1)+c-1,v=(i+1)*(s-1)+c,g=(i+1)*s+c;a.push(f,m,g),a.push(m,v,g)}return new y(o,a)}},function(e,t,n){var c=n(7),l=n(0);function u(e){e=e||{},this.root=e.root||null,this.aabb=e.aabb?e.aabb.clone():new c,this.data=[],this.children=[]}function i(e,t){(t=t||{}).root=null,t.aabb=e,u.call(this,t),this.maxDepth=void 0!==t.maxDepth?t.maxDepth:8}(e.exports=i).prototype=new u,u.prototype.reset=function(e,t){this.children.length=this.data.length=0},u.prototype.insert=function(e,t,n){var i=this.data;if(n=n||0,!this.aabb.contains(e))return!1;var r=this.children;if(n<(this.maxDepth||this.root.maxDepth)){var o=!1;r.length||(this.subdivide(),o=!0);for(var a=0;8!==a;a++)if(r[a].insert(e,t,n+1))return!0;o&&(r.length=0)}return i.push(t),!0};var h=new l;u.prototype.subdivide=function(){var e=this.aabb,t=e.lowerBound,n=e.upperBound,i=this.children;i.push(new u({aabb:new c({lowerBound:new l(0,0,0)})}),new u({aabb:new c({lowerBound:new l(1,0,0)})}),new u({aabb:new c({lowerBound:new l(1,1,0)})}),new u({aabb:new c({lowerBound:new l(1,1,1)})}),new u({aabb:new c({lowerBound:new l(0,1,1)})}),new u({aabb:new c({lowerBound:new l(0,0,1)})}),new u({aabb:new c({lowerBound:new l(1,0,1)})}),new u({aabb:new c({lowerBound:new l(0,1,0)})})),n.vsub(t,h),h.scale(.5,h);for(var r=this.root||this,o=0;8!==o;o++){var a=i[o];a.root=r;var s=a.aabb.lowerBound;s.x*=h.x,s.y*=h.y,s.z*=h.z,s.vadd(t,s),s.vadd(h,a.aabb.upperBound)}},u.prototype.aabbQuery=function(e,t){this.data,this.children;for(var n=[this];n.length;){var i=n.pop();i.aabb.overlaps(e)&&Array.prototype.push.apply(t,i.data),Array.prototype.push.apply(n,i.children)}return t};var r=new c;u.prototype.rayQuery=function(e,t,n){return e.getAABB(r),r.toLocalFrame(t,r),this.aabbQuery(r,n),n},u.prototype.removeEmptyNodes=function(){for(var e=[this];e.length;){for(var t=e.pop(),n=t.children.length-1;0<=n;n--)t.children[n].data.length||t.children.splice(n,1);Array.prototype.push.apply(e,t.children)}}},function(e,t,n){e.exports=g,n(1);var i=n(0),r=n(3),o=n(75),a=(n(10),n(53),n(71)),s=n(52),c=n(69),l=n(149),u=n(28),h=n(74),G=n(9),d=n(150),p=n(29),f=n(7),m=n(36),v=n(77);function g(e){e=e||{},s.apply(this),this.dt=-1,this.allowSleep=!!e.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=void 0!==e.quatNormalizeSkip?e.quatNormalizeSkip:0,this.quatNormalizeFast=void 0!==e.quatNormalizeFast&&e.quatNormalizeFast,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new i,e.gravity&&this.gravity.copy(e.gravity),this.broadphase=void 0!==e.broadphase?e.broadphase:new v,this.bodies=[],this.solver=void 0!==e.solver?e.solver:new o,this.constraints=[],this.narrowphase=new a(this),this.collisionMatrix=new c,this.collisionMatrixPrevious=new c,this.bodyOverlapKeeper=new l,this.shapeOverlapKeeper=new l,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new d,this.defaultMaterial=new u("default"),this.defaultContactMaterial=new h(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}g.prototype=new s,new f;var y=new m;if(g.prototype.getContactMaterial=function(e,t){return this.contactMaterialTable.get(e.id,t.id)},g.prototype.numObjects=function(){return this.bodies.length},g.prototype.collisionMatrixTick=function(){var e=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=e,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()},g.prototype.add=g.prototype.addBody=function(e){-1===this.bodies.indexOf(e)&&(e.index=this.bodies.length,this.bodies.push(e),e.world=this,e.initPosition.copy(e.position),e.initVelocity.copy(e.velocity),e.timeLastSleepy=this.time,e instanceof G&&(e.initAngularVelocity.copy(e.angularVelocity),e.initQuaternion.copy(e.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=e,this.idToBodyMap[e.id]=e,this.dispatchEvent(this.addBodyEvent))},g.prototype.addConstraint=function(e){this.constraints.push(e)},g.prototype.removeConstraint=function(e){var t=this.constraints.indexOf(e);-1!==t&&this.constraints.splice(t,1)},g.prototype.rayTest=function(e,t,n){n instanceof p?this.raycastClosest(e,t,{skipBackfaces:!0},n):this.raycastAll(e,t,{skipBackfaces:!0},n)},g.prototype.raycastAll=function(e,t,n,i){return n.mode=m.ALL,n.from=e,n.to=t,n.callback=i,y.intersectWorld(this,n)},g.prototype.raycastAny=function(e,t,n,i){return n.mode=m.ANY,n.from=e,n.to=t,n.result=i,y.intersectWorld(this,n)},g.prototype.raycastClosest=function(e,t,n,i){return n.mode=m.CLOSEST,n.from=e,n.to=t,n.result=i,y.intersectWorld(this,n)},g.prototype.removeBody=g.prototype.remove=function(e){e.world=null;var t=this.bodies.length-1,n=this.bodies,i=n.indexOf(e);if(-1!==i){n.splice(i,1);for(var r=0;r!==n.length;r++)n[r].index=r;this.collisionMatrix.setNumObjects(t),this.removeBodyEvent.body=e,delete this.idToBodyMap[e.id],this.dispatchEvent(this.removeBodyEvent)}},g.prototype.getBodyById=function(e){return this.idToBodyMap[e]},g.prototype.getShapeById=function(e){for(var t=this.bodies,n=0,i=t.length;n<i;n++)for(var r=t[n].shapes,o=0,a=r.length;o<a;o++){var s=r[o];if(s.id===e)return s}},g.prototype.addMaterial=function(e){this.materials.push(e)},g.prototype.addContactMaterial=function(e){this.contactmaterials.push(e),this.contactMaterialTable.set(e.materials[0].id,e.materials[1].id,e)},"undefined"==typeof performance&&(performance={}),!performance.now){var A=Date.now();performance.timing&&performance.timing.navigationStart&&(A=performance.timing.navigationStart),performance.now=function(){return Date.now()-A}}new i,g.prototype.step=function(e,t,n){if(n=n||10,0===(t=t||0))this.internalStep(e),this.time+=e;else{this.accumulator+=t;for(var i=0;this.accumulator>=e&&i<n;)this.internalStep(e),this.accumulator-=e,i++;for(var r=this.accumulator%e/e,o=0;o!==this.bodies.length;o++){var a=this.bodies[o];a.previousPosition.lerp(a.position,r,a.interpolatedPosition),a.previousQuaternion.slerp(a.quaternion,r,a.interpolatedQuaternion),a.previousQuaternion.normalize()}this.time+=t}};var b,w,x,E,M,T,V={type:"postStep"},W={type:"preStep"},q={type:G.COLLIDE_EVENT_NAME,body:null,contact:null},X=[],Q=[],Y=[],Z=[];new i,new i,new i,new i,new i,new i,new i,new i,new i,new r,new r,new r,new i,g.prototype.internalStep=function(e){this.dt=e;var t,n=this.contacts,i=Y,r=Z,o=this.numObjects(),a=this.bodies,s=this.solver,c=this.gravity,l=this.doProfiling,u=this.profile,h=G.DYNAMIC,d=this.constraints,p=Q,f=(c.norm(),c.x),m=c.y,v=c.z,g=0;for(l&&(t=performance.now()),g=0;g!==o;g++)if((L=a[g]).type===h){var y=L.force,A=L.mass;y.x+=A*f,y.y+=A*m,y.z+=A*v}g=0;for(var b=this.subsystems.length;g!==b;g++)this.subsystems[g].update();l&&(t=performance.now()),i.length=0,r.length=0,this.broadphase.collisionPairs(this,i,r),l&&(u.broadphase=performance.now()-t);var w=d.length;for(g=0;g!==w;g++)if(!(P=d[g]).collideConnected)for(var x=i.length-1;0<=x;--x)(P.bodyA===i[x]&&P.bodyB===r[x]||P.bodyB===i[x]&&P.bodyA===r[x])&&(i.splice(x,1),r.splice(x,1));this.collisionMatrixTick(),l&&(t=performance.now());var E=X,M=n.length;for(g=0;g!==M;g++)E.push(n[g]);n.length=0;var T=this.frictionEquations.length;for(g=0;g!==T;g++)p.push(this.frictionEquations[g]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(i,r,this,n,E,this.frictionEquations,p),l&&(u.narrowphase=performance.now()-t),l&&(t=performance.now()),g=0;g<this.frictionEquations.length;g++)s.addEquation(this.frictionEquations[g]);for(var S=n.length,C=0;C!==S;C++){var L=(P=n[C]).bi,_=P.bj,B=P.si,R=P.sj;(L.material&&_.material&&this.getContactMaterial(L.material,_.material)||this.defaultContactMaterial).friction,L.material&&_.material&&(0<=L.material.friction&&0<=_.material.friction&&(L.material.friction,_.material.friction),0<=L.material.restitution&&0<=_.material.restitution&&(P.restitution=L.material.restitution*_.material.restitution)),s.addEquation(P),!L.allowSleep||L.type!==G.DYNAMIC||L.sleepState!==G.SLEEPING||_.sleepState!==G.AWAKE||_.type===G.STATIC||_.velocity.norm2()+_.angularVelocity.norm2()>=2*Math.pow(_.sleepSpeedLimit,2)&&(L._wakeUpAfterNarrowphase=!0),_.allowSleep&&_.type===G.DYNAMIC&&_.sleepState===G.SLEEPING&&L.sleepState===G.AWAKE&&L.type!==G.STATIC&&L.velocity.norm2()+L.angularVelocity.norm2()>=2*Math.pow(L.sleepSpeedLimit,2)&&(_._wakeUpAfterNarrowphase=!0),this.collisionMatrix.set(L,_,!0),this.collisionMatrixPrevious.get(L,_)||(q.body=_,q.contact=P,L.dispatchEvent(q),q.body=L,_.dispatchEvent(q)),this.bodyOverlapKeeper.set(L.id,_.id),this.shapeOverlapKeeper.set(B.id,R.id)}for(this.emitContactEvents(),l&&(u.makeContactConstraints=performance.now()-t,t=performance.now()),g=0;g!==o;g++)(L=a[g])._wakeUpAfterNarrowphase&&(L.wakeUp(),L._wakeUpAfterNarrowphase=!1);for(w=d.length,g=0;g!==w;g++){var P;(P=d[g]).update(),x=0;for(var D=P.equations.length;x!==D;x++){var I=P.equations[x];s.addEquation(I)}}s.solve(e,this),l&&(u.solve=performance.now()-t),s.removeAllEquations();var O=Math.pow;for(g=0;g!==o;g++)if((L=a[g]).type&h){var k=O(1-L.linearDamping,e),j=L.velocity;j.mult(k,j);var H=L.angularVelocity;if(H){var F=O(1-L.angularDamping,e);H.mult(F,H)}}for(this.dispatchEvent(W),g=0;g!==o;g++)(L=a[g]).preStep&&L.preStep.call(L);l&&(t=performance.now());var N=this.stepnumber%(this.quatNormalizeSkip+1)==0,z=this.quatNormalizeFast;for(g=0;g!==o;g++)a[g].integrate(e,N,z);for(this.clearForces(),this.broadphase.dirty=!0,l&&(u.integrate=performance.now()-t),this.time+=e,this.stepnumber+=1,this.dispatchEvent(V),g=0;g!==o;g++){var U=(L=a[g]).postStep;U&&U.call(L)}if(this.allowSleep)for(g=0;g!==o;g++)a[g].sleepTick(this.time)},g.prototype.emitContactEvents=(b=[],w=[],x={type:"beginContact",bodyA:null,bodyB:null},E={type:"endContact",bodyA:null,bodyB:null},M={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},T={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},function(){var e=this.hasAnyEventListener("beginContact"),t=this.hasAnyEventListener("endContact");if((e||t)&&this.bodyOverlapKeeper.getDiff(b,w),e){for(var n=0,i=b.length;n<i;n+=2)x.bodyA=this.getBodyById(b[n]),x.bodyB=this.getBodyById(b[n+1]),this.dispatchEvent(x);x.bodyA=x.bodyB=null}if(t){for(n=0,i=w.length;n<i;n+=2)E.bodyA=this.getBodyById(w[n]),E.bodyB=this.getBodyById(w[n+1]),this.dispatchEvent(E);E.bodyA=E.bodyB=null}b.length=w.length=0;var r=this.hasAnyEventListener("beginShapeContact"),o=this.hasAnyEventListener("endShapeContact");if((r||o)&&this.shapeOverlapKeeper.getDiff(b,w),r){for(n=0,i=b.length;n<i;n+=2){var a=this.getShapeById(b[n]),s=this.getShapeById(b[n+1]);M.shapeA=a,M.shapeB=s,M.bodyA=a.body,M.bodyB=s.body,this.dispatchEvent(M)}M.bodyA=M.bodyB=M.shapeA=M.shapeB=null}if(o){for(n=0,i=w.length;n<i;n+=2)a=this.getShapeById(w[n]),s=this.getShapeById(w[n+1]),T.shapeA=a,T.shapeB=s,T.bodyA=a.body,T.bodyB=s.body,this.dispatchEvent(T);T.bodyA=T.bodyB=T.shapeA=T.shapeB=null}}),g.prototype.clearForces=function(){for(var e=this.bodies,t=e.length,n=0;n!==t;n++){var i=e[n];i.force,i.torque,i.force.set(0,0,0),i.torque.set(0,0,0)}}},function(e,t){function n(){this.current=[],this.previous=[]}function u(e,t){e.push((4294901760&t)>>16,65535&t)}(e.exports=n).prototype.getKey=function(e,t){if(t<e){var n=t;t=e,e=n}return e<<16|t},n.prototype.set=function(e,t){for(var n=this.getKey(e,t),i=this.current,r=0;n>i[r];)r++;if(n!==i[r]){for(t=i.length-1;r<=t;t--)i[t+1]=i[t];i[r]=n}},n.prototype.tick=function(){var e=this.current;this.current=this.previous,this.previous=e,this.current.length=0},n.prototype.getDiff=function(e,t){for(var n=this.current,i=this.previous,r=n.length,o=i.length,a=0,s=0;s<r;s++){for(var c=n[s];c>i[a];)a++;c===i[a]||u(e,c)}for(s=a=0;s<o;s++){for(var l=i[s];l>n[a];)a++;n[a]===l||u(t,l)}}},function(e,t){function n(){this.data={keys:[]}}(e.exports=n).prototype.get=function(e,t){if(t<e){var n=t;t=e,e=n}return this.data[e+"-"+t]},n.prototype.set=function(e,t,n){if(t<e){var i=t;t=e,e=i}var r=e+"-"+t;this.get(e,t)||this.data.keys.push(r),this.data[r]=n},n.prototype.reset=function(){for(var e=this.data,t=e.keys;0<t.length;)delete e[t.pop()]}},function(e,t,n){e.exports={velocity:n(152),registerAll:function(e){this._registered||((e=e||window.AFRAME).components.velocity||e.registerComponent("velocity",this.velocity),this._registered=!0)}}},function(e,t){e.exports=AFRAME.registerComponent("velocity",{schema:{type:"vec3"},init:function(){this.system=this.el.sceneEl.systems.physics,this.system&&this.system.addComponent(this)},remove:function(){this.system&&this.system.removeComponent(this)},tick:function(e,t){t&&(this.system||this.afterStep(e,t))},afterStep:function(e,t){if(t){var n=this.el.sceneEl.systems.physics||{data:{maxInterval:1/60}},i=this.el.getAttribute("velocity")||{x:0,y:0,z:0},r=this.el.getAttribute("position")||{x:0,y:0,z:0};t=Math.min(t,1e3*n.data.maxInterval),this.el.setAttribute("position",{x:r.x+i.x*t/1e3,y:r.y+i.y*t/1e3,z:r.z+i.z*t/1e3})}}})},function(e,t,n){function i(o,n){var e,t,i,r,a,s,c,l,u,h,d,p,f,m,v;if((n=n||{}).type===b.BOX)return x(o);if(n.type===b.CYLINDER)return t=o,i=n,c=new THREE.Box3,l=["x","y","z"],u=i.cylinderAxis||"y",h=l.splice(l.indexOf(u),1)&&l,c.setFromObject(t),isFinite(c.min.lengthSq())?(a=c.max[u]-c.min[u],s=.5*Math.max(c.max[h[0]]-c.min[h[0]],c.max[h[1]]-c.min[h[1]]),(r=new g.Cylinder(s,s,a,12))._type=g.Shape.types.CYLINDER,r.radiusTop=s,r.radiusBottom=s,r.height=a,r.numSegments=12,r.orientation=new g.Quaternion,r.orientation.setFromEuler("y"===u?A:0,"z"===u?A:0,0,"XYZ").normalize(),r):null;if(n.type===b.SPHERE)return function(e){if(n.sphereRadius)return new g.Sphere(n.sphereRadius);var t=E(e);return t?(t.computeBoundingSphere(),new g.Sphere(t.boundingSphere.radius)):null}(o);if(n.type===b.HULL)return function(){var e,t,n,i,r=E(o);if(!r||!r.vertices.length)return null;for(e=0;e<r.vertices.length;e++)r.vertices[e].x+=1e-4*(Math.random()-.5),r.vertices[e].y+=1e-4*(Math.random()-.5),r.vertices[e].z+=1e-4*(Math.random()-.5);for(i=y(r),t=new Array(i.vertices.length),e=0;e<i.vertices.length;e++)t[e]=new g.Vec3(i.vertices[e].x,i.vertices[e].y,i.vertices[e].z);for(n=new Array(i.faces.length),e=0;e<i.faces.length;e++)n[e]=[i.faces[e].a,i.faces[e].b,i.faces[e].c];return new g.ConvexPolyhedron(t,n)}();if(n.type===b.MESH)return(e=E(o))?(p=M(e)).length?(d=Object.keys(p).map(Number),new g.Trimesh(p,d)):null:null;if(n.type)throw new Error('[CANNON.mesh2shape] Invalid type "%s".',n.type);if(!(e=E(o)))return null;switch(e.metadata?e.metadata.type:e.type){case"BoxGeometry":case"BoxBufferGeometry":return w(e);case"CylinderGeometry":case"CylinderBufferGeometry":return v=e.metadata?e.metadata.parameters:e.parameters,(m=new g.Cylinder(v.radiusTop,v.radiusBottom,v.height,v.radialSegments))._type=g.Shape.types.CYLINDER,m.radiusTop=v.radiusTop,m.radiusBottom=v.radiusBottom,m.height=v.height,m.numSegments=v.radialSegments,m.orientation=new g.Quaternion,m.orientation.setFromEuler(THREE.Math.degToRad(90),0,0,"XYZ").normalize(),m;case"PlaneGeometry":case"PlaneBufferGeometry":return function(e){e.computeBoundingBox();var t=e.boundingBox;return new g.Box(new g.Vec3((t.max.x-t.min.x)/2||.1,(t.max.y-t.min.y)/2||.1,(t.max.z-t.min.z)/2||.1))}(e);case"SphereGeometry":case"SphereBufferGeometry":return f=e.metadata?e.metadata.parameters:e.parameters,new g.Sphere(f.radius);case"TubeGeometry":case"Geometry":case"BufferGeometry":return x(o);default:return console.warn('Unrecognized geometry: "%s". Using bounding box as shape.',e.type),w(e)}}var g=n(5),y=n(154),A=Math.PI/2,b={BOX:"Box",CYLINDER:"Cylinder",SPHERE:"Sphere",HULL:"ConvexPolyhedron",MESH:"Trimesh"};function w(e){if(!M(e).length)return null;e.computeBoundingBox();var t=e.boundingBox;return new g.Box(new g.Vec3((t.max.x-t.min.x)/2,(t.max.y-t.min.y)/2,(t.max.z-t.min.z)/2))}function x(e){var t,n,i=new THREE.Box3,r=e.clone();return r.quaternion.set(0,0,0,1),r.updateMatrixWorld(),i.setFromObject(r),isFinite(i.min.lengthSq())?(t=new g.Box(new g.Vec3((i.max.x-i.min.x)/2,(i.max.y-i.min.y)/2,(i.max.z-i.min.z)/2)),(n=i.translate(r.position.negate()).getCenter(new THREE.Vector3)).lengthSq()&&(t.offset=n),t):null}function E(e){var t,n,i,r=(i=[],e.traverse(function(e){"Mesh"===e.type&&i.push(e)}),i),o=new THREE.Geometry,a=new THREE.Geometry;if(0===r.length)return null;if(1===r.length){var s=new THREE.Vector3,c=new THREE.Quaternion,l=new THREE.Vector3;return r[0].geometry.isBufferGeometry?r[0].geometry.attributes.position&&2<r[0].geometry.attributes.position.itemSize&&o.fromBufferGeometry(r[0].geometry):o=r[0].geometry.clone(),o.metadata=r[0].geometry.metadata,r[0].updateMatrixWorld(),r[0].matrixWorld.decompose(s,c,l),o.scale(l.x,l.y,l.z)}for(;n=r.pop();)if(n.updateMatrixWorld(),n.geometry.isBufferGeometry){if(n.geometry.attributes.position&&2<n.geometry.attributes.position.itemSize){var u=new THREE.Geometry;u.fromBufferGeometry(n.geometry),a.merge(u,n.matrixWorld),u.dispose()}}else a.merge(n.geometry,n.matrixWorld);return(t=new THREE.Matrix4).scale(e.scale),a.applyMatrix(t),a}function M(e){return e.attributes||(e=(new THREE.BufferGeometry).fromGeometry(e)),(e.attributes.position||{}).array||[]}i.Type=b,e.exports=g.mesh2shape=i},function(e,t){function y(e,t){if(void 0!==e.normal)return e.normal;var n=t[e[0]],i=t[e[1]],r=t[e[2]];return x.subVectors(i,n),E.subVectors(r,n),S.crossVectors(E,x),S.normalize(),e.normal=S.clone()}function A(e,t,n){var i=n[e[0]],r=[],o=y(e,n);t.sort(function(e,t){return r[e.x/3]=void 0!==r[e.x/3]?r[e.x/3]:o.dot(M.subVectors(e,i)),r[t.x/3]=void 0!==r[t.x/3]?r[t.x/3]:o.dot(T.subVectors(t,i)),r[e.x/3]-r[t.x/3]});var a=t.length;for(1===a&&(r[t[0].x/3]=o.dot(M.subVectors(t[0],i)));0<a--&&0<r[t[a].x/3];);a+1<t.length&&0<r[t[a+1].x/3]&&(e.visiblePoints=t.splice(a+1))}function l(e,t){for(var n,i=R.length,r=[e],o=t.indexOf(e.visiblePoints.pop());0<i--;)(n=R[i])!==e&&0<y(n,t).dot(C.subVectors(t[o],t[n[0]]))&&r.push(n);var a,s,c,l,u=i=r.length,h=1===i,d=[],p=0,f=[];if(r[0][0],r[0][1],r[0][1],r[0][2],r[0][2],r[0][0],1===r.length)d=[(n=r[0])[0],n[1],n[1],n[2],n[2],n[0]],-1<P.indexOf(n)&&P.splice(P.indexOf(n),1),n.visiblePoints&&(f=f.concat(n.visiblePoints)),R.splice(R.indexOf(n),1);else for(;0<i--;){var m;for(n=r[i],-1<P.indexOf(n)&&P.splice(P.indexOf(n),1),n.visiblePoints&&(f=f.concat(n.visiblePoints)),R.splice(R.indexOf(n),1),cEdgeIndex=0;cEdgeIndex<3;){for(m=!1,u=r.length,c=n[cEdgeIndex],l=n[(cEdgeIndex+1)%3];0<u--&&!m;)if(p=0,(a=r[u])!==n)for(;p<3&&!m;)s=p+1,m=a[p]===c&&a[s%3]===l||a[p]===l&&a[s%3]===c,p++;m&&!h||(d.push(c),d.push(l)),cEdgeIndex++}}i=0;for(var v,g=d.length/2;i<g;)A(v=[d[2*i+1],o,d[2*i]],f,t),R.push(v),void 0!==v.visiblePoints&&P.push(v),i++}var u,h,d,p,f,m,v,g,b,w,x,E,M,T,S,C,L,_,B,i,r,o,R,P,D,I,a,s,c,O;e.exports=(R=[],P=[],D=0,i=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Vector3,I=function(e,t,n){return i.subVectors(n,e),r.subVectors(t,e),o.crossVectors(i,r),o.normalize()},a=new THREE.Vector3,s=new THREE.Vector3,c=new THREE.Vector3,O=function(e,t,n){a.subVectors(t,e),s.subVectors(n,e),c.subVectors(n,t);var i=s.dot(a);if(i<0)return s.dot(s);var r=a.dot(a);return r<=i?c.dot(c):s.dot(s)-i*i/r},function(e){for(x=new THREE.Vector3,E=new THREE.Vector3,new THREE.Vector3,M=new THREE.Vector3,T=new THREE.Vector3,S=new THREE.Vector3,C=new THREE.Vector3,L=new THREE.Vector3,_=new THREE.Vector3,B=new THREE.Vector3,points=e.vertices,R=[],P=[],s=u=points.length,h=points.slice(0,6),D=0;0<s--;)points[s].x<h[0].x&&(h[0]=points[s]),points[s].x>h[1].x&&(h[1]=points[s]),points[s].y<h[2].y&&(h[2]=points[s]),points[s].y<h[3].y&&(h[3]=points[s]),points[s].z<h[4].z&&(h[4]=points[s]),points[s].z<h[5].z&&(h[5]=points[s]);for(p=s=6;0<s--;)for(p=s-1;0<p--;)D<(d=h[s].distanceToSquared(h[p]))&&(D=d,f=h[s],m=h[p]);for(s=6,D=0;0<s--;)d=O(f,m,h[s]),D<d&&(D=d,v=h[s]);for(b=I(f,m,v),w=b.dot(f),D=0,s=u;0<s--;)d=Math.abs(points[s].dot(b)-w),D<d&&(D=d,g=points[s]);var t=points.indexOf(f),n=points.indexOf(m),i=points.indexOf(v),r=points.indexOf(g),o=[[i,n,t],[n,r,t],[i,r,n],[t,r,i]];L.subVectors(m,f).normalize(),_.subVectors(v,f).normalize(),B.subVectors(g,f).normalize(),B.dot((new THREE.Vector3).crossVectors(_,L))<0&&(o[0].reverse(),o[1].reverse(),o[2].reverse(),o[3].reverse());var a=points.slice();a.splice(a.indexOf(f),1),a.splice(a.indexOf(m),1),a.splice(a.indexOf(v),1),a.splice(a.indexOf(g),1);for(var s=o.length;0<s--;)A(o[s],a,points),void 0!==o[s].visiblePoints&&P.push(o[s]),R.push(o[s]);!function(e){for(;0<P.length;)l(P.shift(),e)}(points);for(var c=R.length;0<c--;)e.faces[c]=new THREE.Face3(R[c][2],R[c][1],R[c][0],R[c].normal);return e.normalsNeedUpdate=!0,e})},function(e,t,n){var C=n(5);C.shape2mesh=function(e){for(var t=new THREE.Object3D,n=0;n<e.shapes.length;n++){var i,r=e.shapes[n];switch(r.type){case C.Shape.types.SPHERE:var o=new THREE.SphereGeometry(r.radius,8,8);i=new THREE.Mesh(o,this.currentMaterial);break;case C.Shape.types.PARTICLE:i=new THREE.Mesh(this.particleGeo,this.particleMaterial);var a=this.settings;i.scale.set(a.particleSize,a.particleSize,a.particleSize);break;case C.Shape.types.PLANE:var s=new THREE.PlaneGeometry(10,10,4,4);i=new THREE.Object3D;var c=new THREE.Object3D,l=new THREE.Mesh(s,this.currentMaterial);l.scale.set(100,100,100),c.add(l),l.castShadow=!0,l.receiveShadow=!0,i.add(c);break;case C.Shape.types.BOX:var u=new THREE.BoxGeometry(2*r.halfExtents.x,2*r.halfExtents.y,2*r.halfExtents.z);i=new THREE.Mesh(u,this.currentMaterial);break;case C.Shape.types.CONVEXPOLYHEDRON:for(var h=new THREE.Geometry,d=0;d<r.vertices.length;d++){var p=r.vertices[d];h.vertices.push(new THREE.Vector3(p.x,p.y,p.z))}for(d=0;d<r.faces.length;d++)for(var f=r.faces[d],m=f[0],v=1;v<f.length-1;v++){var g=f[v],y=f[v+1];h.faces.push(new THREE.Face3(m,g,y))}h.computeBoundingSphere(),h.computeFaceNormals(),i=new THREE.Mesh(h,this.currentMaterial);break;case C.Shape.types.HEIGHTFIELD:s=new THREE.Geometry;for(var A=new C.Vec3,b=new C.Vec3,w=new C.Vec3,x=0;x<r.data.length-1;x++)for(var E=0;E<r.data[x].length-1;E++)for(var M=0;M<2;M++)r.getConvexTrianglePillar(x,E,0===M),A.copy(r.pillarConvex.vertices[0]),b.copy(r.pillarConvex.vertices[1]),w.copy(r.pillarConvex.vertices[2]),A.vadd(r.pillarOffset,A),b.vadd(r.pillarOffset,b),w.vadd(r.pillarOffset,w),s.vertices.push(new THREE.Vector3(A.x,A.y,A.z),new THREE.Vector3(b.x,b.y,b.z),new THREE.Vector3(w.x,w.y,w.z)),d=s.vertices.length-3,s.faces.push(new THREE.Face3(d,d+1,d+2));s.computeBoundingSphere(),s.computeFaceNormals(),i=new THREE.Mesh(s,this.currentMaterial);break;case C.Shape.types.TRIMESH:for(s=new THREE.Geometry,A=new C.Vec3,b=new C.Vec3,w=new C.Vec3,d=0;d<r.indices.length/3;d++)r.getTriangleVertices(d,A,b,w),s.vertices.push(new THREE.Vector3(A.x,A.y,A.z),new THREE.Vector3(b.x,b.y,b.z),new THREE.Vector3(w.x,w.y,w.z)),v=s.vertices.length-3,s.faces.push(new THREE.Face3(v,v+1,v+2));s.computeBoundingSphere(),s.computeFaceNormals(),i=new THREE.Mesh(s,this.currentMaterial);break;default:throw"Visual type not recognized: "+r.type}if(i.receiveShadow=!0,i.castShadow=!0,i.children)for(d=0;d<i.children.length;d++)if(i.children[d].castShadow=!0,i.children[d].receiveShadow=!0,i.children[d])for(v=0;v<i.children[d].length;v++)i.children[d].children[v].castShadow=!0,i.children[d].children[v].receiveShadow=!0;var T=e.shapeOffsets[n],S=e.shapeOrientations[n];i.position.set(T.x,T.y,T.z),i.quaternion.set(S.x,S.y,S.z,S.w),t.add(i)}return t},e.exports=C.shape2mesh},function(e,t,n){var i=n(55),r=AFRAME.utils.extend({},i.definition);e.exports=AFRAME.registerComponent("dynamic-body",r)},function(e,t,n){var i=n(55),r=AFRAME.utils.extend({},i.definition);r.schema=AFRAME.utils.extend({},i.definition.schema,{type:{default:"static",oneOf:["static","dynamic"]},mass:{default:0}}),e.exports=AFRAME.registerComponent("static-body",r)},function(e,t,n){var c=n(5),i={schema:{shape:{default:"box",oneOf:["box","sphere","cylinder"]},offset:{type:"vec3",default:{x:0,y:0,z:0}},orientation:{type:"vec4",default:{x:0,y:0,z:0,w:1}},radius:{type:"number",default:1,if:{shape:["sphere"]}},halfExtents:{type:"vec3",default:{x:.5,y:.5,z:.5},if:{shape:["box"]}},radiusTop:{type:"number",default:1,if:{shape:["cylinder"]}},radiusBottom:{type:"number",default:1,if:{shape:["cylinder"]}},height:{type:"number",default:1,if:{shape:["cylinder"]}},numSegments:{type:"int",default:8,if:{shape:["cylinder"]}}},multiple:!0,init:function(){this.el.sceneEl.hasLoaded?this.initShape():this.el.sceneEl.addEventListener("loaded",this.initShape.bind(this))},initShape:function(){this.bodyEl=this.el;for(var e=this._findType(this.bodyEl),t=this.data;!e&&this.bodyEl.parentNode!=this.el.sceneEl;)this.bodyEl=this.bodyEl.parentNode,e=this._findType(this.bodyEl);if(e){var n,i,r,o=new THREE.Vector3;switch(this.bodyEl.object3D.getWorldScale(o),t.hasOwnProperty("offset")&&(i=new c.Vec3(t.offset.x*o.x,t.offset.y*o.y,t.offset.z*o.z)),t.hasOwnProperty("orientation")&&(r=new c.Quaternion).copy(t.orientation),t.shape){case"sphere":n=new c.Sphere(t.radius*o.x);break;case"box":var a=new c.Vec3(t.halfExtents.x*o.x,t.halfExtents.y*o.y,t.halfExtents.z*o.z);n=new c.Box(a);break;case"cylinder":n=new c.Cylinder(t.radiusTop*o.x,t.radiusBottom*o.x,t.height*o.y,t.numSegments);var s=new c.Quaternion;s.setFromEuler(90*THREE.Math.DEG2RAD,0,0,"XYZ").normalize(),r.mult(s,r);break;default:return void console.warn(t.shape+" shape not supported")}this.bodyEl.body?this.bodyEl.components[e].addShape(n,i,r):this.bodyEl.addEventListener("body-loaded",function(){this.bodyEl.components[e].addShape(n,i,r)},{once:!0})}else console.warn("body not found")},_findType:function(e){return e.hasAttribute("body")?"body":e.hasAttribute("dynamic-body")?"dynamic-body":e.hasAttribute("static-body")?"static-body":null},remove:function(){this.bodyEl.parentNode&&console.warn("removing shape component not currently supported")}};e.exports.definition=i,e.exports.Component=AFRAME.registerComponent("shape",i)},function(e,t,n){var a=n(5);e.exports=AFRAME.registerComponent("constraint",{multiple:!0,schema:{type:{default:"lock",oneOf:["coneTwist","distance","hinge","lock","pointToPoint"]},target:{type:"selector"},maxForce:{default:1e6,min:0},collideConnected:{default:!0},wakeUpBodies:{default:!0},distance:{default:0,min:0},pivot:{type:"vec3"},targetPivot:{type:"vec3"},axis:{type:"vec3",default:{x:0,y:0,z:1}},targetAxis:{type:"vec3",default:{x:0,y:0,z:1}}},init:function(){this.system=this.el.sceneEl.systems.physics,this.constraint=null},remove:function(){this.constraint&&(this.system.removeConstraint(this.constraint),this.constraint=null)},update:function(){var e=this.el,t=this.data;this.remove(),e.body&&t.target.body?(this.constraint=this.createConstraint(),this.system.addConstraint(this.constraint)):(e.body?t.target:e).addEventListener("body-loaded",this.update.bind(this,{}))},createConstraint:function(){var e,t=this.data,n=new a.Vec3(t.pivot.x,t.pivot.y,t.pivot.z),i=new a.Vec3(t.targetPivot.x,t.targetPivot.y,t.targetPivot.z),r=new a.Vec3(t.axis.x,t.axis.y,t.axis.z),o=new a.Vec3(t.targetAxis.x,t.targetAxis.y,t.targetAxis.z);switch(t.type){case"lock":(e=new a.LockConstraint(this.el.body,t.target.body,{maxForce:t.maxForce})).type="LockConstraint";break;case"distance":(e=new a.DistanceConstraint(this.el.body,t.target.body,t.distance,t.maxForce)).type="DistanceConstraint";break;case"hinge":(e=new a.HingeConstraint(this.el.body,t.target.body,{pivotA:n,pivotB:i,axisA:r,axisB:o,maxForce:t.maxForce})).type="HingeConstraint";break;case"coneTwist":(e=new a.ConeTwistConstraint(this.el.body,t.target.body,{pivotA:n,pivotB:i,axisA:r,axisB:o,maxForce:t.maxForce})).type="ConeTwistConstraint";break;case"pointToPoint":(e=new a.PointToPointConstraint(this.el.body,n,t.target.body,i,t.maxForce)).type="PointToPointConstraint";break;default:throw new Error("[constraint] Unexpected type: "+t.type)}return e.collideConnected=t.collideConnected,e}})},function(e,t,n){var i=n(5);e.exports=AFRAME.registerComponent("spring",{multiple:!0,schema:{target:{type:"selector"},restLength:{default:1,min:0},stiffness:{default:100,min:0},damping:{default:1,min:0},localAnchorA:{type:"vec3",default:{x:0,y:0,z:0}},localAnchorB:{type:"vec3",default:{x:0,y:0,z:0}}},init:function(){this.system=this.el.sceneEl.systems.physics,this.system.addComponent(this),this.isActive=!0,this.spring=null},update:function(e){var t=this.el,n=this.data;n.target?t.body&&n.target.body?(this.createSpring(),this.updateSpring(e)):(t.body?n.target:t).addEventListener("body-loaded",this.update.bind(this,{})):console.warn("Spring: invalid target specified.")},updateSpring:function(t){if(this.spring){var n=this.data,i=this.spring;Object.keys(n).forEach(function(e){if(n[e]!==t[e]){if("target"===e)return void(i.bodyB=n.target.body);i[e]=n[e]}})}else console.warn("Spring: Component attempted to change spring before its created. No changes made.")},createSpring:function(){this.spring||(this.spring=new i.Spring(this.el.body))},step:function(e,t){return this.spring&&this.isActive?this.spring.applyForce():void 0},play:function(){this.isActive=!0},pause:function(){this.isActive=!1},remove:function(){this.spring&&delete this.spring,this.spring=null}})},function(e,t,n){var i=n(5),r=n(162),o=r.GRAVITY,a=r.CONTACT_MATERIAL,s=n(80),c=n(163),l=n(168);n(82),e.exports=AFRAME.registerSystem("physics",{schema:{driver:{default:"local",oneOf:["local","worker","network","ammo"]},networkUrl:{default:"",if:{driver:"network"}},workerFps:{default:60,if:{driver:"worker"}},workerInterpolate:{default:!0,if:{driver:"worker"}},workerInterpBufferSize:{default:2,if:{driver:"worker"}},workerEngine:{default:"cannon",if:{driver:"worker"},oneOf:["cannon"]},workerDebug:{default:!1,if:{driver:"worker"}},gravity:{default:o},iterations:{default:r.ITERATIONS},friction:{default:a.friction},restitution:{default:a.restitution},contactEquationStiffness:{default:a.contactEquationStiffness},contactEquationRelaxation:{default:a.contactEquationRelaxation},frictionEquationStiffness:{default:a.frictionEquationStiffness},frictionEquationRegularization:{default:a.frictionEquationRegularization},maxInterval:{default:4/60},debug:{default:!1}},init:function(){var e=this.data;switch(this.debug=e.debug,this.callbacks={beforeStep:[],step:[],afterStep:[]},this.listeners={},this.driver=null,e.driver){case"local":this.driver=new s;break;case"network":this.driver=new l(e.networkUrl);break;case"worker":this.driver=new c({fps:e.workerFps,engine:e.workerEngine,interpolate:e.workerInterpolate,interpolationBufferSize:e.workerInterpBufferSize,debug:e.workerDebug});break;default:throw new Error('[physics] Driver not recognized: "%s".',e.driver)}this.driver.init({quatNormalizeSkip:0,quatNormalizeFast:!1,solverIterations:e.iterations,gravity:e.gravity}),this.driver.addMaterial({name:"defaultMaterial"}),this.driver.addMaterial({name:"staticMaterial"}),this.driver.addContactMaterial("defaultMaterial","defaultMaterial",{friction:e.friction,restitution:e.restitution,contactEquationStiffness:e.contactEquationStiffness,contactEquationRelaxation:e.contactEquationRelaxation,frictionEquationStiffness:e.frictionEquationStiffness,frictionEquationRegularization:e.frictionEquationRegularization}),this.driver.addContactMaterial("staticMaterial","defaultMaterial",{friction:1,restitution:0,contactEquationStiffness:e.contactEquationStiffness,contactEquationRelaxation:e.contactEquationRelaxation,frictionEquationStiffness:e.frictionEquationStiffness,frictionEquationRegularization:e.frictionEquationRegularization})},tick:function(e,t){if(t){var n,i=this.callbacks;for(n=0;n<this.callbacks.beforeStep.length;n++)this.callbacks.beforeStep[n].beforeStep(e,t);for(this.driver.step(Math.min(t/1e3,this.data.maxInterval)),n=0;n<i.step.length;n++)i.step[n].step(e,t);for(n=0;n<i.afterStep.length;n++)i.afterStep[n].afterStep(e,t)}},addBody:function(t){var e=this.driver;t.__applyImpulse=t.applyImpulse,t.applyImpulse=function(){e.applyBodyMethod(t,"applyImpulse",arguments)},t.__applyForce=t.applyForce,t.applyForce=function(){e.applyBodyMethod(t,"applyForce",arguments)},t.updateProperties=function(){e.updateBodyProperties(t)},this.listeners[t.id]=function(e){t.el.emit("collide",e)},t.addEventListener("collide",this.listeners[t.id]),this.driver.addBody(t)},removeBody:function(e){this.driver.removeBody(e),e.removeEventListener("collide",this.listeners[e.id]),delete this.listeners[e.id],e.applyImpulse=e.__applyImpulse,delete e.__applyImpulse,e.applyForce=e.__applyForce,delete e.__applyForce,delete e.updateProperties},addConstraint:function(e){e.type||(e instanceof i.LockConstraint?e.type="LockConstraint":e instanceof i.DistanceConstraint?e.type="DistanceConstraint":e instanceof i.HingeConstraint?e.type="HingeConstraint":e instanceof i.ConeTwistConstraint?e.type="ConeTwistConstraint":e instanceof i.PointToPointConstraint&&(e.type="PointToPointConstraint")),this.driver.addConstraint(e)},removeConstraint:function(e){this.driver.removeConstraint(e)},addComponent:function(e){var t=this.callbacks;e.beforeStep&&t.beforeStep.push(e),e.step&&t.step.push(e),e.afterStep&&t.afterStep.push(e)},removeComponent:function(e){var t=this.callbacks;e.beforeStep&&t.beforeStep.splice(t.beforeStep.indexOf(e),1),e.step&&t.step.splice(t.step.indexOf(e),1),e.afterStep&&t.afterStep.splice(t.afterStep.indexOf(e),1)},getContacts:function(){return this.driver.getContacts()},getMaterial:function(e){return this.driver.getMaterial(e)}})},function(e,t){e.exports={GRAVITY:-9.8,MAX_INTERVAL:4/60,ITERATIONS:10,CONTACT_MATERIAL:{friction:.01,restitution:.3,contactEquationStiffness:1e8,contactEquationRelaxation:3,frictionEquationStiffness:1e8,frictionEquationRegularization:3}}},function(e,t,n){var i=n(164),r=n(165),o=n(40),s=n(81),a=n(166),c=n(83),l=c.ID;function u(e){this.fps=e.fps,this.engine=e.engine,this.interpolate=e.interpolate,this.interpBufferSize=e.interpolationBufferSize,this.debug=e.debug,this.bodies={},this.contacts=[],this.frameDelay=1e3*this.interpBufferSize/this.fps,this.frameBuffer=[],this.worker=this.debug?r(a):i(a),this.worker.addEventListener("message",this._onMessage.bind(this))}(u.prototype=new o).constructor=u,(e.exports=u).prototype.init=function(e){this.worker.postMessage({type:s.INIT,worldConfig:e,fps:this.fps,engine:this.engine})},u.prototype.step=function(){if(this.interpolate){for(var e=this.frameBuffer[0],t=this.frameBuffer[1],n=performance.now();e&&t&&n-e.timestamp>this.frameDelay;)this.frameBuffer.shift(),e=this.frameBuffer[0],t=this.frameBuffer[1];if(e&&t){var i=(n-e.timestamp)/this.frameDelay;for(var r in i=(i-(1-1/this.interpBufferSize))*this.interpBufferSize,e.bodies)e.bodies.hasOwnProperty(r)&&t.bodies.hasOwnProperty(r)&&c.deserializeInterpBodyUpdate(e.bodies[r],t.bodies[r],this.bodies[r],i)}}},u.prototype.destroy=function(){this.worker.terminate(),delete this.worker},u.prototype._onMessage=function(e){if(e.data.type===s.STEP){var t=e.data.bodies;if(this.contacts=e.data.contacts,this.interpolate)this.frameBuffer.push({timestamp:performance.now(),bodies:t});else for(var n in t)t.hasOwnProperty(n)&&c.deserializeBodyUpdate(t[n],this.bodies[n])}else{if(e.data.type!==s.COLLIDE)throw new Error("[WorkerDriver] Unexpected message type.");var i=this.bodies[e.data.bodyID],r=this.bodies[e.data.targetID],o=c.deserializeContact(e.data.contact,this.bodies);if(!i._listeners||!i._listeners.collide)return;for(var a=0;a<i._listeners.collide.length;a++)i._listeners.collide[a]({target:r,body:i,contact:o})}},u.prototype.addBody=function(e){c.assignID("body",e),this.bodies[e[l]]=e,this.worker.postMessage({type:s.ADD_BODY,body:c.serializeBody(e)})},u.prototype.removeBody=function(e){this.worker.postMessage({type:s.REMOVE_BODY,bodyID:e[l]}),delete this.bodies[e[l]]},u.prototype.applyBodyMethod=function(e,t,n){switch(t){case"applyForce":case"applyImpulse":this.worker.postMessage({type:s.APPLY_BODY_METHOD,bodyID:e[l],methodName:t,args:[n[0].toArray(),n[1].toArray()]});break;default:throw new Error("Unexpected methodName: %s",t)}},u.prototype.updateBodyProperties=function(e){this.worker.postMessage({type:s.UPDATE_BODY_PROPERTIES,body:c.serializeBody(e)})},u.prototype.getMaterial=function(e){},u.prototype.addMaterial=function(e){this.worker.postMessage({type:s.ADD_MATERIAL,materialConfig:e})},u.prototype.addContactMaterial=function(e,t,n){this.worker.postMessage({type:s.ADD_CONTACT_MATERIAL,materialName1:e,materialName2:t,contactMaterialConfig:n})},u.prototype.addConstraint=function(e){c.assignID("constraint",e),this.worker.postMessage({type:s.ADD_CONSTRAINT,constraint:c.serializeConstraint(e)})},u.prototype.removeConstraint=function(e){this.worker.postMessage({type:s.REMOVE_CONSTRAINT,constraintID:e[l]})},u.prototype.getContacts=function(){var t=this.bodies;return this.contacts.map(function(e){return c.deserializeContact(e,t)})}},function(e,t){var g=arguments[3],y=arguments[4],A=arguments[5],b=JSON.stringify;e.exports=function(e,t){for(var n,i=Object.keys(A),r=0,o=i.length;r<o;r++){var a=i[r],s=A[a].exports;if(s===e||s&&s.default===e){n=a;break}}if(!n){n=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var c={};for(r=0,o=i.length;r<o;r++)c[a=i[r]]=a;y[n]=["function(require,module,exports){"+e+"(self); }",c]}var l=Math.floor(Math.pow(16,8)*Math.random()).toString(16),u={};u[n]=n,y[l]=["function(require,module,exports){var f = require("+b(n)+");(f.default ? f.default : f)(self);}",u];var h={};!function e(t){for(var n in h[t]=!0,y[t][1]){var i=y[t][1][n];h[i]||e(i)}}(l);var d="("+g+")({"+Object.keys(h).map(function(e){return b(e)+":["+y[e][0]+","+b(y[e][1])+"]"}).join(",")+"},{},["+b(l)+"])",p=window.URL||window.webkitURL||window.mozURL||window.msURL,f=new Blob([d],{type:"text/javascript"});if(t&&t.bare)return f;var m=p.createObjectURL(f),v=new Worker(m);return v.objectURL=m,v}},function(e,t){function i(){this.listeners=[]}e.exports=function(e){var t=new i,n=new i;return t.setTarget(n),n.setTarget(t),e(t),n},i.prototype.setTarget=function(e){this.target=e},i.prototype.addEventListener=function(e,t){this.listeners.push(t)},i.prototype.dispatchEvent=function(e,t){for(var n=0;n<this.listeners.length;n++)this.listeners[n](t)},i.prototype.postMessage=function(e){this.target.dispatchEvent("message",{data:e})}},function(e,t,n){var u=n(81),h=n(80),d=n(82),p=n(83),f=p.ID;e.exports=function(r){var o,a=null,s={},c={};function l(){a.step(o);var t={};Object.keys(s).forEach(function(e){t[e]=p.serializeBody(s[e])}),r.postMessage({type:u.STEP,bodies:t,contacts:a.getContacts().map(p.serializeContact)})}r.addEventListener("message",function(e){var t=e.data;switch(t.type){case u.INIT:(a="cannon"===t.engine?new h:new d).init(t.worldConfig),o=1/t.fps,setInterval(l,1e3/t.fps);break;case u.ADD_BODY:var n=p.deserializeBody(t.body);n.material=a.getMaterial("defaultMaterial"),(s[n[f]]=n).addEventListener("collide",function(e){var t={type:u.COLLIDE,bodyID:e.target[f],targetID:e.body[f],contact:p.serializeContact(e.contact)};r.postMessage(t)}),a.addBody(n);break;case u.REMOVE_BODY:a.removeBody(s[t.bodyID]),delete s[t.bodyID];break;case u.APPLY_BODY_METHOD:s[t.bodyID][t.methodName](p.deserializeVec3(t.args[0]),p.deserializeVec3(t.args[1]));break;case u.UPDATE_BODY_PROPERTIES:p.deserializeBodyUpdate(t.body,s[t.body.id]);break;case u.ADD_MATERIAL:a.addMaterial(t.materialConfig);break;case u.ADD_CONTACT_MATERIAL:a.addContactMaterial(t.materialName1,t.materialName2,t.contactMaterialConfig);break;case u.ADD_CONSTRAINT:var i=p.deserializeConstraint(t.constraint,s);c[i[f]]=i,a.addConstraint(i);break;case u.REMOVE_CONSTRAINT:a.removeConstraint(c[t.constraintID]),delete c[t.constraintID];break;default:throw new Error("[Worker] Unexpected event type: %s",t.type)}})}},function(e,t){e.exports.slerp=function(e,t,n){if(n<=0)return e;if(1<=n)return t;var i=e[0],r=e[1],o=e[2],a=e[3],s=a*t[3]+i*t[0]+r*t[1]+o*t[2];if(!(s<0))return t;if((e=e.slice())[3]=-t[3],e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],1<=(s=-s))return e[3]=a,e[0]=i,e[1]=r,e[2]=o,this;var c=Math.sqrt(1-s*s);if(Math.abs(c)<.001)return e[3]=.5*(a+e[3]),e[0]=.5*(i+e[0]),e[1]=.5*(r+e[1]),e[2]=.5*(o+e[2]),this;var l=Math.atan2(c,s),u=Math.sin((1-n)*l)/c,h=Math.sin(n*l)/c;return e[3]=a*u+e[3]*h,e[0]=i*u+e[0]*h,e[1]=r*u+e[1]*h,e[2]=o*u+e[2]*h,e}},function(e,t,n){var i=n(40);function r(){throw new Error("[NetworkDriver] Driver not implemented.")}(r.prototype=new i).constructor=r,e.exports=r},function(e,t){AFRAME.registerComponent("change-scene",{init:function(){var t=this;this.el.addEventListener("click",function(e){"#scene-two"===e.target.attributes["change-scene"].value&&(t.el.emit("scene-one-transition"),document.getElementById("game").emit("sceneTwo")),"#scene-three"===e.target.attributes["change-scene"].value&&document.getElementById("game").emit("sceneThree"),"#scene-four"===e.target.attributes["change-scene"].value&&document.getElementById("game").emit("sceneFour"),"#scene-five"===e.target.attributes["change-scene"].value&&(document.getElementById("start-ignition-sound-container").components.sound.playSound(),setTimeout(function(){document.getElementById("driving-sound-container").components.sound.playSound()},3e3),document.getElementById("game").emit("sceneFive")),t.el.emit("scene-change",{nextScene:e.target.attributes["change-scene"].value})})}})},function(e,t){AFRAME.registerComponent("stop",{init:function(){var t=this;this.game=document.getElementById("game").sceneEl.systems["scene-manager"].state,this.hasBraked=!1,this.el.addEventListener("brake",function(e){t.hasBraked||("unsealed"===t.game.selectedScenario?document.getElementById("gravel-braking-sound-container").components.sound.playSound():document.getElementById("brake-sound-container").components.sound.playSound(),t.el.emit("stop"),t.hasBraked=!0)})}})},function(e,t,n){"use strict";n(172);function i(e){n(18)(RegExp.prototype,"toString",e,!0)}var r=n(6),o=n(85),a=n(12),s=/./.toString;n(31)(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?i(function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!a&&e instanceof RegExp?o.call(e):void 0)}):"toString"!=s.name&&i(function(){return s.call(this)})},function(e,t,n){n(12)&&"g"!=/./g.flags&&n(17).f(RegExp.prototype,"flags",{configurable:!0,get:n(85)})},function(e,t,n){var i=Date.prototype,r=i.toString,o=i.getTime;new Date(NaN)+""!="Invalid Date"&&n(18)(i,"toString",function(){var e=o.call(this);return e==e?r.call(this):"Invalid Date"})},function(e,t){AFRAME.registerComponent("loading-manager",{init:function(){this.el.addEventListener("loaded",function(e){setTimeout(function(){var e=document.getElementById("loading-ui");document.getElementById("rotate-mobile").style.opacity=1,e.style.opacity=0,e.style["pointer-events"]="none"},1e3)})}})},function(e,t){AFRAME.registerComponent("hover-visible",{schema:{type:"string"},init:function(){var t=this;this.el.addEventListener("mouseenter",function(e){AFRAME.utils.device.isMobile()||t.onMouseEnter()}),this.el.addEventListener("mouseleave",function(e){AFRAME.utils.device.isMobile()||t.onMouseLeave()})},onMouseEnter:function(){document.getElementById(this.data).object3D.visible=!0},onMouseLeave:function(){document.getElementById(this.data).object3D.visible=!1}})},function(e,t){AFRAME.registerComponent("background-vehicle-select",{schema:{type:"string"},init:function(){var t=this;this.el.addEventListener("click",function(e){document.getElementById(t.data).emit("click")})}})},function(e,t,a){AFRAME.registerComponent("particle-rain",{schema:{count:{type:"number",default:1e4}},init:function(){var e=new AFRAME.THREE.TextureLoader;this.particleCount=this.data.count,this.particles=new AFRAME.THREE.Geometry,this.pMaterial=new AFRAME.THREE.PointsMaterial({color:"#add8e6",size:20,map:e.load(a(86)),blending:AFRAME.THREE.AdditiveBlending,transparent:!0,sizeAttenuation:!1}),this.pMaterial.side=AFRAME.THREE.DoubleSide;for(var t=0;t<this.particleCount;t++){var n=100*Math.random()-50,i=100*Math.random()-50,r=100*Math.random()-50,o=new AFRAME.THREE.Vector3(n,i,r);this.particles.vertices.push(o)}this.particleSystem=new AFRAME.THREE.Points(this.particles,this.pMaterial),this.particleSystem.sortParticles=!0,this.el.object3D.add(this.particleSystem)},tick:function(e,t){this.particleSystem.rotation.y+=.001*t}})},function(e,t,a){AFRAME.registerComponent("dais-rain",{schema:{count:{type:"number",default:500}},init:function(){var e=new AFRAME.THREE.TextureLoader;this.particleCount=this.data.count,this.particles=new AFRAME.THREE.Geometry,this.pMaterial=new AFRAME.THREE.PointsMaterial({color:"#add8e6",size:10,map:e.load(a(86)),blending:AFRAME.THREE.AdditiveBlending,transparent:!0,sizeAttenuation:!1}),this.pMaterial.side=AFRAME.THREE.DoubleSide;for(var t=0;t<this.particleCount;t++){var n=10*Math.random()-5,i=10*Math.random(),r=10*Math.random()-5,o=new AFRAME.THREE.Vector3(n,i,r);this.particles.vertices.push(o)}this.particleSystem=new AFRAME.THREE.Points(this.particles,this.pMaterial),this.particleSystem.sortParticles=!0,this.el.object3D.add(this.particleSystem)},tick:function(e,t){for(var n=this.particleCount;n--;){var i=this.particles.vertices[n];i.y<0&&i.setY(10*Math.random()),(5<i.x||i.x<-5)&&i.setX(10*Math.random()-5),(5<i.z||i.z<-5)&&i.setZ(10*Math.random()-5),i.setX(i.x-.05*Math.random()),i.setZ(i.z-.05*Math.random()),i.setY(i.y-.1)}this.particleSystem.geometry.verticesNeedUpdate=!0}})},function(e,t,n){var i=n(15);i(i.P,"String",{repeat:n(180)})},function(e,t,n){"use strict";var r=n(33),o=n(26);e.exports=function(e){var t=String(o(this)),n="",i=r(e);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;0<i;(i>>>=1)&&(t+=t))1&i&&(n+=t);return n}},function(e,t,n){var i=n(182);"string"==typeof i&&(i=[[e.i,i,""]]);n(188)(i,{hmr:!0,transform:void 0,insertInto:void 0}),i.locals&&(e.exports=i.locals)},function(e,t,n){t=e.exports=n(183)(!1);var i=n(184),r=i(n(185)),o=i(n(186)),a=i(n(187));t.push([e.i,"#start-ui {\n  position: absolute;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  justify-content: space-between;\n  pointer-events: auto;\n  overflow: hidden; }\n\n#start-ui-container-left {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  height: 100%; }\n\n#start-ui-container-right {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  justify-content: space-between;\n  height: 100%; }\n\n#start-ui-did-you-know-container {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  margin-left: 1vw;\n  margin-bottom: 1vw;\n  opacity: 0;\n  transition: opacity ease-in 0.25s; }\n\n#start-ui-did-you-know-box {\n  transform-origin: 0% 100%;\n  transform: scale(1);\n  transition: transform ease-out 0.25s; }\n\n#start-ui-did-you-know-text {\n  max-width: 25vw;\n  min-height: 15vw;\n  max-height: 40vh;\n  padding-top: 1vw;\n  padding-left: 2vw;\n  padding-bottom: 2vw;\n  padding-right: 4vw;\n  transform: rotateZ(-0.75deg); }\n\n#start-ui-did-you-know-heading {\n  font-family: Avenir, sans-serif;\n  font-size: 30px;\n  color: #96d1f2;\n  font-weight: 600; }\n\n#start-ui-did-you-know-body {\n  font-family: Avenir, sans-serif;\n  font-size: 20px;\n  color: #96d1f2;\n  font-weight: 600; }\n\n#start-ui-did-you-know-click {\n  font-family: Avenir, sans-serif;\n  font-size: 25px;\n  color: #96d1f2;\n  font-weight: bold;\n  text-align: right; }\n\n@media screen and (max-width: 2000px) {\n  #start-ui-did-you-know-heading {\n    font-size: 1.75vw; }\n  #start-ui-did-you-know-body {\n    font-size: 1vw; }\n  #start-ui-did-you-know-click {\n    font-size: 1.25vw; } }\n\n@media screen and (max-width: 1600px) {\n  #start-ui-did-you-know-heading {\n    font-size: 2vw; }\n  #start-ui-did-you-know-body {\n    font-size: 1.2vw; }\n  #start-ui-did-you-know-click {\n    font-size: 1.5vw; }\n  #start-ui-did-you-know-text {\n    max-width: 60vw;\n    padding-top: 1vw;\n    padding-left: 2.5vw;\n    padding-bottom: 2vw;\n    padding-right: 7.5vw; } }\n\n#stop-it-title {\n  margin-left: -10%;\n  padding-top: 4%;\n  transform: translate(0, 0);\n  height: auto;\n  width: 35vw; }\n\n#test-yourself {\n  margin-left: -5%;\n  transform: translate(0, 0);\n  height: auto;\n  width: 35vw; }\n\n#volume-on {\n  margin-right: 2.5%;\n  transform: translate(0, 0);\n  padding-top: 3.5%;\n  padding-right: 25px;\n  height: auto;\n  width: 5.5vw; }\n\n#start-button {\n  margin-right: 2.5vw;\n  transform: translate(0, 0) scale(1);\n  margin-bottom: 2.5vw;\n  pointer-events: auto;\n  height: auto;\n  width: 20vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 2.5) 0.1s;\n  cursor: pointer; }\n\n#vehicle-title {\n  margin-left: -3.5%;\n  transform: translate(0, 0);\n  padding-top: 4%;\n  height: auto;\n  width: 40vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#vehicle-ui-container-left {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  height: 100%;\n  width: 33vw; }\n\n#vehicle-ui-container-right {\n  width: 33vw;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  justify-content: flex-end;\n  position: relative;\n  height: 100%; }\n\n.vehicle-select-button {\n  position: absolute;\n  bottom: 2vw;\n  right: 2vw;\n  opacity: 0;\n  pointer-events: none;\n  cursor: pointer;\n  transform: scale(1);\n  width: auto;\n  height: 6vw;\n  transition: transform linear 0.1s, opacity linear 0s !important; }\n  .vehicle-select-button:hover {\n    transform: scale(1.1); }\n\n#vehicle-ui-container-middle {\n  width: 33vw;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: flex-end;\n  height: 100%; }\n\n#vehicle-ui-icons {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  margin-left: 7.5vw;\n  width: 100%;\n  height: 100%;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n.vehicle-ui-icon {\n  pointer-events: auto;\n  height: auto;\n  width: 25vw;\n  cursor: pointer;\n  transform: scale(1);\n  transform-origin: 50% 50%;\n  opacity: 0.75;\n  transition: transform linear 0.1s, opacity linear 0.1s; }\n  .vehicle-ui-icon:hover {\n    transform: scale(1.1);\n    transition: transform linear 0.1s, opacity linear 0.1s !important; }\n\n#truck-select {\n  margin-left: 10vw;\n  margin-bottom: 2vw;\n  transform-origin: 50% 100%; }\n\n#sedan-select {\n  margin-left: 5vw;\n  margin-bottom: 1vw; }\n\n#cycle-select {\n  transform-origin: 50% 0%;\n  margin-top: 1vw; }\n\n#vehicle-description {\n  margin-right: -7.5%;\n  transform: translate(0, 0);\n  padding-top: 4.5%;\n  padding-right: 25px;\n  height: auto;\n  width: 40vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#vehicle-ui {\n  position: absolute;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  justify-content: space-between;\n  overflow: hidden; }\n\n#vehicle-next {\n  margin-right: 2.5vw;\n  margin-bottom: 2.5vw;\n  transform: translate(0, 0);\n  margin-left: 0%;\n  pointer-events: auto;\n  height: auto;\n  width: 7.5vw;\n  cursor: pointer;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#speedo-ui-container {\n  display: none;\n  position: absolute;\n  width: 100vw;\n  height: 100vh;\n  z-index: 100;\n  pointer-events: none;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  transform: translate(0, 0);\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#speedo-launch {\n  height: auto;\n  pointer-events: auto;\n  width: 20vw;\n  margin-left: 16.5vw;\n  margin-top: 3vw;\n  transform: rotateZ(-4deg) scale(1.2);\n  cursor: pointer;\n  transition: transform ease-out 0.25s !important; }\n  #speedo-launch:hover {\n    transform: scale(1.3) rotateZ(-4deg); }\n\n#speedo-back-button {\n  height: auto;\n  width: 6vw;\n  padding: 2vw;\n  cursor: pointer;\n  pointer-events: auto;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  position: absolute;\n  bottom: 0;\n  left: 0; }\n\n#heavy-duty-note {\n  height: auto;\n  width: 25vw;\n  margin-left: 12.5vw; }\n\n#heavy-duty-note-container {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-end;\n  margin-left: 1.5vw;\n  margin-bottom: 4vw;\n  width: 100%;\n  transform: rotateZ(-4deg) scale(1);\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#speedo-title {\n  margin-left: -4%;\n  padding-top: 2%;\n  transform: translate(0, 0);\n  height: auto;\n  width: 35vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#speedo-internal-container {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  width: 35vw;\n  margin-top: 10%;\n  margin-left: 8%; }\n\n#speedo-increase {\n  height: auto;\n  width: 10vw;\n  pointer-events: auto;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 2.5) 0.1s;\n  cursor: pointer;\n  transform: translate(0, 0) scale(1); }\n\n#speedo-decrease {\n  margin-top: 13%;\n  height: auto;\n  width: 10vw;\n  pointer-events: auto;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 2.5) 0.1s;\n  cursor: pointer;\n  transform: translate(0, 0) scale(1); }\n\n#speedo-number-container {\n  flex: 1;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 10vw; }\n\n#speedo-numbers {\n  position: relative;\n  width: 10vw; }\n\n.speedo-number {\n  visibility: hidden;\n  position: absolute;\n  height: auto;\n  width: 100%; }\n\n.speedo-kph {\n  height: auto;\n  top: 10vh;\n  width: 7.5vw;\n  margin-top: 7vw; }\n\n.speedo-number-three-digits {\n  width: 12vw;\n  right: -0.5vw; }\n\n.active-speedo-number {\n  visibility: visible; }\n\n#scenario-ui-container {\n  position: absolute;\n  width: 100vw;\n  height: 100vh;\n  z-index: 100;\n  pointer-events: none;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-around;\n  transform: translate(0, 0);\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#scenario-back-button {\n  height: auto;\n  width: 6vw;\n  padding: 2vw;\n  cursor: pointer;\n  pointer-events: auto;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#scenario-ui-container-left {\n  width: 25%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-items: flex-start; }\n\n#scenario-ui-container-middle {\n  width: 50%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  position: relative;\n  align-items: center; }\n\n.scenario-select-button {\n  position: absolute;\n  bottom: 2vw;\n  right: 2vw;\n  opacity: 0;\n  pointer-events: none;\n  cursor: pointer;\n  transform: scale(1);\n  width: auto;\n  height: 10vw;\n  transition: transform linear 0.1s, opacity ease-out 0.2s !important; }\n  .scenario-select-button:hover {\n    transform: scale(1.1); }\n\n.active-scenario-select-button {\n  opacity: 1;\n  pointer-events: auto; }\n\n#scenario-ui-container-right {\n  width: 25%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  transform: translate(0, 0);\n  justify-content: flex-end;\n  align-items: flex-end;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#scenario-ui-select {\n  pointer-events: auto;\n  margin-right: 2.5vw;\n  margin-bottom: 2.5vw;\n  transform: scale(1);\n  height: auto;\n  width: 7.5vw;\n  transition: transform ease-out 0.25s !important;\n  cursor: pointer; }\n  #scenario-ui-select:hover {\n    transform: scale(1.1); }\n\n#scenario-title {\n  margin-left: -40%;\n  padding-top: 7.5%;\n  transform: translate(0, 0);\n  height: auto;\n  width: 35vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#scenario-ui-rotate-control-container {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-around;\n  width: 100%;\n  margin-bottom: 3vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n.scenario-ui-rotate-control {\n  height: auto;\n  width: 10vw;\n  transform: scale(1); }\n\n#scenario-ui-left {\n  pointer-events: auto;\n  transition: transform ease-out 0.25s;\n  transform: scale(1) rotateZ(40deg);\n  cursor: pointer; }\n\n#scenario-ui-right {\n  pointer-events: auto;\n  transition: transform ease-out 0.25s;\n  transform: scale(1) rotateZ(-40deg);\n  cursor: pointer; }\n\n#selected-scenario-container {\n  flex: 1;\n  position: relative;\n  margin: 0 auto; }\n\n.selected-scenario {\n  visibility: hidden;\n  position: absolute;\n  left: 13%;\n  height: 3.5vw;\n  transform-origin: 50% 50%;\n  width: auto;\n  transition: opacity ease-out 0.1s;\n  opacity: 0;\n  margin-bottom: -7.5%; }\n\n.active-scenario {\n  visibility: visible;\n  transition: opacity ease-out 0.5s;\n  opacity: 1; }\n\n#outcome-ui-container {\n  position: absolute;\n  width: 100vw;\n  height: 100vh;\n  z-index: 100;\n  pointer-events: none;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-around;\n  transform: translate(0, 0);\n  transition: transform cubic-bezier(0.4, -0.1, 0.735, 0.045) 1.5s;\n  will-change: transform; }\n\n#serious-injury-note {\n  height: auto;\n  width: 30vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  will-change: transform; }\n\n#outcome-container-left {\n  height: 100%;\n  width: 25%;\n  margin-top: 5%;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-items: flex-start; }\n\n#outcome-stats {\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 3vw;\n  padding-left: 3vw; }\n\n.outcome-braking-stat-icon {\n  height: auto;\n  width: 5vw;\n  padding-right: 1vw; }\n\n.outcome-braking-stat-title {\n  font-size: 32px !important;\n  font-weight: bold !important;\n  font-style: oblique !important;\n  padding-right: 1vw; }\n\n.outcome-braking-stat-number {\n  font-size: 32px !important;\n  font-weight: bold !important;\n  font-style: oblique !important;\n  padding-right: 1vw; }\n\n.outcome-braking-stat {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  width: 7.5vw;\n  padding-bottom: 3vh;\n  justify-content: space-between; }\n\n#outcome-container-middle {\n  height: 100%;\n  width: 50%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: space-between; }\n\n#outcome-container-right {\n  height: 100%;\n  width: 25%;\n  left: 0.5vw;\n  margin-bottom: 7.5vh;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  transition: transform cubic-bezier(0.4, -0.1, 0.735, 0.045) 1.5s !important; }\n\n#outcome-visualisation {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: flex-end;\n  transition: transform cubic-bezier(0.4, -0.1, 0.735, 0.045) 1.5s !important; }\n\n.outcome-obstacle {\n  position: absolute;\n  top: 7.5vh;\n  height: auto;\n  width: 4vw;\n  z-index: 150;\n  transform-origin: 50% 50%;\n  transition: transform ease-out 0.5s; }\n\n#roo-obstacle {\n  transform: scale(0); }\n\n#pedestrian-obstacle {\n  transform: scale(0); }\n\n#cow-obstacle {\n  transform: scale(0); }\n\n#outcome-braking-sedan {\n  height: 12.5vh;\n  width: auto;\n  position: absolute;\n  bottom: 6vh;\n  z-index: 105;\n  transform-origin: 50% 50%;\n  transition: bottom linear 6.5s, transform ease-out 0.5s;\n  transform: scale(0); }\n\n#outcome-braking-truck {\n  height: 12.5vh;\n  width: auto;\n  position: absolute;\n  bottom: 6vh;\n  z-index: 105;\n  transform-origin: 50% 50%;\n  transition: bottom linear 6.5s, transform ease-out 0.5s;\n  transform: scale(0); }\n\n#outcome-braking-motorcycle {\n  height: 12.5vh;\n  width: auto;\n  position: absolute;\n  bottom: 6vh;\n  z-index: 105;\n  transform-origin: 50% 50%;\n  transition: bottom linear 6.5s, transform ease-out 0.5s;\n  transform: scale(0); }\n\n#braking-distance-mask {\n  z-index: 100;\n  height: 0vh;\n  width: 2vw;\n  background-size: 100%;\n  margin-bottom: 1vh;\n  background-position: bottom;\n  background-image: url("+r+");\n  transition: height linear; }\n\n#reaction-distance-mask {\n  z-index: 100;\n  height: 0vh;\n  width: 2vw;\n  background-size: 100%;\n  margin-top: 1vh;\n  margin-bottom: 1vh;\n  background-position: bottom;\n  background-image: url("+o+");\n  transition: height linear; }\n\n#outcome-brakes-applied {\n  height: 7.5vh;\n  width: auto;\n  transform-origin: 50% 50%;\n  transform: scale(0);\n  transition: transform ease-out 0.5s; }\n\n#obstacle-appeared-symbol {\n  height: 6vh;\n  width: auto;\n  transform: scale(0);\n  transform-origin: 50% 50%;\n  transition: transform ease-out 0.5s; }\n\n#reset-buttons-container {\n  width: 100%;\n  display: flex;\n  margin-bottom: 5vh;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-around;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  transform: translate(0, 0); }\n\n#outcome-game-over {\n  height: auto;\n  width: 35vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  transform: translate(0, 0); }\n\n#outcome-adjust-speed {\n  pointer-events: auto;\n  height: auto;\n  width: 20vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  transform: scale(1);\n  cursor: pointer; }\n  #outcome-adjust-speed:hover {\n    transform: scale(1.1);\n    transition: transform 0.25s !important; }\n\n#outcome-restart {\n  pointer-events: auto;\n  height: auto;\n  width: 20vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  transform: scale(1);\n  cursor: pointer; }\n  #outcome-restart:hover {\n    transform: scale(1.1);\n    transition: transform 0.25s !important; }\n\n#outcome-breakdown {\n  margin-left: 10%;\n  height: auto;\n  min-height: 35vh;\n  width: 25vw;\n  background-image: url("+a+");\n  background-size: 100% 100%;\n  transform: translate(0, 0);\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#outcome-braking-board {\n  width: auto;\n  height: 20vw;\n  margin-left: 2.5vw;\n  margin-bottom: 5vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#outcome-breakdown-heading {\n  font-family: Avenir, sans-serif;\n  font-size: 40px;\n  color: rgba(0, 0, 0, 0.6);\n  font-weight: 800;\n  transform: rotateZ(1deg);\n  padding-left: 10%;\n  padding-top: 1%;\n  padding-right: 15%; }\n\n#outcome-breakdown-body {\n  font-family: Avenir, sans-serif;\n  font-size: 25px;\n  color: rgba(0, 0, 0, 0.6);\n  font-weight: 600;\n  transform: rotateZ(1deg);\n  padding-left: 10%;\n  padding-bottom: 10%;\n  padding-right: 20%; }\n\n.outcome-visualisation-titles {\n  font-family: Avenir, sans-serif;\n  font-style: italic;\n  font-size: 20px;\n  color: rgba(0, 0, 0, 0.6);\n  font-weight: 800; }\n\n.outcome-visualisation-numbers {\n  font-family: Avenir, sans-serif;\n  font-style: italic;\n  font-size: 20px;\n  color: rgba(0, 0, 0, 0.6);\n  font-weight: 800; }\n\n#outcome-text-left {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  justify-content: space-between; }\n\n#outcome-reaction-distance,\n#outcome-reaction {\n  position: relative;\n  bottom: 10vh;\n  opacity: 0;\n  transition: opacity ease-in 0.5s; }\n\n#outcome-total-distance,\n#outcome-total {\n  position: relative;\n  top: 5vh;\n  opacity: 0;\n  transition: opacity ease-in 0.5s;\n  transition-delay: 2s; }\n\n#outcome-braking,\n#outcome-braking-distance {\n  position: relative;\n  bottom: 0vh;\n  opacity: 0;\n  transition: opacity ease-in 0.5s;\n  transition-delay: 1s; }\n\n@media screen and (max-width: 2000px) {\n  #outcome-breakdown-heading {\n    font-size: 1.75vw; }\n  #outcome-breakdown-body {\n    font-size: 1vw; } }\n\n@media screen and (max-width: 1600px) {\n  #outcome-breakdown-heading {\n    font-size: 2vw; }\n  #outcome-breakdown-body {\n    font-size: 1.2vw; }\n  .outcome-visualisation-titles {\n    font-size: 1.5vw; }\n  .outcome-visualisation-numbers {\n    font-size: 1.5vw; } }\n\n#outcome-try-again {\n  pointer-events: auto;\n  height: auto;\n  width: 12.5vw;\n  margin-left: 1vw;\n  margin-right: 1vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  transform: scale(1);\n  cursor: pointer; }\n  #outcome-try-again:hover {\n    transform: scale(1.1);\n    transition: transform 0.25s !important; }\n\n@keyframes loading-rotation {\n  from {\n    transform: rotateZ(0deg); }\n  to {\n    transform: rotateZ(360deg); } }\n\n@keyframes loading-letters {\n  0% {\n    transform: translate(0, 0); }\n  60% {\n    transform: translate(0, -2.5vh); }\n  90% {\n    transform: translate(0, 0); } }\n\n#loading-ui {\n  position: absolute;\n  width: 100vw;\n  height: 100vh;\n  overflow: hidden;\n  background-color: black;\n  opacity: 1;\n  will-change: opacity;\n  transition: opacity ease-out 1s;\n  pointer-events: auto;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center; }\n\n#loading-letters-container {\n  padding-left: 2.5vw;\n  padding-top: 1.5vw; }\n\n#loading-tyre {\n  transform: rotateZ(0deg);\n  transform-origin: 50% 50%;\n  width: 12.5vw;\n  height: auto;\n  animation-duration: 2.5s;\n  animation-iteration-count: infinite;\n  animation-name: loading-rotation; }\n\n#l {\n  margin-left: 2px;\n  height: 5vw;\n  width: auto;\n  animation-duration: 3s;\n  animation-iteration-count: infinite;\n  animation-name: loading-letters;\n  animation-delay: 0.25s;\n  animation-timing-function: ease-in-out; }\n\n#o {\n  margin-left: 4px;\n  height: 5vw;\n  width: auto;\n  animation-duration: 3s;\n  animation-iteration-count: infinite;\n  animation-name: loading-letters;\n  animation-delay: 0.5s;\n  animation-timing-function: ease-in-out; }\n\n#a {\n  margin-left: 2px;\n  height: 5vw;\n  width: auto;\n  animation-duration: 3s;\n  animation-iteration-count: infinite;\n  animation-name: loading-letters;\n  animation-delay: 0.75s;\n  animation-timing-function: ease-in-out; }\n\n#d {\n  margin-left: 6px;\n  height: 5vw;\n  width: auto;\n  animation-duration: 3s;\n  animation-iteration-count: infinite;\n  animation-name: loading-letters;\n  animation-delay: 1s;\n  animation-timing-function: ease-in-out; }\n\n#i {\n  margin-left: 6px;\n  height: 5vw;\n  width: auto;\n  animation-duration: 3s;\n  animation-iteration-count: infinite;\n  animation-name: loading-letters;\n  animation-delay: 1.25s;\n  animation-timing-function: ease-in-out; }\n\n#n {\n  margin-left: 10px;\n  height: 5vw;\n  width: auto;\n  animation-duration: 3s;\n  animation-iteration-count: infinite;\n  animation-name: loading-letters;\n  animation-delay: 1.5s;\n  animation-timing-function: ease-in-out; }\n\n#g {\n  margin-left: 6px;\n  height: 5vw;\n  width: auto;\n  animation-duration: 3s;\n  animation-iteration-count: infinite;\n  animation-name: loading-letters;\n  animation-delay: 2s;\n  animation-timing-function: ease-in-out; }\n\n#dot1,\n#dot2,\n#dot3 {\n  margin-left: 7.5px;\n  height: 1vw;\n  width: auto;\n  animation-duration: 3s;\n  animation-timing-function: ease-in-out; }\n\n#dot1 {\n  animation-iteration-count: infinite;\n  animation-name: loading-letters;\n  animation-delay: 2.5s;\n  animation-timing-function: ease-in-out; }\n\n#dot2 {\n  animation-iteration-count: infinite;\n  animation-name: loading-letters;\n  animation-delay: 2.75s;\n  animation-timing-function: ease-in-out; }\n\n#dot3 {\n  animation-iteration-count: infinite;\n  animation-name: loading-letters;\n  animation-delay: 3s;\n  animation-timing-function: ease-in-out; }\n\n#too-soon-ui-container {\n  position: absolute;\n  width: 50vw;\n  padding-left: 25vw;\n  height: 100vh;\n  z-index: 100;\n  pointer-events: none;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: space-between;\n  transform: translate(0, 0);\n  transition: transform cubic-bezier(0.4, -0.1, 0.735, 0.045) 1.5s; }\n\n#too-soon-message {\n  height: 25vh;\n  width: auto;\n  position: absolute;\n  top: 40vh;\n  transform: scale(1);\n  position: absolute;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#didnt-brake-message {\n  height: 25vh;\n  width: auto;\n  position: absolute;\n  top: 40vh;\n  transform: scale(1);\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#too-soon-game-over {\n  height: auto;\n  width: 35vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  transform: translate(0, 0); }\n\n#too-soon-bottom-container {\n  width: 100%;\n  display: flex;\n  margin-bottom: 4%;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-around;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  transform: translate(0, 0); }\n\n#too-soon-adjust-speed {\n  pointer-events: auto;\n  height: auto;\n  width: 20vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  transform: scale(1);\n  cursor: pointer; }\n  #too-soon-adjust-speed:hover {\n    transform: scale(1.1);\n    transition: transform 0.25s !important; }\n\n#too-soon-restart {\n  pointer-events: auto;\n  height: auto;\n  width: 20vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  transform: scale(1);\n  cursor: pointer; }\n  #too-soon-restart:hover {\n    transform: scale(1.1);\n    transition: transform 0.25s !important; }\n\n#too-soon-try-again {\n  pointer-events: auto;\n  height: auto;\n  width: 12.5vw;\n  margin-left: 1vw;\n  margin-right: 1vw;\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s;\n  transform: scale(1);\n  cursor: pointer; }\n  #too-soon-try-again:hover {\n    transform: scale(1.1);\n    transition: transform 0.25s !important; }\n\n#simulation-ui-container {\n  position: absolute;\n  display: flex;\n  width: 100vw;\n  height: 100vh;\n  z-index: 100;\n  pointer-events: none;\n  flex-direction: row;\n  align-items: flex-end;\n  justify-content: flex-start;\n  transform: translate(0, 0);\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\n#simulation-instructions {\n  height: auto;\n  width: 35vw;\n  margin-left: 2.5vw;\n  margin-bottom: 2.5vw;\n  transform: translate(0, 0);\n  transition: transform cubic-bezier(0.3, 1.2, 0.75, 1.05) 1s; }\n\nhtml {\n  box-sizing: border-box;\n  -webkit-tap-highlight-color: rgba(255, 255, 255, 0); }\n\n.default-background {\n  background: #737373;\n  background: radial-gradient(circle, #737373 0%, rgba(66, 66, 66, 0.5) 46%, black 100%); }\n\n.unsealed-background {\n  background: #ddfaf8;\n  background: linear-gradient(0deg, #e2f8ff 25%, #b2f0ff 75%, #9ddbff 90%); }\n\n.city-background {\n  background: #feffee;\n  background: linear-gradient(0deg, #feffee 17%, #f2fffd 44%, #ccb9b4 76%, #6b6c9c 100%); }\n\n.wet-background {\n  background: #8d83a3;\n  background: linear-gradient(0deg, #8d83a3 0%, #463662 30%, #190d29 72%, #8e64ab 100%); }\n\n.regional-background {\n  background: #ddfaf8;\n  background: linear-gradient(0deg, #e2f8ff 25%, #b2f0ff 75%, #9ddbff 90%); }\n\n.ui-container {\n  position: absolute;\n  width: 100vw;\n  height: 100vh;\n  z-index: 100;\n  pointer-events: none;\n  overflow: hidden; }\n\n#rotate-mobile {\n  pointer-events: none;\n  background-color: black;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  visibility: hidden;\n  width: 100vw;\n  height: 100vh;\n  position: absolute;\n  z-index: 200; }\n\n#rotate-prompt {\n  color: white;\n  font-size: 24px; }\n\n@media (orientation: portrait) {\n  #rotate-mobile {\n    visibility: visible; } }\n\n.out-left {\n  transform: translate(-75vw, 0) !important;\n  transition: transform cubic-bezier(0.4, -0.1, 0.735, 0.045) 1.5s !important; }\n\n.out-right {\n  transform: translate(75vw, 0) !important;\n  transition: transform cubic-bezier(0.4, -0.1, 0.735, 0.045) 1.5s !important; }\n\n.out-bottom {\n  transform: translate(0, 50vh) !important;\n  transition: transform cubic-bezier(0.4, -0.1, 0.735, 0.045) 1.5s !important; }\n\n.out-top {\n  transform: translate(0, -50vh) !important;\n  transition: transform cubic-bezier(0.4, -0.1, 0.735, 0.045) 1.5s !important; }\n\n.scale-out {\n  transform: scale(0) !important;\n  transition: transform cubic-bezier(0.4, -0.1, 0.735, 0.045) 1.5s !important; }\n\n.hide {\n  display: none; }\n\n.mouseDown {\n  transform: scale(0.8) !important;\n  transition: transform cubic-bezier(0.4, -0.1, 0.735, 0.045) 0.05s !important; }\n\n.scale-up {\n  transform: scale(1.25) !important;\n  transition: transform linear 0.1s, opacity linear 0.1s !important;\n  opacity: 1; }\n",""])},function(e,t,n){"use strict";e.exports=function(t){var a=[];return a.toString=function(){return this.map(function(o){var e=function(e){var t=o[1]||"",n=o[3];if(!n)return t;if(e&&"function"==typeof btoa){var i="/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */",r=n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"});return[t].concat(r).concat([i]).join("\n")}return[t].join("\n")}(t);return o[2]?"@media "+o[2]+"{"+e+"}":e}).join("")},a.i=function(e,t){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var r=this[i][0];null!=r&&(n[r]=!0)}for(i=0;i<e.length;i++){var o=e[i];null!=o[0]&&n[o[0]]||(t&&!o[2]?o[2]=t:t&&(o[2]="("+o[2]+") and ("+t+")"),a.push(o))}},a}},function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF8AAAbsCAMAAABGHL8mAAADAFBMVEUAAAAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAml7G3AAABAHRSTlMABAUBAgMLpCNX/P/dHZ3KEILDDA3cgf3LnLv3RhwRWIBHdfhZ28xgNnQbY/BazdpkczUSrAawZXLOGjHTFbHZZnHSFNYXkc8TZxhwq8HyOWjR129FaTrQGW5C9mrY/kFioKF2OKLHD3dhCbrfIH8OeOC5xesuecZfVex64SFeg1GG+1BU6XsiT4dTkPriPcSIklIl6CmJ4yqKJOQ8K4u4CJWX3owH6pi3XSyZrbZEMJrvNFstQ5uq86bxp22pN6ie9UBJL7XAjSZK5U1OrrR87VyyvWtsOxbCr/l+SB++ClZMS4/mkz6U9J+z1aMzpe4yvyjnvJYnhR7JhNQ/yH2O2uRaRgAALilJREFUeAHt3WG4VdPaxvFRcxd6RBJRAkEIqAARAQgIEQGgECo5AQIhQgAhCKCCFAAFAAhOIiBwEHA4HOe9rjV369nMMdZ9z7v98X2+1GVvv/8Hdu211zPmCA2mSdMmWaifuqbRqf+EZk3C3GmW+MRQnObzzR/qZ4EWFpsFW1baC5kt3Crkky1i0Wm9aKRA83qA4rlAm3L8Ys7/LbA4E3C+LcWbLSEEEL+kWYlAu0zg+UD7pWi+Q4HPA0t7gOGXQXwyEJZtDB4GdD4sZ4YDOh/C8iUCHYv8CnF+xZyvEVjJAyLPB0SeD6j8yp0qv6wCA6X4VUP9rGad2UCEXx3zBgJrVAPzSzwfkHghAPg1q/xaZn8NrM0HON4D69QMdCnyWVeK1wPd1uV5PcDxeiDBr2eWCqwfD2yAA2tuGOU9sJEeIHjbuHvQAzxfLrCJ5bMpw+sB53tgPoTNygUwv3mFb9pTC7B81y22VAJbsbyZFAg0TwS23ibJb4t5PcDweWC7UD/b4wDB93ReDWB+B7MSgV6ZwPOBHXcq8DsjHgcEfpcEb7ZrNbBb4/E4IPChtxkO6HwIa5GBBL874MsEdtyD5fd0Ph3oE+pnL53nAxK//d50QOFXsb55YDUYiPD7YN7owJY0v43zBgP7VgMijwMS7y9KPdCPD1C8B/ar/KP9+UB2AM9LgWYH1vybzXk9AHk+sCkTcP6gCKEFMO+Bg0sHDinB26GHBT1gG7B8OrBhjcAGXWheCTh/OOZDOKJkgOT7d9ACLD/gyKOUwNGQH5jzZlIg0DwRWDMdOAbzDQMrw4DAmx2rBTCvBzB/nFmJwKBM4PnA4CEF/vg4P9T5ROCEYkDncUDncUDjw34tDAd0PoR/lAgMK/InAp4KlOYHOZ8MnHRyqJ9T+uk8HxD47NTT6IDCn27Dz6j87kwYOKvIn415owMDNR4GznFQ4CuBETjA822cNz2A+XPN/h44jw9k53O8HtiK4H1G1gxcAAKAlwM874HhaiDBe+DCeQqMqvIXJbYa+ofSgYvL8+nA/IkAzUsBnve5pEyA5weOlgI0f+illymBvar85XF+QD1vBgNXRAKB5sUAzzcMnAYCAl8JXCkFMK8HMD/UrERgaFbgr4rzxznPB664WuD5gM77nFUNnOEBnS8RuKYkH8Z0NBzQ+RCWwwGRB4FrPZDmr4vz1zsfwlIoMGJ4zo+m+bEhlA4IfN0NJ9ABhb/R+rGBm4r8zZg3OjBO4z3Q3mJzSzWg8HngFCGA+VvNhIDAS4FlMd/4gdtifB64PX+zNhG4AwQALwZIXg8k+DvNYoG9hQDP211Ngx6wu1k+hPFCgOJBYHAiwPJigOe7T9ACzk+M811zfvN77lUC97G8GQ7cHwnQvBjg+YaBSSgg8Hqg7gGON+uMAzy/Q4Xv6TwTGJRpfCTQN71lK/MgoPCFwDrJgMiDgMBPrvBhnSlGBhL8kkk+nz1QYO++Ol8usKLCpwOdPKDyGR9Q+CYP7pUHdsQBiTdjA3sW+YUSfBPnjQ7USTwMPFQNlOYfNtMDNO+BnUoEsiUJ3ueR0oG9LDaPRng1gHk+8BgVcP7xoqEHMK8HeN5sfOWjB4uBxxH/RF3QAzyfDhxcI+D8o4CXAhzvgYdKBTC/UIVvOUYLsPxiTz6lBKZW+cm1eTMY2DEWoHk9QPINA4/hAMMv2ZDXA01r8h2qvFlfHJB4PtArE3g+sOc2Co8DaX6HOP9AhPdl2Xw6eUDncUDmw5BhhgM6H8I0JpDmuwKeCXT2zX6Sn+h8OrC3B1S+CR9Q+HFPL0sHJN4sDwyBgWc0ng5kBf6uOH9nQx4HJrlYjh+b83xA5c2OzgOD+UA2meL1wO39IN/4gVur/N1mJQLtQQDzeoDiPXB/icApHsC82VJ6gOGfzYIesBur/G21+XRgfDrA8UrghH40Lwcwf3OFf+75UD93lAqw/AsjX1QCe1T562vzZjjQOxKg+b8EbgEBgRcCkL/O+TzwkhBA/Oic1wMEzwfaZQLPB0a1EfhE4NpbCL7/cXH+qhifB0YkAyKPAwJf8a8xHBB5MnBWLX4A4MsEBtH85c7zAYHvX/nN1fHA8IYBiV+09cV0QOLNyMCVL2s8HQgFvl2cv6ghjwNnqHybet5sqzxwBQgIvBzIXqF4PTBiJOQbP3Buijc7v2bgNCrg/CizeGB+IYB4PTCc4/31hR7A/Ksh6AE7neBB4JJ0gOI9cAEX8N1c5wcBXglg/uzKRycsowVY/rW2ryuBa1neDAfOC8kZCPmGgXNAQOCFAOZPdF4P8LxZPyEA+GnOM4E3sgI/FPGJwEmJLVuBBwGBPz7O+7KsB3R+iPMwIPChw4qGAxpPBk72QIQ/FPBlAtfT/DEh4MApHlD5w5qFEMKqOKDxXTY4hA1E+MMwb8YGltR4OhBY/vCGPA6coPLbbG31c2AeWBMEBF4OZG9SvB7Yry/kGz9wUIo3O6BmYGUQALwaSPF7mqUCG5YI7N2X430/Sg9gfnoIesCWJ3gQOCIdcL5nmvfApnxgUl+W1wOY3yc/armzFmD5KTZdCbSkecOB/UNyeu4CeT1A8uaBPjjA8Ls7n89bQgDxbzvPB0QeBx7OBD4e2LfWlq3zmyMeBwR+5xRv9kg8IPDrOA8CAu//aUAgzXdP82xgV1//Ls+XCfD8tiHgwF4eUPl3ulUCe+KAxG+46SZ0QOLNyMB2VxX5jQmeDgSW79GQx4Hd5pU3W7cS2IYPUPyaZnoge5fi9cA6nXleD7C82T9rBranAuuFfIqvIjywtRAAvBzo5AHMW9v9gh4g+PtC0AMUDwKbFXjfzV2L4D2wQdmA8ytiPoQuJQMkP/VEKXAP5FfP+Rn2nhLYhuYNB9YPyemAeT1A8nqA5M2OFgKIn9nRTAsAfgXn+cCdWYFfDPGJwBoxvk7ncUDlcUDg0893WtYDKu9vSvKBiQW+ZYJfJgQ+IPF0YOk1dJ4PSPz7zfmAwM9/wQd5YBQMxPgFIW/GBo6h+QUa8nQgiDwOqPwVZnxA5fPArFqBxbMinw2y2LSI8R5ozQeuPIvn1QDPq4EEf3WBFwM8LwZ43mZcGGoFFokGnP8Q8R/5WiIduPas0rwSaMhfg3ghwPNKgOYXuDlTAi9A/uOcb2ufVAPvxgOnRgKzaN6EgM9ozPMBkecDIm92vhQAfAszMcDzkUCv2ku8zr8Q5593ng/oPA7oPA5o/H7Ow4DAJ8+ubBUNXF7gn0vzZKB5L53nAzLPB3h+aqify1rxAYG/Y/ASeeA2GIjxn0LerHbg4mqgh8bTgSDxZIDnO04tHtLEAZ6fWeSVQDaU4H0WzgN3xwOfRQJHHcvzeiDFD3He9ADPqwGeFwM8b08+5ifv2cBJJfjZIdQMfB4JnHxSkR+W5uUAzwsBns+kAM33WKhOCWyK+C/qefPHYI0rEWgCnqPiPBG4IRLgeT4g8noA80JA4M2+bDY38AoOAP5CvzOfDxxe5F+jeRzQeRzQeRzQ+N4WnQM8APgJNfnQdDIKfKXy5QPHlOHLB3h+TAg4cKAHVP7eLclAlN8I8Qc/tEUl0AQHNN6MDZyp8ShwyNyAxpMBnp/i/I5WP1/ngUdxQOKVQNaa56XAdrvSPA78CwcSvAfeUQIJfqecjwUeVwOAVwPOv12bt3smhFqB+RIBmv8mhNKBPruW5qWA83ukeQ88XCrA83Ug8G08APnvcv7wu5oqgYUhPyfnzV5WAhnNM4EmITV7TIF8w8CDICDwlUA3GBD4g8yEgMAzgfkyhecD6xX4txne55/VwLeNzeOAwuOAwG+U3x5nVibQg+f9egwcSPNj0nztwLoe0Hg60OzbsvxrzpcIbFuef+qoSmAiDkj8+PZHsoEY/wXkzWoHNqkGxms8HaD5wiVTR77vV1PBAM/3znk+oPJKIPue5nHgjUhg6ZV43gO3qgHAm90kB5yfVr0P03k2MA4FAC8F1ijB26U/BC3A83ngRiEwjOFB4KtkoCHfMc0rgS5rMPyPFT7rJgVo/vKfZs0N/FwicBzLm0mBQPNE4JV0YDnMSwHA/9KQN3sTBzS+EMhQgOcvMisRWDfTeRzwdUCfmXH+U+f5gMKnAzc0Pu/Lsh6Q+TDVDAd0PmSX44DCPxdC6UCLBcrwMNA85JN9rvN8QOJfusz/HwIBnn+hyl8y/FI2EOGnzoC8GRv4RuNR4Pu5AY0XAoCvXlN+Xs574FwckHglkF3P8B74oWyg+TM8LwZoHgeeYQLXON/CLBE4XQ0AXg9g3l+/SAGeLx/oNZe/muBBoFc64PyZad4D/y4ZwPyvle84F5UCND/xt8OUwIMsb4YDi4b0QH7eAv/AfMPAf0CA5Bd0ng+IfB5oJQQAf6dZicBxmc7jgK8D+nyI+FTg1HniWzpPB3QeBwQ+zLToLOwBmc/nGDKQ4BcAPBFYpDy/mPN8QOL5gMLffi8dUPgj+t2TBw6PB5bwgMabsYHRRb5tnO/QkKcDKo8DIr9/zvMBkff1ioMSgaWLfPYyz0uBcW9YcVZM8GKA58UAz+sBxHtggh5AvO9fhbB8PLBSLPCV86uSvBbgeSng/GoGeCHA8k22kQI0P/n3d5TA54j/vZ4388AqFp01IoFA8/MWWAvzfEDk+YDIm32tBAD/qFkssLZF55lM53HAF0l91ovzGzvPBxS+ENgyGdB5HBD40NsMB3Q+hG1RYP3I8rpPD8AzAYHvHkKZgMDjwBYeUPm99vPPAwGFX9/6PkUGphT5bTFvdKCPxOPAdg4KPBng+c27F78un+QDAu+B9fhAdgjDe+CPsoFm89E8DuwKA4AXAzyvBRL8KrXOX68lBADvPxIrG/jW+Z4knw70SQd4XgrwvBDg+bGJb+RRwPnlE/xhFf76m35VAqeyvBkM7BsJBJrnAyL/l0A/FBD4hu+E7V8qcBDmlQDg/5vzt5mVCIzKBJ4PvDZN4PmAzvscmQ4oPAgA/vA4f2iFD3u3NRzQ+RAWwAGRZwNH9PMF6hI8DBzlAZ3nAwKfLftSHmgBAzH+mAQ/0N96GskGBku80YHDNN5s5Iu1AsdWAyKPAwrv7+164EMckHglkH1msRka5aXA5wzvgY/0AObFAM974B9ywPl/m8UCF+oBzPvOsBYYRPLpwEknpwM8LwV4XgjwfJvEIhIKOH96nP8p5wf9+IsS2J7lzXDgnJAczPMBkdcDmPfjHr7pxweyczGvBADfzp98zgeGZgLPB14YLfCpwPBG5XFA4BPLsh4A/EUJvn/lwxfOMBzQ+RCm4oDIw4AvwvtuPM/DwGUe0Hk+IPDZVq/ngY444Dw6FzKgyn9ubfPATBg4VuKNDoyVeBy40kWJxwGRv8H8eisc0HkpkC0S35yN8lqA5nHgLC7g/M/mowd43gPLiQHA+/13auB659MP9JADfvt/HeDTgWvTAZ6XAjwvBHi+55DESWcQcP7GOP9yzu/53RwlcArLm8HALZFAoHk+IPJ/CbRHAYGXA3W3Jvimfm8oH1B4PjAoE3g+sFgHgU8Eerdn+DsRjwMCf1eK921cD6h86PSF4YDOhzAGB0SeDYyvD/hmv/MTIc8HBD6rGbjXA6X4rnP5ZvO9lQem4IDCf2vGBjYu8g8QPB1opvF8QOXNpsMAz++Q8/5UNA+8XSKQTWR5HOgcC2zP83qA5vUA5hstMDn96EocWAcEIG823p/0SAY243h/lLQeoHg9QPF6gOM9sGM80CkRcP7hWo9SX3UPJbC+TW7C8St+MVsJfMTyZlqA5onAQx4g+S+d/0tgJyrg/OOY1wM0b/akEED8mmYlAu9mLP+E83xg8540X+c8DqT5R0neA38knpSu8SCg8n47BgrofAgb4YDOc4GH5vLdC/xkyKcDT3lA5ZuVCPD8QnP5cV+95/dkgIDEm7GB1gW+KcPTgUzkzf7kAqX5V8yIQF8PMPySBV4KZI/TvAemlQis3I/gfV7VA5jHgf2owAMJXg8k+KfNkoFhfOAID2DebCk9wPDnZ0EP8Hw6sHeNwMT0zXDOK4H9+9G8HMD8JxX+6uUSF9mBAMtfM+NjJTCG5c1wYFJIzti7Ea8HSP4vgcE4QPD/cz4PfAQDGq8HMH+FWYnAT1mBvw3x8cD9scDQgQIPAhL/bII3G5kIiDwIqLxf5IsCOs8HEvz1gCcCd8wNHErzNzufDrzoAZUfm1UCL8CAxjfv9Qkb0HgzNrCJxtOBwPLXNeRx4CWd/+sfQ6P5AMMvmvNiIPuK4vXAacMx3+iBq1K82bM1AyNAAPEeuEYIAF4OXDI8zr+bfH2hBzB/dAh6wC5neD1A8D5XxwPDY4HzhtO8HiD5IR9qAedbx/n3cn5Y2xWUwP0sb4YDZ0QCNP+XwBUgoPB6gOHzwOpSoE2C/9N5OYD5wWYlAq9kAh8NzB8LHNdf4nFA5xPLsh7Q+TucR4EEP8os/fOw0HJBwwGdZwIX+Pp3eZ4KKDwOvO4BlR/YrBJYDAY0fuk1vqQDPH+282Zk4Jwvi/wggqcDQeNxQOW7VHh/t6pDPNDvdZ3XA1m7OH9ihJcC49vzvB7APBe4nQo4v4FZIrCiFMC8HiB5s95hXgLHI/6REPQAxYPAKekAw/usWjpA8XqA5PfooQVYfortowTeR/xbc3nDgRNCcrbZGvINA2uCgMTrAZI3mw4DGi8EMD/dd9H4wKOZzuOAr8E6vyfkE4ENCwGJhwGdX8d5EJD40H1zKxHoWuB7pnk2sKnO0wGdpwIq370bGdD4Pru+XDPwlgdi/C4WnX2cr54vg4FnNZ4OBI3HAZnf10wPsHweaFor8EiEz3pZdHaP8B7YhQ889hDP6wGW1wMMrwcS/KZmjRzAvPXbr+afKXuBwM6Ifz2E0oGDHyrD6wHnNwS8FqB4PUDyyx0uBTojvm0939HORt907BYJ9KR50wI0rwScXxPzeoDlzV4VAohfynktwPAeAC8bHsj+zq+a4O9zng8sWSfxOKDzMKDzb8d4sz8jAYUPAw81HNB5JrBBcXnd+RUBTwS6bFCaXz2EUgGVbzmLDGj8ySf9lAeGxgPveSDCd8C8GRs4W+PpQNB4HFD5c+p5s3Y4QPMrFHgYODrCZ4N43gOD+MAdtzC8B/rrAczrgQR/QZHQA5jXAzxvI2fXfONs2WjA+WUQPyKE8oHBZXg94Pz8gJcCFC8HAO8LhmdelCmBH1m+hV1XDYziA81p3qSAL2JAXg+QvNnNfIDiX3ReDWD+POe1AOajgdY1l3h9rmZ4n2fTAZ3HAZ3nAyTv5weech4EJD70b2clAjcX+Wtq8unA/3ztUufLBWh+hvNcQOV/OawSGAADGn/tWb/VDHzigQg/GvNmbGB3jacDgeU/bsjrAczf4hfZVALHgYDG48D5kUA2lOL1wDkXkLweKPLPp3izQ/WA88mXHh64Xghg3gNjE4GtIoH5PYB563tw0AMEv18IeoDilcAVOT+V4OVAQ34w5tOBi6MBwPsDEtZ6oE4JrMjyZgspgaY0rwR87se8B5LnSj/LyvFP5vxqZnqgBG/2BA4ovBDQeBw4vsAPSfB/xO+g88DdjcfjgM7DgM6Pd54JnFiSD03vMjKQ4IfF+dkhsIGnNR4FvmzmAZ0vETi7PD/nnUqgKxOg+S+qfKfOv7OBCD8N82ZkYNwCGo8CB8wNiLwHdsABhr+wyj/kd82DgMrrgWwUxeuBPpsyvAe613po1oEgAHg9kOAfK/B6wPkxaV4P0Lx1nhP0AMGvE0LNwCHFgK+0TKH5EJqUDzh/MOClAMvXaQGWX75rU38qIx9YCfL35ryZFMhongj8qxio8jtCXg8QvBDA/D05v0rk2fdNHgcBiScCh2Q6zwR2LvA7YZ4L6Hwi8LDp/Dcp3uzlSEDjlzPDAZ0PdQuRgQS/R5ovH9i9DA8D3eYGHizLf+c8H+B5vx5l9q+VwJIwoPF7972JDkT4KZA3YwO9NR4F/GKq0vykCl8NPAACKo8DMq8Hsu8pXg90WYPnPTAxHlg3FtigFt/erNED322U5s0W1AOYb4TAa2ner6rUA5i/MgQ94Px4wKevTNokHXhtAsHrAZLPmmoBlj99QH8l0A7yl+W8mRLw6Y14DySvPHujm87rAZbXA5iXApgvXgvfDgVezgr8UiTvgfSdgm2XEXgQ0PgfnCcCOg8DOh+mpi739gDgO9biQ3YzDug8FfjZd4RZ/sec5wM6TwVU/qMfagV+8oDGjxj+4y+VwHUwEOGXw7wZGcg6aTwdUHkcEPkzcp4JYN6pAu+Bq+KBNyOB7DiC9/m0dGDRd3leD3C8HkjwpxV4PYD5xgl8Cng79qj0ze44wPLpwAexQOsyvB5w/hLASwGSr2suBTB/ZM7feOhAJTCZ5c08cFEi0DwkB/PzFjgP8noA877mCAMarwQw/75/f0MHbssEPho4t/YSr/MtMM8GdN7nv4mAyMOAzoeZZiCg8TflfAhno8DpNfkzAV8mMOMjgWcCCo8Dv3lA5e/L3yg5EQfK8L+G+jmh33dzyECE/wfmzdjADxoPA60clHgcEPmVc94Dx4OAwMuBbF2LzYIRXguMexrzdGBhHEjwHthID2DeA8fIAeePaMh7YJoeIHjbYrugBXK+JcHrAYoHgSXSAYr3ObxkgOSbLK0FnN8/wW9Z4R/evLsSuJHlzXBg6ZAczOsBkm8YOAgEJF4PkLzZxjjA819v6fsZdOD7TOeJwBcXCnwisHyj8h54JxHQeBAA/GpWgw9LmYGAyM8F9sEBnacCq/huvMAnA797QOfJgMpPz0/B7I4DMX4t9K/tZk/OJgMab3RgVY2nAxqPA1+/I/Lb//3Ix84gIPByIJsv/TXpvAcuLBto8iDm+cCWIIB4PcDxHthWDji/mVks0EkLYN6/7dADG3cneD1A8SCwRTpA8T49SgZIfmwfLeD8+gm+VYV/erGWSuDfLG+GA9uF5GBeD5C8HsB84ZXyeqUCa6d4f5ksBBC/sPN8YFSm80Tgu41UHgd0PvGzorUagwcBwK9S86eCe7c1HND5EFbHAZ0vF/hujsAnAzdVA6vpPBlQ+Vc/pgMRfnnwpkFY1mbkgRVgYJjEGx1oJfE48L6DAq8HOD4PPI8DOu+BZfhA9nONt/yc1wN1kYDz2eJmJQJHggDk9QDF6wHMeyA/ZruAFMC8fd88CIHiysEitfl04Kh0gOP1AMd7oEWJAOJ9ZWXRc7SA86fW5Fu/8JwSWJvlzWDg2Egg0LweIPmGgQ9xgOJnNeTNPtUC2X8Qrwcw/65ZicDQTOeJwKe/6LwHfE0A8/+O828meDciAYWHAZ0Ps2cYDuh8CB/hgM6XC/xY5E/HS+s4cGYLmU8E3POAwGef5NclfIwDEn+xtWUDFxT5czFvdKA/y7dryOPADy4KfCWwAg7ovAee5wME/5mZ6YHsPzyvBxKn0pz3wDJyAPM4cGks8G+S1wMJ/nOzWOCp/DyeEAC8H/vUAwNYPh24LBI4vQyvBzjeAx3LBZy/odax5y73h/qZWSrA8hu8NkEJHMHyZjhwZUgO5pWA8z8jXghgfl3n88BGMKDxQkDgQSDx+qIO83xgwV9l3gN+zFHn/5ngzb5LBEQeBnQ+HPykkYEEf2OSz2d2icBN5fkyAZ5/2fl0YI6fg1b5jA1ofLMD98kDX+BAhL8V8YeYsYGvNZ4ONKH5ps5XZncqoPI4IPL/Mvtr4MISgYzj9cDaDO+zc6ME7krwKHDPNyAAeDmQ4OeLEEJgFYb3GV/56BghAHh/bKUe6Mry6cC96QDHK4Hl/8Z/C/g8MKVUAPOHVPgND9YCLL/plDFKYATLmwkBnyaQJwKdPSDwDQNv4wDDH+h8Zb7AAY2XA5jv4zwTaJ0V+AcxTwc2fkfgQUDiD3A+echiDw/oPAzofJjwnZGBBP9wks9nTonA7+V5JrBjaf5L59OB2R5Q+WZsQOO7bXI2G9B4MzYwtMg/TvB0IGP5J5z3W0twgObrGvI48KQHJN4DG5UIZA8i/g0zPeBnyije7Hg9gHkc+AMEEO+B10oEOF4PrBbnx0V5s6W0AOb9Viw9sBDLpwNPpQMsn8+EEoG1eF4POP9VLX7+3lIA8xfn/AUdZyqBP1jeTAvQPBHo6wGBb3gV4jQQUHg9MO6V5J2OflWnHuB5IvBmJvDxwLDElq3Ee+D5VEDncUDnQUDg/crXH340MpDgn67JpwMfRwK/leeJwJBhOk8GVH5c5Te/4IDGz/rg2TzwKbjKesjgCD/2aXAjdPMPzNjAK60k3uxmLhAkXg+wPA6I/PdWnetKB7JNwI3uzsPAyFjgzBY074HntADmza7SA5jXAyyvByL8M+nXF3rgWcQvnoU88EI88GI6wPJ6gOL1AMXrAed71eLvP1MLQH7ZUOEHt61ecjo6EXgpEpjG8mZagObnKbAo5vUA5n2PEgY0Xg5g/o6cLwausdg8nek8DvgSr/PvYp4I6DwM6Py1DXkPrOABkT86VObXmwwHdJ4IXO2Bn8rzbCDBt4Y8FVD5NnVkQONbLbFQHlgwHljdAxG+TYJ/z3kzNnCIxtOBoPE4oPJL5zwO6LweyAbE+T9jvNmSlUDLROC+SGCp9jyvB0heDyT4lYqGHsC8HuB5s96hVuB1d6P347yK+N1CyAOLKQGK1wMUrwecXwPwUoDkD15NC7D8Q9Yj1E+HEoFzaN5goJ8HwJWcPns5rwdIXg+QvNm2QgDxjzmvBTAfDaxosdkhK/AbYJ4OvNyU5R9xHgd0Prks6wGd/8Z5EJD48M7XhgM6TwRWXdH5bqV5KqDwOLC7B0ryb4X66dm0EvgdBjR+yy26soEIv83WkDdjA+drPB0IEo8D+6j8dvW82Q55YGMcwPz0Ai8Fsl4Urwd22pHn9QDLm02uGZhOBZzf1Swe6K4FMK8HSN767R30AMGvHELpwB47luH1gH+sT5r3wOZlAwyvBzB/Qn499tpS4CGWb2+HK4F3aN5w4K2QnD77Ql4PkLzZMdW/+kFA4IUA4k/xO/OFgMLjwBOZwMcDu8T4ugK/KcX7HJ8IqDwIaPzt+Ze38yAg8aHVb1Yi8GWB37A2nw6cWA3s6Xyz0jwZ0Hk+QPP+Cr9D5dkZh+GAxh915ICagbM9oPFmZGCb94r8mgRPBwLJt/0r74H/8gGOP9bq5zgc0HkceDXCZ6MoXg8MGUzyeqDI35fiza4fWwkcKgQwjwN/xgLDeF4PsLwNnx2EAM+fFvIZqATark7wesD5k09K8jDwXiQwbRjL6wHMn5HfhHt6NjcwtETgLJYfbpcrgTY0bzhwdEjOOZCXAjyvBQA/4u9Xk19VDQyCAYHnAyKPA89mBf6C+KaW83xA4xOBNh5oRN7sunhA4J9yHgZ43rfkZv1kJQL/K/Dzp3k+oPNUYJTC48DNHlD50QMrgXZEgOd9jfaySw+lAxH+CsibsYHpGk8HgsTjwLOZyF9Z4T3QHwQ4/qMCLwWyoQTvM7R04OorSF4P0DwO/I8JzHD+LLNEYIAUALwe4Hnru1MoHbimBD8phJqBT2oFZnxM8HrA+WvTvAeOKxNgeT2A+fytqf1vrVMCC7J8P5uIAudHAt1o3qRAlb8F8g0D18OAwJs9MDcwFgd4/oicFwKA3895JSDwOPBqgb+D53FA53FA44uzpAck3o/hj3ceBgQ+dHvZcEDnmcBtxR8xOT8Y8CUCPP9kzoPAQh5Q+QmVu0ub4oDG33vP5mwgwt+PeTM2sILG0wGa/6MhjwNPeEDiPXAXE+D5zmZ6IBvF8B7oWTaw6pokrwdIXg8kH2O1Ts7HAl2lAOD1AM/bQ3OCEOD5TiF4ADyyr7DZ+gXD6wHnO6V5D+xQKsDzmRSg+fUfbaIEtkZ853rebDIKHBAJ1NG8FqjyD0G+YWAyCgi8HgD8Zg33KHFA56lApvNMYHqBfyzBr+M8H5D4RKBJMaDzOCDwy1l0dogFBD40+5IJpPmD0zwbeFTn+YDM0wGe9ydEj2nJBwT+qScXywNPxANdPRDjd4S8WR6og4GZGk8HVJ4K8Pw9BV4LYL6vWTXQoWwg60XzOHBXJLDNniSvB0heDyT5/Qq8FqB5PeD8N7V5u+XaUAksJAR4Ph14ORLouWcZXg84vzfghQDNZ021AOTPyvlTrx+rBL5neTMPLInulfLJaF4J+ExCvBzgeT0AeTEA+Cv9Wng60DUT+GjgAfIhAZPaszwOiHxh3TcR0HkcEPgw1QwFBN5vWcw+QYGJNfnxab50oJ/ApwMDPKDzfEDin/+lEvgfEeB5vyX1pZGfPkcGInxvzJuxgZ00ng5oPA606y/yI+p5sxeEAM974Fk+kA2geD3QZlT6jmbnPTC6ZmAWCABeDJC8HuB5D9ysBRryw6PCSecEPWA/knw68FMiwPNSgOf1gPNnJPiTK+6suYHrygRo/oZBbZRAV5Y3g4E3I4FA82KA5+clcFqcP9b5PDBwbuAqEOD4o5zXAzzPBO7OdJ4IjPxI54mAzvsMrQYuJ/hLavKfm+GA8y+W48NMMxzQ+RDewwGd5wMyTwQuUngcONQDCf68OH9klV9mQuWXP3FA4l9v+xob0HgzNnClxsPAYQ4KvBrgeQ+8igOYf7/K9zPTA9kbDO+BaWUDY2+jeRz4LwgAXg0k+dtzPhY4WwukeQ8MmafATYC3ffsELcDzUoDnQeC3dMD5UzAfwoklA5DftcI3ayUFaP7bPXsqgYksb4YDrUJ6ID9vgRMw3zBwPAiw/HYNebNdcEDm9QDg5zMrEfggE/lEAN/EuTLkE4Fj5oXfwnkc0Pn0sqwHZD4sZYYDOh/CW0wgzR8BeCJwuK/e0/yWIcBAdw/oPB9Q+J3H0AGFn25T8sB0GIjw+2Pe6EBLlv+6Ic8HyvNvmRGBjbvrvBTgeQ+8XTaQPUjxeqDJozyPA+9Qga+rn/aI+egBnvfAPlogzXtgHSHA87ZGl1A64Kuzfvv/Xmk+EXAhESB5KcDzPruXCfD8uO20gP/j3RL80hX+qxVXVQIXsbyZFAg0TwS+9oDANwzsDAIkv5LzeaCDFtge83oA8W+YlQi0znSeCNzzjcAnAttS/GZxfokEb7ZYOqDzOCDwYVI/wwGdD+F1HNB5KtCjsILss36CbxUCDLT0gM7zAYU/8fk80BYHFP49mzGVDHxX5NfGvNGBLiy/cEMeBhasBiReD0D+aJs7HfOzJ/eBgMDLgexGitcDdbemf3LmPBv4FQQArwXuTPLLmqUCq2uBNO+Bt4UAz1uvRYMWyPnDSD4ZuCkWmFiGlwI8LwZ4vvnJoX5WKBXAfPMK3+uaq5XAQSxvhgPvh/RAfp4C2eKI1wKAf8b5PDC6ursAAgIvBwD/jFmJwNBM53HANz2dXwTxOCDw3yd4sxeqgQU8oPM4IPNh9kjDAZ0P4SUmkOZPBTwTaOHr3yT/gfPpwHMe0Hk+IPDZzflF7y/igMR/Ym0XIAPXFPn/YN7owCyan+W8wcCn1YDIm7VQApg/30wPlOA98BEfyM5leA982CiBNxM8DPwCAoDXAheV4D0wQwqkeQ88pQQi/FYWnVfGBT1gPzF8+cDlZXgQ+DERYHmfj8sEeH7pa7UA5L/K+TWGDVECa1X5i2vzZjjwQ0gO5sUAzzcMPA8CAl8JTMMBldcD2Wdx/o2cX8msRGBopvNE4Mj3dR4HVD4RmOoBnU9u43pA5cNOfY0JpPnPE3w3f9YKDug8E+joy+sleBiYEOpnZkeVz/iAwjd7Yts88CQO8PwmVf5LMzawa5G/geDpQBORN+tRM7CRiyX5A8zkAM974I8SgexzitcDh1ts1o3weoDnzdarFfiOCzh/YNHQA5jXAzxvlt+RMFsM/BPx3zYJeoDn04E5NQLOHwJ4IcDyHviiRIDn+3SSAjS/6457KIFLIN8s5820AM0rAef/hfmGgQthQODNpkgBwG+X80IA8PM5zwdaZzqPA75l6/x8mMcBmY8vy+YzxgM6jwMC/68KH+Z0NhzQ+RDuZQJp/lvAM4EpvtlfgoeBMR5Q+To+oPDdXj4mD9wDAxG+SYI/xHkzNvCbxtOBTOTNDq8V+KIaKM3/00wO8LwHvikRyOajeD2wnsXmwDhvdpAewDwOXEgFnF/XrJEDgPfAd2oA8Ga9878PxMABiP85C6UDPcrz6cDsRIDm9YDzmwBeCND8OZO0AORvyPmTOi6nBPZjeTMtQPNE4MlkoNsbiJcDPN8wsBEOYP7zzG8+90VNGBB4HEif7x7H8ziwcCuFTwRea1weBxQeBwT+s8xvGcaBNP9VmucCE14T+dKBJRSeDwh8t4wPCPysny6vFZgx1QMx/pU4f7HzZnngBxi4TePpQJB4PYD5N61+LsIBjdcD2bo874Ef44HnI4EPW1hktorweoDnzc7VA4jXAyn+A7PGDwDebKlQK/AxCJyP+P9koXRggRal+RB+KR9wvjnghQDL6wHIn1r5hGtP0wIsf1aLM6uBT+OBjyKBOSxvpgXm8t8jXgrwfCXwDyrA84s4rwcQf2XO6wGeJwK3ZQIfDTwXCfgSr/PP8LzvsnpA5Bd3ng/oPA4IfDjqWMMBnU8HFqgGXqjF9wI8H/DNfswvG3zogMAvWlcJHIkDEn/YbxPZQIRfFPNmZGD0txoPAm2rgSDxegDyrep5szsrgfdxQOFxYJkInx1H8XpgZkfIN37g6BRvdqsQSPMLmyUCN2kBwOPACjAAeLPeQQjw/Noh6AF7j+CVwAya9/k1EVg9EphaCTi/BOCFAM13WlkLsHxnW00JXE3zZmtVAwvGA/eF5Cyd4Nd3XgnwvBrgeT2AeS0A+M1id+avBwJ3ZQV+JcTHAy1jgXW76TwO6DwOKPwc52FA4MN2W1h0enhA4rcPgQ0sVotfA/BlApsoPB8Q+C6VC023TAS29UApfrdQP+/8PrkJGYjwXTBvRgY6fKbxdCBovAe+xgGJN3u0ZmDnUvxeVd45IZA9Q/F64O0pLK8HeN7scSGQ4J0pBt5JBHYnAo8keDkwxgOYt36TghDg+f3960IIMDwI7FPgfTf3LYbXA85vAXghQPOTNpMCU1i+ry1fDWzMB7ajecOB6e4WOpDXAoA/wnk9gHi/mtwOCvXTHQcEng+IPA58mRX4XeP8ys7zgQOaKXwisHnj876w7AGd38l5GBB4/6EBFTiwwPdJ8CeEwAd0ngwIPA4cE+qn5+Yqv+HYSmBhHJD4X2+6ng5E+H3j/CnOm7GBZTWeDgSJx4HjVf79nPfAbziA+dsLvBTIRhG8z22lA9NeI3k9QPM4cGIikOKPNIsHDtMD/V5P8nqA5234H0EI8Px5IZQN+GZrW4YHgbPTAeePSvMe+G+ZAMvrAcxfkl8wfWqmBG5h+eF2uhIYSPOGA69GAr6GgPiGgUNBQOClAOBPcz6fc5UA4Ec4zwdEHgfOzwQ+GhgYC+g8Dog8Dgj8GfkDQ2K82UUeUHlfesSBNH/ySWmeDAz1HeHyPB8QeT7A8yOq7w234QMC/8uPgyqBWYnA5R6I8Odg3owN7KXxdCCQ/Mi/8FoA8L5nLgd4HgeuigSyoQTvMyoPvMkHRr9A8nqgyL+U4MUAyeuBFH+pWaMHEG/t9/BTSZG5LhGg+d4hlA34ZuvIFwleDzh/GeCFAMnLAY7XA0dCfnwIfw+0iwdujgTGEbwe8LkS83oA83oA8npA4HHg2UzhI9M/Hli2yJ8V5yeFwAd0Hgd0ng/oPA7oPA4MqMlfS/M4wPN9ed4DOo8DOk8HdJ4KRPhbaB4Hbtd4YQC/dwj/z2eDeF6aDospvB4QeDD9x4/463zUs9Hs/wPADzqso5NiMAAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGEAAAGRCAMAAABCPS08AAAC+lBMVEUAAAAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyAjHyBEVICwAAAA/XRSTlMAAQP+Av0GBAUMCAr6/Af7Duf47vcLEA/5DQkR9HHxsST18xPq7NjWEsjcHzImFe0XHYVd69Xp9uLaKxuIvehNvDqf0OSUNRq7IPKywxTLREXJpGfSdkNgI+Nw33oc7+Aqwaalkzi5T88pOVqXozDAzKoxg6203dFXJ9cZIaB1eYrOUnS/oZ4/ZC7GRtm6Y6gvm7BZxGwlrKKrPZY+QcI0qeXed6eEeIu+0/DmfVC2xUe4aIHKtzMiLYw3S41JWFRIUX8WGDxAO3PHVtQo25ppSh5rQpVVh3JbtZhMgFOuZWHNkE6dhpyJbZmOLOFuj4JeXK9qZl9+s298kTZiAPKjDgAACxVJREFUeNrt3QOU9NqywPEK2pwe27atz7Zt27Zt27Zt89i29YQ60kxP6uGicpnfsua/0rtZ2ZmARqPRaDS8BBlUI8Z1mT/t1Z5xFrMIqjBM6L972eDDJxr1aFVbDypwlsbn4s9sWQnPFdiBm1C4fWqQhPhbY88pMzAL7J/twApSUNmnMrASNxdb0V3EtWRgNX67Dava1B84CW2aWhWFnLMCMApY56FTFKy9TMDI1H8rKiV0BEaGz7eRQr1yGRi1zEfishEYBWcj8bkFGGXGI5ERCIzOL0Tig0Jg1G8oEqEPgFGXR0gc7geMCouCSCGmFBg5W+4nhZyvZOAjzxlHCn7T9cDo8l0kivyBUeNDSCxNA0bnBiKxOgwYFXyBxMtzgVFiByQWDgJGKa11pDA4GRhZenqggrWrNzASLHcdioJHkR44CT1KsArbuHLeAjRei+6kqJopMrAKzByFbsKL++qBWWHzBL/KQNda7AEQfe6FRiNKiLqQIS8MCwAVBJS/2aOFX0TnFY/eLBBBHc4H5UlnVqWJoCbBaJRBo9FoGLARAnzjIv31AqhEEE0bMu9MutclQFSnoU+eHN82KjU1Kq9B6/GgAv9X63d2SfgTKTdmVmMRuPmOORqEFaLWPCsAs1YjvNCNxyt9gVfkBcVXy/xJArA6sgKr8ioLlIHTcTI/GXXQDpy6dUKFrS29gY9g3uRAhagL/pyFhkNQKfU9J/ART/chBc9qvsDHcGovKWTV5DwG45EYUijZaQI+9q9HkUKNdhbgYw7OI4X2L5mBj2WnByk8PKIHPt4fZ5HCuCQj8PEfsY8UWqSLwMe5KRwVpCHeAvDxibWigmOTAIwicyRUiAgFRoZVqagUXQ0Y6Qs86QvuAjAyhNFjSOgAjOTxdB36ZAInn6kuVCg+BZwsH5YoAn7NTMDJUJ6tfM8I5v7O/U4NdOfVIxGYFUx0fzo5VjcxAjNx4/qKDyGp3syLccDOvrlDr1HhOkRXXtkn50yghriNB7rX2VNndcaVQBHUIl9P8yW/sTQajUajUdGNJse273rxYqEeVGFMf2bAwuoL8mPLJn50xgD8/HvuXODCX8X8Z2MTcLP3m+WS8HchoY1l4CUkT7Ghm5DQ2swJe7Bir0POFBOw2txdMVpyJCSKwKn1CbJ96XkfYCR8GIUKXlPSgZF3dxuSXydtgFHd+kgKO8KAUb89tNCNtTCtKSm4aiYCo5XZpJDb8gYwyuhMCkHLA4HRrGhSqHczAPjIh7xQQYpuIwIbwb+pRCZLCQ2Bjzh2NF2GYs5lMDaOQTqOdgIf83+3JwWP497Ax/Ia3QjXeVEA8DF9TJ+s+U30wMe/mScp7E0WOQtrSEF3wl8APqZH5FEKfxk4BdCh/WcZwMkwl5w8aXoQOAmW7oqFCGrWEXiVzvBDN9KmSwbgZWrXx4EVdLF30oBb4vQh9X4/AK8Wk5OBn3/pyZwQLz8/rxCPuwcDQQ1i5LMZZY0aLTzbxFcUQB2CaPyJKINGo9H8VQmi3m636w0yqEO2jG3dLH7qkDcm9fMXQQ2JB2JCvKwOhysib8dYPfDbUC3Pir+yea6YFgnM5NNr3E+FWoufmIGV4HxNcYbvg1rAypyUb8Uq8l40A6eU4AhUeO80cApb5kKFGVeB06ASHSpk/zswMt5yoFLMHd7dgUgsmA6MardDYu9KYJQ8BYl5/YHRsIFIHGoCjG4WI9FtEDA6EovEgEJg9HonEtAVmYGPeZGNFPbtEoBPSkskEpoDo1W7kYgfA4xqVUNi5Hxg1GQkEhNrAaPeXZE4u0rtwq6GvGMAErDOsQOjDWvpk7W3AIxOZ5BPuLXngJN+eZYi4DcpHVgldat6ELbYngZgZZ69wOYWkEKeDwReQtylbFflEbSfnCbyz0pe3+GBv+pU5826IvAzbti1ZnD2uNj4oTtLA0EdAQ+mtbsT/HWSL2g0Go1GU0EQBFCTYI6s7aNeQh/WetaeFfPKJrYbZgA1pCwf+HaqhOjoFBv6uK4KjaffDs6t+CIz+rUuMvsCPK6uw0pbdyUCL8Ogpg5012KOGVj5D1SeLh5YAJzEujV0isLbi4CTs3cIKoTUFIDR+GvhZN6w2A6MJsx0odIbPsAo+aQfKSxLAUZdGjlUPoYlnXVkHbrJwGhzEL3EawAwMszWoVLJh8DIuzcS2zoAo8i31B60Fr6IRHwmMGozHIni3sCooCYS/7YRGCV1R2JxEjDqWR+J99oAo5t1kKiZBoxu90LighMY1VpNAq7jRmD06QBSaLsSOKVvl1Dh8OvAyUj/OeX6M8Aqcb2X4hTWcm9gZSmfEYGVpKCdq4CZeczgehUBW9SjJDNwM7w1or3rt9PSUweE6YGf0OU/DrffH+VRI3vLS2r9SBF8T/3L5GNXH+hBNbLd5OP0Ngqg0Wg0Go0bwXzDxwCqkZ+2emv6+/8anFmeotIn6LntRz1siLbPhjYfpBeAm+xfOrjiC1On0GFm9oT3rbY2rOA1da4deNlv37diJSn8aF/gFZZhRXdSyHdpwEl40gcV6vcDToaPyPwq554MjAJeQCXdM97AyPQKEl+mAyPfHUh8MRYYOZsh0aOAtTARiQFzgZH/B0gsTVJ7pavVAkbeNZFo1hMYWd5BYvFN1sJuJFbfYn5NE8taASPzcLW3qNmvIdHrCTDSd0CiuBQYGVsi0fUqayEYiRXTgJH4LRJ1zgMjYUwIKWxZB5yu3Ff53RuWkD2bns8EAqfIzGhJsQyzBeAkhK0Nd0/oPFYWAvecr1GQVBnwfG6CAOzndhu4KhdhZkMBuAn2YQeGWH/9+yP71xZBBfbEjc2Llm5Z32H55khQiSEuOen23HSTABqNRqPRVCUEWOwiqEb0vv709uxaY2s7DQKoIu1S/a25Vr9O84ITjaACy/kdbSNsEqIu16N65nVgZ8g8Go2/c4yeFAbcroysh5Wk0cec3Jc+TMxCd7r6zwIr4/wY5d6fs2bg5P1cFrl+sA1w8sm2okLTd4FTpIeECvktgZHcMZrup9gNjMT0VFKIWgqMhOsl5FEKGQqcfB46UMFrIXDybepFhrrxMjBynoxApT5OAfiYunmSQotEkXWYGEUKsaybsi3D95NCfiu9yvdh2Pa8GfjYW28jhbzHFuCjfzefFDy+NLHukYpV+a4hYlh1Utg31Af4CKZ4iRS2+AIjuX44eZTWsBZgd1v6z+xMwGlMI0VAimmlB05hIxSf1K5iiwCc5GOKZ9P95sBsfIYnumk7pSEwE5e83x4rPCxaIgA3fd92ZTmOX+/CeTL4jBH4CYHvDl9c1qDBnsUZF1NAJULddedf3TheBo1Go9FoCNWJcVe++m7Rk3QB1GGpdW3E3er3W8SHfrLBBCq4ca97ex3+zBYd2nyCDNx8Ws9wYYXR7eoCM/liAwndvD2HfRgXGqHYt9EKWNnnjJKUN3kXgJOJXFzrWPYUGMlp9KZ3Jw7yXr6bpfLt3AwTolUelckd6THk9hJZ7ydaQ0cS1Vlv7OpsEE4KMf9lBD7es+jMsnNmAPAJmFyDFEqGm4CP/vJDpMMHH9Zfiy1IwdUnhXVT9jzyZJKyJojA6JsgVAqabQFG72ylr7lFDYFR8Di6EEXpwOhqPCn4zWwDjJJ6kYL1m7HAKGUovXnFy32Bkbw+nBzD2mTgNJ0MXr0O1AZOt0LJ62G+CTjFve+FVYR37SgCJ7lJ1YPQLbhsBl6RL7lPLW0JGfzXdnZs3iBE9/sqVx/eF/iZGo/ILomw+uWmJpQ9TgM1CM7Sojqxo+fNvFQowB/sR3fzZ1hNAuriAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV8AAAFhCAMAAADgG1luAAAB0VBMVEUAAAAeGhseGhseGhseGhseGhseGhseGhseGhseGhseGhseGhseGhseGhseGhseGhseGhspIh1iSCWbby6ndi/UlTZ5WCluUCdMOSI1KR6QZyyyfjFAMSDJjTS9hjOEXypXQCMZFhYdGRoYFRYcGBkXFBUaFxgXFBUXFBUYFRYXFBUXFBUbGBkXFBUXFBUXFBUdGRoXFBUYFRYaFhcYFRYXFBUCAgIAAAAAAAAbFxgRDg8AAAAAAAAAAAAXFBUEAwQAAAAODA0AAAAWExQAAAAAAAAAAAALCQoAAAARDxAAAAAZFhcSEBEAAAAAAAATERIHBgcAAAASEBAMCwsAAAAJCAgCAgIUEhMGBQUPDQ4cGRkWFBQaFxcYFRUWExQVExMYFRYaFxgVExQUEhMFBQUSEBEUEhMSEBESEBESEBEbGBgUERITEBESEBESEBAWExMZFhYUEhIODA0SEBETEREIBwgSEBEUERETERESEBEXFBQTERIMCwsSEBESEBETERICAQISEBEJCAgODQ4QDg4GBQUKCQkLCgoODQ0QDg4SDxACAQEEBAQJCAgPDg4SEBADAwMNDAwBAQEIBwcMCwsRDw8HBgYLCgsRDxAMCwwJCAmWvDTPAAAAm3RSTlMAUI+//8+AcEAgEO8w359gr/////////////////////8w71D/gP+vEP/fMP/vYI//z5//YPufVAz/5793GP/Hs9+D95skPNdg66f/70hr78+P69sw08Pzy+P///////9A7///yyDPEJ/////zcP/////jMP/Tz//3j///30Df+8Ng1+/vz9/j7/f3w8vb8/vH68PX5/vT4/vn26R3OikAAApzSURBVHgB7NWFYcMwEIVhxTozM9Upd/8Ni0+loBm/DQR3PztrJ3H6ReaggKqBzjZ1GYpJtckcJAU0sNjm8HZ7YHNwFNhpwFbDsmlE5sETuBoYbAlcmjwO3gxj4NL8HfZ4MjFwSfCDMIrjOIIwgTSDnObNPuyxwPpiibLlRXy1MoKDJ7ihOTuIgdv24g2RtrSKO7WP4DaBTKBZkVWDNafQlyIeXhVBkcDdNJ/AaRxRwxTXO1EHMQgy8Gk4ptru+6bxjJUR9Nljz2BNmF9pq+J5qx+D2j2W71l9O7EdNvvDGGAJwcMjq02iD3m8OaVMfYKnZ1YXv7h9N1VC8PLGvj2sORdEURie/Gzb9m5bO7Z1//cS7RiFc6pn6xs3kjde9eTyytJXfm8ViMrWundhur7x4nsAQnW7HeBburu34Z2TXwOgrrVfEhE9WPj+M/RFmyJ1QUSXV8590b48QzxSsydL3z3wGd+BqdWz3ceLLejp2xXfF2r1arU+wNek5d4TMNHb+8cnfN0mk+kXtftmDgRNfY+AZ+4bonZh5siHoe8G8Cx8BTjKzWK6J4kl+Fr7CnCcWyWS+nkHvja+FxQS4TC3iqTg66i93vuzNnCapYzeF/OZSb+6vgIcZUn5JPz7V6s14Nn4CnCWu+WS6nkSvha+eZJCBe4VKfr2RftiRd06vlJJ6bsLPX1rI75llpRPwpgnPft+81AJHF+48H2kblEeLoB5/Ud9uQhfP23ofCOfk309zZPwTfNoAd/HF/A9o24VHivod16H763KNwNf723pfXOTfVeA58E3zOMFcXzh4PhN4gkVfR5fwPdF6ZvBvO65Xwa+MVe+8H3jCVUn+q4Bz3r+pbLe1/74Ar5k5Yt53bhdE9+AK1/MvzWD9w/4doB336i5b4O9u0iSqgvDIFy/u+LOAhjj7u7O/teB3p6gJyputj5nCQlt+X6RBd64/h3gu8x84R0a4XtnLr1O/z76HN/Hc/HF9/4I3yX0JP07zvefYb7e4RG+Z+j1Rq9Pz3wxG99Tn3vmi1T/nlp6vvD2DPA9T/+mev0BvnPxvdfzpX9nmy+8gwN8P5nf/sJ3+evqYT2Jb6t/8Y30r/li/O0d4XssmC9cVwf6F98n+Lb6N+CrbnRkTecL+neu+QLfp4leF9dYeacKvuIaazlf0L9zzRf4Pmv1r+vqhK+4xlrypX+j+UJcY+Jrvoj078bX6/jSv1ej+UJcY9Jn0XwhrrHx9S+9Tv8eL/mKa5xK41HiGv184bq60+v072V827hGM1/Qv/184bq617/iGvjmcQ18g+vqfr6gf/v5Qlyj1eviGvi2cY1uvqB/+/lCXKPVv66r8c3jGvj2+refL8Q1+vnCdTW+QVwD31z/9vOFuEY/X7iuxjfQv/gm+hffPq7RzhfiGsF8Ia6R63X6F98+rtHPF/RvNl+Ia/T6V1wD3z6ugW+vf/v5Qlyjny9cV+MbxDXwzfRvPl+IawzMFx79i6+4xsT3EHpBXCOfL8Q1zBf0+kaNa+DbxzUmvgfQC+Ia/XzhuhrfKq6Bbx/XmPj+B16gf7v5wnV1P1+Ia/R6XVwD3/S6euK7C71A/3bzhbhGr9fFNfDt4xrmi1b/pvOFuIb5or6uLvmKa+Db6t92vhDX+J3+ba+rU77iGvi2+redL8Q1zBftdfUv+Pb6F99E//Z8xTXa+UJc4/tU/4pr0Oud/u35imuYL1r9m84X4hqLP0q+4hqtXhfXwLfVv+18Ia5hvoivq1O+4hr4tvq3nS/ENcwXrf7dqPMFvS6u0fMV12jnC3GNjTpf0OviGj1fcY12vhDXMF+019XpfCGu0ep1cQ18W/1rvsiuq80Xgf493et1cQ18++tq80Wvf/P5QlyjnS/ENVq9Lq6Bb6t/2/lCXGPp+YL+fT6kJ1O+4hr4tvp3eL7w/huPa5gv+uvqfr4Q16DXQ/3b8xXXMF+019Xmi17/4tvo356vuEY7X4hrmC9a/Wu+6PUvvkPv/xG+V3q+4hr9fCGu0c8X4hq5XhfXwLfVv+l8Ia5hvoivq9P5QlyDXm/1L75L830xztd8Uenf4fnC27a+9Dr92/MV12jnC3EN80Wr19v5Qlyj0+viGj1fcQ0fLd1eV5fzhbjG8nod30vj+hffSv9OfPeiN/t1tfki0L93+/lCXINe76+r8Y31+vRSPSmu0c4X4hr0entdjW+qfye+e9CL4hrtfCGuUcwX4hr0eqB/e77iGjdXd75wXf13yldcg17v9G/PV1zDfNFeV2/Q+YL+pX97vuIa+LbX1eaLVv/+1vOlf/HN4hr4NnGNfr4Q1+jnC3EN+reNa+Db6l98m7hGP1+4ru7nC3ENer3Wv/gGcY1+vqB/+/lCXIP+7fUvvl1cA98mrtHPF/R6P1+Ia9DrbVwD3yau0c8Xrqv7+UJcg/5t4xr4tvoX3+a6up8vxDX6+UJcg15vr6vxTfR6P1+Ia/TzhbgG/dteV+Pb6l9827jGxPcgfE1cw//fNq4x8d0GX6N/Fz/47M0yrrH4u9wvXFcv/vENooxrrNQR9+OX6N/F4t8fffpmF9eYBs7BX9Hos5dnh66rP/0N4sf/Br4FixOceHV2WE9O788PfEngN+zcy07CQACF4S4mcY2SWoogi6ZJExaTsGzC2kTfoNpRULHFW6WqeFdf3GJPR5NBHCpgi3yP8A/JaQqMzJ+Ptx0EluuLCxKhpFcWHUc//u44CCx5uQaegTlN1YuwSDrk7hLXdVBY7tfVQmBRQYOaCvwI/tHHvUQGTBeBZV9PioFTEY5gvQjVeXr5SxzmxoWbsn1hiZIpW9NATRShnJvvjg3GeODRl2sIdvfInytpsMqPIBtjUC6QD602i8SB9+0hlO8dHDYoyTw+BssqrEx/DHQS22xHksC2dF/oHHkty6z7PiX5NuE9rmokZnS7n4GPx+kLJ97AKcfgzIJzH/J+BHwMftrjil4jQINuJAl8kaKv0ttCYWkBA+EIDJJnGIMC4SgLwyRw5FLm9Zmgc4XAE3TNoGmBnyD5YQRhiMARdmOP2xf6CDxTIYNbC8yMHYF553lfA9+n7as8PCJwtohj0JjdGFDXGwh54afnNH3hJaOF04/B747AaHrAA7/aQ20ocnr9NwSeN4E4BiP3mNattpfggd/bq5udBoEwCsPfXUHyQUIM0xASJplk9q6Jd+AWQdQRa1WrXq2bUzeTlt8gpfNcwnsW544H9wWPuYQK7mt4WGV5+49vr29yABR+fBrRFwJuZ0p4rqCGZh2pcwAEfjE8ti8Cj7e1Jnit4VwL/+W1aZo9cLtdCW8VvNfwscDAzZbH9gWPF6OEz/nPIAfY73h8X9ARnw9z9I+b6QIXhk8R1E8Y85rYZ1AfdCn89W34NOrLD/iC2GeAPy6KYv9juE1M/XnclSNpABFxN86GhvBj7sJJaSDJHTgJDaVTbuNEPg2XtRV2MhpFSMXHOYomoCEBqSC9+HPzaRZCg5eAgphXLBK0GKE1wZUCl3cevoYsgUBBxMsTh7Q+Gjb/fgbSp8sk7D+e/gyUIKfHGagD7iAKXN3pzwB/LL3WuL982dJu0QZjhAAAAABJRU5ErkJggg=="},function(e,t,i){var n,r,o,c={},l=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=n.apply(this,arguments)),r}),a=(o={},function(e,t){if("function"==typeof e)return e();if(void 0===o[e]){var n=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}o[e]=n}return o[e]}),u=null,h=0,s=[],d=i(189);function p(e,t){for(var n=0;n<e.length;n++){var i=e[n],r=c[i.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](i.parts[o]);for(;o<i.parts.length;o++)r.parts.push(A(i.parts[o],t))}else{var a=[];for(o=0;o<i.parts.length;o++)a.push(A(i.parts[o],t));c[i.id]={id:i.id,refs:1,parts:a}}}}function f(e,t){for(var n=[],i={},r=0;r<e.length;r++){var o=e[r],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};i[a]?i[a].parts.push(s):n.push(i[a]={id:a,parts:[s]})}return n}function m(e,t){var n=a(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=s[s.length-1];if("top"===e.insertAt)i?i.nextSibling?n.insertBefore(t,i.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),s.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=a(e.insertAt.before,n);n.insertBefore(t,r)}}function v(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=s.indexOf(e);0<=t&&s.splice(t,1)}function g(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=i.nc;n&&(e.attrs.nonce=n)}return y(t,e.attrs),m(e,t),t}function y(t,n){Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])})}function A(t,e){var n,i,r,o,a,s;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var c=h++;n=u=u||g(e),i=x.bind(null,n,c,!1),r=x.bind(null,n,c,!0)}else r=t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(a=e,s=document.createElement("link"),void 0===a.attrs.type&&(a.attrs.type="text/css"),a.attrs.rel="stylesheet",y(s,a.attrs),m(a,s),i=function(e,t,n){var i=n.css,r=n.sourceMap,o=void 0===t.convertToAbsoluteUrls&&r;(t.convertToAbsoluteUrls||o)&&(i=d(i)),r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([i],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n=s,e),function(){v(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(e),i=function(e,t){var n=t.css,i=t.media;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),function(){v(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}e.exports=function(e,a){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(a=a||{}).attrs="object"==typeof a.attrs?a.attrs:{},a.singleton||"boolean"==typeof a.singleton||(a.singleton=l()),a.insertInto||(a.insertInto="head"),a.insertAt||(a.insertAt="bottom");var s=f(e,a);return p(s,a),function(e){for(var t=[],n=0;n<s.length;n++){var i=s[n];(r=c[i.id]).refs--,t.push(r)}for(e&&p(f(e,a),a),n=0;n<t.length;n++){var r;if(0===(r=t[n]).refs){for(var o=0;o<r.parts.length;o++)r.parts[o]();delete c[r.id]}}}};var b,w=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function x(e,t,n,i){var r=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=w(t,r);else{var o=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,o=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var n,i=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(n=0===i.indexOf("//")?i:0===i.indexOf("/")?r+i:o+i.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")})}},function(e,t,n){"use strict";n.r(t),n(87),n(100),n(109),n(49),n(50),n(119),n(123),n(127),n(128),n(84);function Se(e,t){var n=0,i=t();e.forEach(function(e){setTimeout(function(){i.next()},n+=e)})}var k=["THE FASTER YOU TRAVEL, THE LONGER IT TAKES TO BRING YOUR VEHICLE \n\tTO A STOP <br/><br/>WET CONDITIONS AND UNSEALED ROADS INCREASE \n\tTHE TIME IT TAKES TO STOP.","DURING BRAKING, THE OPERATING TEMPERATURES OF BRAKING COMPONENTS \n\tCAN AVERAGE AS MUCH AS 350 CELSIUS.","TODAYS BRAKE PAD LININGS ARE MANUFACTURED USING ENVIRONMENTALLY \n\tSAFE MATERIALS AND NO LONGER CONTAIN HARMFUL AGENTS LIKE ASBESTOS, \n\tLEAD, OR CADMIUM.","THE HYDRAULIC BRAKE SYSTEM, NOW USED ON NEARLY ALL VEHICLES, WAS \n\tFIRST USED ON THE 1920 DUESENBERG, AN AMERICAN LUXURY CAR, BEFORE \n\tBEING USED BY CHRYSLER IN MASS-PRODUCED CARS BEGINNING IN 1924.","ANTILOCK BRAKES WERE INVENTED IN BRITAIN IN 1958 AND FIRST TESTED \n\tON MOTORCYCLES, INITIALLY USED IN VEHICLE PRODUCTION IN 1966, AND \n\tWERE ORIGINALLY CONSIDERED TOO EXPENSIVE FOR MOST AUTOMAKERS FOR \n\tMANY YEARS."],E={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},T={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},i=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],d={CSS:{},springs:{}};function S(e,t,n){return Math.min(Math.max(e,t),n)}function h(e,t){return-1<e.indexOf(t)}function o(e,t){return e.apply(null,t)}var C={arr:function(e){return Array.isArray(e)},obj:function(e){return h(Object.prototype.toString.call(e),"Object")},pth:function(e){return C.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return e.nodeType||C.svg(e)},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return void 0===e},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return C.hex(e)||C.rgb(e)||C.hsl(e)},key:function(e){return!E.hasOwnProperty(e)&&!T.hasOwnProperty(e)&&"targets"!==e&&"keyframes"!==e}};function p(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(e){return parseFloat(e)}):[]}function a(r,n){var e=p(r),t=S(C.und(e[0])?1:e[0],.1,100),i=S(C.und(e[1])?100:e[1],.1,100),o=S(C.und(e[2])?10:e[2],.1,100),a=S(C.und(e[3])?0:e[3],.1,100),s=Math.sqrt(i/t),c=o/(2*Math.sqrt(i*t)),l=c<1?s*Math.sqrt(1-c*c):0,u=c<1?(c*s-a)/l:-a+s;function h(e){var t=n?n*e/1e3:e;return t=c<1?Math.exp(-t*c*s)*(1*Math.cos(l*t)+u*Math.sin(l*t)):(1+u*t)*Math.exp(-t*s),0===e||1===e?e:1-t}return n?h:function(){var e=d.springs[r];if(e)return e;for(var t=0,n=0;;)if(1===h(t+=1/6)){if(16<=++n)break}else n=0;var i=t*(1/6)*1e3;return d.springs[r]=i}}function s(e,t){void 0===e&&(e=1),void 0===t&&(t=.5);var n=S(e,1,10),i=S(t,.1,2);return function(e){return 0===e||1===e?e:-n*Math.pow(2,10*(e-1))*Math.sin((e-1-i/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/i)}}function c(t){return void 0===t&&(t=10),function(e){return Math.round(e*t)*(1/t)}}var l=function(o,t,a,n){if(0<=o&&o<=1&&0<=a&&a<=1){var s=new Float32Array(11);if(o!==t||a!==n)for(var e=0;e<11;++e)s[e]=v(.1*e,o,a);return function(e){return o===t&&a===n?e:0===e||1===e?e:v(function(e){for(var t=0,n=1;10!==n&&s[n]<=e;++n)t+=.1;var i=t+(e-s[--n])/(s[n+1]-s[n])*.1,r=g(i,o,a);return.001<=r?function(e,t,n,i){for(var r=0;r<4;++r){var o=g(t,n,i);if(0===o)return t;t-=(v(t,n,i)-e)/o}return t}(e,i,o,a):0===r?i:function(e,t,n,i,r){for(var o,a,s=0;0<(o=v(a=t+(n-t)/2,i,r)-e)?n=a:t=a,1e-7<Math.abs(o)&&++s<10;);return a}(e,t,t+.1,o,a)}(e),t,n)}}},u=function(){function e(n){t[n].forEach(function(e,t){r["ease"+n+i[t]]=e})}var i=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],t={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],s],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(t,n){return function(e){return 1-s(t,n)(1-e)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(t,n){return function(e){return e<.5?s(t,n)(2*e)/2:1-s(t,n)(-2*e+2)/2}}]},r={linear:[.25,.25,.75,.75]};for(var n in t)e(n);return r}();function r(e,t){return 1-3*t+3*e}function f(e,t){return 3*t-6*e}function m(e){return 3*e}function v(e,t,n){return((r(t,n)*e+f(t,n))*e+m(t))*e}function g(e,t,n){return 3*r(t,n)*e*e+2*f(t,n)*e+m(t)}function M(e,t){if(C.fnc(e))return e;var n=e.split("(")[0],i=u[n],r=p(e);switch(n){case"spring":return a(e,t);case"cubicBezier":return o(l,r);case"steps":return o(c,r);default:return C.fnc(i)?o(i,r):o(l,i)}}function y(e){try{return document.querySelectorAll(e)}catch(e){return}}function L(e,t){for(var n=e.length,i=2<=arguments.length?t:void 0,r=[],o=0;o<n;o++)if(o in e){var a=e[o];t.call(i,a,o,e)&&r.push(a)}return r}function _(e){return e.reduce(function(e,t){return e.concat(C.arr(t)?_(t):t)},[])}function A(e){return C.arr(e)?e:(C.str(e)&&(e=y(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function b(e,t){return e.some(function(e){return e===t})}function w(e){var t={};for(var n in e)t[n]=e[n];return t}function B(e,t){var n=w(e);for(var i in e)n[i]=t.hasOwnProperty(i)?t[i]:e[i];return n}function R(e,t){var n=w(e);for(var i in t)n[i]=C.und(e[i])?t[i]:e[i];return n}function P(e){var t=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[2]}function x(e,t){return C.fnc(e)?e(t.target,t.id,t.total):e}function D(e,t){return e.getAttribute(t)}function I(e,t,n){if(b([n,"deg","rad","turn"],P(t)))return t;var i=d.CSS[t+n];if(!C.und(i))return i;var r=document.createElement(e.tagName),o=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;o.appendChild(r),r.style.position="absolute",r.style.width=100+n;var a=100/r.offsetWidth;o.removeChild(r);var s=a*parseFloat(t);return d.CSS[t+n]=s}function O(e,t,n){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return n?I(e,r,n):r}}function j(e,t){return C.dom(e)&&!C.inp(e)&&(D(e,t)||C.svg(e)&&e[t])?"attribute":C.dom(e)&&b(i,t)?"transform":C.dom(e)&&"transform"!==t&&O(e,t)?"css":null!=e[t]?"object":void 0}function H(e){if(C.dom(e)){for(var t,n=e.style.transform||"",i=/(\w+)\(([^)]*)\)/g,r=new Map;t=i.exec(n);)r.set(t[1],t[2]);return r}}function F(e,t,n,i){switch(j(e,t)){case"transform":return r=e,a=i,s=n,l=h(o=t,"scale")?1:0+(h(c=o,"translate")||"perspective"===c?"px":h(c,"rotate")||h(c,"skew")?"deg":void 0),u=H(r).get(o)||l,a&&(a.transforms.list.set(o,u),a.transforms.last=o),s?I(r,u,s):u;case"css":return O(e,t,n);case"attribute":return D(e,t);default:return e[t]||0}var r,o,a,s,c,l,u}function N(e,t){var n=/^(\*=|\+=|-=)/.exec(e);if(!n)return e;var i=P(e)||0,r=parseFloat(t),o=parseFloat(e.replace(n[0],""));switch(n[0][0]){case"+":return r+o+i;case"-":return r-o+i;case"*":return r*o+i}}function z(e,t){if(C.col(e))return n=e,C.rgb(n)?(a=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(o=n))?"rgba("+a[1]+",1)":o:C.hex(n)?(i=n.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,i){return t+t+n+n+i+i}),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i),"rgba("+parseInt(r[1],16)+","+parseInt(r[2],16)+","+parseInt(r[3],16)+",1)"):C.hsl(n)?function(e){var t,n,i,r=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),o=parseInt(r[1],10)/360,a=parseInt(r[2],10)/100,s=parseInt(r[3],10)/100,c=r[4]||1;function l(e,t,n){return n<0&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(0==a)t=n=i=s;else{var u=s<.5?s*(1+a):s+a-s*a,h=2*s-u;t=l(h,u,o+1/3),n=l(h,u,o),i=l(h,u,o-1/3)}return"rgba("+255*t+","+255*n+","+255*i+","+c+")"}(n):void 0;var n,i,r,o,a,s=P(e),c=s?e.substr(0,e.length-s.length):e;return t&&!/\s/g.test(e)?c+t:c}function U(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function G(e){for(var t,n=e.points,i=0,r=0;r<n.numberOfItems;r++){var o=n.getItem(r);0<r&&(i+=U(t,o)),t=o}return i}function V(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return r=e,2*Math.PI*D(r,"r");case"rect":return 2*D(i=e,"width")+2*D(i,"height");case"line":return U({x:D(n=e,"x1"),y:D(n,"y1")},{x:D(n,"x2"),y:D(n,"y2")});case"polyline":return G(e);case"polygon":return t=e.points,G(e)+U(t.getItem(t.numberOfItems-1),t.getItem(0))}var t,n,i,r}function W(t,e){var n=e||{},i=n.el||function(){for(var e=t.parentNode;C.svg(e)&&(e=e.parentNode,C.svg(e.parentNode)););return e}(),r=i.getBoundingClientRect(),o=D(i,"viewBox"),a=r.width,s=r.height,c=n.viewBox||(o?o.split(" "):[0,0,a,s]);return{el:i,viewBox:c,x:c[0]/1,y:c[1]/1,w:a/c[2],h:s/c[3]}}function q(n,i){function e(e){void 0===e&&(e=0);var t=1<=i+e?i+e:0;return n.el.getPointAtLength(t)}var t=W(n.el,n.svg),r=e(),o=e(-1),a=e(1);switch(n.property){case"x":return(r.x-t.x)*t.w;case"y":return(r.y-t.y)*t.h;case"angle":return 180*Math.atan2(a.y-o.y,a.x-o.x)/Math.PI}}function X(e,t){var n=/-?\d*\.?\d+/g,i=z(C.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(n)?i.match(n).map(Number):[0],strings:C.str(e)||t?i.split(n):[]}}function Q(e){return L(e?_(C.arr(e)?e.map(A):A(e)):[],function(e,t,n){return n.indexOf(e)===t})}function Y(e){var n=Q(e);return n.map(function(e,t){return{target:e,id:t,total:n.length,transforms:{list:H(e)}}})}function Z(e,i){var t=w(i);if(/^spring/.test(t.easing)&&(t.duration=a(t.easing)),C.arr(e)){var n=e.length;2!==n||C.obj(e[0])?C.fnc(i.duration)||(t.duration=i.duration/n):e={value:e}}var r=C.arr(e)?e:[e];return r.map(function(e,t){var n=C.obj(e)&&!C.pth(e)?e:{value:e};return C.und(n.delay)&&(n.delay=t?0:i.delay),C.und(n.endDelay)&&(n.endDelay=t===r.length-1?i.endDelay:0),n}).map(function(e){return R(e,t)})}var K={css:function(e,t,n){return e.style[t]=n},attribute:function(e,t,n){return e.setAttribute(t,n)},object:function(e,t,n){return e[t]=n},transform:function(e,t,n,i,r){if(i.list.set(t,n),t===i.last||r){var o="";i.list.forEach(function(e,t){o+=t+"("+e+") "}),e.style.transform=o}}};function J(e,c){Y(e).forEach(function(e){for(var t in c){var n=x(c[t],e),i=e.target,r=P(n),o=F(i,t,r,e),a=N(z(n,r||P(o)),o),s=j(i,t);K[s](i,t,a,e.transforms,!0)}})}function $(e,n){return L(_(e.map(function(t){return n.map(function(e){return function(e,t){var u,h,d,n=j(e.target,t.name);if(n){var i=(h=e,(u=t).tweens.map(function(e){var t=function(e,t){var n={};for(var i in e){var r=x(e[i],t);C.arr(r)&&1===(r=r.map(function(e){return x(e,t)})).length&&(r=r[0]),n[i]=r}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}(e,h),n=t.value,i=C.arr(n)?n[1]:n,r=P(i),o=F(h.target,u.name,r,h),a=d?d.to.original:o,s=C.arr(n)?n[0]:a,c=P(s)||P(o),l=r||c;return C.und(i)&&(i=a),t.from=X(s,l),t.to=X(N(i,s),l),t.start=d?d.end:0,t.end=t.start+t.delay+t.duration+t.endDelay,t.easing=M(t.easing,t.duration),t.isPath=C.pth(n),t.isColor=C.col(t.from.original),t.isColor&&(t.round=1),d=t})),r=i[i.length-1];return{type:n,property:t.name,animatable:e,tweens:i,duration:r.end,delay:i[0].delay,endDelay:r.endDelay}}}(t,e)})})),function(e){return!C.und(e)})}function ee(e,t){function n(e){return e.timelineOffset?e.timelineOffset:0}var i=e.length,r={};return r.duration=i?Math.max.apply(Math,e.map(function(e){return n(e)+e.duration})):t.duration,r.delay=i?Math.min.apply(Math,e.map(function(e){return n(e)+e.delay})):t.delay,r.endDelay=i?r.duration-Math.max.apply(Math,e.map(function(e){return n(e)+e.duration-e.endDelay})):t.endDelay,r}var te,ne=0,ie=[],re=[],oe=ae;function ae(){te=requestAnimationFrame(se)}function se(e){var t=ie.length;if(t){for(var n=0;n<t;){var i=ie[n];if(i.paused){var r=ie.indexOf(i);-1<r&&(ie.splice(r,1),t=ie.length)}else i.tick(e);n++}ae()}else te=cancelAnimationFrame(te)}function ce(e){void 0===e&&(e={});var o,a=0,s=0,c=0,l=0,u=null;function h(e){var t=window.Promise&&new Promise(function(e){return u=e});return e.finished=t}var t,n,i,r,d,p,f,m,M=(n=B(E,t=e),i=B(T,t),r=function(e,t){var n=[],i=t.keyframes;for(var r in i&&(t=R(function(t){for(var n=L(_(t.map(function(e){return Object.keys(e)})),function(e){return C.key(e)}).reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[]),r={},e=function(e){var i=n[e];r[i]=t.map(function(e){var t={};for(var n in e)C.key(n)?n==i&&(t.value=e[n]):t[n]=e[n];return t})},i=0;i<n.length;i++)e(i);return r}(i),t)),t)C.key(r)&&n.push({name:r,tweens:Z(t[r],e)});return n}(i,t),d=Y(t.targets),p=$(d,r),f=ee(p,i),m=ne,ne++,R(n,{id:m,children:[],animatables:d,animations:p,duration:f.duration,delay:f.delay,endDelay:f.endDelay}));function v(){var e=M.direction;"alternate"!==e&&(M.direction="normal"!==e?"normal":"reverse"),M.reversed=!M.reversed,o.forEach(function(e){return e.reversed=M.reversed})}function g(e){return M.reversed?M.duration-e:e}function y(){a=0,s=g(M.currentTime)*(1/ce.speed)}function A(e,t){t&&t.seek(e-t.timelineOffset)}function b(t){for(var e=0,n=M.animations,i=n.length;e<i;){var r=n[e],o=r.animatable,a=r.tweens,s=a.length-1,c=a[s];s&&(c=L(a,function(e){return t<e.end})[0]||c);for(var l=S(t-c.start-c.delay,0,c.duration)/c.duration,u=isNaN(l)?1:c.easing(l),h=c.to.strings,d=c.round,p=[],f=c.to.numbers.length,m=void 0,v=0;v<f;v++){var g=void 0,y=c.to.numbers[v],A=c.from.numbers[v]||0;g=c.isPath?q(c.value,u*y):A+u*(y-A),d&&(c.isColor&&2<v||(g=Math.round(g*d)/d)),p.push(g)}var b=h.length;if(b){m=h[0];for(var w=0;w<b;w++){h[w];var x=h[w+1],E=p[w];isNaN(E)||(m+=x?E+x:E+" ")}}else m=p[0];K[r.type](o.target,r.property,m,o.transforms),r.currentValue=m,e++}}function w(e){M[e]&&!M.passThrough&&M[e](M)}function x(e){var t=M.duration,n=M.delay,i=t-M.endDelay,r=g(e);M.progress=S(r/t*100,0,100),M.reversePlayback=r<M.currentTime,o&&function(e){if(M.reversePlayback)for(var t=l;t--;)A(e,o[t]);else for(var n=0;n<l;n++)A(e,o[n])}(r),!M.began&&0<M.currentTime&&(M.began=!0,w("begin"),w("loopBegin")),r<=n&&0!==M.currentTime&&b(0),(i<=r&&M.currentTime!==t||!t)&&b(t),n<r&&r<i?(M.changeBegan||(M.changeBegan=!0,M.changeCompleted=!1,w("changeBegin")),w("change"),b(r)):M.changeBegan&&(M.changeCompleted=!0,M.changeBegan=!1,w("changeComplete")),M.currentTime=S(r,0,t),M.began&&w("update"),t<=e&&(s=0,M.remaining&&!0!==M.remaining&&M.remaining--,M.remaining?(a=c,w("loopComplete"),w("loopBegin"),"alternate"===M.direction&&v()):(M.paused=!0,M.completed||(M.completed=!0,w("loopComplete"),w("complete"),!M.passThrough&&"Promise"in window&&(u(),h(M)))))}return h(M),M.reset=function(){var e=M.direction;M.passThrough=!1,M.currentTime=0,M.progress=0,M.paused=!0,M.began=!1,M.changeBegan=!1,M.completed=!1,M.changeCompleted=!1,M.reversePlayback=!1,M.reversed="reverse"===e,M.remaining=M.loop,o=M.children;for(var t=l=o.length;t--;)M.children[t].reset();(M.reversed&&!0!==M.loop||"alternate"===e&&1===M.loop)&&M.remaining++,b(0)},M.set=function(e,t){return J(e,t),M},M.tick=function(e){x(((c=e)+(s-(a=a||c)))*ce.speed)},M.seek=function(e){x(g(e))},M.pause=function(){M.paused=!0,y()},M.play=function(){M.paused&&(M.completed&&M.reset(),M.paused=!1,ie.push(M),y(),te||oe())},M.reverse=function(){v(),y()},M.restart=function(){M.reset(),M.play()},M.reset(),M.autoplay&&M.play(),M}function le(e,t){for(var n=t.length;n--;)b(e,t[n].animatable.target)&&t.splice(n,1)}"undefined"!=typeof document&&document.addEventListener("visibilitychange",function(){document.hidden?(ie.forEach(function(e){return e.pause()}),re=ie.slice(0),ie=[]):re.forEach(function(e){return e.play()})}),ce.version="3.0.1",ce.speed=1,ce.running=ie,ce.remove=function(e){for(var t=Q(e),n=ie.length;n--;){var i=ie[n],r=i.animations,o=i.children;le(t,r);for(var a=o.length;a--;){var s=o[a],c=s.animations;le(t,c),c.length||s.children.length||o.splice(a,1)}r.length||o.length||i.pause()}},ce.get=F,ce.set=J,ce.convertPx=I,ce.path=function(e,t){var n=C.str(e)?y(e)[0]:e,i=t||100;return function(e){return{property:e,el:n,svg:W(n),totalLength:V(n)*(i/100)}}},ce.setDashoffset=function(e){var t=V(e);return e.setAttribute("stroke-dasharray",t),t},ce.stagger=function(e,t){void 0===t&&(t={});var l=t.direction||"normal",u=t.easing?M(t.easing):null,h=t.grid,d=t.axis,p=t.from||0,f="first"===p,m="center"===p,v="last"===p,g=C.arr(e),y=g?parseFloat(e[0]):parseFloat(e),A=g?parseFloat(e[1]):0,b=P(g?e[1]:e)||0,w=t.start||0+(g?y:0),x=[],E=0;return function(e,t,n){if(f&&(p=0),m&&(p=(n-1)/2),v&&(p=n-1),!x.length){for(var i=0;i<n;i++){if(h){var r=m?(h[0]-1)/2:p%h[0],o=m?(h[1]-1)/2:Math.floor(p/h[0]),a=r-i%h[0],s=o-Math.floor(i/h[0]),c=Math.sqrt(a*a+s*s);"x"===d&&(c=-a),"y"===d&&(c=-s),x.push(c)}else x.push(Math.abs(p-i));E=Math.max.apply(Math,x)}u&&(x=x.map(function(e){return u(e/E)*E})),"reverse"===l&&(x=x.map(function(e){return d?e<0?-1*e:-e:Math.abs(E-e)}))}return w+(g?(A-y)/E:y)*(Math.round(100*x[t])/100)+b}},ce.timeline=function(u){void 0===u&&(u={});var h=ce(u);return h.duration=0,h.add=function(e,t){var n=ie.indexOf(h),i=h.children;function r(e){e.passThrough=!0}-1<n&&ie.splice(n,1);for(var o=0;o<i.length;o++)r(i[o]);var a=R(e,B(T,u));a.targets=a.targets||u.targets;var s=h.duration;a.autoplay=!1,a.direction=h.direction,a.timelineOffset=C.und(t)?s:N(t,s),r(h),h.seek(a.timelineOffset);var c=ce(a);r(c),i.push(c);var l=ee(i,u);return h.delay=l.delay,h.endDelay=l.endDelay,h.duration=l.duration,h.seek(0),h.reset(),h.autoplay&&h.play(),h},h},ce.easing=M,ce.penner=u,ce.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};function Ce(e){document.getElementById("vehicle-root").emit("brake"),AFRAME.utils.device.isMobile()?document.querySelector("body").removeEventListener("touchstart",Ce):document.querySelector("body").removeEventListener("click",Ce)}function Le(e){32===e.keyCode&&(document.getElementById("vehicle-root").emit("brake"),document.removeEventListener("keyup",Le))}function _e(e){document.getElementById("vehicle-root").emit("brake"),AFRAME.utils.device.isMobile()?document.querySelector("body").removeEventListener("touchstart",_e):document.querySelector("body").removeEventListener("click",_e)}function Be(e){32===e.keyCode&&(document.getElementById("vehicle-root").emit("brake"),document.removeEventListener("keyup",Be))}function Re(e){document.getElementById("vehicle-root").emit("brake"),AFRAME.utils.device.isMobile()?document.querySelector("body").removeEventListener("touchstart",Re):document.querySelector("body").removeEventListener("click",Re)}function Pe(e){32===e.keyCode&&(document.getElementById("vehicle-root").emit("brake"),document.removeEventListener("keyup",Pe))}var De=ce;AFRAME.registerSystem("scene-manager",{init:function(){var Te=this;this.state={selectedSpeed:40,selectedVehicle:"sedan",reactionDistance:0,brakingDistance:0,reactionTime:0,impactSpeed:0,selectedScenario:"regional",increment:0,cubeMap:null},this.el.sceneEl.renderer.gammaFactor=2.2,this.el.addEventListener("scene-change",function(e){function t(){document.getElementById("dustbowl").setAttribute("visible",!1),document.getElementById("urban").setAttribute("visible",!1),document.getElementById("regional").setAttribute("visible",!1),document.getElementById("cow").setAttribute("visible",!1),document.getElementById("roo").setAttribute("visible",!1),document.getElementById("civilian").setAttribute("visible",!1);var e=document.querySelector("body");switch(Te.state.selectedScenario){case"regional":document.getElementById("regional").setAttribute("visible",!0),e.className="",e.classList.add("regional-background"),document.getElementById("cow").setAttribute("visible",!0);break;case"unsealed":document.getElementById("dustbowl").setAttribute("visible",!0),e.className="",e.classList.add("unsealed-background"),document.getElementById("roo").setAttribute("visible",!0);break;case"city":document.getElementById("urban").setAttribute("visible",!0),e.className="",e.classList.add("city-background"),document.getElementById("civilian").setAttribute("visible",!0);break;case"wet":document.getElementById("urban").setAttribute("visible",!0),e.className="",e.classList.add("wet-background"),document.getElementById("civilian").setAttribute("visible",!0);break;default:document.getElementById("urban").setAttribute("visible",!0)}document.getElementById("vehicle-root").components.stop.hasBraked=!1;var t=document.getElementById("simulation");t.setAttribute("simulation","vehicle","#vehicle-root"),t.components.simulation.reset(),t.setAttribute("simulation","speed",Te.state.selectedSpeed),t.setAttribute("simulation","state","driving"),t.setAttribute("simulation","scenario",Te.state.selectedScenario),Te.state.increment+=1,t.setAttribute("simulation","increment",Te.state.increment)}var r,n,o,a,s,c,l,u,h,d,p,f,i,m,v,g,y,A,b,w,x,E,M,T,S,C,L,_,B,R,P,D,I,O,k,j,H,F,N,z,U,G,V,W,q,X,Q,Y,Z,K,J,$,ee,te,ne,ie,re,oe,ae,se,ce,le,ue,he,de,pe,fe,me,ve,ge,ye,Ae,be,we,xe,Ee,Me;switch(e.detail.nextScene){case"#scene-two":return r=document.getElementById("scene-one"),n=document.getElementById("scene-two"),o=document.getElementById("speedo-ui-container"),a=document.getElementById("test-yourself"),s=document.getElementById("start-ui-did-you-know-container"),c=document.getElementById("start-button"),l=document.getElementById("volume-on"),u=document.getElementById("vehicle-title"),h=document.getElementById("stop-it-title"),d=document.getElementById("vehicle-ui-icons"),p=document.getElementById("vehicle-ui-container-right"),f=document.getElementById("start-ignition-sound-container"),i=document.getElementById("start-light"),m=document.getElementById("start-point-light"),v=document.getElementById("sedan"),document.getElementById("truck"),g=document.getElementById("anchor"),y=document.getElementById("link_a"),A=document.getElementById("link_b"),b=document.getElementById("link_c"),w=document.getElementById("backdrop_left").getObject3D("mesh"),x=document.getElementById("backdrop_right").getObject3D("mesh"),E=document.getElementById("backdrop_left"),M=document.getElementById("backdrop_right"),T=document.getElementById("backdrop"),S=document.getElementById("camera-rig"),C=document.getElementById("camera"),Se([0,250,100,750,500,1e3],regeneratorRuntime.mark(function e(){var t,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.classList.remove("clickable"),t=new De.timeline({easing:"easeInOutQuad",duration:1e3}),n=new AFRAME.THREE.Color("rgb(41,80,255)"),i=new AFRAME.THREE.Color("rgb(255, 41, 80)"),t.add({targets:[x.material.color],r:i.r,g:i.g,b:i.b,duration:2500}).add({targets:[w.material.color],r:n.r,g:n.g,b:n.b,duration:2500},0).add({targets:g.object3D.rotation,duration:900,easing:"easeInOutElastic",x:.0174533*-20,y:0,z:0},0).add({targets:y.object3D.position,duration:900,x:2.5,y:.5,z:1.627,easing:"easeInOutElastic"},0).add({targets:E.object3D.position,x:-12.5},750).add({targets:M.object3D.position,x:12.5},750).add({targets:T.object3D.rotation,z:-.2792528},800).add({targets:S.object3D.position,x:0,y:1,z:8}).add({targets:S.object3D.rotation,x:0,y:0,z:0},"-=1000").add({targets:C,fov:60},"-=1000").add({targets:T.object3D.position,z:-12.5,duration:300},"-=1000").add({targets:T.object3D.scale,x:1,y:1,z:1,duration:100},"-=1000"),f.components.sound.playSound(),c.classList.remove("mouseDown"),l.classList.add("out-right"),e.next=10,h.classList.add("out-left");case 10:return o.style.display="flex",e.next=13,a.classList.add("out-left");case 13:return c.classList.add("out-right"),e.next=16,s.classList.add("out-left");case 16:return e.next=18,u.classList.remove("out-left");case 18:return e.next=20,d.classList.remove("out-left");case 20:return g.removeAttribute("dynamic-body"),y.removeAttribute("dynamic-body"),A.removeAttribute("dynamic-body"),b.removeAttribute("dynamic-body"),e.next=26,p.classList.remove("out-right");case 26:case"end":return e.stop()}},e,this)})),void Se([1950,1e3,750],regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return De({targets:r.object3D.scale,x:1e-5,y:1e-5,z:1e-5,easing:"linear",duration:0}),i.setAttribute("light",{intensity:0}),m.setAttribute("light",{intensity:0}),n.object3D.visible=!0,document.getElementById("backdrop").classList.add("clickable"),e.next=7,n.classList.add("clickable");case 7:return e.next=9,v.emit("vehicle-selected");case 9:case"end":return e.stop()}},e,this)}));case"#scene-three":return se=Te.state.selectedVehicle,ue=document.getElementById("backdrop_right").object3D,he=document.getElementById("backdrop_left").object3D,de=document.getElementById("truck").object3D,pe=document.getElementById("sedan").object3D,fe=document.getElementById("motorcycle").object3D,me=document.getElementById("camera-rig").object3D,ve=document.getElementById("dirtScenario").object3D,ge=document.getElementById("regionalScenario").object3D,ye=document.getElementById("urbanScenario").object3D,Ae=document.getElementById("urbanScenarioRain").object3D,be=document.getElementById("dais-rain").object3D,we=document.getElementById("sedan-visual").object3D,xe=document.getElementById("truck-visual").object3D,Ee=document.getElementById("motorcycle-visual").object3D,"regional"===(Me=document.getElementById("game").sceneEl.systems["scene-manager"].state.selectedScenario)&&document.getElementById("scenario-select-regional-sealed").classList.add("active-scenario-select-button"),"unsealed"===Me&&document.getElementById("scenario-select-regional-unsealed").classList.add("active-scenario-select-button"),"city"===Me&&document.getElementById("scenario-select-city-dry").classList.add("active-scenario-select-button"),"wet"===Me&&document.getElementById("scenario-select-city-wet").classList.add("active-scenario-select-button"),void(se&&(new De.timeline({duration:1e3,easing:"easeInQuad"}).add({targets:ue.position,x:40,y:0,z:0}).add({targets:he.position,x:-40,y:0,z:0},0).add({targets:[de.scale,pe.scale,fe.scale],x:1e-5,y:1e-5,z:1e-5,duration:250},0).add({targets:me.position,x:0,y:13.034,z:16.693,duration:1e3}).add({targets:me.rotation,x:-.5952273432,y:0,z:0,duration:500}).add({targets:ge.scale,x:1,y:1,z:1,easing:"spring(1, 60, 10, 10)"}).add({targets:ve.scale,x:1,y:1,z:1,easing:"spring(1, 60, 10, 10)"},"-=1250").add({targets:ye.scale,x:1,y:1,z:1,easing:"spring(1, 60, 10, 10)"},"-=1250").add({targets:Ae.scale,x:1,y:1,z:1,easing:"spring(1, 60, 10, 10)"},"-=1250").add({targets:[we.scale,xe.scale],x:1,y:1,z:1,easing:"spring(1, 80, 20, 10)",duration:De.stagger(250)},4250).add({targets:Ee.scale,x:2,y:2,z:2,easing:"spring(1, 80, 20, 10)",duration:De.stagger(250)},4250),document.getElementById("vehicle-title").classList.add("out-left"),document.getElementById("vehicle-ui-container-right").classList.add("out-right"),document.getElementById("vehicle-ui-icons").classList.add("out-left"),le=document.getElementById("scene-two"),document.getElementById("backdrop").classList.remove("clickable"),le.classList.remove("clickable"),setTimeout(function(){document.getElementById("scenario-title").classList.remove("out-left"),setTimeout(function(){document.getElementById("scenario-ui-rotate-control-container").classList.remove("out-bottom"),setTimeout(function(){document.getElementById("scenario-ui-container-right").classList.remove("out-right"),setTimeout(function(){be.visible=!0,De({targets:[be.scale],x:1,y:1,z:1,easing:"spring(1, 80, 20, 10)"}),document.getElementById("scenario-back-button").classList.remove("out-left")})},1e3)},4e3)},1e3),setTimeout(function(){switch(ce=document.getElementById("scene-three"),document.getElementById("scenario-light").setAttribute("light",{type:"directional",intensity:1}),ce.classList.add("clickable"),se){case"sedan":document.getElementById("sedan-visual").object3D.visible=!0,document.getElementById("truck-visual").object3D.visible=!1,document.getElementById("motorcycle-visual").object3D.visible=!1;break;case"truck":document.getElementById("truck-visual").object3D.visible=!0,document.getElementById("sedan-visual").object3D.visible=!1,document.getElementById("motorcycle-visual").object3D.visible=!1;break;case"motorcycle":document.getElementById("truck-visual").object3D.visible=!1,document.getElementById("sedan-visual").object3D.visible=!1,document.getElementById("motorcycle-visual").object3D.visible=!0;break;default:alert("BAD VEHICLE ID")}document.getElementById("vehicle-light-orange").setAttribute("visible",!1),document.getElementById("vehicle-light-blue").setAttribute("visible",!1)},1e3)));case"#scene-four":return void function(){var e=document.getElementById("scene-four"),t=document.getElementById("scene-three"),n=document.getElementById("game").sceneEl.systems["scene-manager"],i=n.state.selectedVehicle,r=n.state.selectedSpeed,o=document.getElementById("dial");"truck"===i&&110===r&&(document.getElementById("speed-110").classList.remove("active-speedo-number"),document.getElementById("speed-100").classList.add("active-speedo-number"),o.emit("speed100"),n.state.selectedSpeed=100);var a=document.getElementById("dais-rain").object3D;t.classList.remove("clickable"),document.getElementById("scenario-title").classList.add("out-left"),setTimeout(function(){De({targets:[a.scale],x:1e-5,y:1e-5,z:1e-5,easing:"spring(1, 80, 20, 10)"}),a.visible=!1},1900),document.getElementById("scenario-ui-container-right").classList.add("out-right"),setTimeout(function(){document.getElementById("scenario-back-button").classList.add("out-left")},500),document.getElementById("scenario-ui-rotate-control-container").classList.add("out-bottom"),setTimeout(function(){document.getElementById("speedo-title").classList.remove("out-left"),document.getElementById("speedo-ui-container").classList.remove("out-left"),document.getElementById("speedo-back-button").classList.remove("out-left"),"truck"===i&&setTimeout(function(){document.getElementById("heavy-duty-note-container").classList.remove("out-left")},1500),document.getElementById("scenario-light").setAttribute("light",{type:"directional",intensity:0}),document.getElementById("camera").setAttribute("position","0.018 0.738 3.276"),document.getElementById("camera").setAttribute("rotation","-11.42 14.8 0"),document.getElementById("camera").setAttribute("fov","45"),document.getElementById("sedan-visual").object3D.visible=!0,document.getElementById("truck-visual").object3D.visible=!0,e.object3D.visible=!0,e.classList.add("clickable")},2750)}();case"#scene-five":return void function(t){AFRAME.utils.device.isMobile()?document.querySelector("body").removeEventListener("touchstart",Ce):(document.querySelector("body").removeEventListener("click",Ce),document.removeEventListener("keyup",Le)),document.getElementById("speedo-title").classList.add("out-left"),document.getElementById("speedo-ui-container").classList.add("out-left"),document.getElementById("speedo-launch").style.pointerEvents="none",document.getElementById("speedo-back-button").style.pointerEvents="none",setTimeout(function(){document.getElementById("speedo-launch").style.pointerEvents="auto",document.getElementById("speedo-back-button").style.pointerEvents="auto"},2500),document.getElementById("heavy-duty-note-container").classList.add("out-left"),document.getElementById("speedo-back-button").classList.add("out-left"),document.getElementById("heavy-duty-note-container").classList.add("out-left");var n=document.getElementById("scene-four");n.classList.remove("clickable");var i=document.getElementById("scene-five");setTimeout(function(){setTimeout(function(){document.getElementById("speedometer").emit("speedo_reset_animation"),AFRAME.utils.device.isMobile()?document.querySelector("body").addEventListener("touchstart",Ce):(document.querySelector("body").addEventListener("click",Ce),document.addEventListener("keyup",Le))},8500);var e=document.getElementById("car-cam");e.setAttribute("camera","active",!0),e.setAttribute("camera","fov",60),e.setAttribute("position","0.277 1.169 0.15"),e.setAttribute("rotation","2.376 0 0"),n.object3D.visible=!1,i.object3D.visible=!0,document.getElementById("camera-fade-scenefive").emit("fadeInSimulation"),"wet"===document.getElementById("game").sceneEl.systems["scene-manager"].state.selectedScenario&&(document.getElementById("game").setAttribute("fog","density","0.02"),document.getElementById("rain-container").object3D.visible=!0),document.getElementById("simulation-instructions").classList.remove("out-left"),setTimeout(function(){document.getElementById("simulation-instructions").classList.add("out-left")},7500),t()},2500)}(t);case"#scene-six":return void function(t){var e=document.getElementById("game").sceneEl.systems["scene-manager"].state,n=e.reactionDistance,i=e.brakingDistance,r=e.totalStoppingDistance,o=e.reactionTime,a=e.impactSpeed,s=e.selectedVehicle,c=e.selectedScenario,l=document.getElementById("outcome-breakdown-heading"),u=document.getElementById("outcome-breakdown-body"),h="PEDESTRIAN";"city"!==c&&"wet"!==c||(h="PEDESTRIAN"),"regional"===c&&(h="COW"),"unsealed"===c&&(h="KANGAROO"),50<r?(l.innerHTML="YOU DIDN'T STOP IN TIME!",u.innerHTML="IT TOOK YOU ".concat(o.toFixed(1)," SECONDS TO REACT AND YOU WERE STILL TRAVELLING AT ").concat(Math.ceil(a),"KM/H WHEN YOU HIT THE ").concat(h,".")):(l.innerHTML="YOU STOPPED IN TIME!",u.innerHTML="IN THE ".concat(o.toFixed(1)," SECONDS IT TOOK YOU TO REACT, YOU TRAVELLED A DISTANCE OF ").concat(Math.ceil(n)," METRES BEFORE BRAKING."));var d,p=50<r?r:50,f=50===p?"7.5s":"".concat(50/p*7.5,"s"),m=50===p?"7.5vh":"".concat(100-50/p*100,"vh"),v=n/p*76,g=i/p*76,y="".concat(v+g+5,"vh"),A="".concat(v,"vh"),b="".concat(50===p?g-9.5:g,"vh");d="sedan"===s?document.getElementById("outcome-braking-sedan"):"motorcycle"===s?document.getElementById("outcome-braking-motorcycle"):document.getElementById("outcome-braking-truck");var w,x=document.getElementById("obstacle-appeared-symbol"),E=document.getElementById("reaction-distance-mask"),M=document.getElementById("outcome-brakes-applied"),T=document.getElementById("braking-distance-mask");w="regional"===c?document.getElementById("cow-obstacle"):"unsealed"===c?document.getElementById("roo-obstacle"):document.getElementById("pedestrian-obstacle");var S=document.getElementById("outcome-reaction"),C=document.getElementById("outcome-reaction-distance"),L=document.getElementById("outcome-braking"),_=document.getElementById("outcome-braking-distance"),B=document.getElementById("outcome-total"),R=document.getElementById("outcome-total-distance");S.style.bottom="".concat(v/2+4,"vh"),C.style.bottom="".concat(v/2+4,"vh"),setTimeout(function(){document.getElementById("camera-fade-scenefive").emit("fadeOutSimulation"),document.getElementById("outcome-game-over").classList.remove("out-top"),50<r&&setTimeout(function(){document.getElementById("serious-injury-note").classList.remove("scale-out")},2e3),document.getElementById("rain-container").object3D.visible=!1,setTimeout(function(){"sedan"===t&&(document.getElementById("sedan-top-view").object3D.visible=!0),"truck"===t&&(document.getElementById("truck-top-view").object3D.visible=!0),"motorcycle"===t&&(document.getElementById("motorcycle-top-view").object3D.visible=!0),document.getElementById("sedan-interior").object3D.visible=!1,document.getElementById("truck-interior").object3D.visible=!1,document.getElementById("bike-interior").object3D.visible=!1;var e=document.getElementById("car-cam");e.setAttribute("camera","active",!1),document.getElementById("car-cam-top").setAttribute("camera","active",!0),document.getElementById("outcome-container-right").classList.remove("out-right"),document.getElementById("outcome-breakdown").classList.remove("out-left"),document.getElementById("outcome-braking-board").classList.remove("out-left"),setTimeout(function(){x.style.transform="scale(1)",setTimeout(function(){d.style.transform="scale(1)",d.style.bottom=y,E.style["transition-duration"]="".concat(n/p*7.5,"s"),E.style.height=A,M.style["transition-delay"]="".concat(n/p*7.5,"s"),M.style.transform="scale(1)",T.style["transition-duration"]="".concat(i/p*7.5,"s"),T.style["transition-delay"]="".concat(n/p*7.5+.5,"s"),T.style.height=b,w.style.top=m,w.style["transition-delay"]=f,w.style.transform="scale(1)",setTimeout(function(){_.innerHTML="".concat(Math.ceil(i),"m"),C.innerHTML="".concat(Math.ceil(n),"m"),R.innerHTML="".concat(Math.ceil(r),"m"),L.style.opacity=1,B.style.opacity=1,S.style.opacity=1,_.style.opacity=1,R.style.opacity=1,C.style.opacity=1,setTimeout(function(){document.getElementById("reset-buttons-container").classList.remove("out-bottom")},1e3)},5e3)},1e3)},2500),document.getElementById("camera-fade-top").emit("fadeInSimulation"),e.setAttribute("position","0.277 1.169 0.661")},2e3)},500)}(Te.state.selectedVehicle);case"outcome-adjust-speed":return te=document.getElementById("outcome-reaction"),ne=document.getElementById("outcome-reaction-distance"),ie=document.getElementById("outcome-braking"),re=document.getElementById("outcome-braking-distance"),oe=document.getElementById("outcome-total"),ae=document.getElementById("outcome-total-distance"),setTimeout(function(){document.getElementById("scene-four").object3D.visible=!0},700),document.getElementById("camera-fade-top").emit("fadeOutSimulation"),setTimeout(function(){var e,t;e=document.getElementById("scene-four"),t=document.getElementById("game").sceneEl.systems["scene-manager"].state.selectedVehicle,e.classList.add("clickable"),document.getElementById("scenario-title").classList.add("out-left"),document.getElementById("scenario-ui-rotate-control-container").classList.add("out-bottom"),setTimeout(function(){document.getElementById("speedo-title").classList.remove("out-left"),document.getElementById("speedo-ui-container").classList.remove("out-left"),setTimeout(function(){document.getElementById("speedo-back-button").classList.remove("out-left")},1500),"truck"===t&&setTimeout(function(){document.getElementById("heavy-duty-note-container").classList.remove("out-left")},1500),document.getElementById("scene-five").object3D.visible=!1,document.getElementById("camera").setAttribute("position","0.018 0.738 3.276"),document.getElementById("camera").setAttribute("rotation","-11.42 14.8 0"),document.getElementById("camera").setAttribute("fov","45");var e=document.getElementById("scene-four");document.getElementById("game").setAttribute("fog","density","0.00"),document.getElementById("rain-container").object3D.visible=!1,e.object3D.visible=!0,e.classList.add("clickable")},1e3),document.getElementById("game").emit("outcomeAdjustSpeed")},900),document.getElementById("outcome-game-over").classList.add("out-top"),document.getElementById("serious-injury-note").classList.remove("scale-out"),document.getElementById("serious-injury-note").classList.add("scale-out"),document.getElementById("outcome-container-right").classList.add("out-right"),document.getElementById("outcome-breakdown").classList.add("out-left"),document.getElementById("outcome-braking-board").classList.add("out-left"),setTimeout(function(){document.getElementById("obstacle-appeared-symbol").style.transform="scale(0)",document.getElementById("outcome-braking-sedan").style.transform="scale(0)",document.getElementById("outcome-braking-truck").style.transform="scale(0)",document.getElementById("outcome-brakes-applied").style.transform="scale(0)",document.getElementById("roo-obstacle").style.transform="scale(0)",document.getElementById("pedestrian-obstacle").style.transform="scale(0)",document.getElementById("cow-obstacle").style.transform="scale(0)",document.getElementById("outcome-braking-sedan").style.bottom="6vh",document.getElementById("outcome-braking-truck").style.bottom="6vh",document.getElementById("outcome-braking-motorcycle").style.bottom="6vh",document.getElementById("outcome-braking-sedan").style.transform="scale(0)",document.getElementById("outcome-braking-truck").style.transform="scale(0)",document.getElementById("outcome-braking-motorcycle").style.transform="scale(0)",document.getElementById("reaction-distance-mask").style.height="0vh",document.getElementById("braking-distance-mask").style.height="0vh"},1e3),setTimeout(function(){document.getElementById("reset-buttons-container").classList.add("out-bottom"),document.querySelector("body").className="",document.querySelector("body").classList.add("default-background")},250),void setTimeout(function(){document.getElementById("camera").setAttribute("camera","active",!0),document.getElementById("car-cam").setAttribute("camera","active",!1),document.getElementById("scene-five").object3D.visible=!1,document.getElementById("scene-five").classList.remove("clickable"),document.getElementById("sedan-top-view").object3D.visible=!1,document.getElementById("truck-top-view").object3D.visible=!1,document.getElementById("motorcycle-top-view").object3D.visible=!1,ie.style.opacity=0,oe.style.opacity=0,te.style.opacity=0,re.style.opacity=0,ae.style.opacity=0,ne.style.opacity=0},1e3);case"outcome-restart":return Q=document.getElementById("game").sceneEl.systems["scene-manager"].state.selectedScenario,Y=document.getElementById("outcome-reaction"),Z=document.getElementById("outcome-reaction-distance"),K=document.getElementById("outcome-braking"),J=document.getElementById("outcome-braking-distance"),$=document.getElementById("outcome-total"),ee=document.getElementById("outcome-total-distance"),document.getElementById("camera-fade-top").emit("fadeOutSimulation"),document.getElementById("scene-five").classList.remove("clickable"),document.getElementById("game").emit("outcomeRestart"),document.getElementById("outcome-game-over").classList.add("out-top"),document.getElementById("serious-injury-note").classList.remove("scale-out"),document.getElementById("serious-injury-note").classList.add("scale-out"),document.getElementById("outcome-braking-board").classList.add("out-left"),document.getElementById("reset-buttons-container").classList.add("out-bottom"),document.getElementById("outcome-container-right").classList.add("out-right"),document.getElementById("outcome-breakdown").classList.add("out-left"),setTimeout(function(){document.getElementById("obstacle-appeared-symbol").style.transform="scale(0)",document.getElementById("outcome-braking-sedan").style.transform="scale(0)",document.getElementById("outcome-braking-truck").style.transform="scale(0)",document.getElementById("outcome-braking-motorcycle").style.transform="scale(0)",document.getElementById("outcome-brakes-applied").style.transform="scale(0)",document.getElementById("roo-obstacle").style.transform="scale(0)",document.getElementById("pedestrian-obstacle").style.transform="scale(0)",document.getElementById("cow-obstacle").style.transform="scale(0)",document.getElementById("outcome-braking-sedan").style.bottom="6vh",document.getElementById("outcome-braking-truck").style.bottom="6vh",document.getElementById("outcome-braking-motorcycle").style.bottom="6vh",document.getElementById("reaction-distance-mask").style.height="0vh",document.getElementById("braking-distance-mask").style.height="0vh","regional"===Q&&document.getElementById("scenario-select-regional-sealed").classList.add("active-scenario-select-button"),"unsealed"===Q&&document.getElementById("scenario-select-regional-unsealed").classList.add("active-scenario-select-button"),"city"===Q&&document.getElementById("scenario-select-city-dry").classList.add("active-scenario-select-button"),"wet"===Q&&document.getElementById("scenario-select-city-wet").classList.add("active-scenario-select-button"),document.getElementById("vehicle-light-orange").setAttribute("visible",!0),document.getElementById("vehicle-light-blue").setAttribute("visible",!0),document.getElementById("rain-container").object3D.visible=!1,document.getElementById("game").setAttribute("fog","density","0.00")},1e3),void setTimeout(function(){var r,o,a,s,c,l,u,h,d,p,f,e;r=document.getElementById("vehicle-title"),o=document.getElementById("vehicle-ui-icons"),a=document.getElementById("vehicle-ui-container-right"),s=document.getElementById("backdrop_left").getObject3D("mesh"),c=document.getElementById("backdrop_right").getObject3D("mesh"),l=document.getElementById("backdrop_left"),u=document.getElementById("backdrop_right"),h=document.getElementById("backdrop"),d=document.getElementById("camera-rig"),p=document.getElementById("camera"),f=document.getElementById("sedan"),document.getElementById("truck"),(e=document.getElementById("scene-two")).classList.add("clickable"),e.object3D.visible=!0,Se([0,500,1e3],regeneratorRuntime.mark(function e(){var t,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new De.timeline({easing:"easeInOutQuad",duration:1e3}),n=new AFRAME.THREE.Color("rgb(41,80,255)"),i=new AFRAME.THREE.Color("rgb(255, 41, 80)"),t.add({targets:[c.material.color],r:i.r,g:i.g,b:i.b,duration:0}).add({targets:[s.material.color],r:n.r,g:n.g,b:n.b,duration:0},0).add({targets:l.object3D.position,x:-12.5,duration:0},0).add({targets:u.object3D.position,x:12.5,duration:0},0).add({targets:d.object3D.position,x:0,y:1,z:8,duration:0}).add({targets:d.object3D.rotation,x:0,y:0,z:0,duration:0},0).add({targets:p,fov:60,duration:0},0).add({targets:h.object3D.position,z:-12.5,duration:0},0).add({targets:h.object3D.scale,x:1,y:1,z:1,duration:0},0).add({targets:document.getElementById("camera-fade").getObject3D("mesh").material,opacity:0,duration:1e3,easing:"easeInOutQuad"},1250),e.next=6,f.emit("vehicle-selected");case 6:return r.classList.remove("out-left"),e.next=9,o.classList.remove("out-left");case 9:return e.next=11,a.classList.remove("out-right");case 11:case"end":return e.stop()}},e,this)})),document.getElementById("camera").setAttribute("camera","active",!0),document.getElementById("car-cam").setAttribute("camera","active",!1),document.getElementById("scene-five").object3D.visible=!1,document.getElementById("sedan-top-view").object3D.visible=!1,document.getElementById("truck-top-view").object3D.visible=!1,document.getElementById("motorcycle-top-view").object3D.visible=!1,document.querySelector("body").className="",document.querySelector("body").classList.add("default-background"),K.style.opacity=0,$.style.opacity=0,Y.style.opacity=0,J.style.opacity=0,ee.style.opacity=0,Z.style.opacity=0},1e3);case"too-soon-reset":return X=t,AFRAME.utils.device.isMobile()?document.querySelector("body").removeEventListener("touchstart",_e):(document.querySelector("body").removeEventListener("click",_e),document.removeEventListener("keyup",Be)),setTimeout(function(){document.getElementById("camera-fade-scenefive").emit("fadeInSimulation")},2500),void setTimeout(function(){setTimeout(function(){AFRAME.utils.device.isMobile()?document.querySelector("body").addEventListener("touchstart",_e):(document.querySelector("body").addEventListener("click",_e),document.addEventListener("keyup",Be))},8500),"wet"===document.getElementById("game").sceneEl.systems["scene-manager"].state.selectedScenario&&(document.getElementById("game").setAttribute("fog","density","0.02"),document.getElementById("rain-container").object3D.visible=!0);var e=document.getElementById("car-cam");e.setAttribute("camera","active",!0),e.setAttribute("camera","fov",60),e.setAttribute("position","0.277 1.169 0.15"),e.setAttribute("rotation","2.376 0 0"),X()},2500);case"outcome-again":return void function(t){AFRAME.utils.device.isMobile()?document.querySelector("body").removeEventListener("touchstart",Re):(document.querySelector("body").removeEventListener("click",Re),document.removeEventListener("keyup",Pe));var e=document.getElementById("outcome-reaction"),n=document.getElementById("outcome-reaction-distance"),i=document.getElementById("outcome-braking"),r=document.getElementById("outcome-braking-distance"),o=document.getElementById("outcome-total"),a=document.getElementById("outcome-total-distance");document.getElementById("camera-fade-top").emit("fadeOutSimulation"),document.getElementById("outcome-game-over").classList.add("out-top"),document.getElementById("serious-injury-note").classList.remove("scale-out"),document.getElementById("serious-injury-note").classList.add("scale-out"),document.getElementById("outcome-container-right").classList.add("out-right"),document.getElementById("outcome-breakdown").classList.add("out-left"),document.getElementById("outcome-braking-board").classList.add("out-left"),setTimeout(function(){document.getElementById("obstacle-appeared-symbol").style.transform="scale(0)",document.getElementById("outcome-braking-sedan").style.transform="scale(0)",document.getElementById("outcome-braking-truck").style.transform="scale(0)",document.getElementById("outcome-brakes-applied").style.transform="scale(0)",document.getElementById("roo-obstacle").style.transform="scale(0)",document.getElementById("pedestrian-obstacle").style.transform="scale(0)",document.getElementById("cow-obstacle").style.transform="scale(0)",document.getElementById("outcome-braking-sedan").style.bottom="6vh",document.getElementById("outcome-braking-truck").style.bottom="6vh",document.getElementById("outcome-braking-motorcycle").style.bottom="6vh",document.getElementById("outcome-braking-sedan").style.transform="scale(0)",document.getElementById("outcome-braking-truck").style.transform="scale(0)",document.getElementById("outcome-braking-motorcycle").style.transform="scale(0)",document.getElementById("reaction-distance-mask").style.height="0vh",document.getElementById("braking-distance-mask").style.height="0vh"},1e3),setTimeout(function(){document.getElementById("reset-buttons-container").classList.add("out-bottom"),document.querySelector("body").className="",document.querySelector("body").classList.add("default-background")},250),setTimeout(function(){document.getElementById("sedan-top-view").object3D.visible=!1,document.getElementById("truck-top-view").object3D.visible=!1,document.getElementById("motorcycle-top-view").object3D.visible=!1,i.style.opacity=0,o.style.opacity=0,e.style.opacity=0,r.style.opacity=0,a.style.opacity=0,n.style.opacity=0},1e3),setTimeout(function(){setTimeout(function(){AFRAME.utils.device.isMobile()?document.querySelector("body").addEventListener("touchstart",Re):(document.querySelector("body").addEventListener("click",Re),document.addEventListener("keyup",Pe))},8500),"wet"===document.getElementById("game").sceneEl.systems["scene-manager"].state.selectedScenario&&(document.getElementById("game").setAttribute("fog","density","0.02"),document.getElementById("rain-container").object3D.visible=!0);var e=document.getElementById("car-cam");e.setAttribute("camera","active",!0),e.setAttribute("camera","fov",60),e.setAttribute("position","0.277 1.169 0.15"),e.setAttribute("rotation","2.376 0 0"),document.getElementById("camera-fade-scenefive").emit("fadeInSimulation"),t()},2500)}(t);case"scenario-back":return L=document.getElementById("vehicle-title"),_=document.getElementById("stop-it-title"),B=document.getElementById("vehicle-ui-icons"),R=document.getElementById("vehicle-ui-container-right"),P=document.getElementById("backdrop_left"),D=document.getElementById("backdrop_right"),I=document.getElementById("backdrop"),O=document.getElementById("camera-rig"),k=document.getElementById("camera"),j=document.getElementById("dirtScenario").object3D,H=document.getElementById("regionalScenario").object3D,F=document.getElementById("urbanScenario").object3D,N=document.getElementById("urbanScenarioRain").object3D,z=document.getElementById("dais-rain").object3D,document.getElementById("sedan").object3D,document.getElementById("truck").object3D,document.getElementById("motorcycle").object3D,U=document.getElementById("game").sceneEl.systems["scene-manager"].state.selectedVehicle,G=document.getElementById("sedan-visual").object3D,V=document.getElementById("truck-visual").object3D,W=document.getElementById("motorcycle-visual").object3D,q=document.getElementById("scene-three"),document.getElementById("scene-four").classList.remove("clickable"),document.getElementById("scenario-title").classList.add("out-left"),De({targets:[z.scale],x:1e-5,y:1e-5,z:1e-5,easing:"spring(1, 80, 20, 10)"}),z.visible=!1,document.getElementById("scenario-back-button").classList.add("out-left"),document.querySelectorAll(".scenario-select-button").forEach(function(e){e.style.pointerEvents="none"}),setTimeout(function(){document.querySelectorAll(".scenario-select-button").forEach(function(e){e.style.pointerEvents="auto"})},2500),document.getElementById("scenario-ui-container-right").classList.add("out-right"),document.getElementById("scenario-ui-rotate-control-container").classList.add("out-bottom"),new De.timeline({easing:"easeInOutQuad",duration:1e3}).add({targets:H.scale,x:1e-5,y:1e-5,z:1e-5,easing:"easeInOutQuad",duration:250}).add({targets:j.scale,x:1e-5,y:1e-5,z:1e-5,easing:"easeInOutQuad",duration:250},0).add({targets:F.scale,x:1e-5,y:1e-5,z:1e-5,easing:"easeInOutQuad",duration:250},0).add({targets:N.scale,x:1e-5,y:1e-5,z:1e-5,easing:"easeInOutQuad",duration:250},0).add({targets:[V.scale,G.scale],x:1e-5,y:1e-5,z:1e-5,easing:"easeInOutQuad",duration:250},0).add({targets:W.scale,x:1e-5,y:1e-5,z:1e-5,easing:"easeInOutQuad",duration:250},0).add({targets:P.object3D.position,x:-12.5},750).add({targets:D.object3D.position,x:12.5},750).add({targets:I.object3D.rotation,z:-.2792528},800).add({targets:O.object3D.position,x:0,y:1,z:8}).add({targets:O.object3D.rotation,x:0,y:0,z:0},"-=1000").add({targets:k,fov:60},"-=1000").add({targets:I.object3D.position,z:-12.5,duration:300},"-=1000").add({targets:I.object3D.scale,x:1,y:1,z:1,duration:100},"-=1000"),void setTimeout(function(){_.classList.add("out-left"),L.classList.remove("out-left"),B.classList.remove("out-left"),setTimeout(function(){R.classList.remove("out-right")},2500),q.object3D.visible=!0,setTimeout(function(){"sedan"===U&&document.getElementById("sedan").emit("vehicle-selected"),"truck"===U&&document.getElementById("truck").emit("vehicle-selected"),"motorcycle"===U&&document.getElementById("motorcycle").emit("vehicle-selected"),q.classList.add("clickable")},1e3)},1250);case"speedo-back":return void function(){var e=document.getElementById("dirtScenario").object3D,t=document.getElementById("regionalScenario").object3D,n=document.getElementById("urbanScenario").object3D,i=document.getElementById("urbanScenarioRain").object3D,r=document.getElementById("dais-rain").object3D,o=document.getElementById("camera-rig").object3D,a=document.getElementById("camera"),s=document.getElementById("sedan-visual").object3D,c=document.getElementById("truck-visual").object3D,l=document.getElementById("motorcycle-visual").object3D,u=document.getElementById("truck").object3D,h=document.getElementById("sedan").object3D,d=document.getElementById("motorcycle").object3D,p=document.getElementById("game").sceneEl.systems["scene-manager"].state.selectedScenario,f=document.getElementById("game").sceneEl.systems["scene-manager"].state.selectedVehicle,m=document.getElementById("scene-three"),v=document.getElementById("scene-four"),g=new De.timeline({duration:1e3,easing:"easeInQuad"});switch(document.getElementById("speedo-title").classList.add("out-left"),document.getElementById("speedo-ui-container").classList.add("out-left"),document.getElementById("heavy-duty-note-container").classList.add("out-left"),document.getElementById("speedo-back-button").classList.add("out-left"),document.getElementById("heavy-duty-note-container").classList.add("out-left"),document.getElementById("speedometer").emit("speedo_reset_animation"),setTimeout(function(){v.classList.remove("clickable"),v.object3D.visible=!1,document.getElementById("scenario-light").setAttribute("light",{type:"directional",intensity:1})},1e3),setTimeout(function(){g.add({targets:[u.scale,h.scale,d.scale],x:1e-5,y:1e-5,z:1e-5,duration:250},0).add({targets:o.position,x:0,y:13.034,z:16.693,duration:1e3}).add({targets:o.rotation,x:-.5952273432,y:0,z:0,duration:500}).add({targets:t.scale,x:1,y:1,z:1,easing:"spring(1, 60, 10, 10)"}).add({targets:e.scale,x:1,y:1,z:1,easing:"spring(1, 60, 10, 10)"},"-=1250").add({targets:n.scale,x:1,y:1,z:1,easing:"spring(1, 60, 10, 10)"},"-=1250").add({targets:i.scale,x:1,y:1,z:1,easing:"spring(1, 60, 10, 10)"},"-=1250").add({targets:[s.scale,c.scale],x:1,y:1,z:1,easing:"spring(1, 80, 20, 10)",duration:De.stagger(250)},4250).add({targets:l.scale,x:2,y:2,z:2,easing:"spring(1, 80, 20, 10)",duration:De.stagger(250)},4250)},2e3),setTimeout(function(){a.setAttribute("fov","60"),document.getElementById("scenario-title").classList.remove("out-left"),setTimeout(function(){document.getElementById("scenario-ui-rotate-control-container").classList.remove("out-bottom"),setTimeout(function(){setTimeout(function(){document.getElementById("scenario-ui-container-right").classList.remove("out-right")},2500),setTimeout(function(){"regional"===p&&document.getElementById("scenario-select-regional-sealed").classList.add("active-scenario-select-button"),"unsealed"===p&&document.getElementById("scenario-select-regional-unsealed").classList.add("active-scenario-select-button"),"city"===p&&document.getElementById("scenario-select-city-dry").classList.add("active-scenario-select-button"),"wet"===p&&document.getElementById("scenario-select-city-wet").classList.add("active-scenario-select-button"),document.getElementById("game").setAttribute("fog","density","0.00"),document.getElementById("rain-container").object3D.visible=!1,setTimeout(function(){r.visible=!0,De({targets:[r.scale],x:1,y:1,z:1,easing:"spring(1, 80, 20, 10)"})},2e3),setTimeout(function(){setTimeout(function(){m.classList.add("clickable")},2e3),document.getElementById("scenario-back-button").classList.remove("out-left")},3e3)})},1e3)},2e3)},3e3),f){case"sedan":document.getElementById("sedan-visual").object3D.visible=!0,document.getElementById("truck-visual").object3D.visible=!1,document.getElementById("motorcycle-visual").object3D.visible=!1;break;case"truck":document.getElementById("truck-visual").object3D.visible=!0,document.getElementById("sedan-visual").object3D.visible=!1,document.getElementById("motorcycle-visual").object3D.visible=!1;break;case"motorcycle":document.getElementById("truck-visual").object3D.visible=!1,document.getElementById("sedan-visual").object3D.visible=!1,document.getElementById("motorcycle-visual").object3D.visible=!0;break;default:alert("BAD VEHICLE ID")}}();default:return}})}}),n(169);AFRAME.registerComponent("vehicle-select",{schema:{selectedScale:{type:"vec3"},selectedPosition:{type:"vec3"},selectedRotation:{type:"vec3"},deselectedScale:{type:"vec3"},deselectedPosition:{type:"vec3"}},init:function(){var t=this;this.scale=this.el.object3D.scale,this.position=this.el.object3D.position,this.rotation=this.el.object3D.rotation,this.backdropOne=document.getElementById("backdrop_left"),this.backdropTwo=document.getElementById("backdrop_right"),this.sedan=document.getElementById("sedan"),this.truck=document.getElementById("truck"),this.motorcycle=document.getElementById("motorcycle"),this.animating=!1;var n=document.getElementById("vehicle-select-pivot"),i=document.getElementById("sedan-select"),r=document.getElementById("cycle-select"),o=document.getElementById("truck-select");this.vehicleSelect=document.getElementById("vehicle-ui-container-right"),this.sedanSelectButton=document.getElementById("vehicle-select-sedan"),this.truckSelectButton=document.getElementById("vehicle-select-truck"),this.bikeSelectButton=document.getElementById("vehicle-select-bike"),this.el.addEventListener("vehicle-selected",function(e){if(!t.animating)switch(t.el.id){case"truck":t.el.sceneEl.systems["scene-manager"].state.selectedVehicle="truck",t.select(),t.backgroundTruck(),De({targets:n.object3D.rotation,y:2.094396,duration:0,easing:"easeOutQuad"}),i.classList.remove("scale-up"),r.classList.remove("scale-up"),o.classList.add("scale-up"),t.sedanSelectButton.style.opacity=0,t.sedanSelectButton.style.pointerEvents="none",t.truckSelectButton.style.pointerEvents="auto",t.truckSelectButton.style.opacity=1,t.bikeSelectButton.style.pointerEvents="none",t.bikeSelectButton.style.opacity=0,t.motorcycle.components["vehicle-select"].deselect(),t.sedan.components["vehicle-select"].deselect();break;case"sedan":t.el.sceneEl.systems["scene-manager"].state.selectedVehicle="sedan",t.select(),t.backgroundSedan(),De({targets:n.object3D.rotation,y:0,duration:0,easing:"easeOutQuad"}),i.classList.add("scale-up"),r.classList.remove("scale-up"),o.classList.remove("scale-up"),t.sedanSelectButton.style.opacity=1,t.sedanSelectButton.style.pointerEvents="auto",t.truckSelectButton.style.pointerEvents="none",t.truckSelectButton.style.opacity=0,t.bikeSelectButton.style.pointerEvents="none",t.bikeSelectButton.style.opacity=0,t.motorcycle.components["vehicle-select"].deselect(),t.truck.components["vehicle-select"].deselect();break;case"motorcycle":t.el.sceneEl.systems["scene-manager"].state.selectedVehicle="motorcycle",t.select(),t.backgroundMotorcycle(),De({targets:n.object3D.rotation,y:4.188792,duration:0,easing:"easeOutQuad"}),i.classList.remove("scale-up"),r.classList.add("scale-up"),o.classList.remove("scale-up"),t.sedanSelectButton.style.opacity=0,t.sedanSelectButton.style.pointerEvents="none",t.truckSelectButton.style.pointerEvents="none",t.truckSelectButton.style.opacity=0,t.bikeSelectButton.style.pointerEvents="auto",t.bikeSelectButton.style.opacity=1,t.truck.components["vehicle-select"].deselect(),t.sedan.components["vehicle-select"].deselect();break;default:window.alert("ERROR: TODO: Real Error Handling")}})},in:function(){De({targets:this.scale,x:1,y:1,z:1,easing:"spring(1, 80, 15, 25)",delay:250})},select:function(){var e=this;this.animating=!0,this.vehicleSelect.style.pointerEvents="none",document.getElementById("vehicle-ui-icons").style.pointerEvents="none";var t=De.timeline({duration:250});this.el.object3D.visible=!0,t.add({targets:this.scale,x:this.data.selectedScale.x,y:this.data.selectedScale.y,z:this.data.selectedScale.z,easing:"easeOutQuad"},0),t.finished.then(function(){document.getElementById("vehicle-ui-icons").style.pointerEvents="auto",setTimeout(function(){e.vehicleSelect.style.pointerEvents="auto"},250),e.animating=!1})},deselect:function(){var e=this;this.animating=!0,this.vehicleSelect.style.pointerEvents="none";var t=De.timeline({duration:250});this.el.object3D.visible=!1,t.add({targets:this.scale,x:this.data.deselectedScale.x,y:this.data.deselectedScale.y,z:this.data.deselectedScale.z},0),t.finished.then(function(){document.getElementById("vehicle-ui-icons").style.pointerEvents="auto",setTimeout(function(){e.vehicleSelect.style.pointerEvents="auto"},250),e.animating=!1})},backgroundTruck:function(){var e=new AFRAME.THREE.Color("rgb(255,128,56)"),t=new AFRAME.THREE.Color("rgb(56, 182, 255)");De({targets:this.backdropOne.getObject3D("mesh").material.color,r:t.r,g:t.g,b:t.b,duration:200,easing:"easeInOutQuad"}),De({targets:this.backdropTwo.getObject3D("mesh").material.color,r:e.r,g:e.g,b:e.b,duration:200,easing:"easeInOutQuad"})},backgroundSedan:function(){var e=new AFRAME.THREE.Color("rgb(41,80,255)"),t=new AFRAME.THREE.Color("rgb(255, 41, 80)");De({targets:this.backdropOne.getObject3D("mesh").material.color,r:e.r,g:e.g,b:e.b,duration:200,easing:"easeInOutQuad"}),De({targets:this.backdropTwo.getObject3D("mesh").material.color,r:t.r,g:t.g,b:t.b,duration:200,easing:"easeInOutQuad"})},backgroundMotorcycle:function(){var e=new AFRAME.THREE.Color("rgb(255,75,64)"),t=new AFRAME.THREE.Color("rgb(74, 64, 255)");De({targets:this.backdropOne.getObject3D("mesh").material.color,r:t.r,g:t.g,b:t.b,duration:200,easing:"easeInOutQuad"}),De({targets:this.backdropTwo.getObject3D("mesh").material.color,r:e.r,g:e.g,b:e.b,duration:200,easing:"easeInOutQuad"})}}),AFRAME.registerComponent("rotomap",{init:function(){var t=this;this.rotation=this.el.object3D.rotation,this.el.addEventListener("left",function(e){t.rotateLeft()}),this.el.addEventListener("right",function(e){t.rotateRight()})},rotateLeft:function(){De({targets:this.rotation,y:this.rotation.y+1.5708,duration:250,easing:"linear"})},rotateRight:function(){De({targets:this.rotation,y:this.rotation.y-1.5708,duration:250,easing:"linear"})}});var ue={40:9,50:14,60:20,70:27,80:36,90:45,100:56,110:67},he={40:13,50:20,60:29,70:40,80:52,90:65,100:80,110:97},de={40:9*1.2,50:16.8,60:24,70:32.4,80:36*1.2,90:54,100:67.2,110:67*1.2},pe={40:18.2,50:28,60:29*1.4,70:56,80:72.8,90:91,100:112,110:97*1.4};AFRAME.registerComponent("simulation",{schema:{vehicle:{type:"selector",default:null},speed:{type:"number"},obstacle:{type:"string"},state:{type:"string",default:"prestart"},scenario:{type:"string",default:"regional"},increment:{type:"number",default:1}},init:function(){var t=this;this.velocity=0,this.deceleration=0,this.truckMultiplier=1,this.brakingDistances=ue,this.dummySpawnZ=this.getRandomSpawn(),this.dummySpawnRadius=50,this.reactionTime=0,this.brakesAppliedAtZ=0,this.reactionDistance=0,this.dummy=document.getElementById("dummy"),this.el.addEventListener("stop",function(e){t.state="braking",t.brakesAppliedAtZ=t.data.vehicle.getAttribute("position").z,document.getElementById("car-cam").emit("braking_animation_trigger")})},reset:function(){try{this.deceleration=0,this.reactionTime=0,this.brakesAppliedAtZ=0,this.reactionDistance=0,this.dummySpawnZ=this.getRandomSpawn(this.data.speed),this.dummygo=!1,"truck"===this.el.sceneEl.systems["scene-manager"].state.selectedVehicle?(document.getElementById("sedan-interior").object3D.visible=!1,document.getElementById("bike-interior").object3D.visible=!1,document.getElementById("truck-interior").object3D.visible=!0,this.vehicleHeight=.7):"sedan"===this.el.sceneEl.systems["scene-manager"].state.selectedVehicle?(document.getElementById("sedan-interior").object3D.visible=!0,document.getElementById("bike-interior").object3D.visible=!1,document.getElementById("truck-interior").object3D.visible=!1,this.vehicleHeight=.25):"motorcycle"===this.el.sceneEl.systems["scene-manager"].state.selectedVehicle&&(document.getElementById("sedan-interior").object3D.visible=!1,document.getElementById("truck-interior").object3D.visible=!1,document.getElementById("bike-interior").object3D.visible=!0,this.vehicleHeight=.5),this.data.vehicle.object3D.position.set(0,this.vehicleHeight,0),document.getElementById("camera-fade-top").setAttribute("material","opacity",1),this.dummy.object3D.position.set(-4,.25,-this.dummySpawnZ),this.dummy.object3D.visible=!1;var e=document.getElementById("car-cam");e.emit("revert_braking_animation"),e.emit("headbob_start")}catch(e){console.debug(e),console.debug("RESET FAILED")}},goDummyAnimation:function(){this.dummy.object3D.visible=!0,De({targets:this.dummy.object3D.position,x:-.085,y:.25,z:-this.dummySpawnZ,easing:"linear",duration:400})},getDeceleration:function(e,t){return Math.pow(t,2)/(2*e)},getRandomSpawn:function(e){return e<=70?Math.floor(100*Math.random())+250:Math.floor(200*Math.random())+400},update:function(e){var t=this.el.sceneEl.systems["scene-manager"].state.selectedVehicle;this.truckMultiplier="truck"===t?1.4:1;var n=this.el.sceneEl.systems["scene-manager"].state.selectedScenario;this.brakingDistances="unsealed"===n||"wet"===n?"motorcycle"===t?pe:he:"motorcycle"===t?de:ue,this.velocity=this.data.speed/3.6,this.state=this.data.state,this.deceleration=this.getDeceleration(this.brakingDistances[this.data.speed]*this.truckMultiplier,this.velocity)},tick:function(e,t){var n,i;switch(this.state){case"prestart":break;case"driving":i=(n=this.data.vehicle.object3D.position.z)+this.velocity*(t/1e3)*-1,this.data.vehicle.object3D.position.z=i,!this.dummygo&&this.dummySpawnZ-Math.abs(n)<this.dummySpawnRadius&&(this.dummy.object3D.visible=!0,this.el.emit("dummygo"),this.dummygo=!0,this.goDummyAnimation()),n<2-this.dummySpawnZ&&(this.state="stopped");break;case"braking":if((n=this.data.vehicle.object3D.position.z)<2-this.dummySpawnZ){this.state="stopped",this.el.sceneEl.systems["scene-manager"].state.impactSpeed=3.6*this.velocity;break}this.velocity-=this.deceleration*(t/1e3),this.velocity<=0?this.state="stopped":(i=n+this.velocity*(t/1e3)*-1,this.data.vehicle.object3D.position.z=i);break;case"stopped":document.getElementById("driving-sound-container").components.sound.stopSound(),this.state="end",this.reactionDistance=Math.abs(-this.dummySpawnZ+this.dummySpawnRadius-this.brakesAppliedAtZ),this.reactionTime=this.reactionDistance/(this.data.speed/3.6),this.el.sceneEl.systems["scene-manager"].state.reactionTime=this.reactionTime,this.el.sceneEl.systems["scene-manager"].state.reactionDistance=this.reactionDistance,this.el.sceneEl.systems["scene-manager"].state.brakingDistance=this.brakingDistances[this.data.speed]*this.truckMultiplier,this.el.sceneEl.systems["scene-manager"].state.totalStoppingDistance=this.brakingDistances[this.data.speed]*this.truckMultiplier+this.reactionDistance,document.getElementById("dummy").getAttribute("visible")?document.getElementById("vehicle-root").components.stop.hasBraked?document.getElementById("game").emit("scene-change",{nextScene:"#scene-six"}):(document.getElementById("vehicle-root").components.stop.hasBraked=!0,document.getElementById("too-soon-game-over").classList.remove("out-top"),document.getElementById("too-soon-bottom-container").classList.remove("out-bottom"),document.getElementById("didnt-brake-message").classList.remove("scale-out")):(document.getElementById("too-soon-game-over").classList.remove("out-top"),document.getElementById("too-soon-bottom-container").classList.remove("out-bottom"),document.getElementById("too-soon-message").classList.remove("scale-out"))}}}),n(170),n(171),n(173),AFRAME.registerComponent("speedadjust",{schema:{positive:{type:"boolean"}},init:function(){var r=this;this.enabled=!0,this.speedText=document.getElementById("speed-text"),this.dial=document.getElementById("dial"),this.el.addEventListener("click",function(e){if(r.enabled){var t=parseInt(r.speedText.getAttribute("value"));if(r.data.positive){if(t<110){var n=t+10;r.speedText.setAttribute("value",n.toString()),r.el.sceneEl.systems["scene-manager"].state.selectedSpeed=n,r.dial.emit("speed".concat(n))}}else if(40<t){var i=t-10;r.speedText.setAttribute("value",i.toString()),r.el.sceneEl.systems["scene-manager"].state.selectedSpeed=i,r.dial.emit("speed".concat(i))}r.enabled=!1,setTimeout(function(){r.enabled=!0},300)}})}}),n(174),n(175),n(176),n(177),n(178),n(179),AFRAME.registerComponent("camera-cube-env",{schema:{resolution:{type:"number",default:1024},distance:{type:"number",default:1e5},interval:{type:"number",default:1e3},repeat:{type:"boolean",default:!0}},multiple:!1,init:function(){this.counter=this.data.interval,this.cam=new THREE.CubeCamera(1,this.data.distance,this.data.resolution),this.cam.renderTarget.texture.minFilter=THREE.LinearMipMapLinearFilter,this.el.object3D.add(this.cam),this.done=!1;var t=this.cam;this.mesh=this.el.getObject3D("mesh"),this.mesh&&this.mesh.traverse(function(e){e instanceof THREE.Mesh&&(e.material.envMap=t.renderTarget.texture,e.material.needsUpdate=!0)})},tick:function(e,t){var n=this.cam;this.done||(0<this.counter?this.counter-=t:(this.mesh=this.el.getObject3D("mesh"),this.mesh&&(this.mesh.visible=!1,AFRAME.scenes[0].renderer.autoClear=!0,n.position.copy(this.el.object3D.worldToLocal(this.el.object3D.getWorldPosition(new THREE.Vector3))),n.update(AFRAME.scenes[0].renderer,this.el.sceneEl.object3D),this.mesh.traverse(function(e){e instanceof THREE.Mesh&&(e.material.envMap=n.renderTarget.texture,e.material.needsUpdate=!0)}),this.mesh.visible=!0,this.data.repeat||(this.done=!0,this.counter=this.data.interval))))},update:function(e){this.counter=this.data.interval,this.cam=new THREE.CubeCamera(1,this.data.distance,this.data.resolution),this.el.object3D.add(this.cam),this.done=!1;var t=this.cam;this.mesh=this.el.getObject3D("mesh"),this.mesh&&this.mesh.traverse(function(e){e instanceof THREE.Mesh&&(e.material.envMap=t.renderTarget.texture,e.material.needsUpdate=!0)})},remove:function(){},pause:function(){},play:function(){}}),n(181),document.addEventListener("DOMContentLoaded",function(){try{setTimeout(function(){},7500),document.documentElement.requestFullscreen(),window.screen.orientation.onchange=function(){if(this.type.startsWith("landscape"))try{document.documentElement.requestFullscreen()}catch(e){}}}catch(e){console.log(e)}}),window.onload=function(){try{document.documentElement.requestFullscreen()}catch(t){console.log(t)}var t=document.getElementById("backdrop_left"),n=document.getElementById("backdrop_right"),i=document.getElementById("game"),r=i.sceneEl.systems["scene-manager"],o=document.getElementById("start-button"),a=document.getElementById("anchor"),s=document.getElementById("dial"),c=document.getElementById("map-roto"),l=document.getElementById("camera-fade-scenefive"),u=document.getElementById("too-soon-bottom-container"),h=document.getElementById("too-soon-message"),d=document.getElementById("didnt-brake-message"),p=document.getElementById("too-soon-game-over"),f=document.getElementById("outcome-adjust-speed"),m=document.getElementById("outcome-restart"),v=document.getElementById("start-ui-did-you-know-body"),g=document.getElementById("start-ui-did-you-know-container"),e=(document.getElementById("start-ui-did-you-know-box"),document.getElementById("click-one"),document.getElementById("truck-select")),y=document.getElementById("truck"),A=document.getElementById("sedan"),b=document.getElementById("motorcycle"),w=document.getElementById("sedan-select"),x=document.getElementById("cycle-select");document.getElementById("vehicle-select-pivot"),o.addEventListener("mousedown",function(e){o.classList.add("mouseDown")}),o.addEventListener("click",function(e){try{document.documentElement.requestFullscreen()}catch(e){}document.getElementById("start-ui").style.pointerEvents="none",o.style.pointerEvents="none",setTimeout(function(){o.classList.remove("mouseDown")},50),o.classList.remove("mouseDown"),a.emit("scene-change",{nextScene:"#scene-two"}),setTimeout(function(){t.emit("sceneTwoColor"),n.emit("sceneTwoColor")},500),i.emit("sceneTwo")}),e.addEventListener("click",function(e){y.emit("vehicle-selected")}),w.addEventListener("click",function(e){A.emit("vehicle-selected")}),x.addEventListener("click",function(e){b.emit("vehicle-selected")});var E=document.getElementById("vehicle-select-sedan"),M=document.getElementById("vehicle-select-truck"),T=document.getElementById("vehicle-select-bike");E.addEventListener("click",function(e){document.querySelectorAll(".vehicle-ui-icon").forEach(function(e){e.style.pointerEvents="none"}),setTimeout(function(){document.querySelectorAll(".vehicle-ui-icon").forEach(function(e){e.style.pointerEvents="auto"})},3e3),E.style.pointerEvents="none",setTimeout(function(){E.style.pointerEvents="auto"},2500),t.emit("sceneThreeTransition"),n.emit("sceneThreeTransition"),i.emit("sceneThree"),i.emit("scene-change",{nextScene:"#scene-three"})}),M.addEventListener("click",function(e){document.querySelectorAll(".vehicle-ui-icon").forEach(function(e){e.style.pointerEvents="none"}),setTimeout(function(){document.querySelectorAll(".vehicle-ui-icon").forEach(function(e){e.style.pointerEvents="auto"})},3e3),M.style.pointerEvents="none",setTimeout(function(){M.style.pointerEvents="auto"},2500),t.emit("sceneThreeTransition"),n.emit("sceneThreeTransition"),i.emit("sceneThree"),i.emit("scene-change",{nextScene:"#scene-three"})}),T.addEventListener("click",function(e){document.querySelectorAll(".vehicle-ui-icon").forEach(function(e){e.style.pointerEvents="none"}),setTimeout(function(){document.querySelectorAll(".vehicle-ui-icon").forEach(function(e){e.style.pointerEvents="auto"})},3e3),T.style.pointerEvents="none",setTimeout(function(){T.style.pointerEvents="auto"},2500),t.emit("sceneThreeTransition"),n.emit("sceneThreeTransition"),i.emit("sceneThree"),i.emit("scene-change",{nextScene:"#scene-three"})}),document.getElementById("speedo-increase").addEventListener("click",function(e){document.getElementById("speedo-increase").classList.add("mouseDown"),setTimeout(function(){document.getElementById("speedo-increase").classList.remove("mouseDown")},50);var t=r.state.selectedSpeed;if((100!==t||"truck"!==r.state.selectedVehicle)&&110!==t){var n=t+10;document.getElementById("speed-".concat(t)).classList.remove("active-speedo-number"),document.getElementById("speed-".concat(n)).classList.add("active-speedo-number"),s.emit("speed".concat(n)),r.state.selectedSpeed=n}}),document.getElementById("speedo-decrease").addEventListener("click",function(e){document.getElementById("speedo-decrease").classList.add("mouseDown"),setTimeout(function(){document.getElementById("speedo-decrease").classList.remove("mouseDown")},50);var t=r.state.selectedSpeed;if(40!==t){var n=t-10;document.getElementById("speed-".concat(t)).classList.remove("active-speedo-number"),document.getElementById("speed-".concat(n)).classList.add("active-speedo-number"),s.emit("speed".concat(n)),r.state.selectedSpeed=n}});var S=0,C=!0,L=["regional","unsealed","wet","city"],_=Array.from(document.querySelectorAll(".scenario-select-button"));document.getElementById("scenario-ui-left").addEventListener("click",function(e){C&&(_.forEach(function(e){e.classList.remove("active-scenario-select-button")}),C=!1,c.emit("left"),0===S?S=L.length-1:--S,r.state.selectedScenario=L[S],setTimeout(function(){switch(C=!0,S){case 0:document.getElementById("scenario-select-regional-sealed").classList.add("active-scenario-select-button");break;case 1:document.getElementById("scenario-select-regional-unsealed").classList.add("active-scenario-select-button");break;case 2:document.getElementById("scenario-select-city-wet").classList.add("active-scenario-select-button");break;case 3:document.getElementById("scenario-select-city-dry").classList.add("active-scenario-select-button")}},300))}),document.getElementById("scenario-ui-right").addEventListener("click",function(e){C&&(_.forEach(function(e){e.classList.remove("active-scenario-select-button")}),C=!1,c.emit("right"),S===L.length-1?S=0:S++,r.state.selectedScenario=L[S],setTimeout(function(){switch(C=!0,S){case 0:document.getElementById("scenario-select-regional-sealed").classList.add("active-scenario-select-button");break;case 1:document.getElementById("scenario-select-regional-unsealed").classList.add("active-scenario-select-button");break;case 2:document.getElementById("scenario-select-city-wet").classList.add("active-scenario-select-button");break;case 3:document.getElementById("scenario-select-city-dry").classList.add("active-scenario-select-button")}},300))}),_.forEach(function(t){t.addEventListener("click",function(e){e.preventDefault(),document.querySelectorAll(".scenario-select-button").forEach(function(e){e.style.pointerEvents="none"}),B.style.pointerEvents="none",setTimeout(function(){document.querySelectorAll(".scenario-select-button").forEach(function(e){e.style.pointerEvents="auto"}),B.style.pointerEvents="auto"},2500),t.classList.remove("active-scenario-select-button"),i.emit("scene-change",{nextScene:"#scene-four"}),i.emit("sceneFour")})});var B=document.getElementById("scenario-back-button");B.addEventListener("click",function(e){e.preventDefault(),B.style.pointerEvents="none",setTimeout(function(){B.style.pointerEvents="auto"},2500),i.emit("scene-change",{nextScene:"scenario-back"})}),document.getElementById("speedo-launch").addEventListener("click",function(e){e.preventDefault(),i.emit("scene-change",{nextScene:"#scene-five"}),R.style.pointerEvents="none",setTimeout(function(){R.style.pointerEvents="auto"},2500),"truck"===r.state.selectedVehicle&&document.getElementById("truck-ignition-sound-container").components.sound.playSound(),"sedan"===r.state.selectedVehicle&&document.getElementById("start-ignition-sound-container").components.sound.playSound(),"motorcycle"===r.state.selectedVehicle&&document.getElementById("bike-ignition-sound-container").components.sound.playSound(),setTimeout(function(){document.getElementById("driving-sound-container").components.sound.playSound()},3e3),i.emit("sceneFive")});var R=document.getElementById("speedo-back-button");R.addEventListener("click",function(e){e.preventDefault(),R.style.pointerEvents="none",document.getElementById("speedo-launch").style.pointerEvents="none",setTimeout(function(){R.style.pointerEvents="auto",document.getElementById("speedo-launch").style.pointerEvents="auto"},2500),i.emit("scene-change",{nextScene:"speedo-back"})});var P=document.getElementById("too-soon-adjust-speed");P.addEventListener("click",function(e){e.preventDefault(),P.style.pointerEvents="none",I.style.pointerEvents="none",D.style.pointerEvents="none",setTimeout(function(){P.style.pointerEvents="auto",I.style.pointerEvents="auto",D.style.pointerEvents="auto"},2500),l.emit("fadeOutSimulation"),u.classList.add("out-bottom"),h.classList.add("scale-out"),d.classList.add("scale-out"),p.classList.add("out-top"),setTimeout(function(){i.emit("scene-change",{nextScene:"outcome-adjust-speed"})},2e3)});var D=document.getElementById("too-soon-restart");D.addEventListener("click",function(e){e.preventDefault(),P.style.pointerEvents="none",I.style.pointerEvents="none",D.style.pointerEvents="none",setTimeout(function(){P.style.pointerEvents="auto",I.style.pointerEvents="auto",D.style.pointerEvents="auto"},2500),l.emit("fadeOutSimulation"),u.classList.add("out-bottom"),h.classList.add("scale-out"),d.classList.add("scale-out"),p.classList.add("out-top"),setTimeout(function(){i.emit("scene-change",{nextScene:"outcome-restart"})},2e3)});var I=document.getElementById("too-soon-try-again");I.addEventListener("click",function(e){e.preventDefault(),P.style.pointerEvents="none",I.style.pointerEvents="none",D.style.pointerEvents="none",setTimeout(function(){P.style.pointerEvents="auto",I.style.pointerEvents="auto",D.style.pointerEvents="auto"},2500),l.emit("fadeOutSimulation"),u.classList.add("out-bottom"),h.classList.add("scale-out"),d.classList.add("scale-out"),p.classList.add("out-top"),document.getElementById("driving-sound-container").components.sound.playSound(),setTimeout(function(){i.emit("scene-change",{nextScene:"too-soon-reset"})},2e3)}),f.addEventListener("click",function(e){e.preventDefault(),f.style.pointerEvents="none",m.style.pointerEvents="none",O.style.pointerEvents="none",setTimeout(function(){f.style.pointerEvents="auto",m.style.pointerEvents="auto",O.style.pointerEvents="auto"},2500),i.emit("scene-change",{nextScene:"outcome-adjust-speed"})}),m.addEventListener("click",function(e){e.preventDefault(),m.style.pointerEvents="none",f.style.pointerEvents="none",O.style.pointerEvents="none",setTimeout(function(){m.style.pointerEvents="auto",f.style.pointerEvents="auto",O.style.pointerEvents="auto"},2500),i.emit("scene-change",{nextScene:"outcome-restart"})});var O=document.getElementById("outcome-try-again");O.addEventListener("click",function(e){e.preventDefault(),f.style.pointerEvents="none",m.style.pointerEvents="none",O.style.pointerEvents="none",setTimeout(function(){m.style.pointerEvents="auto",f.style.pointerEvents="auto",O.style.pointerEvents="auto"},2500),document.getElementById("driving-sound-container").components.sound.playSound(),i.emit("scene-change",{nextScene:"outcome-again"})}),new Promise(function(e){e(k[Math.floor(Math.random()*k.length)])}).then(function(e){v.innerHTML=e,g.style.opacity=1})}}]);